<html>
<head>
<title>GCP — Deploying highly available databases with GKE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP —在GKE部署高可用性数据库</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcp-deploying-highly-available-databases-with-gke-d4979c7bb6a2?source=collection_archive---------0-----------------------#2021-04-07">https://medium.com/google-cloud/gcp-deploying-highly-available-databases-with-gke-d4979c7bb6a2?source=collection_archive---------0-----------------------#2021-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cf28" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">数据库的GKE</h2></div><h1 id="903c" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">介绍</h1><p id="6e48" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">软件应用程序的容器化改变了软件应用程序打包的简易性。除此之外，Google Kubernetes Engine (GKE)使这些容器的管理变得更加容易。在这篇文章中，我们将看看像数据库这样的有状态应用程序如何利用同样的技术。</p><h1 id="6461" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">架构图</h1><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/c64163e0c101c154e2b38ad8dc5e927b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9p2wSYw8MMyFrMk688KBCg.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx translated">GKE的数据库</figcaption></figure><p id="1dde" class="pw-post-body-paragraph jp jq hi jr b js lb ij ju jv lc im jx jy ld ka kb kc le ke kf kg lf ki kj kk hb bi translated"><strong class="jr hj">识别数据库二进制码</strong> <br/>上图描绘了GKE上任何*关系数据库(如MySQL、Postgresql、MSSQL-Linux)的高可用性部署。你将能够在<a class="ae lg" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>找到所有这些的现成容器图像。</p><p id="ac65" class="pw-post-body-paragraph jp jq hi jr b js lb ij ju jv lc im jx jy ld ka kb kc le ke kf kg lf ki kj kk hb bi translated"><strong class="jr hj">创建GKE集群<br/> </strong>托管数据库的GKE集群应该在单个区域中有一个双区域节点池。这是为了确保基于<a class="ae lg" href="https://cloud.google.com/compute/docs/disks/high-availability-regional-persistent-disk" rel="noopener ugc nofollow" target="_blank">区域持久磁盘</a>的HA设置能够正常工作。<br/> GKE集群应该有具有备用容量的节点，以便在出现故障时，所有POD可以安全地移动到HA区域。</p><p id="195c" class="pw-post-body-paragraph jp jq hi jr b js lb ij ju jv lc im jx jy ld ka kb kc le ke kf kg lf ki kj kk hb bi translated"><strong class="jr hj">为数据库提供存储<br/> </strong> GKE提供永久卷声明(PVC)来存储数据。可以使用PD或PD SSD创建PVC。此外，PVC可以是区域的或区域性的(双区域的)。在此设置中，您应该使用<a class="ae lg" href="https://cloud.google.com/compute/docs/disks/high-availability-regional-persistent-disk" rel="noopener ugc nofollow" target="_blank">区域PD/PD-SSD实现HA </a>目的。区域PD/PD-SSD自动维护两个数据副本(图中的磁盘01和磁盘02)。</p><p id="2092" class="pw-post-body-paragraph jp jq hi jr b js lb ij ju jv lc im jx jy ld ka kb kc le ke kf kg lf ki kj kk hb bi translated"><strong class="jr hj"> GKE服务</strong> <br/>这是一个允许客户端应用程序与数据库通信的门面。虽然可以有各种低级实现，但通常内部负载平衡器(ILB)是在GKE服务的幕后生成的。故障转移后，gke服务会自动重新配置，以便在新的gke pod上发送流量。</p><h1 id="f73e" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">参考实现</h1><p id="9962" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated"><a class="ae lg" href="https://cloud.google.com/solutions/deploying-highly-available-postgresql-with-gke" rel="noopener ugc nofollow" target="_blank">使用GKE </a> <br/>部署高可用性postgresql阅读上面的文章(我写的)以获得使用PostgreSQL的详细说明。然而，同样可以采用任何*通用关系数据库。</p></div></div>    
</body>
</html>