<html>
<head>
<title>Running Eclipse HONO and Ditto on Google Cloud (6)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在谷歌云上运行Eclipse HONO和Ditto)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/running-eclipse-hono-and-ditto-on-google-cloud-6-a715c59a5d05?source=collection_archive---------4-----------------------#2022-08-20">https://medium.com/google-cloud/running-eclipse-hono-and-ditto-on-google-cloud-6-a715c59a5d05?source=collection_archive---------4-----------------------#2022-08-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经验证了与HTTP客户端的端到端连接，如果我的设备使用MQTT会怎样？</p><p id="ed12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Eclipse HONO支持MQTT 3.1.1，要向MQTT端点发布遥测数据，有一些事情需要额外注意。</p><ul class=""><li id="99d2" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj"> clientId: </strong>设备的客户端Id应该是<code class="du jm jn jo jp b">gcp-nnection-name</code> + p，比如你按照这个教程，连接名应该是<code class="du jm jn jo jp b">gcp-connection-org-eclipse-ditto</code>，那么你的MQTT客户端中指定的clientId应该是<code class="du jm jn jo jp b">gcp-connection-org-eclipse-dittop</code></li><li id="291d" class="jd je hi ih b ii jq im jr iq js iu jt iy ju jc ji jj jk jl bi translated"><strong class="ih hj">用户名:</strong>设备的用户名应该是${DEVICE-AUTH}@${TENANT}，如果您按照教程操作，应该是<code class="du jm jn jo jp b">demo-device-001-auth@org.eclipse.ditto</code>，其中<code class="du jm jn jo jp b">demo-device-001</code>是设备标识符，<code class="du jm jn jo jp b">org.eclipse.ditto</code>是HONO租户名称。</li></ul><p id="3bb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的MQTT连接选项应该与此类似</p><pre class="jv jw jx jy fd jz jp ka kb aw kc bi"><span id="2127" class="kd ke hi jp b fi kf kg l kh ki">const connectionArgs = {<br/>host: ‘YOUR MQTT HOST URL’,<br/>port: 1883,<br/>clientId: ‘gcp-connection-org-eclipse-ditto’ + ‘p’,<br/>username: `demo-device-001-auth@<!-- -->org.eclipse.ditto<!-- -->`, <br/>password: ‘my-password’,<br/>protocol: ‘mqtt’<br/>};</span></pre><p id="3903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要将遥测发布到Eclipse HONO，您可以发布到主题<code class="du jm jn jo jp b">t/?content-type=application/json</code>，其中</p><ul class=""><li id="424b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><code class="du jm jn jo jp b">t</code>是认证设备的主题名称。更多详情请参考<a class="ae kj" href="https://www.eclipse.org/hono/docs/user-guide/mqtt-adapter/" rel="noopener ugc nofollow" target="_blank"> Eclipse文档</a>。</li><li id="5346" class="jd je hi ih b ii jq im jr iq js iu jt iy ju jc ji jj jk jl bi translated"><code class="du jm jn jo jp b">/?content-type=application/json</code>是可选的，指定遥测是以JSON格式。</li></ul><p id="0dd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要订阅来自Eclipse的通知，例如，发送到边缘设备的命令，您可以订阅<code class="du jm jn jo jp b">command///req/#</code></p></div></div>    
</body>
</html>