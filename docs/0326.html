<html>
<head>
<title>Write, Launch, Forget: Building a Chatbot on Cloud Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">写、启动、忘记:在云功能上构建聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/write-launch-forget-building-a-chatbot-on-cloud-functions-db69780dc398?source=collection_archive---------1-----------------------#2017-07-04">https://medium.com/google-cloud/write-launch-forget-building-a-chatbot-on-cloud-functions-db69780dc398?source=collection_archive---------1-----------------------#2017-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/caca3ee3038e8e10f95748f910cdb994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IssRskxTzBae0mHq9GK_3Q.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">函数的新家</figcaption></figure><div class=""/><div class=""><h2 id="4a6f" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">我第一次接触无服务器架构</h2></div><h1 id="accb" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">为什么是另一个聊天机器人？</h1><p id="62e3" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">聊天机器人是一个很好的编程练习，因为它们直接、开门见山。</p><p id="affc" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">对于我们这些在MS-DOS时代接触过聊天工具的人来说，聊天机器人很奇怪地让人想起了命令提示符。忘记样板MFC代码和HTML支架——用户的输入和业务逻辑再一次被一个简单的回车键分开。</p><p id="7e15" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">这一次，您不是从STDIN中读取，而是从一个经过92层抽象、传输和代码转换协议的字符串参数中读取，它是从半个世界之外发送过来的。聊天机器人协议的承诺是你永远不需要担心那些细节；这是站台(信使、电报、线路等)的职责。)将其用户的移动应用连接到您的互联网服务器。</p><h1 id="015a" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">承诺</h1><p id="314c" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">无服务器架构只是这一承诺的逻辑延伸。现在，您只需编写一个函数——代码执行的原子单位——并且不再需要担心它如何运行。</p><p id="79c7" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">对于这个练习，我选择了谷歌云功能，因为我一直想尝试一下。它应该同样适用于AWS Lambda。</p><p id="8665" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">Google Cloud Functions负责提供底层机器、调度您的代码以及将您的请求发送给您。假设你的功能会在没有你参与的情况下无限放大和缩小，这是安全的。作为一个喜欢搞一些小项目，但又不愿意在三年后将它们从不可避免的平台腐烂中拯救出来的人来说，这简直好得令人难以置信。</p><h1 id="18ad" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">问题是</h1><p id="175d" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">如果您有一段时间没有运行它，或者您刚刚部署了一个新版本，它将会遭受缓慢的冷启动。这是可以理解的，因为应用程序包需要时间在整个服务器场中传播，并且实例需要加速运行。如果你的应用程序流量很大，这应该不是问题。</p><p id="0520" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">哦，还要用Node.js写。</p><p id="3994" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">对于无服务器编程来说，Node.js是一个非常好的选择——我说的非常好是指非常糟糕的选择，因为该语言及其整个生态系统是为异步、无阻塞的世界而设计的。顺便提一下，这是你最不在乎的属性，<strong class="kg hy">在一个没有任何东西相互阻塞的生产环境中，<em class="lf">线程</em>和<em class="lf">进程</em>是从词汇表</strong>中完全缺失的概念。</p><p id="5af7" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">JavaScript开发人员已经花费了137，285个集体人工年来讨论如何使异步程序不那么令人呕吐，他们已经提出了差不多同样多的解决方案。因为到目前为止，他们中没有一个是明确一致的赢家，所以我可以自由选择我最不讨厌的。</p><p id="6097" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">我选择了IcedCoffeeScript，它是普通JavaScript之上的两层宏。第一层(CoffeeScript)将我们从大括号和分号的地狱中拯救出来；第二层，回调地狱。</p><div class="hh hi ez fb hj lh"><a href="http://maxtaco.github.io/coffee-script" rel="noopener  ugc nofollow" target="_blank"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hy fi z dy lm ea eb ln ed ef hw bi translated">IcedCoffeeScript</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">通过示例安装ics ics基础ICS控制流ICS:教程结论ICS:阅读更多用法概述语言…</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">maxtaco.github.io</p></div></div></div></a></div><h1 id="c164" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">设置它</h1><p id="7eab" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">开始使用谷歌云功能非常简单。界面是光滑的材料设计风格，并夹杂着大量的提示，所以你几乎可以不用参考他们做得很好的文档。</p><p id="2272" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">GCF期望你的调度函数实现Express API，仅此而已。它不会对您选择的模块或数据库引擎做出判断。因为开始使用Facebook Messenger API的最低要求是正确回答它的挑战，所以我用下面的代码让日志开始流动:</p><figure class="lq lr ls lt fd hk"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="9c10" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">我切换回日志控制台，并开始滥发测试脸书页面。它开始被信息填满，但在我忘记这个小练习之后很久，它还会继续这样。</p><p id="0e6d" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">总之，我花了大约两个小时来设置这个，其中大部分时间都花在了研究上。</p><h1 id="d293" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">向外扩展</h1><p id="0897" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">最终，我的一个文件片段变成了一个包含node_modules、gitignore和whatnots的合适的存储库。该存储库也位于GCP。我特别喜欢的不是被迫从一开始就创建一个新的存储库，而是允许我按照自己的速度来做。</p><p id="0ab7" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">直到我第三次重构的时候，训练的车轮才慢慢磨损，我开始摸索我的代码组织。我是从一个存储库中运行许多功能，还是将它们分散开来？我是将<em class="lf">视图</em>保存在同一个文件中，还是作为单独的文件保存在一个文件夹中，或者它甚至是这里的一个东西？</p><figure class="lq lr ls lt fd hk er es paragraph-image"><div class="er es lw"><img src="../Images/3a2fdc49a1bbe109fa883f422d4bd0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*16eucR2oPHDQi122K1dD_Q.png"/></div></figure><p id="41e7" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">这感觉就像是一个框架可以真正进来并提出一般最佳实践的地方。但是，当对大量应用程序应该如何构建达成共识时，框架就出现了，而且可能还没有那么多。有一个被称为<a class="ae lg" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器</a>的既定框架，我计划下一步研究他们的方法，尽管他们似乎不重视文档。</p><h1 id="08fd" class="jm jn hx bd jo jp jq jr js jt ju jv jw jd jx je jy jg jz jh ka jj kb jk kc kd bi translated">思想</h1><p id="6310" class="pw-post-body-paragraph ke kf hx kg b kh ki iy kj kk kl jb km kn ko kp kq kr ks kt ku kv kw kx ky kz hb bi translated">我认识的那些将<a class="ae lg" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank">fire base</a>引入他们的武器库的人似乎对此深信不疑。紧挨着他们的是一大群人，他们发誓永远不与它有任何关系，因为他们害怕创建一个其核心业务功能完全依赖于一家公司心血来潮的堆栈。</p><div class="hh hi ez fb hj lh"><a href="https://startupsventurecapital.com/firebase-costs-increased-by-7-000-81dc0a27271d" rel="noopener  ugc nofollow" target="_blank"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hy fi z dy lm ea eb ln ed ef hw bi translated">火焰基地的成本增加了7000%！</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">更新(2017年5月17日上午8:50):</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">startupsventurecapital.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc hp lh"/></div></div></a></div><p id="3462" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">对我来说，无服务器架构代表了两个世界之间非常明智的妥协。</p></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><p id="1c15" class="pw-post-body-paragraph ke kf hx kg b kh la iy kj kk lb jb km kn lc kp kq kr ld kt ku kv le kx ky kz hb bi translated">我将定期分享我在担任一家灵活的初创公司的首席技术官期间遇到的方法和流程。如果您对此感兴趣，请关注和/或打招呼。</p></div></div>    
</body>
</html>