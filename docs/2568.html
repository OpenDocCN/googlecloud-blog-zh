<html>
<head>
<title>GCP Native GKE Backup Solution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP本地GKE备份解决方案</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcp-native-gke-backup-solution-ef971750c388?source=collection_archive---------0-----------------------#2022-11-29">https://medium.com/google-cloud/gcp-native-gke-backup-solution-ef971750c388?source=collection_archive---------0-----------------------#2022-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6de1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GKE的备份</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/da2f2c3c5a67af7d65b91959e55bf699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qq0LqW0mNOd37UZpqCGQYw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">GCP本地备份解决方案</figcaption></figure><p id="4664" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">简介</strong></p><p id="7a50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes集群的备份一直是确保高可用性和容错解决方案的热门话题。虽然市场上很少有第三方软件解决方案，但对于希望利用云成熟度的企业客户来说，完全原生的解决方案始终是一个需求。</p><p id="30f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，GCP推出了GKE备份功能，为GKE集群提供备份。它集成了GKE用户界面、gcloud CLI。</p><p id="7b89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是备份？</strong></p><p id="a4cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GKE捕获的备份</p><ol class=""><li id="b243" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">配置备份:GKE集群的K'8资源描述集(应用程序)。它单独存储有状态数据，还存储集群数据的自定义脚本。</li><li id="5ec1" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">卷备份:已经创建的所有永久卷声明。</li></ol><p id="d604" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以根据需要安排备份和从备份恢复。更多细节可以在<a class="ae ko" href="https://cloud.google.com/kubernetes-engine/docs/add-on/backup-for-gke/concepts/backup-for-gke" rel="noopener ugc nofollow" target="_blank">这里找到。</a></p><p id="4b5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">GKE备份的主要特点</strong>:</p><ol class=""><li id="a806" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">谷歌云原生解决方案:与GKE控制台完全集成。</li><li id="51c6" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">精细控制:选择特定的应用程序、命名空间或整个集群进行备份或恢复</li><li id="6308" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">灵活运营:在一个区域备份克隆工作负载，然后恢复到另一个区域。</li><li id="c9c5" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">策略管理:设置备份计划和数据保留策略。</li></ol><p id="9286" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么没有备份？</strong></p><ol class=""><li id="75f3" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">GKE群集配置，如节点池、启用的功能、节点配置。</li><li id="d3d0" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">备份引用的容器映像。</li><li id="8656" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">集群之外的服务的配置信息或状态，例如云sql或外部负载平衡器。</li></ol><p id="c974" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何配置备份计划？</strong></p><p id="557e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要在GKE上启用备份，您需要启用工作负载标识。这里有一个现有群集，我将为其启用备份。</p><ol class=""><li id="2c83" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">在GKE集群和节点池上启用工作负载标识，还应该配置一个元数据服务器。</li></ol><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kp"><img src="../Images/c88c136e3cb0192d626866ec777a93a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3LYwRBbpeniRLx_PQRLnfg.png"/></div></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kq"><img src="../Images/32cde78cb9c98ec12786d315a2da31f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lGJmmsCo3JVuFL4TuYG2RA.png"/></div></div></figure><p id="d1c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.滚动到GKE服务的备份，并启用GKE服务的备份。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/70850b0d0e9f89ee12ee2c11e5754aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEGdfzhc39d9I_nh0eVOaw.png"/></div></div></figure><p id="16a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.点击<em class="ks">创建备份计划</em>，创建备份计划。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/9b2802839951359eaf6d5b0bb6ef9ca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHa7HEnk8Idt8ieTMvlR8A.png"/></div></div></figure><p id="4634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.您可以选择命名空间或整个群集、永久卷和密钥来加密备份。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kt"><img src="../Images/3cac92c7aad9c14b99c658dc00c4a677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WHVW6r10dD20VDgVJg8Hxw.png"/></div></div></figure><p id="2586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.您可以使用cron表达式指定备份计划，然后选择保留备份的天数。选项锁定备份从意外删除和审计。最后复习创造。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ku"><img src="../Images/8e70720fd1957eb7f2175185d53bf554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wtyy2LsootEOl6ZPaTa8FA.png"/></div></div></figure><p id="3449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.创建备份计划后，它将列在群集名称下。您可以启动按需备份(如果需要)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/977876c25163529326b4d3c941a1d04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8TYKA86chKc6VfoJumpd_g.png"/></div></div></figure><p id="1019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何配置恢复计划？</strong></p><ol class=""><li id="4f48" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">同样，我们可以创建一个恢复计划。</li></ol><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kv"><img src="../Images/974695d9d519b809796ff9eadce25a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tFhO20ciEsviR4XeYNea5A.png"/></div></div></figure><p id="f265" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.选择要恢复的命名空间。我们有两个选择来解决冲突，要么冲突失败，要么回滚。可以相应地选择恢复永久卷的选项。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kw"><img src="../Images/fe8b36000bb4433ed990f2b6862c96ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHSVvigGB6tTiXxDGdjBOA.png"/></div></div></figure><p id="76a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.排除其他选项，因为它们是可选的。单击创建恢复计划。</p><p id="1616" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，创建恢复计划。您可以使用它从任何可用的备份版本中恢复。万一我们还没有任何后援。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/bff990e39bb651a85192f509345c7f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCNGqqgmeLvRWyPyx5vldg.png"/></div></div></figure><p id="b1bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上述所有配置也可以通过gcloud命令来完成。这个博客到此为止。快乐学习。</p></div></div>    
</body>
</html>