<html>
<head>
<title>Google Cloud Functions: Scheduling (Cron)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云功能:日程安排(Cron)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-functions-scheduling-cron-5657c2ae5212?source=collection_archive---------1-----------------------#2017-12-04">https://medium.com/google-cloud/google-cloud-functions-scheduling-cron-5657c2ae5212?source=collection_archive---------1-----------------------#2017-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/75d0da55912af21f7ab01580709a78a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*meNHFp2XlBRYb4Xq1zp1Kw.png"/></div></figure><p id="3c86" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在<a class="ae jk" rel="noopener" href="/@viatsko/deploying-google-cloud-functions-in-5-easy-steps-21f6d837c6bb">之前的一篇文章</a>中，我解释了部署谷歌云功能的5个简单步骤。在本文中，我将解释如何在Google Cloud Standard App Engine平台上为它设置cron。</p><p id="d24a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">问题是NodeJS只在App Engine Flexible上可用，只是为了用cron踢GCF而设置Flexible实例没有意义。</p><p id="1d74" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">相反，我们可以创建一个简单的python应用程序，并将其部署在App Engine标准平台上。</p><p id="f43d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要向应用程序添加3个文件:</p><p id="49b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">app.yaml</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="b643" class="ju jv hi jq b fi jw jx l jy jz">runtime: python27<br/>api_version: 1<br/>threadsafe: true</span><span id="60d0" class="ju jv hi jq b fi ka jx l jy jz">handlers:<br/>- url: /.*<br/>  script: main.app</span><span id="eba1" class="ju jv hi jq b fi ka jx l jy jz">skip_files:<br/>  - ^node_modules/.*</span></pre><p id="0b0a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">cron.yaml</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="5ef6" class="ju jv hi jq b fi jw jx l jy jz">cron:<br/>    - description: "regular job"<br/>      url: /hourly<br/>      schedule: every 1 hours</span></pre><p id="279f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">main.py</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="e0a2" class="ju jv hi jq b fi jw jx l jy jz">import webapp2<br/>import urllib2</span><span id="4707" class="ju jv hi jq b fi ka jx l jy jz">class HourlyCronPage(webapp2.RequestHandler):<br/>    def get(self):<br/>        response = urllib2.urlopen('<a class="ae jk" href="https://us-central1-open-source-awards.cloudfunctions.net/fetch-trending'" rel="noopener ugc nofollow" target="_blank">&lt;url_of_your_cloud_function&gt;'</a>)</span><span id="210f" class="ju jv hi jq b fi ka jx l jy jz">self.response.write(response.read())</span><span id="9806" class="ju jv hi jq b fi ka jx l jy jz">app = webapp2.WSGIApplication([<br/>    ('/hourly', HourlyCronPage),<br/>], debug=True)</span></pre><p id="fd09" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建这些文件后，部署cronjob运行程序的步骤如下:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="6a14" class="ju jv hi jq b fi jw jx l jy jz">gcloud app deploy<br/>gcloud app deploy cron.yaml</span></pre><p id="37cc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">尽情享受吧！🎉</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="83ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你好，我是瓦莱里。我在阿姆斯特丹生活和写作。我写了这篇文章，所有观点都是我自己的。如果你喜欢读它，一定要在推特上关注我【https://twitter.com/viatsko T2】</p></div></div>    
</body>
</html>