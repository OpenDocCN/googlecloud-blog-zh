<html>
<head>
<title>Google Cloud Tips and Tricks: Understanding the Resource Hierarchy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云提示和技巧:理解资源层次</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-tips-and-tricks-understanding-the-resource-hierarchy-3227f225a8e7?source=collection_archive---------0-----------------------#2020-03-06">https://medium.com/google-cloud/google-cloud-tips-and-tricks-understanding-the-resource-hierarchy-3227f225a8e7?source=collection_archive---------0-----------------------#2020-03-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="da23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，你想开始在谷歌云上构建你的基础设施。您已经阅读了所有关于云是未来的内容，并且您已经准备好采取行动。但是在云上进行构建似乎有些力不从心。从理论上讲，你可以在短短的几天内启动一台造价数千美元的巨型服务器。呀。</p><p id="d00c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这听起来很可怕，但事实并非如此。我将分享一些在Google Cloud上组织资源的重要技巧(小建议)和诀窍(有用的提示)。我希望我将分享的内容能够帮助您更快地开始，并更好地理解您在云中运行的内容。让我们把事情变得更简单，更简单。</p><h1 id="34a3" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">资源层次结构</h1><p id="f92d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我听说剥猫皮的方法不止一种。虽然我不知道这是什么意思，但我知道有不止一种方法来组织你的谷歌云资源。这就是资源层级。</p><p id="3fa1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该层级可以映射到您组织的结构，并允许您管理对所有云资源的访问和权限。下面是一个资源层级的例子，直接来自谷歌云的官方资源层级<a class="ae kg" href="https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy" rel="noopener ugc nofollow" target="_blank">文档</a>:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/0281014bd15bb4bb784a381ef8583dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Id_WW48rv5_nRhPH"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">你的等级可能会有所不同</figcaption></figure><p id="fe12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的资源层次结构可以像一个组织下的单个项目一样简单，但是如果您有更大的计划，有更多的方法来组织事情，以便您可以更好地了解哪些团队使用哪些资源以及负责哪些成本。</p><h2 id="52a4" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">提示:做一些规划</strong></h2><p id="2a70" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">了解资源层次结构将使您能够以最适合组织的方式组织资源。做一些类似于上面的图表，以了解您的资源层次结构可能是什么样子。如果您的组织是按部门分组的，那么这些部门映射到文件夹可能是有意义的。考虑访问管理的主要连接点—组织级别、文件夹级别和项目级别—并记住权限是自上而下继承的。</p><h2 id="a255" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">绝招:开始简单</strong></h2><p id="6b16" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">资源层次结构是灵活的。在初始设置后，您可以随时移动项目、文件夹和更改权限，所以不要对您的计划感到不知所措。在绘制图表时熟悉组织资源，这样您可以进行更小更快的更改。</p><h1 id="92f2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">领域和组织</h1><p id="0d52" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">这是资源层次结构的顶层。当你注册云身份或G套件时，你将被要求提供一个<strong class="ih hj">域</strong>。当这得到验证后，一个<strong class="ih hj">组织</strong>就创建了。它本质上是谷歌云创造的所有事物的保护伞。所有创建的项目都将属于组织，而不是创建它们的用户。这在项目所有者离开组织的情况下尤其重要。在组织级别设置的权限将被下面的文件夹和项目继承。</p><h2 id="62b9" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">提示:你只需要一个组织</strong></h2><p id="dc57" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">您可能需要管理多个组织。但是，您的G Suite或云身份帐户仅限于一个组织和一个域。请考虑将您的子组织组织为文件夹。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ll"><img src="../Images/b493d17c8090cbb981b7ae83a8aecb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ypowfBIGDA50pxA6"/></div></div></figure><p id="43cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果这确实不能满足您的需求，您可以管理多个G Suite或云身份帐户，从而管理多个组织。不利的一面是，它们将相互隔离，需要单独的域，并且缺乏集中的访问和管理。这里有更多关于使用多个组织节点的效果的信息。</p><h2 id="9d00" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">招数:从IAM开始</strong></h2><p id="4702" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">如果您刚刚开始并设置您的组织，您开始使用的初始帐户将具有有限的权限。事实上，您将只有角色<strong class="ih hj">组织管理员</strong>。<strong class="ih hj">组织管理员</strong>将能够访问属于该组织的所有项目，并将IAM角色分配给其他用户。在探索您的组织下的文件夹和项目创建之前，花点时间检查一下<a class="ae kg" href="https://console.cloud.google.com/projectselector2/iam-admin/org-onboarding" rel="noopener ugc nofollow" target="_blank">身份&amp;组织页面。</a>在这里，您可以迁移项目、创建计费帐户、为自己或其他用户扩展权限，甚至将组织管理权限委托给其他人。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lm"><img src="../Images/424dd7b39f89e8107bb8f51f6eaef313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Fe5DRKMSvoGUh-qZ"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">IAM &amp; Admin的身份和组织页</figcaption></figure><h1 id="918f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">账单账户和支付配置文件</h1><p id="65fa" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><strong class="ih hj">计费账户</strong>是一个云端资源，用于管理与计费相关的功能。在这里，您将定义用于支付云使用费用的支付方式，访问成本报告和预测，生成预算以避免意外，以及几乎所有与账单相关的事情。</p><p id="cce3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然计费帐户是在云控制台中管理的，但<strong class="ih hj">支付配置文件</strong>是一个谷歌级的资源，可以连接到所有的谷歌服务，如云、广告或Chrome许可证。我之所以在这里提到它，是因为需要将一个计费帐户链接到一个现有的支付配置文件，否则将会创建一个。如果你还没有支付其他谷歌服务，你可能不需要担心连接到现有的支付配置文件。</p><h2 id="9377" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">提示:使用单一计费账户</strong></h2><p id="9cc9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">您可以为每个组织配置多个计费帐户，但我建议坚持使用单个计费帐户。将您组织的所有项目关联到一个计费帐户将使您能够更完整、更集中地查看您的成本，并使其更易于跟踪。</p><h2 id="66be" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">诀窍:了解付费账户用户、观众和管理员</strong></h2><p id="3b0d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">您可以委派3种类型的计费帐户角色:计费帐户<strong class="ih hj">用户</strong>，计费帐户<strong class="ih hj">查看者</strong>，以及计费帐户<strong class="ih hj">管理员</strong>。虽然管理员可以取消项目链接、设置预算和启动计费导出，但计费帐户用户只能关联项目和查看支出。计费帐户管理员也是唯一可以联系计费支持的人。付费帐户查看者拥有与用户相同的权限，但有更多的可见性。要特别注意用户、查看者和管理员之间的差异，并相应地将每个角色分配给不同的组或人。作为参考，下面并列列出了每个角色的权限:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ln"><img src="../Images/56151a56b0d9841cfa9c53eed6a37b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_lQKQKwascMb3jdi"/></div></div></figure><h1 id="4f63" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">资源</h1><p id="3350" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">面包和黄油。肉和土豆。资源是任何谷歌云服务，像BigQuery，Compute Engine，云存储等。资源被组织成<strong class="ih hj">个项目。</strong></p><h2 id="120b" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">提示:想想你的文件夹</strong></h2><p id="d977" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">项目可以组织到<strong class="ih hj">文件夹</strong>中。与基本的文件系统非常相似，一个项目将从它所属的文件夹中继承权限和访问权，以及它上面的组织。如果您计划在Google Cloud上有多个项目，或者如果您的组织下有多个团队将部署到Google Cloud，那么一定要考虑使用文件夹。正如我前面提到的，文件夹是访问管理的一个附加点，可以更容易地委派角色和权限。如果您导出到Big Query，它还将为您提供另一种方式来分解月底的账单费用，允许您通过文件夹<a class="ae kg" href="https://cloud.google.com/blog/products/data-analytics/analyzing-gcp-costs-using-folders-and-bigquery-billing-export" rel="noopener ugc nofollow" target="_blank">而不是单个项目</a>来分析成本。</p><h2 id="b4dd" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">诀窍:使用标签获得额外的粒度</strong></h2><p id="8338" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">标签提供了一种横向组织项目资源的方式，并帮助您获得更精细的成本视图。例如，假设您有一个项目，其中的虚拟机和Kubernetes集群对应于一个试运行或生产环境。通过应用带有关键字“环境”和值“暂存”或“生产”的标签，您可以看到每个环境的支出，而不仅仅是资源类型。你的粒度越细，你就能更好地理解你的成本并控制它们。你可以在这里阅读更多关于标签的信息。</p><h1 id="530c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">更多资源开始使用</h1><p id="72c7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">为了帮助你开始使用云计算，谷歌提供了一个价值300美元的<a class="ae kg" href="https://console.developers.google.com/billing/freetrial?hl=en" rel="noopener ugc nofollow" target="_blank">免费试用。</a>他们的定价登陆页面是正确的<a class="ae kg" href="https://cloud.google.com/pricing" rel="noopener ugc nofollow" target="_blank">这里</a>。要了解更多关于账单的信息，请查看Youtube上的<a class="ae kg" href="https://twitter.com/markmirch" rel="noopener ugc nofollow" target="_blank"> Mark Mirchandani </a>的<a class="ae kg" href="https://www.youtube.com/playlist?list=PLIivdWyY5sqKJx6FwJMRcsnFIkkNFtsX9" rel="noopener ugc nofollow" target="_blank">超越你的账单系列</a>，它涵盖了上面的大部分内容以及更多内容。</p><p id="b101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝你好运！</p><p id="b884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo"> **不，提示和技巧之间没有明显的区别。</em></p></div></div>    
</body>
</html>