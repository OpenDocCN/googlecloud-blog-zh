<html>
<head>
<title>A Node.JS Websocket Server on Google App Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个节点。Google App Engine上的JS Websocket服务器</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/a-node-js-websocket-server-on-google-app-engine-c6c32a486e9a?source=collection_archive---------0-----------------------#2017-05-10">https://medium.com/google-cloud/a-node-js-websocket-server-on-google-app-engine-c6c32a486e9a?source=collection_archive---------0-----------------------#2017-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bc0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近我实现了一个websocket服务器来演示一些iOS特性。该服务器最初在我的本地端运行良好。经过一些测试后，我决定将websocket服务器迁移到google云平台，以获取公共ip用于演示目的。</p><p id="7767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我第一次使用应用引擎，它真的花了我很多时间。</p><p id="9de1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是将web套接字部署到GAE的一些简单步骤。</p><p id="a6d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，注册谷歌云平台，现在它提供300次免费试用来测试它的云服务。</p><p id="4979" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注册后，点击App Engine，一步一步运行官方快速入门教程。</p><p id="f81e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的。现在，我们能够将node.js项目部署到App Engine。</p><p id="bb35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，从以下位置克隆一个websocket示例:</p><p id="fb9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://github.com/GoogleCloudPlatform/nodejs-docs-samples/tree/master/appengine/websockets" rel="noopener ugc nofollow" target="_blank">https://github . com/Google cloud platform/nodejs-docs-samples/tree/master/app engine/web sockets</a></p><p id="722c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是谷歌的一个例子。它展示了如何在app engine上实现websocket。</p><p id="db28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，我们在gcloud控制台中克隆项目并部署，一切都会好的？</p><p id="c852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不。我们需要一些修改。</p><p id="0a85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先修改app.yaml:</p><blockquote class="je"><p id="d8b9" class="jf jg hi bd jh ji jj jk jl jm jn jc dx translated">#vm:对</p><p id="a91a" class="jf jg hi bd jh ji jj jk jl jm jn jc dx translated">环境:伸缩</p></blockquote><p id="21e6" class="pw-post-body-paragraph if ig hi ih b ii jo ik il im jp io ip iq jq is it iu jr iw ix iy js ja jb jc hb bi translated">并且请注意这个文件的结尾:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/340adcc0b82be09223be385c9106c0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*Cg8aThbSOkWja4hmIsqv4A.png"/></div></figure><p id="fe86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这部分很重要。</p><p id="0090" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，通过README中列出的命令为您的防火墙启用端口65080</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="er es kb"><img src="../Images/b5794b88302229956db8b778c94c361e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9wF-YIeAa9csNjnOhewTHw.png"/></div></div></figure><p id="c5a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此之后，只需部署到应用程序引擎，一切都会很好。</p><p id="3403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">部署后，我们将获得如下URL:</p><p id="61fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://{project" rel="noopener ugc nofollow" target="_blank">https://{项目</a>名称}.appspot.com</p><blockquote class="kg kh ki"><p id="fcd5" class="if ig kj ih b ii ij ik il im in io ip kk ir is it kl iv iw ix km iz ja jb jc hb bi translated"><strong class="ih hj">将https替换为http </strong>，因为App Engine上的websocket现在不支持安全模式。</p></blockquote><p id="0440" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，启动以<strong class="ih hj"> <em class="kj"> http </em> </strong> ://开头的新网址，现在就试试websocket吧！</p><h2 id="7636" class="kn ko hi bd kp kq kr ks kt ku kv kw kx iq ky kz la iu lb lc ld iy le lf lg lh bi translated">注意:在我的测试中，App Engine预览模式不适用于websocket。</h2></div></div>    
</body>
</html>