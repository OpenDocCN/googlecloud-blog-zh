<html>
<head>
<title>Introduction to Google Container Builder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google容器构建器简介</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/introduction-to-google-container-builder-dbe6645f9421?source=collection_archive---------0-----------------------#2017-06-11">https://medium.com/google-cloud/introduction-to-google-container-builder-dbe6645f9421?source=collection_archive---------0-----------------------#2017-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8dcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://cloud.google.com/container-builder/" rel="noopener ugc nofollow" target="_blank"> Google Container Builder </a>是一个有趣的工具，它允许您使用Google云平台的力量来快速可靠地构建您的容器映像。</p><p id="0f6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就它能做的事情而言，这个名字有点令人困惑，但我将谈论一个我一直在使用的流程场景，我相信它适用于我们大多数人，并看看Google Container Builder如何使它更高效。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4b5976b0c9b66729814d8941153d9952.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/0*m7275oIn61uG2_X0.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">图片参考:<a class="ae jd" href="https://cloud.google.com/container-builder/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/container-builder/</a></figcaption></figure><h1 id="6c0f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">我们的使用案例</h1><p id="1b2f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">如果您一直在使用Docker，那么最重要的事情之一就是构建一个Docker映像，并让其他人可以获取该映像以在他们的本地环境中使用。这个过程大概是这样的:</p><ul class=""><li id="1eea" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">您应该有一个包含所有工具的本地Docker环境。</li><li id="4acc" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">写一个Docker文件来构建你的Docker镜像。</li><li id="56da" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">执行<code class="du ll lm ln lo b">docker build</code>命令创建图像，并用图像名称和版本对其进行标记</li><li id="46c7" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">使用<code class="du ll lm ln lo b">docker push</code>命令将生成的图像推送到Docker Hub</li></ul><p id="a35a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个过程无疑是简单的，但是如果你已经使用了一段时间，你会观察到一些事情。这些要点是基于我的经验，既做本地开发，又向广大开发人员讲授Docker:</p><ul class=""><li id="aba8" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated"><code class="du ll lm ln lo b">docker build</code>要求你有一个良好的网络来降低依赖性。理想情况下，您最终会考虑将这一步转移到整个构建系统中。</li><li id="c74b" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">执行<code class="du ll lm ln lo b">docker push</code>命令需要很长时间，该命令将图像移动到Docker Hub。当你的Docker图像文件很大时，这个问题变得更加复杂。</li><li id="a12a" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">集成其他容器注册中心如<a class="ae jd" href="https://cloud.google.com/container-registry/" rel="noopener ugc nofollow" target="_blank"> Google容器注册中心</a>并不简单。它需要一些设置才能与标准的Docker工具一起工作。</li><li id="6187" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">在许多情况下，网络是一个限制因素，因此我经常建议，在学习Docker或使用Docker时，云是您最好的朋友。我建议人们在云中拥有一个虚拟机，然后惊讶于<code class="du ll lm ln lo b">docker build/push</code>命令的运行速度。它极大地提高了你使用Docker工具集的效率。</li></ul><p id="af8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来我们将看到Google Container Builder如何通过在云中为您提供一个环境来解决上述问题，该环境将加速您的容器构建，自动将图像推送到Google Container Registry。我们只是触及了Google Container Builder的皮毛，它具有与构建过程集成、触发事件以通知外部用户、定制构建脚本等功能。</p><h1 id="c057" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">使用Google容器构建器构建Docker图像</h1><p id="c0de" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这里我们假设您已经有了自己的应用程序和相关的Docker文件来帮助构建Docker映像。如果没有，你可以从<a class="ae jd" href="https://github.com/rominirani/Google-Container-Builder-Demo" rel="noopener ugc nofollow" target="_blank">这里</a>拉一个简单的项目(在这篇文章的后面会给出操作说明):</p><p id="0dcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Google Cloud SDK，它为我们提供了命令行工具(命令)来处理容器图像。它包含构建、列出和执行其他容器图像操作的命令。</p><h2 id="e6bc" class="lp jv hi bd jw lq lr ls ka lt lu lv ke iq lw lx ki iu ly lz km iy ma mb kq mc bi translated">设置</h2><p id="ac0a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我假设你对谷歌云平台(GCP)很熟悉，你有一个付费账户，可以浏览<a class="ae jd" href="http://console.cloud.google.com" rel="noopener ugc nofollow" target="_blank"> GCP控制台</a>，有一个谷歌云平台项目，最重要的是已经下载并初始化了<a class="ae jd" href="https://cloud.google.com/sdk/" rel="noopener ugc nofollow" target="_blank">谷歌云SDK </a>。</p><p id="6cce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果上述情况属实，我们需要确保以下几点:</p><ol class=""><li id="0fae" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc md ld le lf bi translated">转到项目的GCP控制台，确保启用了Google容器构建器API。从控制台中，访问API管理器→库，如下所示:</li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es me"><img src="../Images/c3a9c4c4b441921137963bd214715528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*qPw9ESDg6H6H16nHFHKVhA.png"/></div></figure><p id="ccce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">键入Container builder，它应该会显示Google Container Builder API。单击它，并确保启用它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mf"><img src="../Images/d339ef1842f0b1a60545613432d325e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*mNrWl9IMH_gAozow1a9_hw.png"/></div></figure><p id="524f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.从控制台或终端，我们将假设您已经验证了您的Google Cloud SDK，并使用如下所示的一组命令设置默认项目:<br/> <code class="du ll lm ln lo b">$ gcloud auth login</code>和<br/> <code class="du ll lm ln lo b">$ gcloud config set project [YOUR_PROJECT_ID]</code></p><h2 id="823e" class="lp jv hi bd jw lq lr ls ka lt lu lv ke iq lw lx ki iu ly lz km iy ma mb kq mc bi translated">命令</h2><p id="6bb2" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们要做的第一件事是创建一个简单的应用程序及其相关的Dockerfile。我已经提供了一个项目，足以看到这个过程在行动中。</p><p id="53c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里简单地引入项目:</p><div class="mg mh ez fb mi mj"><a href="https://github.com/rominirani/Google-Container-Builder-Demo" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">rominirani/Google-容器生成器-演示</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">Google-Container-Builder-Demo -构建Docker图像的示例项目</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">github.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx jo mj"/></div></div></a></div><p id="851f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您已经在本地机器上安装了<code class="du ll lm ln lo b">git</code>，在您选择的特定目录中执行以下操作:</p><pre class="jf jg jh ji fd my lo mz na aw nb bi"><span id="ad00" class="lp jv hi lo b fi nc nd l ne nf">$ git clone <a class="ae jd" href="https://github.com/rominirani/Google-Container-Builder-Demo" rel="noopener ugc nofollow" target="_blank">https://github.com/rominirani/Google-Container-Builder-Demo</a></span></pre><p id="e8e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了！接下来我们需要做的就是将我们的图像构建提交给Google容器构建器。就是这样。</p><p id="651a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">向Google Cloud中的容器构建器环境提交构建的<code class="du ll lm ln lo b">gcloud</code>工具命令如下:</p><pre class="jf jg jh ji fd my lo mz na aw nb bi"><span id="acdb" class="lp jv hi lo b fi nc nd l ne nf">$ gcloud container builds submit --tag gcr.io/[PROJECT-ID]/[IMAGENAME]:[VERSION] .</span></pre><p id="cb17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个命令很容易理解:</p><ul class=""><li id="bd28" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">它向Google容器构建器提交一个构建。</li><li id="534e" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated"><code class="du ll lm ln lo b">tag</code>选项是你从Docker那里了解到的。在这种情况下，最终构建的映像将被推送到<a class="ae jd" href="https://cloud.google.com/container-registry/" rel="noopener ugc nofollow" target="_blank"> Google Container Registry </a>，这是一个快速可靠的容器映像托管服务。前缀是gcr.io，接下来的两部分是你在Google云平台中的项目名，然后是Docker镜像和版本。</li><li id="d6ad" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">最后一个参数是<code class="du ll lm ln lo b">.</code>，它是<code class="du ll lm ln lo b">Dockerfile</code>所在的目录。</li></ul><p id="01ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的例子中，我的GCP项目被命名为mindstormclouddemo，我希望将我的Docker图像命名为myapp，版本为1.0。该命令如下所示:</p><pre class="jf jg jh ji fd my lo mz na aw nb bi"><span id="984e" class="lp jv hi lo b fi nc nd l ne nf">$ gcloud container builds submit --tag gcr.io/mindstormclouddemo/myapp:1.0 .</span></pre><p id="ea05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将触发如下所示的过程，并产生一系列有趣的步骤来查看正在发生的事情<strong class="ih hj">(我已经用我的注释对其中的一些部分进行了注释和格式化)</strong>:</p><pre class="jf jg jh ji fd my lo mz na aw nb bi"><span id="374a" class="lp jv hi lo b fi nc nd l ne nf">$ gcloud container builds submit --tag gcr.io/mindstormclouddemo/myapp:1.0 .</span><span id="2fc2" class="lp jv hi lo b fi ng nd l ne nf"><strong class="lo hj">Creating temporary tarball</strong> archive of 37 file(s) totalling 34.1 KiB before compression. <strong class="lo hj">&lt;-- This zips the folder and moves to Google Cloud Storage</strong><br/>Uploading tarball of [.] to [gs://mindstormclouddemo_cloudbuild/source/1497163737.39.tgz]<br/>Created [<a class="ae jd" href="https://cloudbuild.googleapis.com/v1/projects/mindstormclouddemo/builds/a329e313-5ff4-4d51-9a7b-78c1f11e13b0" rel="noopener ugc nofollow" target="_blank">https://cloudbuild.googleapis.com/v1/projects/mindstormclouddemo/builds/a329e313-5ff4-4d51-9a7b-78c1f11e13b0</a>].<br/>Logs are available at [<a class="ae jd" href="https://console.cloud.google.com/gcr/builds/a329e313-5ff4-4d51-9a7b-78c1f11e13b0?project=mindstormclouddemo" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/gcr/builds/a329e313-5ff4-4d51-9a7b-78c1f11e13b0?project=mindstormclouddemo</a>].<br/>------------------------------------------------- REMOTE BUILD OUTPUT --------------------------------------------------<br/>starting build "a329e313-5ff4-4d51-9a7b-78c1f11e13b0"</span><span id="1b7b" class="lp jv hi lo b fi ng nd l ne nf"><strong class="lo hj">--&gt; NOW START THE BUILD. PICK UP THE ZIP FILE THAT WAS PUT IN CLOUD STORAGE</strong><br/>FETCHSOURCE<br/>Fetching storage object: gs://mindstormclouddemo_cloudbuild/source/1497163737.39.tgz#1497163745785739<br/>Copying gs://mindstormclouddemo_cloudbuild/source/1497163737.39.tgz#1497163745785739...<br/>/ [1 files][ 18.1 KiB/ 18.1 KiB]<br/>Operation completed over 1 objects/18.1 KiB.<br/>BUILD<br/>Already have image (with digest): gcr.io/cloud-builders/docker<br/>Sending build context to Docker daemon  79.36kB</span><span id="e99c" class="lp jv hi lo b fi ng nd l ne nf"><strong class="lo hj">--&gt; THE STEPS BELOW SHOULD BE FAMILIAR TO EVERYONE WHO HAS DONE A DOCKER BUILD. IT IS EXECUTING THE COMMANDS THAT IT HAS FOUND IN DOCKERFILE</strong><br/>Step 1/8 : FROM python:2.7<br/>2.7: Pulling from library/python<br/>ef0380f84d05: Already exists<br/>24c170465c65: Pulling fs layer<br/>4f38f9d5c3c0: Pulling fs layer<br/>4125326b53d8: Pulling fs layer<br/>35de80d77198: Pulling fs layer<br/>ed5d9d659d3d: Pulling fs layer<br/>cdb5322408aa: Pulling fs layer<br/>9c9c3d6f5264: Pulling fs layer<br/>35de80d77198: Waiting<br/>ed5d9d659d3d: Waiting<br/>cdb5322408aa: Waiting<br/>9c9c3d6f5264: Waiting<br/>24c170465c65: Verifying Checksum<br/>24c170465c65: Download complete<br/>24c170465c65: Pull complete<br/>4f38f9d5c3c0: Verifying Checksum<br/>4f38f9d5c3c0: Download complete<br/>35de80d77198: Verifying Checksum<br/>35de80d77198: Download complete<br/>4f38f9d5c3c0: Pull complete<br/>cdb5322408aa: Verifying Checksum<br/>cdb5322408aa: Download complete<br/>ed5d9d659d3d: Verifying Checksum<br/>ed5d9d659d3d: Download complete<br/>4125326b53d8: Verifying Checksum<br/>4125326b53d8: Download complete<br/>9c9c3d6f5264: Verifying Checksum<br/>9c9c3d6f5264: Download complete<br/>4125326b53d8: Pull complete<br/>35de80d77198: Pull complete<br/>ed5d9d659d3d: Pull complete<br/>cdb5322408aa: Pull complete<br/>9c9c3d6f5264: Pull complete<br/>Digest: sha256:e9508797d99ab5b2e1311febbdbb22c92595fe82719ab3ccb61a0c458d9bac5d<br/>Status: Downloaded newer image for python:2.7<br/> ---&gt; c061fb1b6aa4<br/>Step 2/8 : MAINTAINER Romin Irani "<a class="ae jd" href="mailto:romin.k.irani@gmail.com" rel="noopener ugc nofollow" target="_blank">romin.k.irani@gmail.com</a>"<br/> ---&gt; Running in 10673c027bb1<br/> ---&gt; a2f2a0ecc9fe<br/>Removing intermediate container 10673c027bb1<br/>Step 3/8 : COPY . /app<br/> ---&gt; a8bbd17c74e3<br/>Removing intermediate container 2b7ef1e2af6d<br/>Step 4/8 : WORKDIR /app<br/> ---&gt; 290884694d72<br/>Removing intermediate container bafd9afe6536<br/>Step 5/8 : RUN pip install -r requirements.txt<br/> ---&gt; Running in 73260323b338<br/>Collecting flask (from -r requirements.txt (line 1))<br/>  Downloading Flask-0.12.2-py2.py3-none-any.whl (83kB)<br/>Collecting itsdangerous&gt;=0.21 (from flask-&gt;-r requirements.txt (line 1))<br/>  Downloading itsdangerous-0.24.tar.gz (46kB)<br/>Collecting Jinja2&gt;=2.4 (from flask-&gt;-r requirements.txt (line 1))<br/>  Downloading Jinja2-2.9.6-py2.py3-none-any.whl (340kB)<br/>Collecting Werkzeug&gt;=0.7 (from flask-&gt;-r requirements.txt (line 1))<br/>  Downloading Werkzeug-0.12.2-py2.py3-none-any.whl (312kB)<br/>Collecting click&gt;=2.0 (from flask-&gt;-r requirements.txt (line 1))<br/>  Downloading click-6.7-py2.py3-none-any.whl (71kB)<br/>Collecting MarkupSafe&gt;=0.23 (from Jinja2&gt;=2.4-&gt;flask-&gt;-r requirements.txt (line 1))<br/>  Downloading MarkupSafe-1.0.tar.gz<br/>Building wheels for collected packages: itsdangerous, MarkupSafe<br/>  Running setup.py bdist_wheel for itsdangerous: started<br/>  Running setup.py bdist_wheel for itsdangerous: finished with status 'done'<br/>  Stored in directory: /root/.cache/pip/wheels/fc/a8/66/24d655233c757e178d45dea2de22a04c6d92766abfb741129a<br/>  Running setup.py bdist_wheel for MarkupSafe: started<br/>  Running setup.py bdist_wheel for MarkupSafe: finished with status 'done'<br/>  Stored in directory: /root/.cache/pip/wheels/88/a7/30/e39a54a87bcbe25308fa3ca64e8ddc75d9b3e5afa21ee32d57<br/>Successfully built itsdangerous MarkupSafe<br/>Installing collected packages: itsdangerous, MarkupSafe, Jinja2, Werkzeug, click, flask<br/>Successfully installed Jinja2-2.9.6 MarkupSafe-1.0 Werkzeug-0.12.2 click-6.7 flask-0.12.2 itsdangerous-0.24<br/> ---&gt; 4ef93aa93c12<br/>Removing intermediate container 73260323b338<br/>Step 6/8 : ENTRYPOINT python<br/> ---&gt; Running in 9b562217e6f0<br/> ---&gt; fa730d15fbb7<br/>Removing intermediate container 9b562217e6f0<br/>Step 7/8 : CMD app.py<br/> ---&gt; Running in c6406b0f22b4<br/> ---&gt; fe3b17b083e7<br/>Removing intermediate container c6406b0f22b4<br/>Step 8/8 : EXPOSE 8080<br/> ---&gt; Running in 2600ada9fd32<br/> ---&gt; c75fbbe837f9<br/>Removing intermediate container 2600ada9fd32</span><span id="89ca" class="lp jv hi lo b fi ng nd l ne nf"><strong class="lo hj">--&gt; THE IMAGE IS BUILD SUCCESSFULLY NOW</strong><br/>Successfully built c75fbbe837f9<br/>Successfully tagged gcr.io/mindstormclouddemo/myapp:1.0</span><span id="27ee" class="lp jv hi lo b fi ng nd l ne nf"><strong class="lo hj">--&gt; PUSH IT TO GOOGLE CONTAINER REGISTRY NOW WITH THE TAGGED NAME and VERSION</strong><br/>PUSH<br/>Pushing gcr.io/mindstormclouddemo/myapp:1.0<br/>The push refers to a repository [gcr.io/mindstormclouddemo/myapp]<br/>ab6ff790b987: Preparing<br/>b8e904668fbc: Preparing<br/>de93d2f820b8: Preparing<br/>95449babbdd8: Preparing<br/>f3d633859721: Preparing<br/>201187968504: Preparing<br/>ecf5c2e2468e: Preparing<br/>bb07d0c1008d: Preparing<br/>4902b007e6a7: Preparing<br/>007ab444b234: Preparing<br/>201187968504: Waiting<br/>ecf5c2e2468e: Waiting<br/>bb07d0c1008d: Waiting<br/>4902b007e6a7: Waiting<br/>007ab444b234: Waiting<br/>b8e904668fbc: Pushed<br/>ab6ff790b987: Pushed<br/>ecf5c2e2468e: Layer already exists<br/>201187968504: Layer already exists<br/>bb07d0c1008d: Layer already exists<br/>4902b007e6a7: Layer already exists<br/>007ab444b234: Layer already exists<br/>95449babbdd8: Pushed<br/>de93d2f820b8: Pushed<br/>f3d633859721: Pushed<br/>1.0: digest: sha256:3bc4dacb99b2e4234bfda8d8e617dbf96320d7d79b1a81f9d80ce1b7ef7888fe size: 2431<br/>DONE<br/>------------------------------------------------------------------------------------------------------------------------</span><span id="7b82" class="lp jv hi lo b fi ng nd l ne nf">ID                                    CREATE_TIME                DURATION  SOURCE                                                       IMAGES                               STATUS<br/>a329e313-5ff4-4d51-9a7b-78c1f11e13b0  2017-06-11T06:49:09+00:00  49S       gs://mindstormclouddemo_cloudbuild/source/1497163737.39.tgz  gcr.io/mindstormclouddemo/myapp:1.0  SUCCESS</span></pre><p id="0f1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的构建过程可以看出，它的每一步都是从Google Container Builder在云中启动的过程中提供给你的。我用一些注释对上面的输出进行了注释，以帮助您理解正在发生的事情，如果您以前处理过Docker构建，这个过程应该很熟悉。</p><p id="4e61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，从<code class="du ll lm ln lo b">gloud container build</code>命令触发的每个构建过程都是独一无二的。您也可以通过<code class="du ll lm ln lo b">list</code>或<code class="du ll lm ln lo b">log</code>子命令，通过<code class="du ll lm ln lo b">gcloud container builds</code>命令获得构建的状态/日志。</p><p id="1a8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里需要注意的一件重要事情是<strong class="ih hj">完成构建</strong>所花费的时间。在我的例子中，正如在构建输出中打印的最终语句中看到的那样，是49秒。这很重要，因为Google Container Builder提供了一个免费层，即每个计费帐户每天的前120分钟是免费的。</p><h2 id="594a" class="lp jv hi bd jw lq lr ls ka lt lu lv ke iq lw lx ki iu ly lz km iy ma mb kq mc bi translated">查看容器图像列表</h2><p id="b464" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">您可以通过gcloud命令查看容器图像列表，如下所示:</p><pre class="jf jg jh ji fd my lo mz na aw nb bi"><span id="8798" class="lp jv hi lo b fi nc nd l ne nf">$ gcloud container images list</span><span id="a66a" class="lp jv hi lo b fi ng nd l ne nf">A sample output (from my system) is shown below:</span><span id="fea3" class="lp jv hi lo b fi ng nd l ne nf">NAME<br/>gcr.io/mindstormclouddemo/myapp<br/>gcr.io/mindstormclouddemo/pingpong<br/>gcr.io/mindstormclouddemo/simpleserver</span></pre><p id="770f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一定要研究一下<code class="du ll lm ln lo b">gcloud container</code>命令，它可以对容器图像进行多种操作，比如标记、取消标记、删除等等。</p><h1 id="274d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">Google云控制台中的容器注册表</h1><p id="9bd4" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">如果你使用谷歌云控制台多于命令行(我也是)——你可以看看控制台中的谷歌容器注册表选项。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nh"><img src="../Images/1cfd74bb23ed2a12087fa99c5420a7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*izAwxd3MVkQfUrvkG_Ir4g.png"/></div></figure><p id="f5a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将打开Container Registry的主屏幕，在这里您可以看到刚刚构建的映像:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es et"><img src="../Images/cc5b852afce95361a5c0c7111a7dace9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rx25bZxaiEVO2KcY6iqwfQ.png"/></div></div></figure><p id="1fec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有趣的是，您还可以查看您提交的构建的<strong class="ih hj">构建历史</strong>。您可以在这里查看详细的构建过程输出:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ni"><img src="../Images/2b1f6ec9a2cc26ec9dbeb208fee4b666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEBvvk9E5ws6RqKMp9H9mw.png"/></div></div></figure><p id="50e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击任何构建实例，您应该会看到构建过程输出。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es et"><img src="../Images/060ab88561649fdbc219a830850cf987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxCVg6bFYiid9S7z2jw-wQ.png"/></div></div></figure><p id="d186" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以使用Stackdriver日志来检查您的构建日志。集装箱制造商也是StackDriver的一等公民:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es nj"><img src="../Images/0fd4de81c885c315d6de7f587a50c51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sgdgDZl9r8VnV04R6xlSg.png"/></div></div></figure><p id="5210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以在这里查看构建输出日志:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es nk"><img src="../Images/e413f13825ae77b74e35fe01d8fffab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izGw_peW7pyFGpuK7RYVug.png"/></div></div></figure><h1 id="cee7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">定价</h1><p id="7159" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">你可能想知道作为一个用户，这整个过程是否是免费的。这听起来好得令人难以置信，因为有一个为您提供的计算环境来执行构建，您的文件被压缩并存储在Google云存储中，并且您的容器映像可能有网络出口。</p><p id="ae10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我建议你应该看看<a class="ae jd" href="https://cloud.google.com/container-builder/pricing" rel="noopener ugc nofollow" target="_blank">定价页面</a>了解全部细节，但这里有一些要点一目了然。</p><ul class=""><li id="bfcd" class="kx ky hi ih b ii ij im in iq kz iu la iy lb jc lc ld le lf bi translated">Google Container Builder附带了一个免费层。你每天可以免费使用120分钟。之后，你被收取0.0034美元/建造分钟。同样，免费等级分钟是一种促销活动，可能会有所变化。</li><li id="2349" class="kx ky hi ih b ii lg im lh iq li iu lj iy lk jc lc ld le lf bi translated">现在让我们来看看容器注册中心，我们的容器图像存储在这里。查看<a class="ae jd" href="https://cloud.google.com/container-registry/pricing" rel="noopener ugc nofollow" target="_blank">的价格</a>也是如此。引用官方文件的定价，“容器注册只对你的Docker镜像使用的云存储<a class="ae jd" href="https://cloud.google.com/storage/pricing#storage-pricing" rel="noopener ugc nofollow" target="_blank">存储</a>和<a class="ae jd" href="https://cloud.google.com/storage/pricing#network-pricing" rel="noopener ugc nofollow" target="_blank">网络出口</a>收费。”</li></ul><p id="d852" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这个教程。我们所看到的是Container Builder可以为您简化的一个方面。它有更多的功能，如自定义构建、触发器、在某些构建事件发生时在Slack等外部应用程序中通知用户、绑定到Google源代码库以在代码被推送时启动构建等。一定要检查那些细节。</p></div></div>    
</body>
</html>