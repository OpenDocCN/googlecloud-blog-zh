<html>
<head>
<title>Installing Istio On Google Kubernetes Engine (GKE)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Kubernetes引擎上安装Istio(GKE)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/installing-istio-on-google-kubernetes-engine-gke-bd18e3781b88?source=collection_archive---------1-----------------------#2018-09-05">https://medium.com/google-cloud/installing-istio-on-google-kubernetes-engine-gke-bd18e3781b88?source=collection_archive---------1-----------------------#2018-09-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/9bba2df44c6c3121fad30afdf599b7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_-ulLqHoVA2jOVIEU3G5Q.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">Istio + Kubernetes + Google云平台</figcaption></figure><div class=""/><p id="123f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Istio是这个街区新的酷小子。嗯，这是新的酷小子在街上的街区，所有的房子刚刚开始建造。很新，真的很新。更好的是，它刚刚达到1.0！</p><h2 id="7817" class="jt ju hx bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">Istio是什么？我为什么要在乎？</h2><p id="a82a" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">您应该关心，因为Istio为您的Kubernetes集群添加了许多您想要的功能。然而，如果你不知道Istio是什么或者为什么你应该关心它，我建议你去看看Istio的官方文档。他们做了一项了不起的工作，用你能理解的真实术语把一切都拼写出来。</p><div class="hh hi ez fb hj kt"><a href="https://istio.io/docs/concepts/what-is-istio/" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hy fi z dy ky ea eb kz ed ef hw bi translated">Istio是什么？</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">云平台为使用它们的组织提供了大量的好处。然而，不可否认的是…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">istio.io</p></div></div></div></a></div><p id="18ee" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设你读过Istio或者已经知道它的重要性，让我们来关注这篇文章的目的，如何在Google Kubernetes引擎上安装Istio。我说现在，是因为谷歌云的人正在努力创建Istio的托管实例。当它出现时，很可能只需要一两个命令，您就可以将Istio添加到已经运行的Kubernetes集群中，并获得一些好处。</p><p id="ba78" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，让我们看看将Istio集成到Google Kubernetes引擎(GKE)的最简单的方法。</p><p id="3853" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="lc">如果你不确定Kubernetes是什么，为什么它很重要，或者刚刚开始使用Kubernetes，这篇文章不适合你。我建议去看看我在谷歌云平台(GCP)和GKE上的其他帖子。</em></p><div class="hh hi ez fb hj kt"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-day-one-30a80b5dcb29"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hy fi z dy ky ea eb kz ed ef hw bi translated">Kubernetes:第一天</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">这是Kubernetes帖子的必选步骤之一。如果你对Kubernetes感兴趣，你可能已经读过100本了…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="ld l"><div class="le l lf lg lh ld li hp kt"/></div></div></a></div><h1 id="bd27" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">设置您的Kubernetes环境</h1><p id="9c7d" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">我们需要做的第一件事是在你的谷歌云项目中设置一个Kubernetes集群。正如我写的其他文章一样，我创建了一些脚本，您可以在您的Google Shell环境中运行这些脚本，使这个过程变得超级轻松。下面的命令将<a class="ae js" rel="noopener" href="/google-cloud/kubernetes-day-one-30a80b5dcb29">创建一个新的Kubernetes集群</a>，然后<a class="ae js" rel="noopener" href="/google-cloud/installing-helm-in-google-kubernetes-engine-7f07f43c536e">使用TLS </a>将Helm/Tiller安装到您的Kubernetes集群中。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="6e22" class="jt ju hx mf b fi mj mk l ml mm">$ git clone <a class="ae js" href="https://github.com/jonbcampos/istio-series" rel="noopener ugc nofollow" target="_blank">https://github.com/jonbcampos/istio-series.git</a><br/>$ cd <a class="ae js" href="https://github.com/jonbcampos/istio-series/tree/master/getting-started/scripts" rel="noopener ugc nofollow" target="_blank">~/istio-series/getting-started/scripts</a><br/>$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/scripts/startup.sh" rel="noopener ugc nofollow" target="_blank">startup.sh</a><br/>$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/scripts/add-helm.sh" rel="noopener ugc nofollow" target="_blank">add-helm.sh</a></span></pre><p id="b1d3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您对我们如何设置这些文件有疑问，我已经包含了解释这些步骤的其他文章的链接以及这些文件中代码的链接。同样，这不是这篇文章的主要目的，所以我试图快速进入新的内容。</p><p id="e3c7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，对于新的东西…</p><h1 id="d27b" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">下载Istio</h1><p id="5994" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">我们需要做的第一件事是将Istio代码下载到我们的环境中，并将Istio添加到我们的命令行环境中。我在网上的各种帖子中看到，有很多方法可以做到这一点。一如既往，我将向你展示最快、最直接的方法来实现这一点。您可以在Google Shell中输入以下命令来下载Istio。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="8f89" class="jt ju hx mf b fi mj mk l ml mm"><strong class="mf hy">$ export ISTIO_VERSION=1.0.0</strong> # set the version we want<br/><strong class="mf hy">$ curl -L https://git.io/getLatestIstio | ISTIO_VERSION=${ISTIO_VERSION} sh -</strong> # download Istio<br/><strong class="mf hy">$ cd istio-${ISTIO_VERSION}/</strong> # change directory into Istio folder<br/><strong class="mf hy">$ export PATH=${PWD}/bin:$PATH</strong> # add Istio to the path</span></pre><p id="222f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下载Istio并安装在您的路径上后，我们可以进入下一步，将Istio安装到我们的Kubernetes集群中。</p><h1 id="c1e9" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">安装Istio</h1><p id="1a9c" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">Istio文档中介绍了多种安装Istio的方法。我把重点放在使用Helm进行安装上，因为我觉得它为你提供了最简单的安装方式，同时也为你提供了最多的功能。最重要的是，随着Istio现在达到1.0，Helm是Istio维护者在Kubernetes集群中安装Istio的<em class="lc">推荐方式</em>。</p><p id="da26" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将能够用一行代码完成所有这些，但是我将对头盔安装做一些调整，包括<a class="ae js" href="https://grafana.com/" rel="noopener ugc nofollow" target="_blank"> Grafana </a>、<a class="ae js" href="https://github.com/istio/istio/tree/release-1.0/addons/servicegraph" rel="noopener ugc nofollow" target="_blank"> ServiceGraph </a>、<a class="ae js" href="https://istio.io/docs/tasks/telemetry/distributed-tracing/" rel="noopener ugc nofollow" target="_blank">跟踪</a>和<a class="ae js" href="https://github.com/kiali/kiali" rel="noopener ugc nofollow" target="_blank"> Kiali </a>，以及<a class="ae js" href="https://istio.io/docs/tasks/security/mutual-tls/" rel="noopener ugc nofollow" target="_blank">相互TLS认证</a>。默认情况下不会启用这些值，但是您遇到的大多数项目都需要这些值。下面一行将完成安装。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="3046" class="jt ju hx mf b fi mj mk l ml mm"><strong class="mf hy">$ helm install install/kubernetes/helm/istio \</strong> # use Helm Chart<br/>    <strong class="mf hy">--name istio \</strong> # name install 'istio'<br/>    <strong class="mf hy">--tls \</strong> # install using TLS<br/>    <strong class="mf hy">--namespace istio-system \</strong> # set the namespace<br/>    <strong class="mf hy">--set global.mtls.enabled=true \</strong> # enable MTLS<br/>    <strong class="mf hy">--set grafana.enabled=true \</strong> # enable Grafana<br/>    <strong class="mf hy">--set servicegraph.enabled=true \</strong> # enable ServiceGraph<br/>    <strong class="mf hy">--set tracing.enabled=true \</strong> # enable Tracing<br/>    <strong class="mf hy">--set kiali.enabled=true</strong> # enable Kiali</span></pre><p id="0c0f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦你运行这个，安装过程将开始。没有发生的日志记录，因此您可能会认为什么也没有发生。大约一两分钟后，您将看到该过程完成，然后我们可以开始验证一切安装正确。</p><p id="bb4c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作为舵安装的一部分，你可以进行更多的设置。这些只是我发现拥有它们很重要的一部分。我建议查看文档，看看您拥有的所有选项。</p><div class="hh hi ez fb hj kt"><a href="https://github.com/istio/istio/tree/master/install/kubernetes/helm/istio" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hy fi z dy ky ea eb kz ed ef hw bi translated">istio/istio</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">连接、保护、控制和观察服务。在GitHub上创建一个帐户，为istio/istio开发做出贡献。</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">github.com</p></div></div><div class="ld l"><div class="mn l lf lg lh ld li hp kt"/></div></div></a></div><h1 id="464d" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">单线安装</h1><p id="1d52" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">如果你很懒，不喜欢打字，那么我已经为你创建了一个bash脚本来处理下载和安装。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="064a" class="jt ju hx mf b fi mj mk l ml mm">$ cd <a class="ae js" href="https://github.com/jonbcampos/istio-series/tree/master/getting-started/scripts" rel="noopener ugc nofollow" target="_blank">~/istio-series/getting-started/scripts</a><br/>$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/scripts/add-istio.sh" rel="noopener ugc nofollow" target="_blank">add-istio.sh</a></span></pre><p id="ecc3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">随着下载和安装的完成，是时候集中精力来验证一切都按预期工作了。</p><h1 id="e93c" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">确认Istio安装完成</h1><p id="f716" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">如果你在你的Google Cloud项目中查看你的<code class="du mo mp mq mf b">Kubernetes Engine&gt; Workloads</code>视图，应该很明显已经安装了Istio。</p><figure class="ma mb mc md fd hk er es paragraph-image"><div class="er es mr"><img src="../Images/fb08a5175dc6354594782f02960847d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*tJzBjg7obDS_gTIJxeIvKg.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">GKE集群中的所有Istio部件</figcaption></figure><p id="f399" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，为了确认一切都是完整的，我们将安装一个由Istio团队创建的示例项目，以确保一切都设置正确。为此，我们可以运行一个快速脚本来设置和安装示例项目。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="eada" class="jt ju hx mf b fi mj mk l ml mm">$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/samples/launch-bookinfo.sh" rel="noopener ugc nofollow" target="_blank">~/istio-series/getting-started/samples/launch-bookinfo.sh</a><br/>$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/samples/check-bookinfo-gateway.sh" rel="noopener ugc nofollow" target="_blank">~/istio-series/getting-started/samples/check-bookinfo-gateway.sh</a></span></pre><p id="e561" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">运行第二个脚本后，您应该会看到类似如下的输出。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="e22a" class="jt ju hx mf b fi mj mk l ml mm">determine ingress host and port<br/>Gateway URL<br/><strong class="mf hy">http://[some IP Address]:80/productpage</strong><br/>confirm app is running<br/>200</span></pre><p id="dc58" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您点击提供的url，您将看到正在运行的应用程序，从而证明一切安装正确。</p><figure class="ma mb mc md fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ms"><img src="../Images/c86197ec837692af2a747251a36b2b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mbmq7qL5kz9omxKcE9MhlA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">图书信息示例应用程序正在运行</figcaption></figure><h1 id="7e4e" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">结论</h1><p id="9403" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">就是这样！几分钟后，您将拥有一个运行Istio的Kubernetes集群，并为开发做好准备。还有太多太多的路要走，还有许多其他功能要添加，但现在我们应该对此感到高兴。</p><p id="812c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">不久，我将继续发布帖子，介绍Istio内置的各种功能。幸运的是没有那么多，但是那里的都很强大。敬请期待！</p><h1 id="7a7f" class="lj ju hx bd jv lk ll lm jz ln lo lp kd lq lr ls kg lt lu lv kj lw lx ly km lz bi translated">拆卸</h1><p id="9e4f" class="pw-post-body-paragraph iu iv hx iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">在您离开之前，请确保清理您的项目，这样您就不会为您用来运行群集的虚拟机付费。返回到云Shell并运行teardown脚本来清理您的项目。这将删除您的集群和我们构建的容器。</p><pre class="ma mb mc md fd me mf mg mh aw mi bi"><span id="8f29" class="jt ju hx mf b fi mj mk l ml mm">$ cd <a class="ae js" href="https://github.com/jonbcampos/istio-series/tree/master/getting-started/scripts" rel="noopener ugc nofollow" target="_blank">~/istio-series/getting-started/scripts</a><br/>$ sh <a class="ae js" href="https://github.com/jonbcampos/istio-series/blob/master/getting-started/scripts/teardown.sh" rel="noopener ugc nofollow" target="_blank">teardown.sh</a></span></pre></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><h1 id="2ad4" class="lj ju hx bd jv lk na lm jz ln nb lp kd lq nc ls kg lt nd lv kj lw ne ly km lz bi translated">本文中对其他帖子的引用</h1><div class="hh hi ez fb hj kt"><a rel="noopener follow" target="_blank" href="/google-cloud/installing-helm-in-google-kubernetes-engine-7f07f43c536e"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hy fi z dy ky ea eb kz ed ef hw bi translated">在Google Kubernetes引擎中安装Helm(GKE)</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">当我第一次真正开始进入Kubernetes时，我会去寻找各种必要程序的docker图像…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="ld l"><div class="nf l lf lg lh ld li hp kt"/></div></div></a></div><div class="hh hi ez fb hj kt"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-day-one-30a80b5dcb29"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hy fi z dy ky ea eb kz ed ef hw bi translated">Kubernetes:第一天</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">这是Kubernetes帖子的必选步骤之一。如果你对Kubernetes感兴趣，你可能已经读过100本了…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="ld l"><div class="le l lf lg lh ld li hp kt"/></div></div></a></div></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><p id="875d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi ng translated">问问题？反馈？我很想听听你可能会遇到什么问题，或者这是否有助于你更好地理解。如果我错过了什么，也可以随意分享。我们都在一起！</p></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><p id="1551" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="http://jonbcampos.com/" rel="noopener ugc nofollow" target="_blank">乔纳森·坎波斯</a>是一个狂热的开发者，也是学习新事物的爱好者。我相信我们应该不断学习、成长和失败。我总是开发社区的支持者，并且总是愿意提供帮助。因此，如果你对这个故事有任何问题或意见，请在下面提出。在<a class="ae js" href="https://www.linkedin.com/in/jonbcampos/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae js" href="https://twitter.com/jonbcampos" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系，并提及这个故事。</p></div></div>    
</body>
</html>