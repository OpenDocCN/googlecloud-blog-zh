<html>
<head>
<title>How to utilize cloud storage like Google Drive, to copy local or NAS data with rclone, for out of region disaster recovery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何利用Google Drive等云存储，通过rclone复制本地或NAS数据，以实现区域外灾难恢复</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/rclone-and-google-drive-3fdfb00f34e8?source=collection_archive---------0-----------------------#2019-01-23">https://medium.com/google-cloud/rclone-and-google-drive-3fdfb00f34e8?source=collection_archive---------0-----------------------#2019-01-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="70d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">TL；dr: </strong>如果你想将数据从本地或网络连接存储复制到你的云存储中——加密或不加密——而不依赖于除rclone之外的任何应用程序，请继续阅读。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7c514d9da42f69dfa594590b869cc4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrqPyNWUgEF7trnXnZySwg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">毁坏的硬盘。希望你有这些的副本…(版权适用于这张照片)</figcaption></figure><h1 id="f412" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">背景</h1><p id="3df4" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">几周前，我决定通过添加区域外灾难恢复将我的专用NAS备份战略提升到一个新的水平。换句话说，我不仅想将最重要的数据复制到本地磁盘和NAS上，还想将它们存储在Google Drive上的云中。</p><p id="d320" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，我已经有很多在云端的文件，比如谷歌文档和表格。但是还有其他的，像一些音乐，特别是RAW照片，到目前为止还没有。</p><p id="28eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本指南将概述如何使用rclone进行从QNAP NAS到Google Drive的加密拷贝，同时保持您当前的存储设置和工作流程不变。它也适用于其他NAS、Linux甚至Windows环境，以及其他云存储(例如Google云存储、OneDrive、Dropbox、S3)，只需要很小的调整。</p><p id="a552" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，它描述了如何利用谷歌云服务帐户，以限制rclone的访问权限和您的帐户凭证落入坏人手中的机会。我将提供一个选项来使用Google Drive的文件夹共享机制，以确保您可以在没有服务帐户的情况下访问您的加密文件，甚至可以在Google Drive web应用程序中访问这些文件。</p><p id="a8b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我把Google Drive作为Google云和G Suite家族的一部分来关注。这是一个面向低数据量的零成本、消费者就绪型解决方案。如果您需要更多存储空间，它还为消费者提供了一个易于理解的<a class="ae kw" href="https://one.google.com/about#upgrade" rel="noopener ugc nofollow" target="_blank">定价模式</a>。</p><p id="d9ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重要的是要理解:</strong>这种方法不支持文件的快照或版本控制(参见下面“复制与同步的区别以及为什么版本控制不可用”一节)！</p><h1 id="bdf0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">可供选择的事物</h1><h2 id="ad52" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">QNAP上的替代方案</h2><p id="defc" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">有很多类似的使用案例利用QNAP内置功能，允许开箱即用的加密，如备份到谷歌云存储或AWS S3，(例如<a class="ae kw" href="https://www.qnap.com/solution/hybrid-backup-sync/en-us/" rel="noopener ugc nofollow" target="_blank"> QNAP混合备份同步应用</a>)。</p><p id="208e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">甚至还有Google Drive连接器可用(例如<a class="ae kw" href="https://www.qnap.com/en/how-to/tutorial/article/connect-to-your-cloud-storage-smoothly-with-cloud-drive-sync-on-qnap-nas/" rel="noopener ugc nofollow" target="_blank"> QNAP云驱动同步</a>)。但是由于只有QNAP知道的原因，它不支持加密。</p><h2 id="9826" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">通用加密的替代方案</h2><p id="5d22" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">您可以通过在将数据放入本地存储之前对其进行加密来解决缺少加密功能的问题。或者使用类似于<a class="ae kw" href="https://cryptomator.org/" rel="noopener ugc nofollow" target="_blank"> Cryptomator </a>(现在也可以作为运行在容器中的服务器版本)或者桌面环境中的<a class="ae kw" href="https://www.boxcryptor.com" rel="noopener ugc nofollow" target="_blank"> Boxcryptor </a>的软件。但是这些选项要求您对现有的存储/备份概念进行调整，或者让您依赖于特定的供应商。</p><h1 id="0546" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">我们将要构建的rclone.conf示例文件</h1><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="59be" class="kx ju hi lm b fi lq lr l ls lt">[GDrive_User]<br/>type = drive<br/>scope = drive.file<br/>service_account_file = /share/homes/username/BackUp/rclone/my-service-account-file-12345.json<br/>auth_owner_only = true</span><span id="44c5" class="kx ju hi lm b fi lu lr l ls lt">/* Below is optional and only required if you want to encrypt your files */<br/>[GDrive_User_Encrypted]<br/>type = crypt<br/>remote = GDrive_User:NAS_Documents/20181117_Baseline/<br/>filename_encryption = standard<br/>directory_name_encryption = true<br/>password = someHash<br/>password2 = otherHash</span></pre><h2 id="0421" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">在QNAP NAS上安装rclone</h2><ol class=""><li id="73dd" class="lv lw hi ih b ii kr im ks iq lx iu ly iy lz jc ma mb mc md bi translated"><a class="ae kw" href="https://rclone.org/downloads/" rel="noopener ugc nofollow" target="_blank">根据你的CPU架构下载</a> rclone。对于QNAP NAS设备，您可以在<a class="ae kw" href="https://www.qnapclub.eu/en/qpkg/330" rel="noopener ugc nofollow" target="_blank"> QNAP Club </a>中找到非官方的预建包(这就是我使用的那个)。</li><li id="4989" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated">使用SSH连接到您的NAS。</li><li id="bb18" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc ma mb mc md bi translated">通过调用rclone命令检查是否安装了rclone。</li></ol><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="5f71" class="kx ju hi lm b fi lq lr l ls lt">[/] # rclone<br/>//Output<br/>Usage:<br/> rclone [flags]<br/> rclone [command]…</span></pre><h2 id="9afc" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">创建一个Google Drive远程链接并添加加密</h2><p id="0362" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">本指南假设您正在使用Google Drive，但rclone也支持大多数其他云存储选项(<a class="ae kw" href="https://rclone.org/docs/#configure" rel="noopener ugc nofollow" target="_blank">参见配置选项</a>)。</p><h2 id="2c84" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">创建一个Google服务帐户</h2><p id="a41b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我建议使用一个<a class="ae kw" href="https://cloud.google.com/iam/docs/understanding-service-accounts" rel="noopener ugc nofollow" target="_blank"> Google服务帐户</a>进行连接，这个帐户需要先创建(见下文)。还有一个使用标准OAuth2令牌的选项，但我认为这在NAS环境中不起作用，因为它需要web浏览器和(定期)登录到您的Google帐户。</p><blockquote class="mj mk ml"><p id="608f" class="if ig mm ih b ii ij ik il im in io ip mn ir is it mo iv iw ix mp iz ja jb jc hb bi translated">2019年10月22日编辑:刚刚从一位读者朋友那里得知OAuth2应该可以工作。您会收到一个在浏览器中打开的URL，然后将OAuth2令牌复制到控制台并从那里获取它。一个额外的好处是，您可以限制rclone只能访问它创建的文件。</p></blockquote><p id="4a20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建服务帐户不仅可以通过<a class="ae kw" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>进行，还可以通过一个轻量级接口<a class="ae kw" href="https://console.developers.google.com/projectselector/iam-admin/serviceaccounts" rel="noopener ugc nofollow" target="_blank">谷歌APIs IAM站点</a>进行。如果你到目前为止没有使用任何其他的谷歌云平台服务，我建议你选择后者。</p><ul class=""><li id="53a2" class="lv lw hi ih b ii ij im in iq mq iu mr iy ms jc mt mb mc md bi translated">转到<a class="ae kw" href="https://console.developers.google.com/projectselector/iam-admin/serviceaccounts" rel="noopener ugc nofollow" target="_blank">Google API IAM网站</a></li><li id="aef9" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc mt mb mc md bi translated">单击“服务账户”</li><li id="f57b" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc mt mb mc md bi translated">创建一个新项目，如果你还没有做的话。项目名称可以是“rclone副本”。然后，您将获得您的服务帐户ID /电子邮件，例如</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/c0c0c0472e8df072baff6cba5dd0e948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RyotItrS9YZYdaob"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">带有电子邮件和姓名的服务帐户</figcaption></figure><ul class=""><li id="6530" class="lv lw hi ih b ii ij im in iq mq iu mr iy ms jc mt mb mc md bi translated">单击新创建的服务帐户，并创建一个JSON格式的密钥</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/8a72b1b2aa017895333bc44f46a1f211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5ZPspaa92wtFx6F8"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">服务帐户的JSON密钥创建</figcaption></figure><ul class=""><li id="e2b8" class="lv lw hi ih b ii ij im in iq mq iu mr iy ms jc mt mb mc md bi translated">下载密钥，因为您的rclone配置文件需要它</li></ul><p id="1e59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将密钥保存在安全的位置，因为它将授予获得它的每个人对存储在服务帐户中(或与其共享)的文件的读写权限。</p><h2 id="7013" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">创建rclone“远程”</h2><p id="c068" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">请<a class="ae kw" href="https://rclone.org/drive/" rel="noopener ugc nofollow" target="_blank">按照官方文档</a>创建一个标准遥控器。远程就像特定云存储中特定文件夹的连接器。</p><h2 id="70c2" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">[可选]添加加密</h2><p id="bc38" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">现在，您在上面创建的远程链接上添加加密。<a class="ae kw" href="https://rclone.org/crypt/" rel="noopener ugc nofollow" target="_blank">官方文件对此也有详细描述</a>。</p><h2 id="c08b" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">[可选]使复制的文件在您的Google Drive中可见</h2><p id="eed5" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在设置过程中，你可能已经检查过你的浏览器和你的Google Drive帐户，意识到你刚才复制的文件不在那里。这是因为服务帐户无法访问您现有的Google Drive文件！把服务账户想象成一个虚拟的新的Google Drive账户，但是和你的配额挂钩。你只能通过Google Drive API访问它的内容，就像rclone一样。</p><p id="81d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在drive.google.com或Google Drive应用程序中提供您的(加密)文件，但请注意，这也意味着您或有权访问您的Google Drive的其他人/应用程序可能会(意外地)删除您使用rclone创建的副本。</p><p id="9fd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您决定这样做，请与服务帐户共享Google Drive中的特定文件夹(例如shared_folder)。由于您的服务帐户名称看起来像电子邮件地址(例如，name-of-your-sa-account @ your-project-name-123456 . iam . gserviceaccount . com ),您可以在Google Drive web UI中共享副本文件夹。只需将服务帐户“电子邮件”作为附加用户添加到复制文件夹中。您可能会收到一封自动发送的电子邮件，说明服务帐户电子邮件不可访问，但它仍然可以工作。</p><p id="6232" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从现在起，您可以建议rclone使用drive-shared-with-me标志来访问此共享文件夹。这适用于所有rclone命令(<a class="ae kw" href="https://rclone.org/drive/#drive-shared-with-me" rel="noopener ugc nofollow" target="_blank">参见官方文档</a>)。这里有一个例子:</p><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="a1e7" class="kx ju hi lm b fi lq lr l ls lt">rclone copy --drive-shared-with-me /source/files your_remote:shared_folder/</span></pre><h1 id="8f7e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使rclone.conf持久并备份它</h1><h2 id="e5b2" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">QNAP设备上的配置持久性</h2><p id="5354" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在QNAP设备上，rclone配置存储在/root/下。由于此位置将在NAS重新启动后或NAS升级后被擦除，因此您需要在其他位置手动复制rclone.conf文件，例如/share/homes/your-user/rclone/。请注意:每当您更改配置或使用rclone config创建新配置时，您都需要将配置再次保存在一个持久的位置。</p><h2 id="00ca" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">配置备份</h2><p id="c1d1" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">强烈建议将rclone.conf备份到保存的远程位置，因为它包含用于恢复加密数据的(散列和加盐)密码。</p><p id="e12b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于您只需要在发生重大事件时恢复您的文件，我建议将其加密并放在不同的云存储中，或者甚至打印出来并存储在一个保存的远程位置。如果您所有的本地副本和备份被破坏或无法访问，您的密码存储，笔记或无论如何你试图记住密码和盐也可能会消失！</p><p id="76b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在新的rclone配置运行中使用您的密码和salt重新创建该文件，但是安全第一。服务帐户密钥文件(*。json)可以随时从谷歌云控制台下载，所以不需要备份。</p><h1 id="3968" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">复制与同步的区别以及版本控制不可用的原因</h1><p id="455d" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">Rclone支持多种文件操作命令。我想快速强调一下拷贝和同步之间的区别，并说明目前没有快照功能！</p><h2 id="082e" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">复制</h2><p id="6717" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">这个命令复制文件，忽略未更改的文件，利用文件大小和修改时间。对于我们的用例很重要:这个命令永远不会删除目标位置的文件。即使文件在源位置被删除。但它确实会覆盖已更改的文件！我在本指南中使用副本。另请参见<a class="ae kw" href="https://rclone.org/commands/rclone_copy/" rel="noopener ugc nofollow" target="_blank">官方文档</a>。</p><h2 id="da9b" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">同步</h2><p id="d7e3" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">此命令将源同步到目标。特别是，如果在源位置删除文件，它还会在目标位置删除文件。但绝不会反过来。另见<a class="ae kw" href="https://rclone.org/commands/rclone_sync/" rel="noopener ugc nofollow" target="_blank">官方文件</a>。</p><h2 id="cbce" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">快照/版本控制</h2><p id="d6e2" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">Rclone不支持开箱即用的版本控制或快照创建！。已更改的文件将在复制时被覆盖，而不是进行版本控制！所以我建议不要只依赖rclone“备份”。确保您的实际备份(例如，在USB磁盘、本地服务器上)允许版本控制，并且如果您的所有备份源都不可用/不再可用，请仅使用rclone。通常这意味着一场灾难。</p><p id="b162" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">举个简单的例子:如果你有一个像important.txt这样的文件，在周一保存，在周二修改，然后想在周三恢复到周一的版本，你不能用rclone做到这一点。除了您使用这种实现类似版本控制行为的变通方法，但是我在这里不使用它(<a class="ae kw" href="https://rclone.org/docs/#backup-dir-dir" rel="noopener ugc nofollow" target="_blank">参见关于backup-dir </a>的官方文档)。</p><h1 id="3bc2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">[可选]为定期执行创建特定的运行脚本和计划</h1><p id="1568" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我建议创建一个总结所有必需选项的脚本，并使用crontab安排定期执行。</p><p id="3b5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我下面的复制脚本中，我使用了两个附加选项:</p><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="7715" class="kx ju hi lm b fi lq lr l ls lt">--config and --bwlimit.</span></pre><p id="334e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个需要指向rclone.conf文件。请记住，在QNAP NAS设备上重新启动后，此文件的标准位置会被擦除！第二个应该将带宽使用限制在500千字节。根据您的具体上行链路环境进行调整。</p><p id="22f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，带宽限制对我不起作用。快速调查显示，这可能是一个常见的错误。因此，我使用我的路由器通过利用服务质量设置来控制带宽使用。重要的是要保留足够的备用上传。否则，您的下载可能会受到影响，包括视频流。</p><h2 id="b9c4" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">我的rclone_copy.sh脚本</h2><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="494b" class="kx ju hi lm b fi lq lr l ls lt">#!/bin/sh<br/>rclone --config /share/homes/username/rclone/rclone.conf --bwlimit=500k copy --drive-shared-with-me /share/homes/username/documents GDrive_Username_Encrypted:<br/>echo -e $(date -u) “ rclone_copy.sh ran” &gt;&gt; /share/homes/username/rclone/rclone.log<br/>exit 0</span></pre><h2 id="1f7f" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">使脚本可执行</h2><p id="5719" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">不要忘记让您的rclone_copy.sh脚本在*NIX环境中可执行。通常你用</p><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="db7b" class="kx ju hi lm b fi lq lr l ls lt">chmod +x /path/to/rclone_copy.sh</span></pre><h2 id="6544" class="kx ju hi bd jv ky kz la jz lb lc ld kd iq le lf kh iu lg lh kl iy li lj kp lk bi translated">计划定期执行</h2><p id="a55a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">最后，我建议使用crontab进行调度。通常您可以通过crontab -e创建crontab条目，但是如果您在QNAP NAS设备上这样做，您的命令就会丢失！经过一番困惑之后，我在丹尼尔·汉森的技术和我博客上找到了他的描述。非常感谢！如果您正在使用QNAP，请遵循Daniel的解决方法。</p><p id="0a91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，您需要:</p><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="ba5e" class="kx ju hi lm b fi lq lr l ls lt">crontab -e<br/>// insert your entry (vi-like editor)…<br/>// make persistent<br/>crontab /etc/config/crontab<br/>// reload<br/>/etc/init.d/crond.sh restart</span></pre><p id="2a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的crontab条目(每小时运行rclone_copy.sh):</p><pre class="je jf jg jh fd ll lm ln lo aw lp bi"><span id="5696" class="kx ju hi lm b fi lq lr l ls lt">0 0–23 * * * /share/homes/username/rclone/rclone_copy.sh</span></pre><p id="766d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我的复制脚本在每次执行后都会写入一个日志文件，所以您可以将这个日志用作交叉检查。另一种方法是查看加密的文件名或者计算你的Google Drive副本文件夹中的加密文件。</p><h1 id="48d0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在初始上传期间避免并行执行</h1><p id="93a6" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">根据数据量和你的上传能力，最初复制到Google Drive可能需要几天或几周的时间。我建议在这段时间内不要设置cron作业。并行运行多个rclone实例通常不会提高上传效率，但会导致在NAS硬盘上进行大量搜索。您可能希望不时地检查您的初始上传是否完成，或者检查潜在的早期脚本终止。</p><h1 id="2f3f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">接下来是什么？</h1><p id="5a74" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">打开终端，开始为您最珍贵的本地数据构建您的区域外灾难恢复设置。请记住:数据只有在您能够访问的情况下才有价值。因此，请测试恢复。</p><p id="fd5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以看看更多的阅读推荐:</p><ul class=""><li id="e818" class="lv lw hi ih b ii ij im in iq mq iu mr iy ms jc mt mb mc md bi translated"><a class="ae kw" href="https://www.cloudberrylab.com/resources/blog/choosing-online-backup-storage-google-cloud-storage-vs-google-drive/" rel="noopener ugc nofollow" target="_blank">谷歌云存储和谷歌驱动——何时选择什么</a></li><li id="d00e" class="lv lw hi ih b ii me im mf iq mg iu mh iy mi jc mt mb mc md bi translated"><a class="ae kw" rel="noopener" href="/@abhimanyuPathania/google-drive-service-accounts-and-nodejs-a038b8ec482f"> The Matrix — OAuth 2.0、服务账户、Google Drive和Node.js </a></li></ul><p id="8717" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的反馈和改进，比如实现快照功能。</p></div></div>    
</body>
</html>