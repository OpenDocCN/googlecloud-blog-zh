<html>
<head>
<title>Python Development Environments for Apache Beam on Google Cloud Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google云平台上Apache Beam的Python开发环境</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/python-development-environments-for-apache-beam-on-google-cloud-platform-b6f276b344df?source=collection_archive---------0-----------------------#2018-06-18">https://medium.com/google-cloud/python-development-environments-for-apache-beam-on-google-cloud-platform-b6f276b344df?source=collection_archive---------0-----------------------#2018-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c85d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些说明将向您展示如何为Python数据流作业设置开发环境。最终，你将能够以调试模式在本地运行数据流作业，并在<a class="ae jd" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop" rel="noopener ugc nofollow" target="_blank"> REPL </a>中执行代码，以加速你的开发周期。</p><h1 id="0248" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">下载并安装Pycharm</h1><p id="b020" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Pycharm是Python的集成开发环境(IDE)。Pycharm有一个免费的开源版本，包含的特性包括与git的集成和一个不错的调试器。</p><ol class=""><li id="24fc" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">通过点击链接和说明<a class="ae jd" href="https://www.jetbrains.com/pycharm/download/" rel="noopener ugc nofollow" target="_blank">这里</a>，下载并安装社区版Pycharm。</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es kq"><img src="../Images/4cc15d06288c48d9156538454bf93a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*eHASoIO5cePNUx0v"/></div><figcaption class="ky kz et er es la lb bd b be z dx translated">点击这里下载Pycharm <a class="ae jd" href="https://www.jetbrains.com/pycharm/download/" rel="noopener ugc nofollow" target="_blank">并按照说明进行安装。</a></figcaption></figure><h1 id="2d18" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结帐示例代码</h1><ol class=""><li id="dbab" class="kh ki hi ih b ii kc im kd iq lc iu ld iy le jc km kn ko kp bi translated">打开皮查姆。</li><li id="17b4" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">点击从版本控制创建项目。</li><li id="e15a" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">如果你之前已经打开过Pycharm，你可以从下拉菜单中选择“VCS”-&gt;“从版本控制中检出”。这显示在下面的截图。</li><li id="f5f6" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">在Git存储库URL中，粘贴一个指向Google Cloud Professional服务的链接</li></ol><p id="8107" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lk"> Github Repo:Git存储库URL: </em></p><div class="ll lm ez fb ln lo"><a href="https://github.com/GoogleCloudPlatform/professional-services" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hj fi z dy lt ea eb lu ed ef hh bi translated">谷歌云平台/专业服务</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">在GitHub上创建一个帐户，为专业服务的发展做出贡献。</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">github.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc kw lo"/></div></div></a></div><p id="0491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.点击克隆</p><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/aff371ca89fdccc0fb94d3a92c8ad7ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*ruvN8ED3pRo535Gd"/></div><figcaption class="ky kz et er es la lb bd b be z dx translated">通过从Google Cloud professional services repo签出来创建一个新项目。</figcaption></figure><p id="7930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.Pycharm将提示您是否要打开专业服务目录。选择确定</p><p id="8f83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lk">注意</em> : Pycharm可能会提示您将“vcs.xml”文件添加到Git中。选择“不要再问我”和“不”。这是一个包含您对Pycharm的偏好的文件。一般来说，特定于ide的文件不会被签入版本控制，因为其他开发人员可能会使用不同的ide。</p><h1 id="ce7c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置相关性</h1><p id="f0de" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">示例代码需要dataflow python库才能运行。这些步骤将在Pycharm中建立所需的库。这有助于Pycharm在调用库时捕获语法错误，并允许我们以调试模式在IDE中本地运行脚本。</p><ol class=""><li id="3ab0" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">选择Pycharm -&gt;首选项</li><li id="939f" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">选择项目:专业服务-&gt;项目解释器</li><li id="222a" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">点击齿轮图标-&gt;添加</li><li id="3305" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">选择“新环境”-&gt;点击确定</li><li id="f674" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">单击+号</li><li id="a2be" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">键入谷歌云数据流</li><li id="6eef" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">单击安装包</li><li id="70c7" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">单击确定</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/096985041433e9b99c7d002befe90b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*loRJ31jr3JzjI0eP"/></div></figure><h1 id="4592" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">安装运行和调试配置</h1><p id="34bf" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">设置运行和调试配置将允许您在本地测试和调试管道。这通常比在数据流服务中运行更快，因为您不需要在代码运行之前等待虚拟机启动。</p><ol class=""><li id="2066" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">导航至data-analytics/data flow _ python _ examples/data _ ingestion . py</li><li id="fc3d" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">右键单击data_ingestion.py，然后选择创建data_ingestion…</li><li id="ee65" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">选择参数</li></ol><p id="89c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lk">将此粘贴到参数中并用您的项目ID替换＄PROJECT(或设置此环境变量)</em> </strong></p><pre class="kr ks kt ku fd me mf mg mh aw mi bi"><span id="923b" class="mj jf hi mf b fi mk ml l mm mn">--project=$PROJECT</span><span id="312a" class="mj jf hi mf b fi mo ml l mm mn">--runner=DirectRunner</span><span id="d960" class="mj jf hi mf b fi mo ml l mm mn">--staging_location=gs://$PROJECT/test</span><span id="929d" class="mj jf hi mf b fi mo ml l mm mn">--temp_location=gs://$PROJECT/test</span></pre><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/5d671dbb3762a19f1388afa956ad2052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*9j_c5BzWLp-Miygp"/></div></figure><h1 id="0065" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置项目、时段和其它GCP相关性</h1><ol class=""><li id="07c4" class="kh ki hi ih b ii kc im kd iq lc iu ld iy le jc km kn ko kp bi translated">用您的项目ID替换$PROJECT</li><li id="3944" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">点击确定</li><li id="fbf1" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">在命令行上使用gsutil创建一个bucket。您可以使用您的项目名称作为存储桶的名称。</li></ol><p id="1f3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lk">用你的项目ID替换$PROJECT(或者设置这个环境变量)</em> </strong></p><pre class="kr ks kt ku fd me mf mg mh aw mi bi"><span id="8530" class="mj jf hi mf b fi mk ml l mm mn">gsutil mb -c regional -l us-central1 gs://<strong class="mf hj">$PROJECT</strong></span></pre><p id="476a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.使用gsutil命令将文件复制到刚刚创建的GCS bucket中</p><pre class="kr ks kt ku fd me mf mg mh aw mi bi"><span id="7747" class="mj jf hi mf b fi mk ml l mm mn">gsutil cp gs://python-dataflow-example/data_files/usa_names.csv gs://$PROJECT/data_files/</span><span id="11d7" class="mj jf hi mf b fi mo ml l mm mn">gsutil cp gs://python-dataflow-example/data_files/head_usa_names.csv gs://$PROJECT/data_files/</span></pre><p id="6bf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.通过在命令行运行以下命令来创建BigQuery数据集</p><pre class="kr ks kt ku fd me mf mg mh aw mi bi"><span id="298b" class="mj jf hi mf b fi mk ml l mm mn">bq mk lake</span></pre><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/fa256e3a529611a2f2273c80170a9c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*UdTb02fcyaA06bWi"/></div></figure><h1 id="8778" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置断点并运行调试器</h1><p id="b1ba" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">断点将暂停程序的执行，允许您在REPL中检查变量或运行代码片段。</p><ol class=""><li id="6d9a" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">在data_ingestion.py的第59行放置一个调试点，方法是单击空白处代码的左侧</li><li id="4fa1" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">通过单击data_transformation.py旁边的调试按钮运行</li><li id="9a57" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">通过单击“调试”按钮运行调试器</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/7b4a031c5c1974a7c786fa7c6b90ce48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*epzKO0xnq2JVgkog"/></div></figure><h1 id="70f8" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">启动评估表达式窗口</h1><p id="8b1b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Evaluate Expression是Pycharm中的一个工具，它允许您在调试python脚本的过程中执行代码片段。在这个窗口中，您可以检查变量、设置变量，以及用Python编写的任何操作。</p><ol class=""><li id="7de1" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">选择运行-&gt;评估表达式</li><li id="9dcf" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">Evaluate Expression将启动一个<a class="ae jd" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop" rel="noopener ugc nofollow" target="_blank"> REPL </a>，允许你在正在运行的程序中间运行任何python代码。</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/93820e342e25b9b1f0a7c03204eaf6ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*dbjlu6_kXIJNE2nR"/></div></figure><h1 id="a264" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">使用调试器—打印字符串</h1><p id="266f" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在“计算表达式”窗口中执行的任何打印语句都将在Pycharm中打印到控制台。试着打印一些变量，并在输出中看到它们。</p><ol class=""><li id="a73e" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">在代码片段窗口中键入print(string_input)</li><li id="728e" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">单击评估</li><li id="9d11" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">导航到控制台以查看打印的字符串</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/63fe852347ce8f86ad5b2f5136c8006f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*SJkHC_a93oZahgfG"/></div></figure><h1 id="a04c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">使用调试器—自动显示变量</h1><p id="ae0a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">结果，Pycharm将始终显示“计算表达式”窗口中的最后一个变量。这甚至比打印变量更方便。在这个窗口中，您还可以像浏览树一样浏览嵌套字典这样的结构。</p><ol class=""><li id="fa07" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">字符串输入类型</li><li id="54dd" class="kh ki hi ih b ii lf im lg iq lh iu li iy lj jc km kn ko kp bi translated">单击评估(或按ctrl + enter)</li></ol><figure class="kr ks kt ku fd kv er es paragraph-image"><div class="er es md"><img src="../Images/8d358fd7f323fcecdd88a5fee5d8540a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*IMbJI2ZYwe033eti"/></div></figure></div></div>    
</body>
</html>