<html>
<head>
<title>Google Cloud Data Catalog hands-on guide: a mental model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云数据目录实践指南:心智模型</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/data-catalog-hands-on-guide-a-mental-model-dae7f6dd49e?source=collection_archive---------0-----------------------#2019-06-28">https://medium.com/google-cloud/data-catalog-hands-on-guide-a-mental-model-dae7f6dd49e?source=collection_archive---------0-----------------------#2019-06-28</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><p id="28fd" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">这份快速入门指南是一个系列的一部分，它为<strong class="ii hk">数据目录</strong>带来了一种实践方法，这是<a class="ae je" href="https://cloud.google.com/blog/products/data-analytics/google-cloud-data-catalog-now-available-in-public-beta" rel="noopener ugc nofollow" target="_blank">最近宣布的<strong class="ii hk">谷歌云的数据分析</strong>服务家族的</a>成员。</p><blockquote class="jf"><p id="fd70" class="jg jh hj bd ji jj jk jl jm jn jo jd dy translated"><a class="ae je" href="https://cloud.google.com/data-catalog/" rel="noopener ugc nofollow" target="_blank"> Data Catalog是一种全面管理和可扩展的元数据管理服务，使组织能够快速发现、了解和管理他们在Google Cloud中的数据。</a></p></blockquote><figure class="jq jr js jt ju jv es et paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="es et jp"><img src="../Images/15d05ebe05c8f8a737c0a0213a1713f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afeCoOwUYotMSsKPpscgng.png"/></div></div></figure></div><div class="ab cl kc kd gq ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hc hd he hf hg"><h1 id="5e06" class="kj kk hj bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">心理模型</h1><p id="b697" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">为了提供一些关于数据目录的背景信息，并帮助<em class="lm">数据公民</em>在开始使用该服务时提高速度，让我围绕其核心特性描述一下我的心理模型。该模型总结了我开始使用Data Catalog以来的学习历程，也是我将在本系列中撰写的下一篇文章的基础。</p><blockquote class="ln lo lp"><p id="38e7" class="ig ih lm ii b ij ik il im in io ip iq lq is it iu lr iw ix iy ls ja jb jc jd hc bi translated">声明:这是我个人的想法，作为一个数据目录的早期采用者——仅仅&amp;简单地说就是这样。该模型不是基于任何官方/支持的参考。</p></blockquote><h2 id="ea82" class="lt kk hj bd kl lu lv lw kp lx ly lz kt ir ma mb kx iv mc md lb iz me mf lf mg bi translated">基本概念</h2><p id="2ec5" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">数据目录是一种集中的服务，完全由谷歌云管理，为属于GCP项目的数据资产保留一个优化的搜索索引。我所说的数据资产是指:数据集、表格、视图、文本/CSV文件、电子表格和数据流。为了构建索引，数据目录依赖于资产的元数据，即名称、描述和列定义。</p><p id="ad7a" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">它还存储由其他GCP服务管理的资产的元数据，以便用户可以仅使用Data Catalog的UI或API来获取有关它们的详细信息。当资产第一次被编入索引、在其源系统中被更改或者使用数据目录的<em class="lm">标记</em>时，元数据被存储/更新。</p><p id="7df4" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">隐私和信息安全是数据目录的一等公民。在为给定用户或服务帐户提供任何信息之前，会考虑资产的IAM角色和ACL。</p><h2 id="177f" class="lt kk hj bd kl lu lv lw kp lx ly lz kt ir ma mb kx iv mc md lb iz me mf lf mg bi translated">搜索目录</h2><p id="741e" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">第一次接触Data Catalog通常是通过其<strong class="ii hk">搜索</strong>功能:功能强大且易于使用。请看看下面的图片:</p><figure class="mi mj mk ml fe jv es et paragraph-image"><div class="es et mh"><img src="../Images/4331e8e95d6f950136f4283217ec6f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*Ss60DcnuRGnAJCqFiR7wNA.png"/></div><figcaption class="mm mn eu es et mo mp bd b be z dy translated"><strong class="bd kl"> <em class="mq">图像1。</em> </strong> <em class="mq">搜索目录</em>相关实体</figcaption></figure><p id="8e3f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">当有人搜索<code class="dv mr ms mt mu b">Catalog</code>时，会返回一个结果集。请记住，搜索结果只是Data Catalog所知道的关于索引资产的“摘要”，每个<code class="dv mr ms mt mu b">SearchResult</code>都有一小组字段，最显著的是:<code class="dv mr ms mt mu b">searchResultType</code>、<code class="dv mr ms mt mu b">searchResultSubtype</code>、<code class="dv mr ms mt mu b">relativeResourceName</code>和<code class="dv mr ms mt mu b">linkedResource</code>。下面列出了这些字段的可能值:</p><ul class=""><li id="bf71" class="mv mw hj ii b ij ik in io ir mx iv my iz mz jd na nb nc nd bi translated">搜索结果类型:</li></ul><pre class="mi mj mk ml fe ne mu nf ng aw nh bi"><span id="79ac" class="lt kk hj mu b fj ni nj l nk nl"> ENTRY, TAG_TEMPLATE</span></pre><ul class=""><li id="ab8d" class="mv mw hj ii b ij ik in io ir mx iv my iz mz jd na nb nc nd bi translated">搜索结果子类型:</li></ul><pre class="mi mj mk ml fe ne mu nf ng aw nh bi"><span id="3f5d" class="lt kk hj mu b fj ni nj l nk nl">entry.dataset, entry.table, entry.data_stream.topic, tag_template</span></pre><ul class=""><li id="332d" class="mv mw hj ii b ij ik in io ir mx iv my iz mz jd na nb nc nd bi translated">相对资源名称:</li></ul><pre class="mi mj mk ml fe ne mu nf ng aw nh bi"><span id="ce27" class="lt kk hj mu b fj ni nj l nk nl">projects/<strong class="mu hk">&lt;project-id&gt;</strong>/locations/US/entryGroups/<strong class="mu hk">@bigquery</strong>/entries/<strong class="mu hk">&lt;entry-id&gt;</strong> (ENTRY / entry.dataset or entry.table),<br/>  <br/>projects/<strong class="mu hk">&lt;project-id&gt;</strong>/locations/US/entryGroups/<strong class="mu hk">@pubsub</strong>/entries/<strong class="mu hk">&lt;entry-id&gt; (</strong>ENTRY / entry.data_stream.topic<strong class="mu hk">)</strong>,<br/><strong class="mu hk">  <br/></strong>projects/<strong class="mu hk">&lt;project-id&gt;</strong>/locations/us-central1/tagTemplates/<strong class="mu hk">&lt;tag-template-id&gt; (</strong>TAG_TEMPLATE<strong class="mu hk">)</strong></span></pre><ul class=""><li id="c739" class="mv mw hj ii b ij ik in io ir mx iv my iz mz jd na nb nc nd bi translated">链接的资源:</li></ul><pre class="mi mj mk ml fe ne mu nf ng aw nh bi"><span id="96ed" class="lt kk hj mu b fj ni nj l nk nl">//bigquery.googleapis.com/projects/<strong class="mu hk">&lt;<em class="lm">project-id&gt;</em></strong>/datasets/<strong class="mu hk">&lt;<em class="lm">dataset-id&gt; </em></strong>(ENTRY / entry.dataset),</span><span id="b8b2" class="lt kk hj mu b fj nm nj l nk nl">//bigquery.googleapis.com/projects/<strong class="mu hk">&lt;<em class="lm">project-id&gt;</em></strong>/datasets/<strong class="mu hk">&lt;<em class="lm">dataset-id&gt;</em></strong>/tables/<strong class="mu hk">&lt;<em class="lm">table-id&gt; </em></strong>(ENTRY / entry.table),</span><span id="1948" class="lt kk hj mu b fj nm nj l nk nl">//pubsub.googleapis.com/projects/<strong class="mu hk">&lt;<em class="lm">project-id&gt;</em></strong>/topics/<strong class="mu hk">&lt;<em class="lm">topic-id&gt; </em></strong>(ENTRY / entry.data_stream.topic),</span><span id="204c" class="lt kk hj mu b fj nm nj l nk nl">//datacatalog.googleapis.com/projects/<strong class="mu hk">&lt;<em class="lm">project-id&gt;</em></strong>/locations/us-central1/tagTemplates/<strong class="mu hk">&lt;<em class="lm">tag-template-id&gt; </em></strong>(TAG_TEMPLATE)</span></pre><p id="a1a8" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">您可能会从上面的例子中注意到，搜索结果分为两大组:<code class="dv mr ms mt mu b">ENTRY</code>和<code class="dv mr ms mt mu b">TAG_TEMPLATE</code>。<em class="lm">条目</em>指由其他谷歌云服务管理的数据资产。<strong class="ii hk">数据目录自动索引由BigQuery和Pub/Sub管理的资产。请寻找其他集成。</strong> <em class="lm">标签模板</em>指的是数据目录的本地实体，我们将在本文中了解更多。</p><p id="523d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">当搜索结果类型为<code class="dv mr ms mt mu b">ENTRY</code>时，注意<code class="dv mr ms mt mu b">relativeResourceName</code>和<code class="dv mr ms mt mu b">linkedResource</code>字段。在这种情况下，<code class="dv mr ms mt mu b">relativeResourceName</code>是在将底层数据资产添加到索引中时为数据目录的内部元数据记录创建的标识符，而<code class="dv mr ms mt mu b">linkedResource</code>只是指向其源系统中的数据资产——类似于外部引用。</p><blockquote class="ln lo lp"><p id="a814" class="ig ih lm ii b ij ik il im in io ip iq lq is it iu lr iw ix iy ls ja jb jc jd hc bi translated">条目 : <code class="dv mr ms mt mu b">relativeResourceName</code>的快速提示<strong class="ii hk">以一个系统生成的id结尾，人工阅读时看起来毫无意义，而<code class="dv mr ms mt mu b">linkedResource</code>几乎是人工可读的，在分析搜索结果时可能很有用。</strong></p></blockquote><h2 id="d8a8" class="lt kk hj bd kl lu lv lw kp lx ly lz kt ir ma mb kx iv mc md lb iz me mf lf mg bi translated">获取条目</h2><p id="a9d4" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">为了检索关于给定数据资产的更多信息，您可以执行一个<em class="lm"> Get Entry </em>操作。它接收一个由<code class="dv mr ms mt mu b">relativeResourceName</code>字段在<code class="dv mr ms mt mu b">SearchResult</code>中表示的<code class="dv mr ms mt mu b">name</code>参数。对于从<em class="lm">搜索目录</em>操作返回的每个结果，应该有且只有一个目录<code class="dv mr ms mt mu b">Entry</code>。</p><figure class="mi mj mk ml fe jv es et paragraph-image"><div class="es et nn"><img src="../Images/52cc147a514a8dd6a458c25c5a85abfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*LuhyIJq6NoauouQLny1sCg.png"/></div><figcaption class="mm mn eu es et mo mp bd b be z dy translated"><strong class="bd kl"> <em class="mq">图像二。</em> </strong> <em class="mq">目录、搜索结果和E </em>条目关系</figcaption></figure><p id="6f24" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><code class="dv mr ms mt mu b">Entry</code>，一个本地数据目录实体，代表一个资产的技术元数据，包含一个可变的字段集，它将根据它的<code class="dv mr ms mt mu b">type</code>而变化。这意味着与<em class="lm"> BigQuery的日期分片表相关的</em>条目的字段将不会与表示<em class="lm"> PubSub主题</em>的字段相同，尽管有些字段对于所有类型都是通用的。另一个例子:如果一个条目引用一个表，那么<code class="dv mr ms mt mu b">schema</code>字段存储一个表列模式，但是它在引用数据集的条目中不可用。</p><h2 id="9caf" class="lt kk hj bd kl lu lv lw kp lx ly lz kt ir ma mb kx iv mc md lb iz me mf lf mg bi translated">查找条目</h2><p id="7a38" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">如果您需要找到与您已经知道名称的数据资产相关联的目录<code class="dv mr ms mt mu b">Entry</code>，您<strong class="ii hk">不需要</strong>执行先前的目录搜索。<em class="lm">查找条目</em>操作允许您在一个步骤中从资产名称进入其目录条目。</p><p id="376d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">记住GCP数据资产的通用模式<em class="lm">资源名称</em>:</p><pre class="mi mj mk ml fe ne mu nf ng aw nh bi"><span id="201d" class="lt kk hj mu b fj ni nj l nk nl">//bigquery.googleapis.com/projects/<strong class="mu hk">&lt;<em class="lm">project-id&gt;</em></strong>/datasets/<strong class="mu hk">&lt;<em class="lm">dataset-id&gt;</em></strong>/tables/<strong class="mu hk">&lt;<em class="lm">table-id&gt;</em></strong></span></pre><p id="68ca" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">请注意，它们遵循一个约定，使得资产可以唯一地识别，即使是在项目之间。<em class="lm">资源名称</em>存储在条目<code class="dv mr ms mt mu b">linkedResource</code>字段中，足以检索一个目录条目。</p><p id="e9f5" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">到目前为止，我们看到的是Data Catalog的搜索和数据发现功能的最基本部分。即使对于在Google Cloud的项目中保留大量数据的组织来说，Data Catalog也提供了一种简单快捷的方法来找出数据的类型，以及数据的存储方式和位置。</p><h2 id="0734" class="lt kk hj bd kl lu lv lw kp lx ly lz kt ir ma mb kx iv mc md lb iz me mf lf mg bi translated">模板和标签</h2><p id="1efa" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">一旦人们能够发现属于他们组织的数据，他们也应该被允许更好地管理它。从这个意义上来说，Data Catalog附带了另一个特性，即<em class="lm">标记</em>，该特性可用于改善数据治理等。</p><p id="8b4d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><code class="dv mr ms mt mu b">Tag</code>是一个数据目录的原生实体，它允许人员和自动化流程将附加元数据附加到由目录索引的任何数据资产，也使得将来使用<a class="ae je" href="https://cloud.google.com/data-catalog/docs/how-to/search-reference#qualified_predicates" rel="noopener ugc nofollow" target="_blank"> <em class="lm">搜索限定谓词</em> </a>更容易找到这样的数据资产。例如，数据治理团队可能使用搜索功能来查找存储敏感数据(电子邮件、社会安全号码等)的表格，然后<em class="lm">标记</em>它们，以便使定期安全审计更加简单。</p><p id="9028" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">一个<code class="dv mr ms mt mu b">Tag</code>连接到一个<code class="dv mr ms mt mu b">Entry</code>，如下图所示:</p><figure class="mi mj mk ml fe jv es et paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="es et no"><img src="../Images/f31fa28c5f0369f927b64868ca6e8be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMLPV2-25q7ddlBU-fBdig.png"/></div></div><figcaption class="mm mn eu es et mo mp bd b be z dy translated"><strong class="bd kl"> <em class="mq">形象三。</em> </strong> <em class="mq"> </em>模板和标记相关实体</figcaption></figure><p id="d751" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><em class="lm">标记</em>是一个灵活的特性:标记可以由完成数据分类工作所需的任意多的字段组成(实际上，有一个限制，但是相当高)，不同的类型:<strong class="ii hk">布尔</strong>、<strong class="ii hk">双精度</strong>、<strong class="ii hk">字符串</strong>、<strong class="ii hk">时间戳</strong>和自定义<strong class="ii hk">枚举</strong>值。为了使创建标签更加容易和安全(从IAM的角度来看)，Data Catalog提供了一个<em class="lm">模板</em>机制。每个<code class="dv mr ms mt mu b">Tag</code>必须根据用户定义的<code class="dv mr ms mt mu b">TagTemplate</code>创建。</p></div><div class="ab cl kc kd gq ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hc hd he hf hg"><h1 id="3a07" class="kj kk hj bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">接下来该读什么？</h1><p id="0d28" class="pw-post-body-paragraph ig ih hj ii b ij lh il im in li ip iq ir lj it iu iv lk ix iy iz ll jb jc jd hc bi translated">好了，对数据目录的简要介绍到此结束。请查看下面列出的本系列的其他文章和官方文档(参见<strong class="ii hk">参考文献</strong>部分)以进一步了解。</p><ul class=""><li id="2c8b" class="mv mw hj ii b ij ik in io ir mx iv my iz mz jd na nb nc nd bi translated"><strong class="ii hk">数据目录动手指南:用Python搜索、获取&amp;查找</strong>:<a class="ae je" rel="noopener" href="/google-cloud/data-catalog-hands-on-guide-search-get-lookup-with-python-82d99bfb4056">https://medium . com/Google-cloud/Data-Catalog-hands-on-guide-search-get-lookup-with-Python-82d 99 bfb 4056</a></li><li id="998f" class="mv mw hj ii b ij np in nq ir nr iv ns iz nt jd na nb nc nd bi translated"><strong class="ii hk">数据目录动手指南:带Python的模板&amp;标签</strong>:<a class="ae je" rel="noopener" href="/google-cloud/data-catalog-hands-on-guide-templates-tags-with-python-c45eb93372ef">https://medium . com/Google-cloud/Data-Catalog-hand-on-guide-templates-tags-with-Python-c 45 EB 93372 ef</a></li></ul><p id="b5c3" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">希望有帮助！</p><blockquote class="ln lo lp"><p id="a712" class="ig ih lm ii b ij ik il im in io ip iq lq is it iu lr iw ix iy ls ja jb jc jd hc bi translated">用于生成上述类图的plantuml文件可以在GitHub上找到:<a class="ae je" href="https://github.com/ricardolsmendes/gcp-datacatalog-diagrams" rel="noopener ugc nofollow" target="_blank">https://github.com/ricardolsmendes/gcp-datacatalog-diagrams</a>。</p></blockquote></div><div class="ab cl kc kd gq ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hc hd he hf hg"><h1 id="90f8" class="kj kk hj bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">参考</h1><ul class=""><li id="0af8" class="mv mw hj ii b ij lh in li ir nu iv nv iz nw jd na nb nc nd bi translated"><strong class="ii hk">数据目录官网</strong>:<a class="ae je" href="https://cloud.google.com/data-catalog/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/data-catalog</a></li><li id="fb82" class="mv mw hj ii b ij np in nq ir nr iv ns iz nt jd na nb nc nd bi translated"><strong class="ii hk">数据目录概述</strong>:<a class="ae je" href="https://cloud.google.com/data-catalog/docs/concepts/introduction-data-catalog" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/Data-Catalog/docs/concepts/introduction-Data-Catalog</a></li><li id="1eeb" class="mv mw hj ii b ij np in nq ir nr iv ns iz nt jd na nb nc nd bi translated"><strong class="ii hk">数据目录入门</strong>:<a class="ae je" href="https://cloud.google.com/data-catalog/docs/quickstarts/quickstart-search-tag" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/Data-Catalog/docs/quick starts/quick start-search-tag</a></li></ul></div></div>    
</body>
</html>