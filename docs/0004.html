<html>
<head>
<title>Your desktop on Google Cloud Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你在谷歌云平台上的桌面</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/linux-gui-on-the-google-cloud-platform-800719ab27c5?source=collection_archive---------0-----------------------#2015-05-12">https://medium.com/google-cloud/linux-gui-on-the-google-cloud-platform-800719ab27c5?source=collection_archive---------0-----------------------#2015-05-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cd67" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">谷歌计算引擎实例上的VNC</h2></div><p id="171b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将服务器放在云上是很棒的:你可以随时随地访问它们！你可以很容易地ssh到你的服务器，做任何你想做的事情，对不对？</p><p id="2299" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">嗯，如果你想浏览网页呢？我想用Chrome！或者你可以使用Lynx，但是我听说它不兼容CSS3。这是一个小教程，它将带你通过GUI访问Google计算引擎实例的所有步骤。</p><blockquote class="ju jv jw"><p id="0c9c" class="ix iy jx iz b ja jb ij jc jd je im jf jy jh ji jj jz jl jm jn ka jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">重要</em> </strong>:如果你启动了一个实例，你将被按分钟收费。转到这篇文章的结尾，看看如何停止它，并获得<strong class="iz hj"> $300 </strong>的信用！</p></blockquote><p id="9ec4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更新:我的下一篇文章将讨论如何通过使用VPN上的VNC来保证这个连接的安全。</p><h2 id="d0d2" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated"><strong class="ak">创建新项目</strong></h2><p id="79e9" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">访问<a class="ae jt" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">开发者控制台</a>，登录，如果需要，点击<strong class="iz hj">创建项目</strong>按钮创建项目。导航左侧菜单，列出项目中运行的虚拟机实例:<em class="jx">计算&gt;计算引擎&gt;虚拟机实例。如果这是你第一次为这个项目这样做，可能会花一点时间，因为它设置了一些东西，不要担心这只会发生一次。</em></p><h2 id="0c2b" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">创建新实例</h2><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lb"><img src="../Images/2fb1571a98fe59c8d2db17f13622f79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oducTOyVksn-lzdxqyAEw.png"/></div></div></figure><p id="f2ba" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">点击<strong class="iz hj">创建实例</strong>按钮进入实例创建表单。为实例选择一个名称。任何实例类型和linux发行版都可以，但是如果你想要安全的话，选择<em class="jx"> n1-standard-1 </em>和<em class="jx">backports-debian-7-wheezy-v 2015 04 23。</em></p><p id="1a96" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择一个靠近您的区域，以获得最佳的连接延迟。</p><p id="5562" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想使用Windows，这些实例已经支持RDP(远程桌面协议)，所以你不需要任何额外的步骤。</p><h2 id="8b70" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">安装VNC服务器</h2><p id="9c1e" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">一旦您的实例正在运行，您就可以通过简单地点击SSH按钮直接进入它。这也为你处理认证，真的很方便！</p><p id="cfe8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">连接后，让我们更新我们的源列表并安装一些额外的包:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="6706" class="kb kc hi lo b fi ls lt l lu lv">$ sudo apt-get update<br/>$ sudo apt-get install tightvncserver</span></pre><p id="78f6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们继续配置允许我们通过桌面环境访问实例的VNC服务器之前，我们应该安装一个。你可以安装你最喜欢的:</p><p id="b236" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">a)如果你喜欢Gnome并且不着急:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="c4ca" class="kb kc hi lo b fi ls lt l lu lv">$ sudo apt-get install aptitude tasksel<br/>$ sudo tasksel install gnome-desktop --new-install</span></pre><p id="7e90" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">侏儒很漂亮…而且很重！所以在所有东西安装好的时候要有耐心，两到五分钟是完全正常的。</p><p id="f770" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">b)如果您喜欢安装速度更快的软件，您可能会喜欢:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="8317" class="kb kc hi lo b fi ls lt l lu lv">$ sudo apt-get install xfce4 xfce4-goodies</span></pre><h2 id="ff32" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">设置VNC服务器</h2><p id="70e0" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">现在我们的实例有了一个桌面环境，让我们通过VNC访问它。启动vncserver，并按照说明创建密码</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="0c4a" class="kb kc hi lo b fi ls lt l lu lv">$ vncserver</span></pre><blockquote class="ju jv jw"><p id="876a" class="ix iy jx iz b ja jb ij jc jd je im jf jy jh ji jj jz jl jm jn ka jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">注意:</em> </strong>这个密码将授予对你的实例的访问权限，所以要使它很强。</p></blockquote><p id="fe31" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果一切正常，您的VNC服务器现在正在运行并监听端口5901。您可以从Google计算引擎实例中使用netcat来验证这一点:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="2dd0" class="kb kc hi lo b fi ls lt l lu lv">$ nc localhost 5901<br/>RFB 003.008</span></pre><h2 id="28f1" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">安装VNC客户端</h2><p id="1b3a" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">有很多选项可供选择，我最喜欢的是<a class="ae jt" href="http://www.realvnc.com/download/viewer/" rel="noopener ugc nofollow" target="_blank"> RealVNC Viewer </a>。安装一个，但不要试图连接到您的服务器:它会失败，因为防火墙规则不允许它。</p><h2 id="9183" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">打开防火墙</h2><p id="44f9" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">为了与我们的实例通信，我们需要它的外部IP。您可以在开发人员控制台上找到它。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lw"><img src="../Images/c125180e085d83582e8b188d35e5b63d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZbvVCFGWA02HUPxS6I8Lw.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">找到你的外部IP，应该是这样的。</figcaption></figure><p id="31c6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们再次尝试使用netcat连接到它:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="dc8d" class="kb kc hi lo b fi ls lt l lu lv">$ nc 104.197.91.140 5901</span><span id="1dd8" class="kb kc hi lo b fi mb lt l lu lv">alternatively you can use telnet</span><span id="9e2b" class="kb kc hi lo b fi mb lt l lu lv">$ telnet 104.197.91.140 5901</span></pre><p id="d5dc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论您使用什么工具，连接都将失败，这是意料之中的，因为出于安全原因，防火墙规则默认情况下会阻止所有通信。让我们来解决这个问题。</p><p id="03a6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导航到默认网络<em class="jx">的配置“计算&gt;计算引擎&gt;网络】</em>，然后单击<em class="jx">默认</em>。或者您也可以点击<a class="ae jt" href="https://console.developers.google.com/project/_/compute/networksDetail/global/networks/default" rel="noopener ugc nofollow" target="_blank">此处</a>并选择您的项目。</p><p id="c8e9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将添加一个新的防火墙规则，按下相应的按钮。</p><figure class="lc ld le lf fd lg md me mf mg mh paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mc"><img src="../Images/a94ac67030b468f1a82a12b0d20dc318.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*gRV8v5bYwICjRJwBo052YA.png"/></div></div></figure><p id="1706" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为规则选择一个描述性名称。</p><p id="89c0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将允许来自任何来源的流量，这就是我们使用0.0.0.0/0(相当于通配符的IP掩码)的原因。</p><p id="a04b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">流量将位于协议TCP的端口5901上，并去往标记为<em class="jx"> vnc-server </em>的实例。</p><p id="1709" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后一步是将我们的实例标记为vnc-server，为此，返回到虚拟机描述页面并单击<em class="jx">“添加标记”</em></p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mi"><img src="../Images/c3d45dd4f4259a8f8e3ae1161c97d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32i01jWXvYVvEniadZB9rw.png"/></div></div></figure><h2 id="9736" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">连接到VNC服务器</h2><p id="7207" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">让我们首先确保防火墙现在允许连接:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="a85d" class="kb kc hi lo b fi ls lt l lu lv">$ nc 104.197.91.140 5901<br/>RFB 003.008</span></pre><p id="7347" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">太好了！一切似乎都准备好了，我们的VNC客户端连接。打开VNC查看器，在端口5901上连接到计算引擎实例的IP。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mj"><img src="../Images/1f5c85133497d8648fb7ea3f99949b81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uo1TINIpHkSTvosa53_3tA.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">连接到端口5901上的计算引擎实例。</figcaption></figure><p id="2a5e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要进行连接，您需要提供您在本教程开始时提供的密码。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mk"><img src="../Images/ee9368476f116a5d9dda2142260baa0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkSMY89OyaxHBhh8jnusfg.png"/></div></div></figure><p id="d05c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">瞧！现在，您可以在Google计算引擎实例上使用您最喜欢的桌面环境。</p><h2 id="d171" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">解决纷争</h2><p id="5b45" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">如果你在创建了防火墙规则后仍然无法连接到VNC，你应该确保你的IP没有被<a class="ae jt" href="http://www.sshguard.net/" rel="noopener ugc nofollow" target="_blank"> sshguard </a>禁止。</p><p id="9f30" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要查看是否是这种情况，您可以运行:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="4c87" class="kb kc hi lo b fi ls lt l lu lv">$ sudo iptables -L<br/>Chain INPUT (policy ACCEPT)<br/>target     prot opt source               destination         <br/>Chain FORWARD (policy ACCEPT)<br/>target     prot opt source               destination         <br/>Chain OUTPUT (policy ACCEPT)<br/>target     prot opt source               destination</span></pre><p id="ef74" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您的输出与此不同，刷新表格并重试:</p><pre class="lc ld le lf fd ln lo lp lq aw lr bi"><span id="ec5f" class="kb kc hi lo b fi ls lt l lu lv">$ sudo iptables -F</span></pre><h2 id="6db2" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jg km kn ko jk kp kq kr jo ks kt ku kv bi translated">清理和费用</h2><p id="d3d8" class="pw-post-body-paragraph ix iy hi iz b ja kw ij jc jd kx im jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">运行在云上的一个实例是有成本的，但是好消息是你可以简单地停止它，并在你需要的时候重启它。点击停止按钮，你将只为相关的<a class="ae jt" href="https://cloud.google.com/compute/pricing#persistentdisk" rel="noopener ugc nofollow" target="_blank">磁盘</a>付费，在本文撰写之时为每月<strong class="iz hj">40</strong>。我打赌你在旧金山找不到比这更便宜的咖啡了！</p><p id="d8fa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，如果你是谷歌云平台的新手，一定要参加<a class="ae jt" href="https://cloud.google.com/free-trial/" rel="noopener ugc nofollow" target="_blank">免费试用</a>来获得300美元的信用额度，这样你就可以尝试一下，享受一下乐趣了！</p><p id="6495" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这是有用的。欢迎在<a class="ae jt" href="http://twitter.com/francesc" rel="noopener ugc nofollow" target="_blank"> twitter </a>上添加任何反馈意见或问题。</p></div></div>    
</body>
</html>