<html>
<head>
<title>Create and serve HLS video content to your app with Google Cloud CDN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Google Cloud CDNåˆ›å»ºHLSè§†é¢‘å†…å®¹å¹¶æä¾›ç»™ä½ çš„åº”ç”¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-cloud/create-and-serve-hls-video-content-to-your-app-with-google-cloud-cdn-b7a6e65bb7c1?source=collection_archive---------4-----------------------#2022-12-27">https://medium.com/google-cloud/create-and-serve-hls-video-content-to-your-app-with-google-cloud-cdn-b7a6e65bb7c1?source=collection_archive---------4-----------------------#2022-12-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»åŸå§‹åª’ä½“æ–‡ä»¶åˆ›å»ºHLSè§†é¢‘æµï¼Œå¹¶å°†å®ƒä»¬ä¼ è¾“åˆ°Flutterç§»åŠ¨åº”ç”¨ç¨‹åºã€‚</p><p id="9283" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚ä»Šï¼Œè§†é¢‘å†…å®¹æ— å¤„ä¸åœ¨ï¼Œç”¨æˆ·å¼€å§‹æœŸæœ›ä½å»¶è¿Ÿå’Œå¿«é€ŸåŠ è½½æ—¶é—´ã€‚æœ‰å¤šç§åè®®å¯ä»¥è®©ä½ è¿›è¡Œè‡ªé€‚åº”æµå¼ä¼ è¾“ï¼Œä½†æ¯«æ— ç–‘é—®ï¼Œæœ€å—æ¬¢è¿çš„åè®®ä¹‹ä¸€æ˜¯<a class="ae jd" href="https://en.wikipedia.org/wiki/HTTP_Live_Streaminghttps://en.wikipedia.org/wiki/HTTP_Live_Streaming" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> HTTP </strong> <strong class="ih hj">å®æ—¶æµå¼ä¼ è¾“</strong> </a> (HLS)ã€‚</p><p id="a866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†åˆ©ç”¨ä¸åŒçš„è°·æ­Œäº‘äº§å“ï¼Œå¦‚<strong class="ih hj">äº‘å­˜å‚¨</strong>ã€<strong class="ih hj">äº‘CDN </strong>å’Œ<strong class="ih hj">ä»£ç è½¬æ¢å™¨API </strong>æ¥å®Œå…¨è‡ªåŠ¨åŒ–è¿™ä¸€è¿‡ç¨‹ã€‚</p><p id="1824" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ¬æŒ‡å—ä¸­çš„æ‰€æœ‰æ­¥éª¤éƒ½å¯ä»¥åœ¨GitHub repo ä¹‹åçš„<a class="ae jd" href="https://github.com/dariobanfi/hls-streaming-gcp" rel="noopener ugc nofollow" target="_blank">ä¸­ä½œä¸º<strong class="ih hj"> Terraformè„šæœ¬</strong>è·å¾—ï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²åˆ°æ‚¨çš„Google Cloudå¸æˆ·ä¸­ã€‚</a></p><p id="6ff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™æ˜¯æˆ‘ä»¬å°†è¦æ„å»ºçš„å†…å®¹çš„é«˜çº§æ¦‚è¿°:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/f0ebffaf5d1cefd84f5c419666e652cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MIjdrR6c5iMLhQas"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">è§£å†³æ–¹æ¡ˆæ¶æ„</figcaption></figure><p id="0771" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è§†é¢‘ç¼–è¾‘å°†åŸå§‹æ–‡ä»¶ä¸Šä¼ åˆ°äº‘å­˜å‚¨æ¡¶ï¼Œè¿™å°†é€šè¿‡äº‘åŠŸèƒ½è‡ªåŠ¨è§¦å‘ä»£ç è½¬æ¢å™¨APIã€‚ç”±æ­¤äº§ç”Ÿçš„<strong class="ih hj"> .m3u8æ’­æ”¾åˆ—è¡¨</strong>å°†å¯é€šè¿‡ç§»åŠ¨åº”ç”¨è¿›è¡Œæµå¼ä¼ è¾“ã€‚</p><p id="3019" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬è¿™é‡Œå‡†å¤‡ç”¨äº‘CDNï¼Œå› ä¸ºæˆ‘ä»¬æ‰“ç®—æµå¼ä¼ è¾“çŸ­è§†é¢‘æ–‡ä»¶ã€‚å¦‚æœä½ æ‰“ç®—åšå¤§è§„æ¨¡çš„VODæµåª’ä½“ï¼Œä½ åº”è¯¥å»çœ‹çœ‹<a class="ae jd" href="https://cloud.google.com/media-cdn" rel="noopener ugc nofollow" target="_blank"> Media CDN </a>ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª<a class="ae jd" href="https://cloud.google.com/media-cdn/docs/choose-cdn-product" rel="noopener ugc nofollow" target="_blank">å¯¹ä¸¤ä¸ª</a>çš„åŒºåˆ«çš„æ¦‚è¿°ã€‚</p><h1 id="b10f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">è®¾ç½®ä»£ç è½¬æ¢ç®¡é“</h1><p id="8f1a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">ç¬¬ä¸€æ­¥æ˜¯æ„å»ºä»£ç è½¬æ¢ç®¡é“ã€‚æˆ‘ä»¬å¸Œæœ›è‡ªåŠ¨åŒ–è¯¥è¿‡ç¨‹ï¼Œä»¥ä¾¿æ¯æ¬¡è§†é¢‘ä¸Šä¼ åˆ°äº‘å­˜å‚¨æ—¶ï¼Œè½¬ç å°†è‡ªåŠ¨å¼€å§‹ï¼Œå¹¶è´Ÿè´£ç”Ÿæˆ. m3u8æ’­æ”¾åˆ—è¡¨ã€‚</p><p id="0046" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è°·æ­Œçš„<a class="ae jd" href="https://cloud.google.com/transcoder/docs" rel="noopener ugc nofollow" target="_blank">ä»£ç è½¬æ¢å™¨API </a>ï¼Œå®ƒä½¿ä½ èƒ½å¤Ÿå¯¹è§†é¢‘æ–‡ä»¶è¿›è¡Œ<a class="ae jd" href="https://cloud.google.com/transcoder/docs/concepts/overview" rel="noopener ugc nofollow" target="_blank">å¤šç§æ“ä½œ</a>ï¼Œå¦‚ä»£ç è½¬æ¢ã€è£å‰ªã€ç”Ÿæˆç¼©ç•¥å›¾ç­‰ç­‰ã€‚</p><p id="6181" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å¯ç”¨API</strong></p><p id="1915" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç¬¬ä¸€æ­¥æ˜¯å¯ç”¨æˆ‘ä»¬å°†ç”¨äºæ­¤è§£å†³æ–¹æ¡ˆçš„æ‰€æœ‰å¿…è¦çš„API</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="c0e2" class="lc jv hi ky b be ld le l lf lg">gcloud services enable \<br/>transcoder.googleapis.com \<br/>cloudfunctions.googleapis.com \<br/>cloudbuild.googleapis.com \<br/>pubsub.googleapis.com \<br/>logging.googleapis.com \<br/>eventarc.googleapis.com \<br/>artifactregistry.googleapis.com \<br/>run.googleapis.com \<br/>compute.googleapis.com \<br/>--quiet</span></pre><p id="4c71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬ä¹Ÿå°†é¡¹ç›®idè®¾ç½®ä¸ºä¸€ä¸ªå˜é‡:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="6122" class="lc jv hi ky b be ld le l lf lg">export PROJECT_ID=hls-streaming-gcp</span></pre><p id="ca74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åˆ›å»ºäº‘å­˜å‚¨æ¡¶</strong></p><p id="4038" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦åˆ›å»ºäº‘å­˜å‚¨ç©ºé—´ï¼Œæˆ‘ä»¬å°†åœ¨å…¶ä¸­ä¸Šä¼ åŸå§‹è§†é¢‘å†…å®¹:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="12ed" class="lc jv hi ky b be ld le l lf lg">gsutil mb -b on -l europe-west1 gs://hls-streaming-gcp-raw-files-${PROJECT_ID}/</span></pre><p id="d79c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬è¿˜å°†ä¸ºå·²å¤„ç†çš„è§†é¢‘æµåˆ›å»ºæˆ‘ä»¬çš„å­˜å‚¨æ¡¶:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="c0e1" class="lc jv hi ky b be ld le l lf lg">gsutil mb -b on -l europe-west1 gs://hls-streaming-gcp-processed-files-${PROJECT_ID}/</span></pre><p id="8b43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åŒæ—¶ï¼Œè®©æˆ‘ä»¬ä¹Ÿå°†å¤„ç†è¿‡çš„æ¡¶å…¬å¼€:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="d2a3" class="lc jv hi ky b be ld le l lf lg">gsutil iam ch allUsers:objectViewer gs://hls-streaming-gcp-processed-files-${PROJECT_ID}/</span></pre><p id="ebb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åˆ›å»ºå’Œé…ç½®æœåŠ¡å¸æˆ·</strong></p><p id="0118" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ç°åœ¨å°†ä¸ºäº‘åŠŸèƒ½é…ç½®æœåŠ¡å¸æˆ·ã€‚è°ƒç”¨ä»£ç è½¬æ¢å™¨APIéœ€è¦ä»£ç è½¬æ¢å™¨ç®¡ç†å‘˜æƒé™ï¼Œåˆ›å»ºè¾“å‡ºå­˜å‚¨æ¡¶éœ€è¦å­˜å‚¨ç®¡ç†å‘˜æƒé™ã€‚</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="4bc3" class="lc jv hi ky b be ld le l lf lg">gcloud iam service-accounts create transcoder-service-account \<br/> --display-name="Transcoder service account"</span></pre><p id="ec22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¹¶ç»™å®ƒå¿…è¦çš„æƒé™:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="8e72" class="lc jv hi ky b be ld le l lf lg">gcloud projects add-iam-policy-binding ${PROJECT_ID} --member="serviceAccount:transcoder-service-account@${PROJECT_ID}.iam.gserviceaccount.com" --role="roles/run.invoker"<br/>gcloud projects add-iam-policy-binding ${PROJECT_ID} --member="serviceAccount:transcoder-service-account@${PROJECT_ID}.iam.gserviceaccount.com" --role="roles/transcoder.admin"<br/>gcloud projects add-iam-policy-binding ${PROJECT_ID} --member="serviceAccount:transcoder-service-account@${PROJECT_ID}.iam.gserviceaccount.com" --role="roles/storage.admin"<br/>gcloud projects add-iam-policy-binding ${PROJECT_ID} --member="serviceAccount:transcoder-service-account@${PROJECT_ID}.iam.gserviceaccount.com" --role="roles/eventarc.eventReceiver"</span></pre><p id="9815" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†å‘å¸ƒ/è®¢é˜…å‘å¸ƒè€…æˆäºˆäº‘å­˜å‚¨æœåŠ¡å¸æˆ·ï¼Œä»¥ä¾¿å®ƒå¯ä»¥é€šçŸ¥Eventarc</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="54d2" class="lc jv hi ky b be ld le l lf lg">GCS_SERVICE_ACCOUNT="$(gsutil kms serviceaccount -p ${PROJECT_ID})"<br/>gcloud projects add-iam-policy-binding $PROJECT_ID \<br/> --member="serviceAccount:${GCS_SERVICE_ACCOUNT}" \<br/> --role="roles/pubsub.publisher"</span></pre><p id="7ae2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åˆ›å»ºä¸€ä¸ªäº‘å‡½æ•°ï¼Œæ¯å½“æœ‰è§†é¢‘ä¸Šä¼ æ—¶ï¼Œå®ƒå°±å¯åŠ¨ä»£ç è½¬æ¢API</strong></p><p id="9da3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯åŠ¨ä»£ç è½¬æ¢è¿‡ç¨‹çš„äº‘å‡½æ•°ã€‚</p><p id="a43a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://cloud.google.com/functions" rel="noopener ugc nofollow" target="_blank">äº‘å‡½æ•°</a>éå¸¸é€‚åˆç²˜åˆä»£ç å’Œäº‹ä»¶é©±åŠ¨çš„ç”¨ä¾‹ï¼Œå°±åƒè¿™ä¸ªä¾‹å­ã€‚</p><p id="062f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å¯ä»¥åœ¨<a class="ae jd" href="https://github.com/dariobanfi/hls-streaming-gcp/tree/main/transcoding_function" rel="noopener ugc nofollow" target="_blank"> git repo </a>ä¸­æ‰¾åˆ°æºä»£ç ã€‚</p><p id="8937" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ–è€…ä½ å¯ä»¥è‡ªå·±åˆ›å»ºï¼Œå› ä¸ºå®ƒå¾ˆçŸ­ã€‚</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="97e8" class="lc jv hi ky b be ld le l lf lg">mkdir transcoding_function<br/><br/>echo 'import functions_framework<br/>import os<br/>from google.cloud.video import transcoder_v1<br/>from google.cloud.video.transcoder_v1.services.transcoder_service import (<br/>  TranscoderServiceClient,<br/>)<br/>@functions_framework.cloud_event<br/>def handle_gcs_event(cloud_event):<br/>  data = cloud_event.data<br/>  bucket = data["bucket"]<br/>  name = data["name"]<br/>  project_id = os.environ.get("PROJECT_ID")<br/>  region = os.environ.get("REGION")<br/>  input_uri = f"gs://{bucket}/{name}"<br/>  output_uri = f"gs://hls-streaming-gcp-processed-files-{project_id}/{name}/"<br/>  preset = "preset/web-hd"<br/>  client = TranscoderServiceClient()<br/>  parent = f"projects/{project_id}/locations/{region}"<br/>  job = transcoder_v1.types.Job()<br/>  job.input_uri = input_uri<br/>  job.output_uri = output_uri<br/>  job.template_id = preset<br/>  response = client.create_job(parent=parent, job=job)<br/>  print(response)<br/>' &gt; transcoding_function/main.py<br/><br/>echo "google-cloud-video-transcoder==1.4.0" &gt; transcoding_function/requirements.txt</span></pre><p id="7329" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹éƒ¨ç½²äº†ï¼ç¡®ä¿ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„æœåŠ¡å¸æˆ·:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="0d4a" class="lc jv hi ky b be ld le l lf lg">gcloud functions deploy transcoding-function \<br/> --gen2 \<br/> --region=europe-west1 \<br/> --runtime=python310 \<br/> --source=./transcoding_function \<br/> --entry-point=handle_gcs_event \<br/> --set-env-vars PROJECT_ID=${PROJECT_ID},REGION=europe-west1 \<br/> --trigger-bucket=hls-streaming-gcp-raw-files-${PROJECT_ID} \<br/> --service-account=transcoder-service-account@${PROJECT_ID}.iam.gserviceaccount.com</span></pre><h1 id="d606" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">æµ‹è¯•è®¾ç½®</strong></h1><p id="20e9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">å¤ªå¥½äº†ï¼Œç°åœ¨ä¸€åˆ‡å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥æµ‹è¯•æˆ‘ä»¬çš„è®¾ç½®äº†ã€‚</p><p id="1433" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªåŸå§‹è§†é¢‘æ–‡ä»¶åˆ°æ¡¶ä¸­è¿›è¡Œæ£€æŸ¥ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•è§†é¢‘æ–‡ä»¶ã€‚åˆšåˆšä¸Šä¼ åˆ°æ¡¶ä¸­:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="4fa7" class="lc jv hi ky b be ld le l lf lg">gsutil cp sample.mov gs://hls-streaming-gcp-raw-files-${PROJECT_ID}</span></pre><p id="e032" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿‡äº†ä¸€ä¼šå„¿ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿåœ¨<strong class="ih hj">HLS-streaming-GCP-processed-files</strong>æ¡¶ä¸­çœ‹åˆ°æˆ‘ä»¬å¤„ç†è¿‡çš„æ–‡ä»¶ã€‚</p><p id="9a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å¯ä»¥éšæ—¶é€šè¿‡ä»¥ä¸‹æ–¹å¼ç›‘æ§ä½œä¸šè¿›åº¦:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="83ad" class="lc jv hi ky b be ld le l lf lg">gcloud transcoder jobs list - location europe-west1</span></pre><p id="0a2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å’Œ</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="3e01" class="lc jv hi ky b be ld le l lf lg">gcloud transcoder jobs describe job_id</span></pre><h1 id="9e5b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">é…ç½®è´Ÿè½½å¹³è¡¡å™¨å’ŒCDN</h1><p id="756a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»ç”Ÿæˆäº†m3u8æ’­æ”¾åˆ—è¡¨å¹¶ä¿å­˜åœ¨äº‘å­˜å‚¨ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‘ç”¨æˆ·å…¬å¼€å®ƒã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªè´Ÿè½½å¹³è¡¡å™¨åœ°å€ï¼Œå¹¶ä½¿ç”¨Google CDNæ¥ç¼“å­˜å†…å®¹ï¼Œå¹¶å°½å¯èƒ½é è¿‘æˆ‘ä»¬çš„ç”¨æˆ·æä¾›æœåŠ¡ã€‚</p><p id="4c91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬é¦–å…ˆä¸ºæˆ‘ä»¬çš„è´Ÿè½½å¹³è¡¡å™¨ä¿ç•™ä¸€ä¸ªå¤–éƒ¨åœ°å€</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="0724" class="lc jv hi ky b be ld le l lf lg">gcloud compute addresses create load-balancer-ip \<br/> --ip-version=IPV4 \<br/> --global</span></pre><p id="f4a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬å†™ä¸‹æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„åœ°å€:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="2547" class="lc jv hi ky b be ld le l lf lg">export LB_IP_ADDRESS=$(gcloud compute addresses describe load-balancer-ip --format="get(address)" --global)</span></pre><p id="cfdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªè´Ÿè½½å¹³è¡¡å™¨å­˜å‚¨æ¡¶ï¼Œå®ƒå°†æˆä¸ºæˆ‘ä»¬çš„è´Ÿè½½å¹³è¡¡å™¨çš„ç›®æ ‡:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="af3b" class="lc jv hi ky b be ld le l lf lg">gcloud compute backend-buckets create hls-streaming-bucket \<br/> --gcs-bucket-name=hls-streaming-gcp-processed-files-${PROJECT_ID} \<br/> --enable-cdn \<br/> --cache-mode=CACHE_ALL_STATIC \<br/> --default-ttl=2419200 \<br/> --max-ttl=2419200</span></pre><p id="9559" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ä½¿ç”¨<em class="lh"> CACHE_ALL_STATIC </em>æ¥ç¼“å­˜æ‰€æœ‰<a class="ae jd" href="https://cloud.google.com/cdn/docs/caching#static" rel="noopener ugc nofollow" target="_blank">é™æ€å†…å®¹</a></p><p id="710f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å°†é»˜è®¤TTLæ›´æ”¹ä¸ºï¼Œå°†æœ€å¤§TTLæ›´æ”¹ä¸º2.419.200ç§’(28å¤©),å› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–ç¼“å­˜å‘½ä¸­ç‡ï¼Œä»¥é™ä½å‡ºå£æˆæœ¬ã€‚</p><p id="61e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬é…ç½®URLæ˜ å°„å’Œç›®æ ‡ä»£ç†:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="2742" class="lc jv hi ky b be ld le l lf lg">gcloud compute url-maps create hls-streaming-load-balancer \<br/> --default-backend-bucket=hls-streaming-bucket<br/>gcloud compute target-http-proxies create hls-streaming-load-balancer-proxy \<br/> --url-map=hls-streaming-load-balancer</span></pre><p id="6aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨ä»¥ä¸‹å†…å®¹é…ç½®è½¬å‘è§„åˆ™:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="d2b3" class="lc jv hi ky b be ld le l lf lg">gcloud compute forwarding-rules create hls-streaming-load-balancer-forwarding-rule \<br/> --load-balancing-scheme=EXTERNAL_MANAGED \<br/> --network-tier=PREMIUM \<br/> --address=load-balancer-ip \<br/> --global \<br/> --target-http-proxy=hls-streaming-load-balancer-proxy \<br/> --ports=80</span></pre><p id="be4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬ç»™è´Ÿè½½å¹³è¡¡å™¨å¤§çº¦5åˆ†é’Ÿçš„æ—¶é—´æ¥ä¼ æ’­è½¬å‘è§„åˆ™ã€‚</p><p id="88fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¹‹åï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿä½¿ç”¨ä»¥ä¸‹å·¥å…·å¯¹å…¶è¿›è¡Œæµ‹è¯•:</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="44db" class="lc jv hi ky b be ld le l lf lg">curl http://${LB_IP_ADDRESS}/sample.mov/manifest.m3u8</span></pre><h2 id="70af" class="li jv hi bd jw lj lk ll ka lm ln lo ke iq lp lq ki iu lr ls km iy lt lu kq lv bi translated">å¤ªæ£’äº†ï¼Œæˆ‘ä»¬çš„ç«¯ç‚¹å·²ç»å‡†å¤‡å¥½ä¼ è¾“åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº†ï¼</h2><h1 id="3401" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">æµå‘ç§»åŠ¨åº”ç”¨</h1><p id="caf0" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">ä¸ºä»€ä¹ˆåœåœ¨è¿™é‡Œï¼Ÿè®©æˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªç®€å•çš„Flutteråº”ç”¨ç¨‹åºå¹¶è¿›è¡Œæµ‹è¯•ã€‚</p><p id="1f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¯ä»¥åœ¨<a class="ae jd" href="https://github.com/dariobanfi/hls-streaming-gcp/tree/main/flutter_app" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šæ‰¾åˆ°ä¸€ä¸ªç¤ºä¾‹è§†é¢‘æ’­æ”¾å™¨åº”ç”¨ç¨‹åºã€‚</p><p id="649c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¯¹äºè¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾ä½ å·²ç»æœ‰ä¸€ä¸ªflutterå¼€å‘ç¯å¢ƒè®¾ç½®ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥éµå¾ª<a class="ae jd" href="https://docs.flutter.dev/get-started/install" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªæŒ‡å—</a>ã€‚</p><p id="bbf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬å…‹éš†å­˜å‚¨åº“å¹¶è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚</p><pre class="jf jg jh ji fd kx ky kz bn la lb bi"><span id="a6f2" class="lc jv hi ky b be ld le l lf lg">git clone https://github.com/dariobanfi/hls-streaming-gcp/tree/main/flutter_app<br/>cd hls-streaming-gcp-demo/flutter_app<br/>flutter run</span></pre><p id="c291" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æ‰“å¼€flutter_app/lib/main.dartæ–‡ä»¶ï¼Œåœ¨videoSourceå˜é‡ä¸­æ·»åŠ m3u8æ’­æ”¾åˆ—è¡¨çš„ç«¯ç‚¹ã€‚</p><p id="bb71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è€Œè¿™å°±æ˜¯ç»“æœï¼Œä¸€ä¸ªå¸¦HLSç›´æ’­çš„è§†é¢‘æ’­æ”¾å™¨ï¼ğŸ‰</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/9cbd6319e04c87d4d7d70d3438e8d3c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WQcXJLT-lQwykHPc"/></div></div></figure></div></div>    
</body>
</html>