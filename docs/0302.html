<html>
<head>
<title>How to deploy a static React site to Google Cloud Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将静态React站点部署到Google云平台</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/how-to-deploy-a-static-react-site-to-google-cloud-platform-55ff0bd0f509?source=collection_archive---------1-----------------------#2017-06-07">https://medium.com/google-cloud/how-to-deploy-a-static-react-site-to-google-cloud-platform-55ff0bd0f509?source=collection_archive---------1-----------------------#2017-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1d89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看着外面的几个指南，当我试图找到如何部署我的应用程序时，我感到非常困惑。</p><p id="8fc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我看了谷歌网站上的一些指南和一些堆栈溢出的帖子，但没有发现它们太有帮助。</p><p id="5cee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我发现了一个很棒的资源，它让我在MDN上获得了70%的支持:</p><div class="jd je ez fb jf jg"><a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/How_do_you_host_your_website_on_Google_App_Engine" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">你如何在谷歌应用引擎上托管你的网站？</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">Google App Engine是一个强大的平台，让您可以在Google的基础设施上构建和运行应用程序——无论是…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">developer.mozilla.org</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><p id="a5b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">填补了一些空白，我能够部署我的静态React站点。这是我的指南，简单几步。</p><h1 id="9818" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">我们将使用的工具:</h1><ul class=""><li id="c380" class="ku kv hi ih b ii kw im kx iq ky iu kz iy la jc lb lc ld le bi translated"><a class="ae lf" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app cli工具</a></li><li id="9079" class="ku kv hi ih b ii lg im lh iq li iu lj iy lk jc lb lc ld le bi translated"><a class="ae lf" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>(我简称它为GCP)</li></ul><p id="5f26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ll">注意:我们将部署一个使用React渲染前端的静态站点。在这个例子中，没有后端/服务器被连接。</em></p><h1 id="b754" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">开始部署吧！</h1><ol class=""><li id="4d20" class="ku kv hi ih b ii kw im kx iq ky iu kz iy la jc lm lc ld le bi translated">使用<code class="du ln lo lp lq b">create-react-app</code> cli工具创建一个react应用程序，添加您的代码、资源等。在这个例子中，我们将使用命令<code class="du ln lo lp lq b">create-react-app test-app</code>，其中将创建一个名为<strong class="ih hj"> test-app </strong>的目录，包含我所有的应用程序文件。</li><li id="891f" class="ku kv hi ih b ii lg im lh iq li iu lj iy lk jc lm lc ld le bi translated">进入test-app目录，使用<code class="du ln lo lp lq b">npm run build</code>命令创建一个缩小的项目包。这将创建一个名为<strong class="ih hj"> build </strong>的新文件夹，其中包含部署静态React站点所需的所有文件。</li></ol><pre class="lr ls lt lu fd lv lq lw lx aw ly bi"><span id="311a" class="lz jx hi lq b fi ma mb l mc md">$ cd test-app<br/>$ npm run build</span></pre><p id="d90f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.在GCP创建一个存储桶。您可以保留默认值，只需点击<code class="du ln lo lp lq b">create</code>。</p><p id="e046" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用这个桶轻松地将我们的构建文件夹文件上传到GCP。之后，我们会将文件转移到我们的GCP项目。记下<em class="ll">桶名</em>，因为我们稍后会用到它。这个水桶的名字叫<code class="du ln lo lp lq b">straight-veld-8658</code></p><figure class="lr ls lt lu fd mf er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es me"><img src="../Images/ee39966331ab8e3640c8eb1c5f128d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CwPNMyMfJVuq2wN2eOoz2g.png"/></div></div></figure><p id="f595" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.一旦创建了存储桶，点击它并选择<code class="du ln lo lp lq b">upload files</code>。浏览到您的项目目录并上传整个<code class="du ln lo lp lq b">build</code>文件夹。</p><figure class="lr ls lt lu fd mf er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es ml"><img src="../Images/fa76d6583dbee07e709e19589c4a9cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQwob9nXpenCTnRZiQy7wQ.png"/></div></div></figure><p id="cda0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.我们还需要一个<code class="du ln lo lp lq b">app.yaml</code>文件。这个文件是一个配置文件，它告诉应用程序引擎如何将URL映射到静态文件。我使用了MDN教程的sample-app中提供的同一个app.yaml文件(但是把<code class="du ln lo lp lq b">website</code>目录改成了<code class="du ln lo lp lq b">build</code>)。看起来是这样的:</p><pre class="lr ls lt lu fd lv lq lw lx aw ly bi"><span id="8095" class="lz jx hi lq b fi ma mb l mc md">runtime: python27<br/>api_version: 1<br/>threadsafe: true</span><span id="1b40" class="lz jx hi lq b fi mm mb l mc md">handlers:<br/>- url: /<br/>  static_files: <strong class="lq hj">build</strong>/index.html<br/>  upload: <strong class="lq hj">build</strong>/index.html</span><span id="8183" class="lz jx hi lq b fi mm mb l mc md">- url: /<br/>  static_dir: <strong class="lq hj">build</strong></span></pre><p id="55b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将该文件也上传到bucket。</p><p id="0845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的存储桶现在应该填充了以下文件:</p><figure class="lr ls lt lu fd mf er es paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="er es mn"><img src="../Images/4ef6b85a6492a7bf02833fbb13aff670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4S9XOepxPX1v4shDuLt6hw.png"/></div></div></figure><p id="08f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.在同一个页面上找到一个图标，让你打开一个谷歌云外壳到你的应用实例。点击它，打开外壳。</p><figure class="lr ls lt lu fd mf er es paragraph-image"><div class="er es mo"><img src="../Images/e94e77bbeaea28ce0399b41439ec4e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*PQ79W7cftuz6pvizdeDPlg.png"/></div></figure><p id="4024" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将上传到<code class="du ln lo lp lq b">straight-veld-8658</code>桶中的<strong class="ih hj">构建</strong>目录和<strong class="ih hj"> app.yaml </strong>文件到我们的实例中，这样我们就可以启动应用程序了。使用以下命令:</p><pre class="lr ls lt lu fd lv lq lw lx aw ly bi"><span id="dbbb" class="lz jx hi lq b fi ma mb l mc md">$ mkdir test-app<br/>$ gsutil rsync -r gs://<!-- -->straight-veld-8658 ./test-app</span></pre><p id="0217" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ll">注意:gsutil rsync命令的格式如下:gsutil rsync-r[source][destination](-r表示递归同步文件)</em></p><p id="70f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以确保文件在那里。当你<code class="du ln lo lp lq b">cd test-app</code>和<code class="du ln lo lp lq b">ls</code>时，你应该同时看到<code class="du ln lo lp lq b">app.yaml</code>和<code class="du ln lo lp lq b"><strong class="ih hj">build</strong></code></p><p id="b1e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.在shell中运行<code class="du ln lo lp lq b">gcloud app deploy</code>来部署应用程序。您应该会看到某种成功消息，表明该应用程序已被提供。它还应该为您提供您可以访问该应用程序的url。</p><p id="a0e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说，除非你已经链接了一个自定义域名，否则这个url的格式如下:<code class="du ln lo lp lq b">https://[app_name].appspot.com</code></p></div></div>    
</body>
</html>