<html>
<head>
<title>Measuring Reliability in GCP: Step By Step SLO creation guide using Cloud Operation Sandbox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">测量GCP的可靠性:使用云操作沙盒的SLO逐步创建指南</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/measuring-reliability-in-gcp-step-by-step-slo-creation-guide-using-cloud-operation-sandbox-99043bd0e70f?source=collection_archive---------1-----------------------#2021-09-10">https://medium.com/google-cloud/measuring-reliability-in-gcp-step-by-step-slo-creation-guide-using-cloud-operation-sandbox-99043bd0e70f?source=collection_archive---------1-----------------------#2021-09-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if"><p id="4319" class="ig ih hi bd ii ij ik il im in io ip dx translated">在这个分步指南中，我将使用我们的学习环境云操作沙箱演示如何在云操作中配置SLO。</p></blockquote><p id="d3b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ip hb bi translated">在简短的术语介绍之后，我将介绍云操作沙盒。然后，我们将为基于web的电子商务应用程序Hipster Shop创建SLO。最后，我们将了解如何配置我们在GCP的云操作套件中定义的SLO。</p><blockquote class="jn jo jp"><p id="1fbc" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated">如果你不熟悉SRE的概念和术语，请在进入下一部分之前回顾一下<a class="ae jz" href="https://cloud.google.com/blog/products/devops-sre/sre-fundamentals-sli-vs-slo-vs-sla" rel="noopener ugc nofollow" target="_blank"> SRE基本面(SLIs vs SLA vs SLOs)</a>。</p></blockquote><p id="5506" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在SRE，我们采用以客户为中心的方法来推动各方面的活动；从确定指标，到容量规划和变更管理。只要你的用户满意，你可以优先考虑速度，但当你被认为不可靠时，你应该优先考虑可靠性。为了改善我们的用户体验，你必须首先定义SLIs和SLO。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ka"><img src="../Images/eb224ef9e5a0061aae5ef1d6e7704dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7p0YZrSJLEr8xq0St6qbQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx translated">SLI，SLO，SLA概述</figcaption></figure><p id="4963" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated"><strong class="is hj"> SLI，SLO，SLA回顾</strong></p><p id="9cf0" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">SLIs和SLO的范围是一个<strong class="is hj">用户之旅。</strong>你的<em class="jq">用户</em>正在使用你的<em class="jq">服务</em>来实现一组<em class="jq">目标</em>，其中最重要的被称为<em class="jq">关键用户旅程(CUJ) </em>。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kq"><img src="../Images/f7878bf114bd8b681a91b8d8681ed49a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOc2amlH0avE620CpxEPrA.png"/></div></div></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="b017" class="ky kz hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">逐步创建SLI/O</h1><p id="5b7c" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">对于本指南，我们将使用<a class="ae jz" href="https://cloud-ops-sandbox.dev/docs/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="jq">云操作沙箱</em> </strong> </a>，这是一个点击即可部署的开源学习环境。云操作沙盒帮助从业者了解如何使用<a class="ae jz" href="https://cloud.google.com/products/operations" rel="noopener ugc nofollow" target="_blank">谷歌云的操作套件</a>，并提供在类似于生产环境的合成流量的隔离云环境中应用SRE实践的能力。</p><blockquote class="jn jo jp"><p id="7379" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated"><strong class="is hj"> <em class="hi">云操作沙盒</em> </strong>是一个快速简单的“游戏环境”,用于评估尽可能接近真实生产环境的云操作。从这里开始:<a class="ae jz" href="http://cloud-ops-sandbox.dev" rel="noopener ugc nofollow" target="_blank"> cloud-ops-sandbox.dev </a></p></blockquote><p id="c9f9" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">云运营沙盒包括一个名为<strong class="is hj"> <em class="jq">潮人店</em> </strong>的云原生微服务演示应用。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mb"><img src="../Images/fb0eee4fa0c30c06b416a416fe9cfa39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ctJ5VYdfd42E-hOz"/></div></div></figure><p id="f9ba" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">Hipster Shop是一个基于web的电子商务应用程序，有一个前端和一系列后端服务。该应用程序由11个用各种语言编写的微服务组成，它们通过gRPC相互通信。潮人商店展示了Kubernetes/GKE、Istio、云监控和日志记录以及gRPC等技术的使用。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es mc"><img src="../Images/a51a5eb6c1a83b8e91254097aba1d4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJsFCE63ZxZW3oHumEb26g.png"/></div></div></figure><p id="7508" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">Hipster Shop的用户可以浏览商品，将它们添加到购物车中，然后购买它们。要开发SLIs，理解应用程序是如何构建的很重要。</p><p id="0a7a" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">首先，让我们回顾一下潮人店的流程:</p><ol class=""><li id="07d7" class="md me hi is b it jr ix js jb mf jf mg jj mh ip mi mj mk ml bi translated">用户通过前端访问应用程序。</li><li id="4d0f" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">然后购买由CheckoutService处理。</li><li id="4e66" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">CheckoutService依赖CurrencyService来处理转换。</li><li id="a7c6" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">其他服务(如RecommendationService、ProductCatalogService和Adservice)用于向前端提供呈现页面所需的内容。</li></ol><blockquote class="jn jo jp"><p id="8eaf" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated">更多信息请参考公开回购:<a class="ae jz" href="https://github.com/GoogleCloudPlatform/cloud-ops-sandbox" rel="noopener ugc nofollow" target="_blank">github.com/GoogleCloudPlatform/cloud-ops-sandbox</a></p></blockquote></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="98f4" class="ky kz hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">SLO创作过程</h1><p id="df81" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">要保证用户快乐，你得先定义它。我们的用户正在使用我们的<strong class="is hj">服务</strong>来实现一系列<strong class="is hj">目标</strong>，其中最重要的是<strong class="is hj">关键用户旅程(CUJs) </strong>。</p><p id="cb9f" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">定义CUJs后，您需要确定最接近描述用户体验的指标，这些指标就是我们的<strong class="is hj"> SLIs </strong>。然后，您将使用这些sli来定义我们的<strong class="is hj"> SLO </strong>目标。</p><h2 id="9968" class="mr kz hi bd la ms mt mu le mv mw mx li jb my mz lm jf na nb lq jj nc nd lu ne bi translated">1.SLO进程-确定我们的CUJ</h2><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nf"><img src="../Images/7e763cae4d6370fb8677c908682b2cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDR8BIZ2QfpjiznclsxYSA.png"/></div></div></figure><p id="02ff" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">用户在“潮人商店”购物时可以采取的一些关键行动包括:</p><ol class=""><li id="8d4b" class="md me hi is b it jr ix js jb mf jf mg jj mh ip mi mj mk ml bi translated">浏览产品，</li><li id="ff1b" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">结帐，</li><li id="56f4" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">并添加到购物车。</li></ol><p id="67dd" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">接下来，你应该问问自己，哪些对业务最重要？并以此作为CUJs的优先级标准。</p><p id="3d42" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">结帐并不是唯一的关键用户旅程，但它与企业收入直接相关，因此我们将它放在首位。</p><p id="007d" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">如果你发现对CUJs进行优先排序很有挑战性，试着把你自己放在用户的位置上。在我们的例子中，作为一个用户，你有多少次在没有购买商品的情况下在线浏览商品或将商品添加到购物车？</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ng"><img src="../Images/a6d137d66ca3d83bd83b5a802e5b9f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vcnUfG1Mm7FQ30-FQsXATQ.png"/></div></div></figure><p id="52e9" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">对于本例的其余部分，“Checkout”将是SLO的基础，但是您可以将相同的技术应用于其他关键的用户旅程。</p><p id="6742" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">CUJ收银台使用我们架构的以下组件</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nh"><img src="../Images/8d3a5a52ffccfe0ee872e20349b83c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nc1FG7GQPJW2xw2u35KhCw.png"/></div></div></figure><h2 id="4e2f" class="mr kz hi bd la ms mt mu le mv mw mx li jb my mz lm jf na nb lq jj nc nd lu ne bi translated"><strong class="ak"> 2。SLO进程-SLI创造</strong></h2><p id="0d85" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">在您确定了CUJ和您将关注的交互之后，您将需要<strong class="is hj"> <em class="jq">选择哪些指标</em> </strong>将最准确地代表用户体验。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ni"><img src="../Images/e7881d98d61a927f8df4ae8cec96e690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fr5KTveTqKlXnkS_SPhY0w.png"/></div></div></figure><p id="3f08" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">假设我们的应用程序Hipster Shop为最终用户的电子商务流量提供服务，用户在结账时在前端执行不同操作的体验应该保持一致。因此，我们应该为请求可用性(有多少请求成功)、延迟(请求需要多长时间)、质量和其他指标定义SLIs。</p><p id="c47c" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在决定使用什么样的SLI打字时，我建议查看一下《SLOs手册的艺术》第7页中的SLI菜单。该手册为根据交互类型(请求/响应、数据处理或存储)起草sli提供了方便的指南。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div class="er es nj"><img src="../Images/dff557d95073f37ce029bee44db37fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/0*JNgiMByo3P3ra0q1"/></div></figure><p id="fc9c" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">下一步是定义SLI规范。<strong class="is hj"> SLI规范</strong>是对你认为对你的用户重要的服务结果的评估。您可能希望将它们表示为“好”事件的数量除以有效事件的总数。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nk"><img src="../Images/06f69aa10bef6c8652f2b971e1a7fb27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hZcUUMD-4IEWVqbj"/></div></div></figure><p id="c855" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">最后，您将通过添加<a class="ae jz" href="https://sre.google/workbook/implementing-slos/" rel="noopener ugc nofollow" target="_blank">度量方法</a>将该规范细化为详细的<strong class="is hj"> SLI实现</strong>，例如，应用级度量、日志处理、前端基础架构度量、合成客户端/数据、客户端工具(要了解更多信息，请阅读:<a class="ae jz" href="https://static.googleusercontent.com/media/sre.google/en//static/pdf/art-of-slos-handbook-letter.pdf" rel="noopener ugc nofollow" target="_blank">SLOs手册的艺术，第16页</a>)。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nl"><img src="../Images/81488877a0bdbd13114f9bfe49d5ded3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ziDrnoR6IPWJ_sfz"/></div></div></figure><p id="9277" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在结帐CUJ的情况下，目标是结帐功能保持可接受的可用性。为了实现这一点，您需要测量有多少用户尝试签出，以及有多少请求成功，因此成功请求的数量是“好”的度量。</p><blockquote class="jn jo jp"><p id="de86" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated">重要的是要详细说明具体要测量什么，以及你计划在哪里测量。</p></blockquote><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nm"><img src="../Images/af26ca228b4b3166b0756e96be42c109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fn5qLmdEAxTkCPv2rFZLQQ.png"/></div></div></figure><blockquote class="jn jo jp"><p id="032e" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated"><strong class="is hj">为什么排除3XX和4XX状态码？</strong>由于3xx和4xx表示重定向和客户端错误，在这种特定情况下，您可以将这些视为“系统正常工作”。因此，您不希望将这些类型的请求视为违反我们可用性SLO的错误。</p><p id="7101" class="iq ir jq is b it jr iv iw ix js iz ja jt ju jd je jv jw jh ji jx jy jl jm ip hb bi translated">请注意，这不应该是一种概括，您应该注意做出这个决定，并且建议在您的系统中检查这些错误，以检查它们是否代表系统故障。</p></blockquote><h2 id="4b0e" class="mr kz hi bd la ms mt mu le mv mw mx li jb my mz lm jf na nb lq jj nc nd lu ne bi translated">3.SLO进程——SLO</h2><p id="b2a4" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">在定义SLIs之后，是时候设置SLO(服务水平目标)了，它是指定时间窗口(例如，一个月或一个季度)内SLI的目标。</p><p id="cddf" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">SLO应包括一个用百分比表示的<em class="jq">目标</em>，即良好/总比率，例如99.99%。在<em class="jq">特定测量窗口</em>中，该窗口应该是一个持续时间，允许我们在需要时做出战略决策并优先考虑可靠性(要了解更多信息，请阅读:<a class="ae jz" href="https://sre.google/workbook/implementing-slos/" rel="noopener ugc nofollow" target="_blank">选择适当的时间窗口</a>)。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nn"><img src="../Images/fd34ec7b26f23175f3c50c38452e290b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RWx_zP4YO8Urj5ZW"/></div></div></figure><p id="044d" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">如果你想在跟踪这些SLO的基础上改变你的系统，设定一个可实现的目标是很重要的。如果你的目标过于雄心勃勃，SLO将很快成为一个被忽视的麻烦。如果你的客户对你今天的服务很满意，你可能做得很好，你可能希望你的目标基于符合用户期望的历史数据。这些目标不是一成不变的，您应该重新访问这些目标，并对它们进行迭代，以符合业务需求。</p><p id="ce38" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在我们的例子中，根据历史数据趋势，您可以假设我们的SLO将有99%的可用性。如果你没有历史数据，试着检查竞争对手和基准类型的旅程的问题，以检查用户的期望。例如，如果在交互服务和报告生成之间需要手动操作，您可能会考虑拆分旅程阶段(更多信息:请参考<a class="ae jz" href="https://static.googleusercontent.com/media/sre.google/en//static/pdf/art-of-slos-handbook-letter.pdf" rel="noopener ugc nofollow" target="_blank">SLOs手册的艺术，第</a> 20页中的买入货币CUJ)。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es no"><img src="../Images/e6c559e4d838f4f21f3823ac08cb62f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_AJy58-Aqo3lOrfcKmgjQ.png"/></div></div></figure><h2 id="5f4f" class="mr kz hi bd la ms mt mu le mv mw mx li jb my mz lm jf na nb lq jj nc nd lu ne bi translated">第四步:</h2><p id="9976" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">在您定义了您的sli和SLO之后，是时候将这些定义转化为有形的仪表板和警报了。在GCP，我们在<strong class="is hj">实现</strong> SLIs和SLOs的工具是<a class="ae jz" href="https://cloud.google.com/products/operations" rel="noopener ugc nofollow" target="_blank"> <em class="jq">云运营套件</em> </a>。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="ac4c" class="ky kz hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用云计算运营套件实施</h1><p id="c0b6" class="pw-post-body-paragraph iq ir hi is b it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm ip hb bi translated">云操作套件提供<strong class="is hj">面向服务的</strong> <strong class="is hj">监控</strong>，这意味着您正在为一项“服务”配置SLIs、SLO和刻录率警报。</p><p id="218e" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">创建SLO的第一步是<strong class="is hj">接收与SLIs中的使用指标相关的数据</strong>，对于GKE服务，它是现成的，但您也可以接收额外的数据。然后你需要定义我们的服务，定义我们的指示器:SLI<strong class="is hj"/>，我们的目标:SLO<strong class="is hj"/>，最后:燃烧率警报<strong class="is hj"/>。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es np"><img src="../Images/f2cc4b5323ede4e877f6b1e7c1d7b1e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8JpQp9LNi323meo6"/></div></div></figure><p id="6c80" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">使用云操作沙盒的优势之一是，它集成了大量来自Hipster Shop中的微服务的不同可观察性指标，即装即用。在<a class="ae jz" href="https://cloud.google.com/stackdriver/docs/solutions/slo-monitoring/ui/svc-overview" rel="noopener ugc nofollow" target="_blank">监控→服务→服务概述</a>下可以找到所有潮人店铺微服务:</p><p id="36a7" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">对于我们的用例，您需要选择结帐服务。如你所见，这里有两个结账服务。原因是因为<em class="jq">的云操作沙箱</em>的服务正在使用Istio。使用Istio的服务会被自动检测到，云操作套件会为我们创建云监控中的服务。然而，为了演示如何创建自己的服务，云操作沙盒还使用Terraform部署定制服务(<a class="ae jz" href="https://github.com/GoogleCloudPlatform/cloud-ops-sandbox/tree/master/terraform/monitoring" rel="noopener ugc nofollow" target="_blank">查看Terraform配置</a>)。因此，我们有两个服务，一个是自动检测的，因为使用了Istio，另一个是在Terraform代码中定义的，它是显式创建的。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nq"><img src="../Images/9e9e0c4a00fd22226140103f76b31f47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K10IF86Pa_3eZsnRE3aCig.png"/></div></div></figure><p id="371a" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">要浏览现有的SLO，请选择自定义结帐服务(这是由云操作沙盒中的Terraform代码创建的):</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nr"><img src="../Images/0f0239a93e5b0abfa4cb199d591e6a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NgMpiuL6C4h8D5An93Z3wg.png"/></div></div></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ns"><img src="../Images/c30074b9c8ad846ade1a66017c77ae15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jrz85PzGbn-PwhR3t2ezw.png"/></div></div></figure><p id="669a" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">接下来，您将选择自动检测的结帐服务(这是自动检测的，因为使用了Istio):</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nt"><img src="../Images/e0f3dd15861deaa0b7c1ea2b216e4af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_ZSTkb6jLNe3s-ittZ6XQ.png"/></div></div></figure><ol class=""><li id="8247" class="md me hi is b it jr ix js jb mf jf mg jj mh ip mi mj mk ml bi translated">要配置您在上一节中介绍的可用性SLI和SLO，您将选择→“创建SLO”。</li><li id="b687" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip mi mj mk ml bi translated">在第一个屏幕中，您将选择您的<strong class="is hj"> SLI类型</strong> : <strong class="is hj">可用性</strong></li></ol><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nu"><img src="../Images/e08777f7ac9e6a287854fe928c07b836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQ06mBjHy0hIJfI7tqeMlQ.png"/></div></div></figure><p id="bc7c" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">3.然后，您将选择性能指标:可用性。您的SLI实现将是:service/server/<strong class="is hj">request count，</strong>这是service/request_count的成功HTTP GET请求的百分比，由Istio测量。在此屏幕中，您还可以看到该指标的历史数据。</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nv"><img src="../Images/c88a1fffc1a92e384b772fd294e5b46c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVozhENQbIjjw5LlZf1oMA.png"/></div></div></figure><p id="7b01" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">4.然后，您应该配置我们的SLO。在这种情况下，过去28天内99%的结帐请求都是成功的。28天的滚动窗口通常更符合客户体验，是制定战略决策和提前计划的良好时间间隔(要了解更多信息，请阅读:<a class="ae jz" href="https://sre.google/workbook/implementing-slos/" rel="noopener ugc nofollow" target="_blank">选择合适的时间窗口</a>):</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nw"><img src="../Images/f29bef230d87e164188c30186586c2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XlT-XvECQixUDy-vVTGlRA.png"/></div></div></figure><p id="8a8a" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在保存之前，您可以查看SLO，看看JSON配置应该是什么样子(这可以作为自动化的一部分):</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nx"><img src="../Images/518c8642b6ba658a00f3377229824e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZN9RDD4JEt7DCvx2VpDlw.png"/></div></div></figure><p id="7ab4" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">5.之后，您可以在“结账服务”概览页面上看到新的SLO。最后，您可以为它创建<a class="ae jz" href="https://cloud.google.com/stackdriver/docs/solutions/slo-monitoring/alerting-on-budget-burn-rate" rel="noopener ugc nofollow" target="_blank"> SLO燃烧率警报</a>:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ny"><img src="../Images/badb1631ca83d4ead475132f19e234fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FShiGL4icWue152Z2DibRw.png"/></div></div></figure><p id="7cfe" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">在下一个屏幕中，您将设置警报的条件、通知谁、通知方式(电子邮件、webhook等)以及要包括的任何附加说明:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es nz"><img src="../Images/205d3503151c7b151df0f73c5af59b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrAFYkUII7sgNm55Ec_IGg.png"/></div></div></figure><p id="20a8" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">创建警报后，您可以在服务屏幕中看到它以及由SLO触发的任何事件:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es oa"><img src="../Images/37b058ddb1e533f7a13a4e82b4a016fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FUZDNllF0GD8mgFTGRrpXA.png"/></div></div></figure><p id="ea43" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">如果触发了警报，您将能够在警报屏幕中看到它:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ob"><img src="../Images/a45ce548c2e1fc7236b28f7ebd5f5b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXTtZ0UhefOMTtWmaFUkIw.png"/></div></div></figure><p id="0a68" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">完成后，您可以在服务屏幕下看到服务详细信息、警报时间表、SLO和其他信息:</p><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es oc"><img src="../Images/0a00e9af411a2565e415e4d1ab2e7068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HS7bBKUbkmfVpNkxI3vWyA.png"/></div></div></figure><p id="f1ac" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">现在，您已经了解了如何起草结账可用性SLO并在云运营中实施它。我想鼓励您起草并实施额外的SLO，如延迟SLO，额外的CUI，如添加到购物车，甚至利用这些知识来起草和配置您自己的服务的sli和SLO。</p><p id="6c15" class="pw-post-body-paragraph iq ir hi is b it jr iv iw ix js iz ja jb ju jd je jf jw jh ji jj jy jl jm ip hb bi translated">SRE之旅既包括实施SRE的实践，比如这里提到的SLO，也包括培养一种<a class="ae jz" href="http://bit.ly/sre_4steps" rel="noopener ugc nofollow" target="_blank">有利的文化</a>。下面，您可以找到其他资源，包括按资源类型和级别分类的公开可用资源的集合。</p><h1 id="ff73" class="ky kz hi bd la lb od ld le lf oe lh li lj of ll lm ln og lp lq lr oh lt lu lv bi translated">其他资源:</h1><ul class=""><li id="206c" class="md me hi is b it lw ix lx jb oi jf oj jj ok ip ol mj mk ml bi translated"><strong class="is hj"/><a class="ae jz" href="http://landing.google.com/sre/books/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj">书籍</strong> </a> <strong class="is hj"> </strong> ( <a class="ae jz" href="https://landing.google.com/sre/sre-book/toc/index.html" rel="noopener ugc nofollow" target="_blank"> SRE </a>，<a class="ae jz" href="https://landing.google.com/sre/workbook/toc/" rel="noopener ugc nofollow" target="_blank">工作簿</a>，<a class="ae jz" href="https://static.googleusercontent.com/media/landing.google.com/en//sre/static/pdf/Building_Secure_and_Reliable_Systems.pdf" rel="noopener ugc nofollow" target="_blank">建筑安全&amp;可靠系统</a>)</li><li id="0be8" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip ol mj mk ml bi translated"><a class="ae jz" href="http://bit.ly/Public_SRE_Resources" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">为GCP客户征集SRE公共资源</strong> </a></li><li id="92d7" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip ol mj mk ml bi translated"><strong class="is hj">Coursera:</strong><a class="ae jz" href="https://www.coursera.org/learn/site-reliability-engineering-slos" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/>现场可靠性工程:测量和管理可靠性</a></li><li id="7a83" class="md me hi is b it mm ix mn jb mo jf mp jj mq ip ol mj mk ml bi translated"><a class="ae jz" href="https://cloud.google.com/stackdriver/docs/solutions/slo-monitoring" rel="noopener ugc nofollow" target="_blank"> SLO监控</a>在GCP的‘云行动’</li></ul></div></div>    
</body>
</html>