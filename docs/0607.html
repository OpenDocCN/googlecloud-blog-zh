<html>
<head>
<title>Kubernetes: Day One</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">库伯内特:第一天</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/kubernetes-day-one-30a80b5dcb29?source=collection_archive---------0-----------------------#2018-05-18">https://medium.com/google-cloud/kubernetes-day-one-30a80b5dcb29?source=collection_archive---------0-----------------------#2018-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/733811a2eda2dd3bb8bb42cf80ceb65f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OtydkY3RawsTdroVfCm8tA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">你可以在72小时内完成</figcaption></figure><p id="e6c7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是Kubernetes帖子的必选步骤之一。如果你对Kubernetes感兴趣，你可能已经阅读了100篇这样的文章，而且你可能已经建立了自己的集群。这篇文章的目的是为接下来更多的高级文章打下基础。尽管入门文章很多，但真正挖掘Kubernetes背后真正力量的文章却很少。</p><p id="67d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">事不宜迟，让我们从基础开始。</p><h1 id="4ffc" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">高层次:什么是Kubernetes？</strong></h1><p id="48ef" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">Kubernetes是一个容器编排和管理工具。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/f110ec3a570255b80afd038e007b8b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*fw8YJnfF32dWsX_beQpWOw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">通用Kubernetes图像</figcaption></figure><p id="e0ae" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你一直在网上阅读大量文章，这很可能是你看到的答案或类似的东西。如果你感兴趣的话，这是一个关于库伯内特斯性质的<a class="ae la" href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/" rel="noopener ugc nofollow" target="_blank">更完整的答案。</a></p><p id="d277" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">阅读其他文章，您会看到如何使用一些命令行命令或YAML文件来告诉Kubernetes如何用容器创建<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/pods/pod/#what-is-a-pod" rel="noopener ugc nofollow" target="_blank"> Pods </a>。然后，您将使用<a class="ae la" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank">服务</a>向外部世界公开这些pods，并使用<a class="ae la" href="https://kubernetes.io/docs/concepts/services-networking/service/#type-loadbalancer" rel="noopener ugc nofollow" target="_blank">负载平衡器</a>将流量路由到这些Pods，这些Pods是由全能的<a class="ae la" href="https://kubernetes.io/docs/concepts/overview/components/#master-components" rel="noopener ugc nofollow" target="_blank"> Kubelet </a>随意创建和销毁的。</p><p id="007b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我把它简化了很多，让它更容易理解，这样我们就可以开门见山了。</p><h1 id="b87f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">开始使用谷歌云平台</h1><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/44d34bf96641ce044db10c5fa5ec40ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-j21t1cUIXbfX4_M5F9XQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用谷歌云平台和一个试用账户</figcaption></figure><p id="c1ef" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于这个演示代码，我推荐使用<a class="ae la" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>和他们管理的Kubernetes产品:<a class="ae la" href="https://cloud.google.com/kubernetes-engine/" rel="noopener ugc nofollow" target="_blank">谷歌Kubernetes引擎</a>。你可以创建一个价值300美元的试用账户(这需要你输入一张信用卡，尽管在试用结束前不会收费)。对这个来说绰绰有余了。</p><h1 id="d3ee" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">我为你提供了什么？</h1><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/6c5100902585795651428cfa7b998daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBr-N-4Jl1uycN46ogyCtQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">我为您提供了一些带有NodeJS代码的Docker容器</figcaption></figure><p id="2454" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设您已经阅读了一些关于Kubernetes的入门文章，那么您已经知道Kubernetes处理如何创建和管理容器，但是不关心容器实际上做什么(再次简化)。在这个例子中，我将为您提供一些容器，它们已经完成了我们需要的功能。你可以在我的Github Repo上看到我提供的所有代码。</p><div class="ld le ez fb lf lg"><a href="https://github.com/jonbcampos/kubernetes-series" rel="noopener  ugc nofollow" target="_blank"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">jonbcampos/kubernetes系列</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">kubernetes-系列- kubernetes系列代码</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">github.com</p></div></div><div class="lp l"><div class="lq l lr ls lt lp lu io lg"/></div></div></a></div><h1 id="007d" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">从哪里开始</h1><p id="cf85" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">我们将从项目中的云外壳控制台开始。这是一个为您的Google云平台项目实例运行命令的简单地方。为了便于使用，我将假设您从一个没有任何特殊设置的100%干净的项目开始。</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="b60a" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">开始编码</h1><p id="35cd" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">随着你的全新干净的谷歌云平台项目准备就绪，是时候让我们实际做一些真正的工作了。现在我们需要创建一个Kubernetes集群，任何必要的配置，并构建我们的docker容器，以便在我们的集群中启动。简单。</p><p id="fa2c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们需要通过点击云控制台右上角的控制台图标来启动云shell会话。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/5699358745fd0a33cc36b0a51f2db566.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*JTC7r26tZjUkB1vbGT74TA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">右上方—单击它</figcaption></figure><p id="f972" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，您应该已经在浏览器中打开了Cloud shell窗口。随意花一点时间，惊叹事情变得如此简单。只需点击一下，您就启动了Docker实例，并完成了与您的云项目进行交互所需的所有准备工作。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/78537afc604dede4f522e7ad097802fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*3Snmnd3O57nED5CpDKto2g.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">耶！云壳</figcaption></figure><p id="1742" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在您需要获取我的代码，创建集群，并构建容器。准备好大吃一惊了吗？转到您的云shell并键入以下内容。</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="8556" class="mo jt hi mk b fi mp mq l mr ms">$ git clone <a class="ae la" href="https://github.com/jonbcampos/kubernetes-series.git" rel="noopener ugc nofollow" target="_blank">https://github.com/jonbcampos/kubernetes-series.git</a><br/>$ cd kubernetes-series/partone/scripts<br/>$ sh startup.sh</span></pre><p id="ad9b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们会让它运行一段时间。我们在这三个命令中所做的是克隆我为您创建的项目代码，转到scripts文件夹，然后运行启动脚本。</p><p id="1e67" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我强烈建议你花点时间看看startup.sh 的<a class="ae la" href="https://github.com/jonbcampos/kubernetes-series/blob/master/partone/scripts/startup.sh" rel="noopener ugc nofollow" target="_blank">代码。在这个文件中，我运行了许多<strong class="iw hj"> gcloud </strong>方法，最终为你设置好一切。您可以自己动手或通过UI来完成所有这些工作，但同样，我们试图快速进入更高级的主题。不过说真的，</a><a class="ae la" href="https://github.com/jonbcampos/kubernetes-series/blob/master/partone/scripts/startup.sh#L1" rel="noopener ugc nofollow" target="_blank">读startup.sh文件</a>，我甚至对我的代码有注释。</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="86ee" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">我们现在在哪里？</h1><p id="a6b4" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">我们已经构建了容器、云环境设置，甚至集群集。现在我们只需要发布一个<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/" rel="noopener ugc nofollow" target="_blank"> Pod </a>、一个<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/" rel="noopener ugc nofollow" target="_blank">复制集</a>和一个<a class="ae la" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank">服务</a>，我们的“Kubernetes的Hello World”就完成了。仅供参考，这是我们真正进入“Kubernetes脚本”的最后时刻。到目前为止，你只是在设置中。</p><h2 id="034e" class="mo jt hi bd ju mt mu mv jy mw mx my kc jf mz na kg jj nb nc kk jn nd ne ko nf bi translated">复制集+单元=部署</h2><p id="0caf" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">一个<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/" rel="noopener ugc nofollow" target="_blank"> ReplicaSet </a>，一个来自Kubernetes早期版本的复制控制器的改进版本，与Kubernetes Master一起管理pod。如果一个Pod被移除/终止/崩溃等，那么ReplicaSet将杀死该Pod并重新创建一个新的Pod，以确保应用程序的高度一致性。</p><p id="2c1e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一个<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/" rel="noopener ugc nofollow" target="_blank">容器</a>是容器的容器。大多数Pod和容器之间有一对一的关系，但这不是必需的。如果一个容器需要与其他容器共享资源，那么您可以在一个Pod中包含多个容器。</p><p id="3ee3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一个<a class="ae la" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" rel="noopener ugc nofollow" target="_blank">部署</a>将复制集和pod集合到一个单独的进程中。)部署应用程序。说真的，他们有一些直截了当的名字——我喜欢。</p><p id="0dd6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面的YAML文件(<a class="ae la" href="https://github.com/jonbcampos/kubernetes-series/blob/master/partone/k8s/deployment.yaml" rel="noopener ugc nofollow" target="_blank">包含在Github </a>中)定义了我们的部署。我们将很快发布这个服务。</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="682a" class="mo jt hi mk b fi mp mq l mr ms"><strong class="mk hj">apiVersion: </strong>apps/v1beta1<br/><strong class="mk hj">kind: </strong>Deployment <em class="ng"># it is a deployment<br/></em><strong class="mk hj">metadata:<br/>  name: </strong>endpoints <em class="ng"># name of the Deployment<br/>  </em><strong class="mk hj">labels:<br/>    </strong><em class="ng"># any Pods with matching labels are included in this Deployment<br/>    </em><strong class="mk hj">app: </strong>kubernetes-series<br/>    <strong class="mk hj">tier: </strong>endpoints<br/><strong class="mk hj">spec:<br/>  </strong><em class="ng"># ReplicaSet specification<br/>  </em><strong class="mk hj">replicas: </strong>3 <em class="ng"># we are making 3 Pods<br/>  </em><strong class="mk hj">selector:<br/>    matchLabels:<br/>      </strong><em class="ng"># ReplicaSet labels will match Pods with the following labels<br/>      </em><strong class="mk hj">tier: </strong>endpoints<br/>  <strong class="mk hj">template:<br/>    </strong><em class="ng"># Pod template<br/>    </em><strong class="mk hj">metadata:<br/>      labels:<br/>        </strong><em class="ng"># Pod's labels<br/>        </em><strong class="mk hj">app: </strong>kubernetes-series<br/>        <strong class="mk hj">tier: </strong>endpoints<br/>    <strong class="mk hj">spec:<br/>      </strong><em class="ng"># Pod specification<br/>      </em><strong class="mk hj">containers:<br/>        </strong><em class="ng"># the container(s) in this Pod<br/>        </em>- <strong class="mk hj">name: </strong>partone-container<br/>          <strong class="mk hj">image: </strong>gcr.io/PROJECT_NAME/partone-container:latest<br/>          <em class="ng"># environment variables for the Pod<br/>          </em><strong class="mk hj">env:<br/>            </strong>- <strong class="mk hj">name: </strong>GCLOUD_PROJECT<br/>              <strong class="mk hj">value: </strong>PROJECT_NAME<br/>            <em class="ng"># we are going to use this later<br/>            # for now it creates a custom endpoint<br/>            # for this pod<br/>            </em>- <strong class="mk hj">name: </strong>POD_ENDPOINT<br/>              <strong class="mk hj">value: </strong>endpoint<br/>            - <strong class="mk hj">name: </strong>NODE_ENV<br/>              <strong class="mk hj">value: </strong>production<br/>          <strong class="mk hj">ports:<br/>            </strong>- <strong class="mk hj">containerPort: </strong>80</span></pre><h2 id="5e03" class="mo jt hi bd ju mt mu mv jy mw mx my kc jf mz na kg jj nb nc kk jn nd ne ko nf bi translated">服务</h2><p id="8065" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">通过部署，我们可以在集群内正确复制我们的pod，但我们还需要创建一种方式让世界访问我们的集群/pod。通过<a class="ae la" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank">服务</a>，我们创建并开放了与我们的pod进行交互所必需的网络接口。</p><p id="5c4b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面的YAML文件(<a class="ae la" href="https://github.com/jonbcampos/kubernetes-series/blob/master/partone/k8s/service.yaml" rel="noopener ugc nofollow" target="_blank">包含在Github </a>中)定义了我们的服务。我们将在接下来的部署中发布这一消息。</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="2bc1" class="mo jt hi mk b fi mp mq l mr ms"><strong class="mk hj">apiVersion: </strong>v1<br/><strong class="mk hj">kind: </strong>Service <em class="ng"># a way for the outside world to reach the Pods<br/></em><strong class="mk hj">metadata:<br/>  </strong><em class="ng"># any Pods with matching labels are included in this Service<br/>  </em><strong class="mk hj">name: </strong>endpoints<br/><strong class="mk hj">spec:<br/>  </strong><em class="ng"># Service ports<br/>  </em><strong class="mk hj">ports:<br/>    </strong>- <strong class="mk hj">name: </strong>http<br/>      <strong class="mk hj">port: </strong>80<br/>      <strong class="mk hj">targetPort: </strong>8080<br/>      <strong class="mk hj">protocol: </strong>TCP<br/>    - <strong class="mk hj">name: </strong>https<br/>      <strong class="mk hj">port: </strong>443<br/>      <strong class="mk hj">targetPort: </strong>8443<br/>      <strong class="mk hj">protocol: </strong>TCP<br/>  <em class="ng"># It includes a LoadBalancer between Pods<br/>  </em><strong class="mk hj">type: </strong>LoadBalancer<br/>  <strong class="mk hj">selector:<br/>    app: </strong>kubernetes-series</span></pre><h2 id="673b" class="mo jt hi bd ju mt mu mv jy mw mx my kc jf mz na kg jj nb nc kk jn nd ne ko nf bi translated">发动</h2><p id="f0b7" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">准备好service.yaml和deployment.yaml后，现在是我们部署所有东西的时候了，这样我们就可以看到发生了什么。我已经设置了以下脚本供您运行，它将部署一切。然后，我们只需要等待外部IP地址对我们的负载平衡器可用。获取外部IP地址可能需要一两分钟的时间，只需运行脚本，它就会等待并为您监视。</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="6df8" class="mo jt hi mk b fi mp mq l mr ms">$ cd kubernetes-series/partone/scripts # if necessary<br/>$ sh deploy.sh<br/>$ sh check-endpoint.sh</span></pre><p id="c92a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们要做的就是等待。等待外部IP地址可用…哦，完成了！</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es nh"><img src="../Images/e3b4214a725805db0bb5de61978e861d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*3GrEqqFT0AbXau8VFtgU5w.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">等待那个甜甜甜甜的外部IP地址</figcaption></figure><p id="e26d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有了由此产生的IP地址，您可以点击您的惊人的Hello World Kubernetes应用程序。</p><p id="04b6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我想提醒你这只是开始。在此基础上，我们可以而且将会做更多的事情。现在我们有了一个基线，我们可以真正处理更多的代码，进入有趣的东西。</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="bbce" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">拆卸</h1><p id="3a77" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在您离开之前，请确保清理您的项目，这样您就不会为您用来运行群集的虚拟机付费。返回到云Shell并运行teardown脚本来清理您的项目。这将删除您的集群和我们构建的容器。</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="8f29" class="mo jt hi mk b fi mp mq l mr ms">$ cd kubernetes-series/partone/scripts # if necessary<br/>$ sh teardown.sh</span></pre></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="c5f8" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">奖金！</h1><p id="93c3" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">好吧好吧。我确实在我们的Kubernetes集群中包含了一个小的高级特性。是在<a class="ae la" href="https://github.com/jonbcampos/kubernetes-series/blob/master/partone/scripts/startup.sh" rel="noopener ugc nofollow" target="_blank">启动脚本</a>里抓到的吗？</p><pre class="kw kx ky kz fd mj mk ml mm aw mn bi"><span id="6b55" class="mo jt hi mk b fi mp mq l mr ms"><em class="ng">gcloud </em>container clusters create <strong class="mk hj">$</strong>{CLUSTER_NAME} <strong class="mk hj">--preemptible </strong>--zone <strong class="mk hj">$</strong>{INSTANCE_ZONE} --scopes cloud-platform --num-nodes 3</span></pre><p id="19bd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了帮助我们节省一些钱，我使用了可抢占的虚拟机，而不仅仅是“普通”的虚拟机。<a class="ae la" href="https://cloud.google.com/preemptible-vms/" rel="noopener ugc nofollow" target="_blank"> <em class="ng">什么是可抢占的虚拟机？</em> </a> <em class="ng"> </em>可抢占的虚拟机最多存在24小时，谷歌可以在它们需要额外计算能力时关闭。在交易中，谷歌给你80%的折扣。因为我们正在构建令人惊叹的应用程序，这些应用程序有望让虚拟机快速启动和关闭，所以这一点也不会让我们感到害怕。</p><p id="784e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因为您使用的是Kubernetes，所以任何关闭的虚拟机都会被立即重新创建。赢了！</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="4d0e" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">第一部分的结论</h1><p id="cedc" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">本系列还有更多内容。Kubernetes给我留下了深刻的印象，我觉得每次我看得更深入，Kubernetes都会奖励我一个新功能，让我的生活更轻松。我打算分享这些发现和一路上我觉得有趣的小事。我不能保证所有的帖子都会很长，大多数很可能会很短，但都应该是有帮助的。</p><p id="cc10" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi ni translated">你对Kubernetes的哪些功能感兴趣？<br/>你发现哪些功能谈论得不够多？</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><h1 id="6bb5" class="js jt hi bd ju jv mc jx jy jz md kb kc kd me kf kg kh mf kj kk kl mg kn ko kp bi translated">本系列的其他文章</h1><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/@jonbcampos/kubernetes-running-background-tasks-with-batch-jobs-56482fbc853"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:使用批处理作业运行后台任务</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">当构建令人惊叹的应用程序时，有时您可能想要处理用户之外的动作…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nr l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/@jonbcampos/kubernetes-cluster-autoscaler-f1948a0f686d"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:集群自动缩放</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">自动缩放是Kubernetes的一个巨大的(并且已经上市的)特性。当你的网站/应用程序/应用程序接口/项目变得越来越大时，洪水…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="ns l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/@jonbcampos/kubernetes-horizontal-pod-scaling-190e95c258f5"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:水平Pod缩放</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">通过Pod自动扩展，您的Kubernetes集群可以监控现有Pod的负载，并确定我们是否需要更多…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nt l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-run-a-pod-per-node-with-daemon-sets-f77ce3f36bf1"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:用守护进程集在每个节点上运行一个Pod</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">我最初给这篇文章起的标题只是“守护进程集”,并假设它足以抓住要点…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nu l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-cron-jobs-455fdc32e81a"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">库伯内特:克朗·乔布斯</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">有时候你的工作不是事务性的。我们不再等待用户点击按钮让系统亮起来…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nv l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-dns-proxy-with-services-d7d9e800c329"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:带服务的DNS代理</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">构建应用程序时，通常需要与外部服务进行交互来完成业务…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nw l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-dns-proxy-with-services-d7d9e800c329"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:带服务的DNS代理</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">构建应用程序时，通常需要与外部服务进行交互来完成业务…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nw l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-routing-internal-services-through-fqdn-d98db92b79d3"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:通过FQDN路由内部服务</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">我记得当我第一次进入Kubernetes时。一切都是崭新的、闪亮的、有规模的。当我继续的时候…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nx l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/google-cloud/kubernetes-liveness-checks-4e73c631661f"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:活性检查</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">最近，我整理了一篇关于Kubernetes就绪性调查以及它对您的集群有多重要的文章…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="ny l lr ls lt lp lu io lg"/></div></div></a></div><div class="ld le ez fb lf lg"><a rel="noopener follow" target="_blank" href="/@jonbcampos/kubernetes-readiness-probe-83f8a06d33d3"><div class="lh ab dw"><div class="li ab lj cl cj lk"><h2 class="bd hj fi z dy ll ea eb lm ed ef hh bi translated">Kubernetes:就绪探测</h2><div class="ln l"><h3 class="bd b fi z dy ll ea eb lm ed ef dx translated">如果对这个特性有任何疑问，我写这篇文章是为了说明这不是一个…</h3></div><div class="lo l"><p class="bd b fp z dy ll ea eb lm ed ef dx translated">medium.com</p></div></div><div class="lp l"><div class="nz l lr ls lt lp lu io lg"/></div></div></a></div></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><p id="e535" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Jonathan Campos 是一个狂热的开发者，也是学习新事物的爱好者。我相信我们应该不断学习、成长和失败。我总是开发社区的支持者，并且总是愿意提供帮助。因此，如果你对这个故事有任何问题或意见，请在下面提出。在<a class="ae la" href="https://www.linkedin.com/in/jonbcampos/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae la" href="https://twitter.com/jonbcampos" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系，并提及这个故事。</p></div></div>    
</body>
</html>