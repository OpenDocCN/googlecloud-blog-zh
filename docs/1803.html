<html>
<head>
<title>C++ Functions Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">C++å‡½æ•°æ¡†æ¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-cloud/c-functions-framework-21f327fdee16?source=collection_archive---------0-----------------------#2021-02-16">https://medium.com/google-cloud/c-functions-framework-21f327fdee16?source=collection_archive---------0-----------------------#2021-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e2463a0e81e00f53c477b0ce2c8c188a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33MENwPR9kYL4QY9D74Jng.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">å¸¦æœ‰æ–‡æœ¬â€œå‡½æ•°æ¡†æ¶â€çš„æœªæ›´æ”¹çš„C++å¾½æ ‡ã€‚åœ¨<a class="ae iu" href="http://isocpp.org" rel="noopener ugc nofollow" target="_blank"><em class="iv">isocpp.org</em></a>äº†è§£æ›´å¤šå…³äºæ ‡å‡†C++çš„ä¿¡æ¯</figcaption></figure><p id="9cd3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><a class="ae iu" href="https://github.com/GoogleCloudPlatform/functions-framework-cpp" rel="noopener ugc nofollow" target="_blank"> C++å‡½æ•°æ¡†æ¶</a>æ˜¯ä¸€ä¸ªå¼€æºåº“ï¼Œå…è®¸ä½ ç”¨C++ç¼–å†™æ— æœåŠ¡å™¨å‡½æ•°ï¼Œå¹¶è½»æ¾éƒ¨ç½²åˆ°äº‘è¿è¡Œã€‚</p><p id="1764" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†é€æ­¥å®‰è£…æ¡†æ¶å¹¶éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæ— æœåŠ¡å™¨C++å‡½æ•°ã€‚</p><h2 id="5ad5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated">è®¾ç½®äº‘å£³</h2><p id="1ea5" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">å¯¹äºé¢„è£…å·¥å…·çš„ç¨³å®šç¯å¢ƒï¼Œè®©æˆ‘ä»¬ä½¿ç”¨Cloud Shellâ€”Google Cloudçš„åœ¨çº¿Shellç¯å¢ƒã€‚</p><p id="72b3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">è¿™é‡Œå¼€ä¸ªå…¨å±å£³:<a class="ae iu" href="http://shell.cloud.google.com/?show=terminal" rel="noopener ugc nofollow" target="_blank">shell.cloud.google.com/?show=terminal</a></p><p id="0f5d" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">è¿™ä¸ªç¯å¢ƒå¸¦æœ‰åƒ<code class="du ku kv kw kx b">docker</code>å’Œ<code class="du ku kv kw kx b">pack</code>è¿™æ ·çš„å·¥å…·ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šç”¨åˆ°å®ƒä»¬ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯å®ƒä»¬æ˜¯å¦å·²å®‰è£…:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="bbaf" class="ju jv hi kx b fi lg lh l li lj">docker --version<br/># Example output: Docker version 20.10.3, build 48d30b5<br/><br/>pack --version<br/># Example output: 0.17.0+git-d9cb4e7.build-2045</span></pre><h2 id="1912" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated">è·å–ç¤ºä¾‹ä»£ç </h2><p id="34f7" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">C++å‡½æ•°æ¡†æ¶åŒ…æ‹¬å…¥é—¨ç¤ºä¾‹ã€‚åœ¨æ‚¨çš„ä¸»ç›®å½•ä¸­ä¸‹è½½æ¡†æ¶:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="120a" class="ju jv hi kx b fi lg lh l li lj">cd $HOME<br/>git clone <a class="ae iu" href="https://github.com/GoogleCloudPlatform/functions-framework-cpp" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/functions-framework-cpp</a></span></pre><p id="ffd8" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">æœ¬æŒ‡å—çš„å…¶ä½™éƒ¨åˆ†å°†å‡è®¾æ‚¨åœ¨æ­¤repoçš„ç›®å½•ä¸­å‘å‡ºå‘½ä»¤:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="ba86" class="ju jv hi kx b fi lg lh l li lj">cd $HOME/functions-framework-cpp</span></pre><p id="f928" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨HTTP hello worldç¤ºä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="ky kz la lb fd ij"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">C++ä¸­çš„Hello Worldå‡½æ•°</figcaption></figure><blockquote class="lm ln lo"><p id="0f94" class="iw ix lp iy b iz ja jb jc jd je jf jg lq ji jj jk lr jm jn jo ls jq jr js jt hb bi translated">æ³¨æ„ä¸Šé¢ç¤ºä¾‹ä¸­å‡½æ•°æ¡†æ¶çš„gcf HTTPè¯·æ±‚å’Œå“åº”ç±»ä»¥åŠ<a class="ae iu" href="https://github.com/nlohmann/json" rel="noopener ugc nofollow" target="_blank"> nlohmann JSONè§£æ</a>ã€‚</p></blockquote><h2 id="701f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated">è®¾ç½®æ„å»ºåŒ…</h2><p id="8b35" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae iu" href="https://buildpacks.io/" rel="noopener ugc nofollow" target="_blank"> Cloud Native Buildpacks </a>æ¥åˆ›å»ºå°†è¢«éƒ¨ç½²åˆ°Cloud Runçš„å®¹å™¨æ˜ åƒã€‚ç¬¬ä¸€æ¬¡è¿è¡Œè¿™äº›å‘½ä»¤å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼Œç”šè‡³ä¸€ä¸ªå°æ—¶ï¼Œè¿™å–å†³äºå·¥ä½œç«™çš„æ€§èƒ½ã€‚</p><p id="5f2f" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="c065" class="ju jv hi kx b fi lg lh l li lj">docker build -t gcf-cpp-develop -f build_scripts/Dockerfile .<br/>docker build -t gcf-cpp-runtime --target gcf-cpp-runtime -f build_scripts/Dockerfile build_scripts<br/>pack builder create gcf-cpp-builder:bionic --config pack/builder.toml<br/>pack config trusted-builders add gcf-cpp-builder:bionic<br/>pack config default-builder gcf-cpp-builder:bionic</span></pre><h2 id="b563" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jh kf kg kh jl ki kj kk jp kl km kn ko bi translated">åœ¨æœ¬åœ°æ„å»ºDockeræ˜ åƒ</h2><p id="e20a" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">è®¾ç½®å®Œæˆåï¼Œä½¿ç”¨<code class="du ku kv kw kx b">pack</code>å‘½ä»¤ç”¨ä½ çš„å‡½æ•°æ„å»ºä¸€ä¸ªDockeré•œåƒ:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="f648" class="ju jv hi kx b fi lg lh l li lj">pack build \<br/>  --builder gcf-cpp-builder:bionic \<br/>  --env FUNCTION_SIGNATURE_TYPE=http \<br/>  --env TARGET_FUNCTION=hello_world_http \<br/>  --path examples/site/hello_world_http \<br/>  gcf-cpp-hello-world-http</span></pre><p id="4e91" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å“åº”:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="cfb6" class="ju jv hi kx b fi lg lh l li lj">Successfully built image gcf-cpp-hello-world-http</span></pre><h1 id="e608" class="lt jv hi bd jw lu lv lw ka lx ly lz ke ma mb mc kh md me mf kk mg mh mi kn mj bi translated">(å¯é€‰)åœ¨æœ¬åœ°æµ‹è¯•å®¹å™¨</h1><p id="7207" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">å¯é€‰åœ°ï¼Œæ‚¨å¯ä»¥åœ¨<code class="du ku kv kw kx b">localhost</code>æµ‹è¯•æ‚¨åˆšåˆšåˆ›å»ºçš„Dockerå®¹å™¨ã€‚è¿è¡Œæˆ‘ä»¬åˆšåˆšæ„å»ºçš„å®¹å™¨æ˜ åƒ:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="3c53" class="ju jv hi kx b fi lg lh l li lj">ID=$(docker run --detach --rm -p 8080:8080 gcf-cpp-hello-world-http)</span></pre><p id="eb09" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">ç„¶åå‘æ‚¨çš„å®¹å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="2298" class="ju jv hi kx b fi lg lh l li lj">curl <a class="ae iu" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank">http://localhost:8080</a><br/># Output: Hello, World!</span></pre><p id="1833" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">ä¸é”™ï¼å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¸…ç†å®¹å™¨:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="e193" class="ju jv hi kx b fi lg lh l li lj">docker kill "${ID}"</span></pre><h1 id="9923" class="lt jv hi bd jw lu lv lw ka lx ly lz ke ma mb mc kh md me mf kk mg mh mi kn mj bi translated">éƒ¨ç½²åˆ°äº‘è¿è¡Œ</h1><p id="73c5" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">è¦éƒ¨ç½²åˆ°Cloud Runï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ„å»ºå®¹å™¨å¹¶å°†å…¶æ¨é€åˆ°Google Container Registryã€‚</p><p id="946b" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»ºæ˜ åƒå¹¶æ¨é€åˆ°å®¹å™¨æ³¨å†Œè¡¨:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="73ac" class="ju jv hi kx b fi lg lh l li lj">GOOGLE_CLOUD_PROJECT=$(gcloud config get-value project)<br/>pack build \<br/>  --builder gcf-cpp-builder:bionic \<br/>  --env FUNCTION_SIGNATURE_TYPE=http \<br/>  --env TARGET_FUNCTION=hello_world_http \<br/>  --path examples/site/hello_world_http \<br/>"gcr.io/$GOOGLE_CLOUD_PROJECT/gcf-cpp-hello-world-http"</span></pre><p id="a7e7" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">ç„¶åï¼Œéƒ¨ç½²åˆ°äº‘è¿è¡Œï¼Œä½¿ç”¨ç›¸åŒçš„<code class="du ku kv kw kx b">gcr.io</code> URL:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="f335" class="ju jv hi kx b fi lg lh l li lj">gcloud run deploy gcf-cpp-hello-world-http \<br/>    --project="${GOOGLE_CLOUD_PROJECT}" \<br/>    --image="gcr.io/${GOOGLE_CLOUD_PROJECT}/gcf-cpp-hello-world-http:latest" \<br/>    --region="us-central1" \<br/>    --platform="managed" \<br/>    --allow-unauthenticated</span></pre><p id="6ad2" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">è·å–å…¬å…±è¿è¡ŒæœåŠ¡çš„URLï¼Œå¹¶é€šè¿‡<code class="du ku kv kw kx b">cURL</code>å‘é€è¯·æ±‚:</p><pre class="ky kz la lb fd lc kx ld le aw lf bi"><span id="1d49" class="ju jv hi kx b fi lg lh l li lj">HTTP_SERVICE_URL=$(gcloud run services describe \<br/>    --project="${GOOGLE_CLOUD_PROJECT}" \<br/>    --platform="managed" \<br/>    --region="us-central1" \<br/>    --format="value(status.url)" \<br/>    gcf-cpp-hello-world-http)</span><span id="c896" class="ju jv hi kx b fi mk lh l li lj">curl -H "Authorization: Bearer $(gcloud auth print-identity-token)" "${HTTP_SERVICE_URL}"</span></pre><p id="3709" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¾“å‡º<code class="du ku kv kw kx b">Hello World!</code>ã€‚</p><p id="7b70" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">æ­å–œä½ ï¼Œä½ ç»™è°·æ­Œäº‘éƒ¨ç½²äº†ä¸€ä¸ªC++å‡½æ•°ï¼ğŸ‰</p><h1 id="555b" class="lt jv hi bd jw lu lv lw ka lx ly lz ke ma mb mc kh md me mf kk mg mh mi kn mj bi translated">æ„Ÿè°¢é˜…è¯»ï¼</h1><p id="bc3c" class="pw-post-body-paragraph iw ix hi iy b iz kp jb jc jd kq jf jg jh kr jj jk jl ks jn jo jp kt jr js jt hb bi translated">å¦‚æœä½ è®¤ä¸ºè¿™ä¸ªé¡¹ç›®å¾ˆæœ‰è¶£ï¼Œåœ¨<a class="ae iu" href="https://github.com/GoogleCloudPlatform/functions-framework-cpp" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šç»™å®ƒæ‰“ä¸ªæ˜Ÿï¼Œå¹¶æŸ¥çœ‹å¤§é‡çš„<a class="ae iu" href="https://github.com/GoogleCloudPlatform/functions-framework-cpp/tree/main/examples" rel="noopener ugc nofollow" target="_blank">ç¤ºä¾‹å’Œæ–‡æ¡£</a>ã€‚</p></div></div>    
</body>
</html>