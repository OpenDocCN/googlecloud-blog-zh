<html>
<head>
<title>Hot Disaster recovery on Google Cloud for applications running on-premises</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Cloud上为内部运行的应用程序进行热灾难恢复</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/hot-disaster-recovery-on-google-cloud-for-applications-running-on-premises-da7048d1a57b?source=collection_archive---------1-----------------------#2019-11-12">https://medium.com/google-cloud/hot-disaster-recovery-on-google-cloud-for-applications-running-on-premises-da7048d1a57b?source=collection_archive---------1-----------------------#2019-11-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ff1c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在云中烹饪</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/ce0b1e6690be0076b23d1f5a18e0ffb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y_OddLw8vfrJKek3"/></div></div></figure><h1 id="f1ce" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">介绍</h1><p id="f7f6" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj"> <em class="kx">【在云端做饭】</em> </strong>是一个博客和视频系列，帮助企业和开发者在Google Cloud上构建商业解决方案。在这第二个迷你系列中，我将介绍Google Cloud上的灾难恢复。当你在网上的时候，灾难是很难处理的。在这一系列的博客中，我们将详细阐述如何应对地震、停电、洪水、火灾等灾害。如果你对之前的迷你系列感兴趣，请查看<a class="ae ky" rel="noopener" href="/google-cloud/hosting-web-applications-on-google-cloud-an-overview-46f5605eb3a6">的这个</a>。</p><p id="bf9c" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">这是这个系列的计划。</p><ol class=""><li id="e8df" class="le lf hi kd b ke kz kh la kk lg ko lh ks li kw lj lk ll lm bi translated"><a class="ae ky" rel="noopener" href="/google-cloud/hosting-web-applications-on-google-cloud-an-overview-87d0962931a3">灾难恢复概述</a></li><li id="c793" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated"><a class="ae ky" rel="noopener" href="/@pvergadia/cold-disaster-recovery-on-google-cloud-for-applications-running-on-premises-114b31933d02">基于Google Cloud的本地应用冷灾难恢复</a></li><li id="7d51" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated"><a class="ae ky" rel="noopener" href="/google-cloud/warm-disaster-recovery-on-google-cloud-for-applications-running-on-premises-7428b0f7db72">在Google Cloud上为本地应用程序提供热灾难恢复</a></li><li id="dc6c" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">针对本地应用程序的Google Cloud热灾难恢复(本文)</li><li id="a1a5" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">Google云中应用程序的冷灾难恢复</li><li id="941f" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">Google云中应用程序的热灾难恢复</li><li id="e106" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">Google云中应用程序的热灾难恢复</li><li id="9dcd" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">Google Cloud上的数据灾难恢复:第1部分</li><li id="6afe" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lj lk ll lm bi translated">Google Cloud上的数据灾难恢复:第2部分</li></ol><p id="847a" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">在本文中，您将学习为部署在本地的应用程序设置一个<strong class="kd hj">热灾难恢复模式</strong>。所以，继续读下去吧！</p><h1 id="5d96" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">你会学到什么</h1><ul class=""><li id="a894" class="le lf hi kd b ke kf kh ki kk ls ko lt ks lu kw lv lk ll lm bi translated">热灾难恢复模式及示例</li><li id="cf4d" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">灾难来袭前需要采取的步骤</li><li id="d44f" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">灾难发生时需要采取的步骤</li><li id="dbdd" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">灾难发生后需要采取的步骤</li></ul><h1 id="1475" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">先决条件</h1><ul class=""><li id="8b04" class="le lf hi kd b ke kf kh ki kk ls ko lt ks lu kw lv lk ll lm bi translated">谷歌云的基本概念和结构，这样你就可以识别产品的名称。</li><li id="68c3" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">继续之前，请阅读<a class="ae ky" rel="noopener" href="/google-cloud/hosting-web-applications-on-google-cloud-an-overview-87d0962931a3">概述文章</a>。</li></ul><h1 id="3581" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">看看这个视频</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lw lx l"/></div></figure><h1 id="3767" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">让我们通过一个例子来学习Warm DR模式</h1><p id="9938" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在前两篇文章中，我们讨论了在内部运行应用程序并在Google Cloud上构建灾难恢复基础架构的Mane-street Art。我们看到，由于需要更低的RTO和RPO值，他们从冷灾难恢复计划开始，并转移到热备用。</p><p id="0a1d" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">现在，<strong class="kd hj">街头艺术</strong>已经变得非常受欢迎，在<strong class="kd hj">甚至</strong>秒都不能停下来。由于他们的要求是实现接近零的RTO和RPO值，唯一的方法是跨生产环境和google云同时运行HA架构。</p><p id="7c37" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated"><em class="kx">注意:如果您不熟悉这里使用的术语(RTO、RPO、灾难恢复模式),请查看之前的博客以获得概述。</em></p><p id="6efc" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">在任何灾难恢复模式中，您都需要了解在灾难发生前需要采取什么步骤，灾难发生时会发生什么，以及灾难过去后需要发生什么。</p><h1 id="2b72" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">热灾难恢复模式—它是如何工作的？</h1><h2 id="0529" class="ly jk hi bd jl lz ma mb jp mc md me jt kk mf mg jv ko mh mi jx ks mj mk jz ml bi translated">灾难来袭前应采取的步骤</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/7bae44b92a68aab12c2e559858dc7a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Jdhhb9nkBq5NHW1OLf2SYQ.gif"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">灾难降临前需要采取的措施</figcaption></figure><ul class=""><li id="3fad" class="le lf hi kd b ke kz kh la kk lg ko lh ks li kw lv lk ll lm bi translated">创建一个VPC网络</li><li id="bf59" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">配置内部网络和Google Cloud网络之间的连接</li><li id="9461" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">使用与内部完全相同的配置在google cloud中创建服务器的自定义映像。</li><li id="227a" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">在我们的内部数据库服务器和Google cloud上的服务器之间配置复制。请记住，如果您的数据库系统在配置复制时只允许单个可写数据库实例，那么您可能需要确保其中一个数据库副本充当只读服务器。</li><li id="be20" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">创建单独的实例模板，这些模板使用应用服务器和web服务器的映像。</li><li id="6608" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">为应用程序和web服务器配置区域托管实例组。</li><li id="e0fd" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">使用stackdriver监控配置运行状况检查。</li><li id="24a5" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">使用我们配置的区域托管实例组来配置负载平衡。</li><li id="f96b" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">配置一个计划任务来创建持久磁盘的常规快照。</li><li id="78ca" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">最后，配置一个DNS服务，在您的内部环境和GCP环境之间分配流量。</li></ul><p id="dce0" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">使用这种混合方法，您需要使用一个支持加权路由到两个生产环境的DNS服务，这样您就可以从两个环境中为相同的应用程序提供服务。</p><h2 id="0179" class="ly jk hi bd jl lz ma mb jp mc md me jt kk mf mg jv ko mh mi jx ks mj mk jz ml bi translated">灾难来袭时应采取的措施</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/c82a859765c90fd7bdb3983f26caa29e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*05DKcCVt5oi232zD"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">灾难来袭时应采取的措施</figcaption></figure><p id="839d" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">如果本地发生故障，您只需禁用到本地web服务器的DNS路由即可！在大多数情况下，DNS服务支持健康检查，并将所有流量自动路由到Google Cloud上的健康服务器。</p><h2 id="4bf5" class="ly jk hi bd jl lz ma mb jp mc md me jt kk mf mg jv ko mh mi jx ks mj mk jz ml bi translated">灾难过去后应采取的步骤</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/81601dc9188603bad8d6bb9c9214827f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XSN7zoqyOjRfxeDq"/></div></div><figcaption class="mn mo et er es mp mq bd b be z dx translated">灾难来袭时应采取的措施</figcaption></figure><p id="bfff" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lb km kn ko lc kq kr ks ld ku kv kw hb bi translated">当生产环境再次在内部运行并能够支持生产工作负载时，Mane-street art必须做到以下几点:</p><ul class=""><li id="ca32" class="le lf hi kd b ke kz kh la kk lg ko lh ks li kw lv lk ll lm bi translated">重新同步数据库。</li><li id="6398" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">如果数据库系统在出现故障时没有自动将只读复制副本提升为可写主副本，您需要干预以确保复制副本得到提升。</li><li id="fb82" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">在确保这一点后，只需启用DNS路由，将流量分发到内部和Google cloud。</li></ul><h1 id="5507" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">结论</h1><p id="4822" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">如果您正在本地运行您的应用程序，并且希望实现非常小的RTO和RPO值，那么希望您已经了解了如何在两种环境中使用Google Cloud hot HA从故障中恢复环境。敬请关注即将发布的文章，在这些文章中，您将了解如何建立更多对您的业务有意义的灾难恢复模式。</p><h1 id="0279" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">后续步骤</h1><ul class=""><li id="9112" class="le lf hi kd b ke kf kh ki kk ls ko lt ks lu kw lv lk ll lm bi translated">在<a class="ae ky" href="https://medium.com/google-cloud" rel="noopener">谷歌云平台媒体</a>上关注这个博客系列。</li><li id="f136" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">参考<a class="ae ky" href="https://cloud.google.com/solutions/dr-scenarios-planning-guide" rel="noopener ugc nofollow" target="_blank">灾难恢复解决方案</a>。</li><li id="2f44" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">关注<a class="ae ky" href="https://www.youtube.com/watch?v=pxp7uYUjH_M" rel="noopener ugc nofollow" target="_blank">获取云端烹饪</a>视频系列，订阅谷歌云平台YouTube频道</li><li id="bc2b" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">想要更多的故事？查看我的<a class="ae ky" rel="noopener" href="/@pvergadia/">媒体</a>，<a class="ae ky" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">在twitter上关注我</a>。</li><li id="c971" class="le lf hi kd b ke ln kh lo kk lp ko lq ks lr kw lv lk ll lm bi translated">请和我们一起欣赏这部迷你剧，并了解更多类似的谷歌云解决方案:)</li></ul></div></div>    
</body>
</html>