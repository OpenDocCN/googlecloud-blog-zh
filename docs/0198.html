<html>
<head>
<title>Apache Cassandra Clusters on Google Cloud (GCE)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云(GCE)上的Apache Cassandra集群</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/apache-cassandra-clusters-on-google-cloud-gce-78c040b66e73?source=collection_archive---------1-----------------------#2017-01-28">https://medium.com/google-cloud/apache-cassandra-clusters-on-google-cloud-gce-78c040b66e73?source=collection_archive---------1-----------------------#2017-01-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e822" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当谈到1click安装广泛的解决方案时(不仅是Apache Cassandra，还有其他关系和非关系数据库、应用服务器、设备等等)，每个主要的云平台(AWS、Azure和GCE)都有预构建的解决方案。我还没有看到(所以我不能谈论)AWS和Azure的模板，但是对于GCE，你有一个模板来启动单节点或3节点集群。据我所知，在这两种情况下，您都不能选择机器的大小，也不能添加额外的节点(更不用说，例如，您将最终使用标准的‘Test Cluster’集群名称)。所以我花时间整理了几个可以运行的脚本，这些脚本有助于用所需的VM配置和一些配置更改来设置Apache Cassandra集群。所有的脚本都在<a class="ae jd" href="http://git.academyofdata.com" rel="noopener ugc nofollow" target="_blank">我们的git</a>T2这里。不仅如此，你还会得到一个<a class="ae jd" href="https://github.com/academyofdata/cassandra-cluster/blob/master/cluster-setup.sh" rel="noopener ugc nofollow" target="_blank">脚本来启动GCE </a>上的Cassandra集群，但是运行在docker容器中(都在同一台机器上)。但是让我们简单地看一下在单个GCE虚拟机上启动Cassandra集群的脚本/命令。需要注意的是，与GCE的交互是使用gcloud utility完成的。</p><ol class=""><li id="6f42" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">gcloud-server-setup.sh</li></ol><p id="cbfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个脚本启动第一个(其他节点的种子)节点。</p><p id="cf6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它首先使用一些可编辑的变量创建一台机器(节点代表机器名称，区域代表部署区域，项目代表项目Id，机器代表虚拟机类型——我在这里使用了g1-small，但是可以随意选择其他类型)</p><pre class="jn jo jp jq fd jr js jt ju aw jv bi"><span id="064b" class="jw jx hi js b fi jy jz l ka kb">gcloud compute instances create $NODE --zone $ZONE --machine-type $MACHINE --network "default" --maintenance-policy "MIGRATE" --scopes …… --image "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/family/ubuntu-1604-lts" --boot-disk-size "10" --boot-disk-type "pd-standard" --boot-disk-device-name "${NODE}disk1" --project $PROJECT</span></pre><p id="d1a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建机器后，我们使用gcloud实用程序ssh命令连接到机器，并执行“标准”Apache Cassandra安装和配置步骤——所有这些都取自git <a class="ae jd" href="https://github.com/academyofdata/cassandra-cluster/blob/master/setup39.sh" rel="noopener ugc nofollow" target="_blank">上的另一个脚本，这里是</a>(注意，这个特定的脚本安装Cassandra 3.9)。安装Cassandra后，我们使用另一个脚本(来自这里的<a class="ae jd" href="https://github.com/academyofdata/cassandra-cluster/blob/master/config-cassandra.sh" rel="noopener ugc nofollow" target="_blank"/>)进行最小配置:更改集群名称，更改listen和rpc_address(以便它使用GCE内部网络而不是127.0.0.1 ),甚至为ssh用户/pass登录添加一个新用户(在这种情况下，我们还需要在SSH中启用密码登录——详细信息请参见脚本)</p><p id="57e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.gcloud-add-replicas.sh</p><p id="d581" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当第一个节点启动并运行时，可以使用该脚本向集群添加一个或多个节点。它主要执行与初始节点设置相同的任务，只是做了一些调整(它希望种子节点IP知道从哪里引导数据)。第二个脚本很可能包含在第一个脚本中(只需增加几个测试，并在某些情况下执行稍微不同的命令)</p><p id="0a23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，这不是一次点击安装(对于一个3节点集群，在CLI中可能只需执行3行代码)，但它提供了更大的灵活性</p></div></div>    
</body>
</html>