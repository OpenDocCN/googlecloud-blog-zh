<html>
<head>
<title>Build a blog application on Google App Engine: Setup (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google App Engine上构建一个博客应用程序:设置(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/build-a-blog-application-on-google-app-engine-setup-part-1-38dab981b779?source=collection_archive---------1-----------------------#2018-11-27">https://medium.com/google-cloud/build-a-blog-application-on-google-app-engine-setup-part-1-38dab981b779?source=collection_archive---------1-----------------------#2018-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/42f55412b5004f1af404589dbeb0c34e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZn5r98DiYp4-2a7vtPqoQ.jpeg"/></div></div></figure><p id="b360" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">去年6月，谷歌宣布在谷歌应用引擎标准环境上对Node.js 8的<a class="ae jo" href="https://cloudplatform.googleblog.com/2018/06/Now-you-can-deploy-your-Node-js-app-to-App-Engine-standard-environment.html" rel="noopener ugc nofollow" target="_blank">支持。有了它，就有可能构建<strong class="is hj">高度可用的Node.js应用程序，而不必担心底层基础设施</strong>。有了这个好消息，<strong class="is hj">我现在<em class="jp">不得不</em>写这个已经在我的待办清单上放了几个月的教程</strong>！:)</a></p><p id="b358" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个多部分教程中，我们将在 <strong class="is hj"> Typescript </strong>中构建<strong class="is hj">一个博客应用程序，使用<strong class="is hj"> Google Datastore </strong>来存储我们的内容。数据存储是Google <strong class="is hj">完全管理的</strong>文档数据库，具有惊人的性能、巨大的可伸缩性和原子事务。我已经用它做了多个项目，我必须说我喜欢它！</strong></p><p id="c017" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本教程分为以下8个部分:</p><ul class=""><li id="8f73" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated">设置(这一部分)</li><li id="36a3" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><a class="ae jo" rel="noopener" href="/@sebelga/build-a-blog-application-on-google-app-engine-architecture-part-2-1b7fb081bf3c">应用架构</a>(第二部分)</li><li id="0c7f" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><a class="ae jo" rel="noopener" href="/@sebelga/build-a-blog-application-on-google-app-engine-the-app-context-part-3-8a0f15c35166">应用背景</a>(第三部分)</li><li id="3a96" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">博客发布模块(第四部分)</li><li id="d168" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">管理模块(第五部分)</li><li id="7f32" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><a class="ae jo" rel="noopener" href="/@sebelga/build-a-blog-application-on-google-app-engine-image-module-part-6-f5eb3eeb49ee">图像模块</a>(第六部分)</li><li id="a488" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><a class="ae jo" rel="noopener" href="/@sebelga/build-a-blog-application-on-google-app-engine-comment-module-part-7-b18e907e3e38">评论模块</a>(第七部分)</li><li id="feee" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">将应用程序部署到Google Cloud (第8部分)</li></ul><h1 id="2a1e" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">我们将会建造什么</h1><p id="aef2" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">在和我一起开始这段旅程之前，你会想先看看我们将要建造的东西…我不会期望更少！:)你可以在这里找到在谷歌应用引擎上运行的应用程序的现场演示:<br/><a class="ae jo" href="https://blog-nodejs.appspot.com" rel="noopener ugc nofollow" target="_blank">https://blog-nodejs.appspot.com</a></p><h1 id="c103" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">我们的目标</h1><p id="3487" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">本教程结束时，您将能够:</p><ul class=""><li id="058a" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hj">阅读/创建/更新/删除</strong>博客文章。</li><li id="93ea" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">将特色图片附加到帖子上，然后<strong class="is hj">将其上传到Google Storage </strong>。</li><li id="1f5c" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">让用户<strong class="is hj">对帖子</strong>发表评论。</li><li id="f401" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><strong class="is hj">自动</strong>当我们从谷歌数据库中删除一篇文章时，删除与该文章相关的评论和特色图片。</li><li id="1d2b" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><strong class="is hj">将应用程序</strong>部署到Google App Engine。</li></ul><h2 id="4ad1" class="lh kf hi bd kg li lj lk kk ll lm ln ko jb lo lp ks jf lq lr kw jj ls lt la lu bi translated">我们看不到的</h2><p id="466f" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">为了将本教程的重点放在<strong class="is hj"> Node.js和Typescript </strong>上，我将不解释以下内容:</p><ul class=""><li id="2d3c" class="jq jr hi is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hj">客户端javascript代码</strong>(保持最小化以“完成工作”)。</li><li id="286b" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated"><strong class="is hj">萨斯造型</strong>(大部分造型来自伟大的<a class="ae jo" href="https://bulma.io/" rel="noopener ugc nofollow" target="_blank">布尔玛框架</a>)。</li><li id="a1d7" class="jq jr hi is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">用Pug 表达<strong class="is hj">视图模板(不太复杂，但如果有不清楚的地方，可以在评论中随意提问)。</strong></li></ul><h1 id="965f" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">我们开始吧！</h1><h2 id="51d8" class="lh kf hi bd kg li lj lk kk ll lm ln ko jb lo lp ks jf lq lr kw jj ls lt la lu bi translated"><strong class="ak">先决条件:</strong></h2><p id="8940" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated"><strong class="is hj">节点版本8 </strong>:本项目要求节点版本8或更高版本。确保您已经安装了它(您可以通过在终端窗口中运行<code class="du lv lw lx ly b">node -v</code>来检查安装的节点版本)。<br/><strong class="is hj">Google Cloud SDK</strong>(<code class="du lv lw lx ly b">gcloud</code>):如果您还没有安装，请<a class="ae jo" href="https://cloud.google.com/sdk/" rel="noopener ugc nofollow" target="_blank">安装SDK </a>并确保<strong class="is hj">您已经通过身份验证</strong>。要对<code class="du lv lw lx ly b">gcloud</code>进行身份验证，请在终端中运行以下命令:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="0b52" class="lh kf hi ly b fi mh mi l mj mk">gcloud auth application-default login</span></pre><p id="616f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您可以通过以下方式检查您被验证的帐户:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="0d2c" class="lh kf hi ly b fi mh mi l mj mk">gcloud config list</span></pre><h2 id="c78b" class="lh kf hi bd kg li lj lk kk ll lm ln ko jb lo lp ks jf lq lr kw jj ls lt la lu bi translated">获取源代码</h2><p id="4027" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">现在，让我们克隆存储库，检出起始分支，并安装项目依赖项。在终端中运行以下4个命令:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="6626" class="lh kf hi ly b fi mh mi l mj mk">git clone <a class="ae jo" href="https://github.com/sebelga/google-datastore-blog-app" rel="noopener ugc nofollow" target="_blank">https://github.com/sebelga/google-datastore-blog-app</a><br/>cd google-datastore-blog-app<br/>git checkout --track origin/tutorial-start<br/>npm install (or yarn install)</span></pre><p id="a220" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很好，现在您已经安装了项目结构和依赖项。我们将大部分时间花在“<em class="jp"> src/server </em>”文件夹中，在那里我们将放置我们的类型脚本代码。<br/>让我们启动应用程序，确保一切运行正常:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="7f07" class="lh kf hi ly b fi mh mi l mj mk">npm run start-local<br/># or<br/>yarn start-local</span></pre><p id="77b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该命令将<strong class="is hj">编译类型脚本</strong>代码，并开始<strong class="is hj">监视</strong>客户端和服务器代码，如果需要，重新启动节点服务器。<br/>打开浏览器窗口，导航至<a class="ae jo" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>。你应该看到<code class="du lv lw lx ly b">Hello!</code>印在屏幕上。</p><h1 id="0dcf" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">gstore-node</h1><p id="04fb" class="pw-post-body-paragraph iq ir hi is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">您可能知道Google Datastore是一个NoSQL数据库。它是<strong class="is hj">无模式</strong>，意思是它让你保存<strong class="is hj">任何形状</strong>的文档(称为实体)并按实体<em class="jp">种类</em>对它们进行分组。这很好，因为它为我们保存非结构化数据提供了很大的灵活性。但这也意味着你可以有两个相同种类的实体，每个实体都有完全不同的属性。</p><p id="5c49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这对于构建复杂的应用程序来说并不太好，因为那些<strong class="is hj">在它们管理的实体上总是有一个<em class="jp">隐式</em>模式</strong>。也就是说，在针对NoSQL数据库构建应用程序时，没有所谓的<em class="jp">无模式</em>;当您从数据库中检索一个"<em class="jp"> BlogPost </em>"实体时，应用程序<strong class="is hj">希望它总是有一个" title" <em class="jp"> </em>属性被转换成一个字符串</strong>。这就是<em class="jp">模式</em>给我们的东西，<strong class="is hj">保证我们的实体<em class="jp">形状</em>总是一致的</strong>。这就是为什么在构建像Google Datastore这样的NoSQL数据库的应用程序时，它们会有如此大的帮助。</p><p id="dbc2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用于管理数据存储实体的官方google-cloud/datastore包没有为<strong class="is hj">提供通过模式</strong>对实体建模的方法。这就是我创建<a class="ae jo" href="https://github.com/sebelga/gstore-node" rel="noopener ugc nofollow" target="_blank"> gstore-node </a>的原因。它<strong class="is hj">不会</strong> <strong class="is hj">取代</strong>谷歌数据存储库，但它是<strong class="is hj">之上的一层</strong>。这意味着Google datastore API仍然可用，以备不时之需。</p><p id="3cbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你会在这里找到gstore-node的完整文档。</p><p id="8c1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如您所想象的，我们将使用<code class="du lv lw lx ly b">gstore-node</code>来创建我们的博客应用程序，并且希望在使用数据存储构建Node.js应用程序时，您会看到它的好处。</p><p id="5252" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">说完这些，<a class="ae jo" rel="noopener" href="/@sebelga/build-a-blog-application-on-google-app-engine-architecture-part-2-1b7fb081bf3c">让我们跳到下一节</a>，在这里我们将讨论<strong class="is hj">应用架构</strong>，不同的<strong class="is hj">模块</strong>，以及应用配置<strong class="is hj"/>。</p></div></div>    
</body>
</html>