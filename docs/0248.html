<html>
<head>
<title>Building your first Action for Google Home (in 30 minutes)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为Google Home构建您的第一个行动(30分钟内)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/building-your-first-action-for-google-home-in-30-minutes-ec6c65b7bd32?source=collection_archive---------0-----------------------#2017-04-05">https://medium.com/google-cloud/building-your-first-action-for-google-home-in-30-minutes-ec6c65b7bd32?source=collection_archive---------0-----------------------#2017-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="f060" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">谷歌系列开发行动概述</h1><p id="c14f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是我将撰写的一系列文章中的第一篇，我们将学习如何在Google上开发和部署动作。动作支持Google Home和Google Assistant，并允许用户通过语音或文本与您的应用程序进行交互。我们的目标是让这个过程对任何水平的开发者来说都变得有趣和简单。动作目前可以在谷歌Home设备上使用，也可以在谷歌Pixel手机上的谷歌助手应用中使用。本教程将重点介绍语音界面。</p><p id="de9d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们将开发一个简单的随机房间生成器，称为三门。如果你想现在就与它互动，并且你的谷歌之家就在附近，只需说，“<strong class="jf hj">嘿，谷歌，我想与疯狂之家</strong>通话”。</p><p id="816e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在这第一篇文章中，目标是让您在尽可能短的时间内启动并运行，以便您可以在测试模式下运行您的操作。在未来的文章中，我们将更深入地研究代码，学习如何测试和部署您的操作，并使用API.ai等其他工具。如果您对未来的文章有任何问题或建议，请在twitter上联系我<a class="ae kg" href="https://twitter.com/eisenzopf" rel="noopener ugc nofollow" target="_blank"> @eisenzopf </a>。现在，时间紧迫，让我们开始吧。</p><blockquote class="kh ki kj"><p id="2406" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注意:在本文中，我们将使用</em> <code class="du ko kp kq kr b"><em class="hi">gaction</em></code> <em class="hi">命令行界面(CLI ),因为它更快且可脚本化。本文中使用CLI的每个操作在Google控制台中都有相应的对等物。</em></p></blockquote><h1 id="d689" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">先决条件</h1><p id="e3f1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">首先，我假设你有一些基本的技术技能，可以在Linux或OS X上工作。</p><p id="2501" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">要做到这一点，你只需要:</p><ul class=""><li id="7a32" class="ks kt hi jf b jg kb jk kc jo ku js kv jw kw ka kx ky kz la bi translated">谷歌家庭设备</li><li id="4796" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">带有Bash、curl、Node.js、git和npm(与Node.js捆绑在一起)的Linux/Unix/OS X</li><li id="dda5" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">Python 2.7或更高版本</li><li id="2a59" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">Java 1.7或更高版本</li><li id="ee6d" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">Google Gmail帐户(推荐但非必需)</li></ul><blockquote class="kh ki kj"><p id="6bd5" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">如果你没有Google Home设备和/或Node.js，请看下面的参考部分。如果您运行的是Windows 10，请参见下面的参考资料部分，了解如何在您的系统上安装Bash和curl。Windows 10用户注意:在本教程中看到</em> <code class="du ko kp kq kr b"><em class="hi">sudo</em></code> <em class="hi">时，请随时删除，因为不需要。</em></p><p id="8bed" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:一旦你看完这篇文章，你的第一站应该是我的好朋友Nandini Stocker的</em> <a class="ae kg" href="https://developers.google.com/actions/design/checklist" rel="noopener ugc nofollow" target="_blank"> <em class="hi">设计清单</em> </a> <em class="hi">，他是业界最好的语音用户界面(VUI)设计师之一。您必须遵循设计指南，以便您的谷歌行动获得批准。我们将在以后的文章中详细讨论如何部署您的应用程序。</em></p></blockquote><h1 id="d347" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">谷歌行动如何工作</h1><p id="d5c1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">不用说得太详细，Google Home设备的工作方式是，它在Google Action平台上捕捉你的语音意图，并将其转换为文本。</p><figure class="lh li lj lk fd ll er es paragraph-image"><div class="er es lg"><img src="../Images/af45f63c86ea478e6ded9d4886998048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*9S_2J4Wxk6EaQgxbbq01fg.png"/></div></figure><ol class=""><li id="a21e" class="ks kt hi jf b jg kb jk kc jo ku js kv jw kw ka lo ky kz la bi translated">Google Action Platform试图将意图与目录中的动作进行匹配，然后与动作端点进行匹配。作为一名开发人员，当你准备部署一个动作时，有一个谷歌注册过程，你可以在那里注册你的动作意图名称，比如<strong class="jf hj">三门</strong>。然后，Google Action Platform知道将请求发送给什么动作。注册后，Google Action Platform通过HTTP POST请求向您的服务器端应用程序发出请求，并通过JSON文档发送用户的输入。</li><li id="8d1a" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka lo ky kz la bi translated">您的应用程序对Node.js或其他服务器端应用程序中的用户输入进行解码，并发回一个JSON响应，该响应将向用户播放内容或请求输入。在上面的例子中，我们提示用户选择一扇门。</li><li id="e639" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka lo ky kz la bi translated">用户说<strong class="jf hj">三个</strong>，它们被发送到Google，被翻译成文本，然后被发送到服务器端应用程序，服务器端应用程序接收输入并用另一个JSON文档进行响应，这可能是下一个选择或结束对话。</li></ol><h1 id="5ace" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为代码创建一个目录</h1><p id="314a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">放在哪里并不重要，我知道这是显而易见的，但首先要为我们的代码创建一个新目录:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="a13d" class="lt ig hi kr b fi lu lv l lw lx">mkdir three-doors<br/>cd three-doors</span></pre><h1 id="9632" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">从GitHub克隆三门</h1><p id="d389" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在您可以从GitHub克隆本教程的代码:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="2fbc" class="lt ig hi kr b fi lu lv l lw lx">git clone https://github.com/eisenzopf/google-action-three-doors.git<br/>cd google-action-three-doors</span></pre><p id="2147" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">关键的源代码文件是:</p><p id="0555" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">action.json.bak、index.js、package.json以及json/目录中的文件</p><h1 id="c29f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">安装Node.js包</h1><p id="ed70" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">下次运行:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="f422" class="lt ig hi kr b fi lu lv l lw lx">npm install</span></pre><p id="65ac" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这将安装项目所需的所有Node.js包依赖项。</p><h1 id="7734" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">设置你的谷歌行动技能</h1><p id="ed26" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在我们有了一个应用程序环境设置，我们可以设置我们的环境来创建一个Google技能。</p><h1 id="6db3" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">Google云设置</h1><p id="b742" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果您已经有一个带付费设置的Google cloud帐户，您可以跳过这一步。否则，您需要访问https://cloud.google.com/<a class="ae kg" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">并创建一个新账户。你可以免费建立一个试用账户，在撰写本文时，谷歌提供300美元的信用额度，可以使用12个月以上。简单。</a></p><p id="7e22" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">一旦你完成设置，系统会将你带入<a class="ae kg" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>。</p><h1 id="592c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">安装gcloud CLI并创建一个新的Google行动计划</h1><p id="febc" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在您已经有了一个Google Cloud帐户，我们将在本地机器上安装名为<code class="du ko kp kq kr b">gcloud</code>的Google Cloud CLI，并使用它来创建一个新的Google Action项目。</p><p id="1bbb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 1。</strong>要安装gcloud CLI，首先要安装Google Cloud SDK。有几种不同的安装选项，都记录在<a class="ae kg" href="https://cloud.google.com/sdk/downloads" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/sdk/downloads</a>中。最简单的方法是运行以下命令:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="9049" class="lt ig hi kr b fi lu lv l lw lx">curl https://sdk.cloud.google.com | bash<br/>exec -l $SHELL<br/>gcloud init</span></pre><p id="e22a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">你会被问一些简单明了的问题，一旦完成，<code class="du ko kp kq kr b">gcloud</code>就可以开始了。</p><p id="51bc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 2。</strong>现在，我们将在项目目录的终端窗口中使用<code class="du ko kp kq kr b">gcloud</code> CLI创建一个新的Google行动项目。运行:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="7533" class="lt ig hi kr b fi lu lv l lw lx">gcloud alpha projects create three-doors-xxxx</span></pre><blockquote class="kh ki kj"><p id="ed8d" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:用你选择的四个随机数替换</em> <code class="du ko kp kq kr b"><em class="hi">xxxx</em></code> <em class="hi">。</em></p></blockquote><p id="b3ab" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这将在您的Google Cloud帐户中创建一个新项目。这是一个字母命令，可能会改变。您也可以在<a class="ae kg" href="https://console.cloud.google.com" rel="noopener ugc nofollow" target="_blank">谷歌云控制台GUI </a>中创建一个新项目。</p><p id="6e50" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 3。</strong>要确认项目已创建，运行:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="9d1d" class="lt ig hi kr b fi lu lv l lw lx">gcloud projects list</span></pre><p id="40e9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">除了运行<code class="du ko kp kq kr b">cloud init</code>命令时创建的默认项目之外，您还应该在列表中看到新创建的项目。</p><p id="540f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 4。</strong>运行以下命令，将当前项目更改为已创建的项目:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="57d2" class="lt ig hi kr b fi lu lv l lw lx">gcloud config set project three-doors-xxxx</span></pre><blockquote class="kh ki kj"><p id="78b1" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:用你上面选择的四个数字替换</em> <code class="du ko kp kq kr b"><em class="hi">xxxx</em></code> <em class="hi">。</em></p></blockquote><p id="8dec" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 5。</strong>为项目设置计费。请访问，确保计费帐户与项目相关联</p><p id="d195" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><code class="du ko kp kq kr b">https://console.developers.google.com/project/three-doors-xxxx/settings</code>其中xxxx是您在创建项目时选择的4个数字。</p><p id="d0ab" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">6。接下来，我们需要将Google Action API添加到项目中。这可以在https://console.cloud.google.com<a class="ae kg" href="https://console.cloud.google.com" rel="noopener ugc nofollow" target="_blank">的谷歌云平台控制台上完成。</a></p><ul class=""><li id="635a" class="ks kt hi jf b jg kb jk kc jo ku js kv jw kw ka kx ky kz la bi translated">在控制台上，在页面的左上角，Google Cloud Platform徽标的右侧，您会看到两个下拉菜单。点击第二个，可能会说<em class="kk">我的第一个项目</em></li><li id="8835" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">选择标签为<strong class="jf hj">的选项查看更多项目</strong>。</li><li id="be85" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">从<code class="du ko kp kq kr b">gcloud</code> CLI (three-doors-xxxx)中选择您刚刚创建的项目，并点击<strong class="jf hj">打开</strong>按钮。</li><li id="5f78" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">在页面中间，单击标记为<strong class="jf hj">的链接，转到API概述</strong>。</li><li id="1350" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">该页面向您展示了哪些Google APIs已经启用，但是我们需要添加一个，因此单击页面顶部中间附近的<strong class="jf hj"> +ENABLE API </strong>链接。</li><li id="5791" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">在搜索框中，键入<em class="kk"> Action </em>，您应该会看到<strong class="jf hj"> Google Actions API </strong>。点击它。</li><li id="89bf" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">在新页面的顶部中间，点击<strong class="jf hj">启用</strong>。</li><li id="6fc2" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">回到搜索框，输入<em class="kk"> Function </em>，你应该会看到<strong class="jf hj">Google Cloud Functions API</strong>。点击它。</li><li id="504e" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">在新页面的顶部中间，点击<strong class="jf hj">启用</strong>。</li></ul><p id="3e8a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Google Actions API和Functions API现在可以在Google Cloud环境中为您的新项目启用了。</p><p id="4f27" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 7。</strong>最后，创建一个Google云存储桶来存储您的Google功能:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="4438" class="lt ig hi kr b fi lu lv l lw lx">gsutil mb gs://three-doors-xxxx</span></pre><blockquote class="kh ki kj"><p id="1eeb" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:将</em> <code class="du ko kp kq kr b"><em class="hi">xxxx</em></code> <em class="hi">替换为您上面选择的四个数字。</em></p></blockquote><p id="7cf0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这将提供一个新的存储桶来在Google Cloud上托管您的代码。您应该能够通过运行命令<code class="du ko kp kq kr b">gsutil ls</code>看到新创建的bucket</p><h1 id="6ad0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">安装并初始化操作CLI</h1><p id="0adb" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在是建立<code class="du ko kp kq kr b">gaction</code>环境的时候了。这是一个命令行工具，您将从部署您的<code class="du ko kp kq kr b">action.json</code>文件的终端运行。这是一个文件，一旦被谷歌发布和批准，就可以让Android或iOS上的<strong class="jf hj"> Google Home </strong>或<strong class="jf hj"> Allo </strong>等支持<strong class="jf hj">谷歌助手</strong>的设备访问你的<strong class="jf hj">谷歌动作</strong>应用。</p><p id="e354" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 1。</strong>首先将你的浏览器指向<a class="ae kg" href="https://developers.google.com/actions/tools/gactions-cli" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/actions/tools/gactions-cli</a>并下载gactions命令行工具。</p><blockquote class="kh ki kj"><p id="71a9" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">快捷方式从终端窗口，在你的项目目录下，你可以使用</em> <code class="du ko kp kq kr b"><em class="hi">curl</em></code> <em class="hi">直接下载。</em></p><p id="4ecd" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">在Linux上:</em></p><p id="aebc" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><code class="du ko kp kq kr b"><em class="hi">curl -O </em><a class="ae kg" href="https://dl.google.com/gactions/updates/bin/linux/amd64/gactions/gactions" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://dl.google.com/gactions/updates/bin/linux/amd64/gactions/gactions</em></a></code></p><p id="05e2" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">在Mac OS X上:</em></p><p id="6650" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><code class="du ko kp kq kr b"><em class="hi">curl -O </em><a class="ae kg" href="https://dl.google.com/gactions/updates/bin/darwin/amd64/gactions/gactions" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://dl.google.com/gactions/updates/bin/darwin/amd64/gactions/gactions</em></a></code></p></blockquote><p id="accd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 2。</strong>接下来将操作权限更改为可执行:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="2aab" class="lt ig hi kr b fi lu lv l lw lx">chmod +x gactions</span></pre><p id="b936" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 3。</strong>在您的项目目录中，初始化终端窗口中的工具:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="2141" class="lt ig hi kr b fi lu lv l lw lx">./gactions init</span></pre><p id="53ea" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这将在您的项目目录中创建一个默认的<code class="du ko kp kq kr b">action.json</code>文件。现在我们需要编辑它。</p><h1 id="9973" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">编辑action.json</h1><p id="0dad" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在你最喜欢的编辑器中打开<code class="du ko kp kq kr b">action.json</code>。</p><p id="c0d7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">将<strong class="jf hj">版本表</strong>更改为1.0，并将<strong class="jf hj">项目Id </strong>更改为three-doors-xxxx(替换为您在使用<code class="du ko kp kq kr b">gcloud</code> CLI创建项目时使用的项目Id)</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="9f92" class="lt ig hi kr b fi lu lv l lw lx">{<br/>  "versionLabel": "1.0",<br/>  "agentInfo": {<br/>    "languageCode": "en-US",<br/>    "projectId": "three-doors-xxxx",<br/>    "voiceName": "male_1"<br/>  },</span></pre><p id="8cbc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">编辑后，它应该看起来像上面这样。</p><p id="258b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">接下来我们将编辑<code class="du ko kp kq kr b">action.json</code>文件的<strong class="jf hj">动作</strong>部分，它包含了应用程序将识别的可能想法列表。每个谷歌助手<code class="du ko kp kq kr b">action.json</code>都会有一个<code class="du ko kp kq kr b">initialTrigger</code>部分。这是最先调用的动作，所以也是最重要的一个动作。</p><p id="fa5a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在这个用<code class="du ko kp kq kr b">actions init</code>命令创建的初始<code class="du ko kp kq kr b">action.json</code>文件中，有两个<code class="du ko kp kq kr b">initialTrigger</code>部分。这是因为可以通过多种方式调用应用程序。在我们的第一个应用程序中，我们不会担心这个问题，所以删除第二个<code class="du ko kp kq kr b">initialTrigger</code>部分。</p><p id="cdad" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们的<code class="du ko kp kq kr b">action.json</code>文件的<code class="du ko kp kq kr b">actions</code>部分现在看起来应该如下所示:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="5cda" class="lt ig hi kr b fi lu lv l lw lx">"actions": [<br/>    {<br/>      "description": "Launch intent",<br/>      "initialTrigger": {<br/>        "intent": "assistant.intent.action.MAIN"<br/>      },<br/>      "httpExecution": {<br/>        "url": "https://us-central1-three-doors-xxxx.cloudfunctions.net/three_doors"<br/>      }<br/>    }<br/>  ]</span></pre><blockquote class="kh ki kj"><p id="0a80" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:将</em> <code class="du ko kp kq kr b"><em class="hi">xxxx</em></code> <em class="hi">替换为您上面选择的四个数字。</em></p></blockquote><h1 id="8043" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">将您的应用部署到Google云功能</h1><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="737a" class="lt ig hi kr b fi lu lv l lw lx">gcloud beta functions deploy three_doors --trigger-http --stage-bucket gs://three-doors-xxxx</span></pre><blockquote class="kh ki kj"><p id="8e9b" class="jd je kk jf b jg kb ji jj jk kc jm jn kl kd jq jr km ke ju jv kn kf jy jz ka hb bi translated"><em class="hi">注:将</em> <code class="du ko kp kq kr b"><em class="hi">xxxx</em></code> <em class="hi">替换为您上面选择的四个数字。</em></p></blockquote><p id="64a5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这将把您的Google函数部署到Google Cloud中，该函数包含在<code class="du ko kp kq kr b">index.js</code>源文件中(我们将在下一次讨论)。如果这是您第一次部署应用程序，这将需要一些时间；多达5分钟。不要担心，更新不需要那么长时间，所以不需要管理自己的服务器是值得等待的。</p><h1 id="d3d0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">部署您的action.json测试文件</h1><p id="d2a8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">接下来，是时候部署您的操作文件(action.json)了。使用下面的命令。如果这是第一次运行该命令，您可能会看到输入安全令牌的说明。</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="a65c" class="lt ig hi kr b fi lu lv l lw lx">./gactions preview --action_package action.json --invocation_name "three doors" --preview_mins 1234</span></pre><p id="1035" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">运行上面的<code class="du ko kp kq kr b">gactions</code>命令会暂时打开你的新动作。只有你能测试它。这允许您在命令行或web模拟器中或者在您的Google Home设备上测试应用程序。您用来设置云项目的google电子邮件必须是管理您的Google Home设备的同一个帐户。</p><h1 id="f0a0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">测试您的行动</h1><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="1f1f" class="lt ig hi kr b fi lu lv l lw lx">./gactions simulate</span></pre><p id="88df" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在模拟器中，键入:</p><pre class="lh li lj lk fd lp kr lq lr aw ls bi"><span id="1f2e" class="lt ig hi kr b fi lu lv l lw lx">talk to three doors</span></pre><p id="ac15" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这应该会启动对话。</p><p id="42ef" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">当您运行该命令时，还有一个选项可以启动一个基于web的模拟器来播放音频。可能会提示您在google gmail帐户上启用音频。</p><h1 id="1276" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">恭喜你！</h1><p id="1cdc" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您刚刚在Google上设置并部署了您的第一个操作。我在下面列出了一些参考资料。在本系列的下一篇文章中，我们将查看代码并更多地理解它是如何工作的。</p><p id="535f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果你觉得这篇文章有用，请分享，或者在twitter @eisenzopf上给我发消息</p><h1 id="46aa" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">参考</h1><ul class=""><li id="547f" class="ks kt hi jf b jg jh jk jl jo ly js lz jw ma ka kx ky kz la bi translated"><a class="ae kg" href="https://nodejs.org/en/download/package-manager/" rel="noopener ugc nofollow" target="_blank">安装Node.js </a></li><li id="a4f0" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/tools/testing" rel="noopener ugc nofollow" target="_blank">使用谷歌动作模拟器</a></li><li id="4326" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/design/checklist" rel="noopener ugc nofollow" target="_blank">Nandini Stocker的设计清单</a></li><li id="c051" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="http://www.windowscentral.com/how-install-bash-shell-command-line-windows-10" rel="noopener ugc nofollow" target="_blank">在Windows 10上安装bash</a>或者<a class="ae kg" href="https://cygwin.com/install.html" rel="noopener ugc nofollow" target="_blank">安装Cygwin </a>哪个我个人更喜欢</li><li id="36de" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://curl.haxx.se/download.html" rel="noopener ugc nofollow" target="_blank">在Windows 10上安装curl</a></li><li id="5622" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/develop/sdk/actions#creating_an_action_package" rel="noopener ugc nofollow" target="_blank">创建谷歌行动包</a></li><li id="1c93" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://console.developers.google.com/projectselector/apis/api/actions.googleapis.com/overview" rel="noopener ugc nofollow" target="_blank">谷歌应用编程接口管理器</a></li><li id="f66f" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://console.developers.google.com/apis/dashboard" rel="noopener ugc nofollow" target="_blank">谷歌API仪表盘</a></li><li id="57ed" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/distribute/deploy" rel="noopener ugc nofollow" target="_blank">部署谷歌行动</a></li><li id="247b" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/develop/sdk/getting-started" rel="noopener ugc nofollow" target="_blank">开始使用Google Action SDK </a></li><li id="6126" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/reference/conversation" rel="noopener ugc nofollow" target="_blank">谷歌行动对话JSON API </a></li><li id="5381" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://developers.google.com/actions/samples/" rel="noopener ugc nofollow" target="_blank">将谷歌动作部署到应用引擎</a></li><li id="84ae" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated"><a class="ae kg" href="https://cloud.google.com/functions/docs/writing/http" rel="noopener ugc nofollow" target="_blank">编写谷歌云HTTP函数</a></li><li id="dd5b" class="ks kt hi jf b jg lb jk lc jo ld js le jw lf ka kx ky kz la bi translated">【RegExr.com T4】Regex</li></ul></div></div>    
</body>
</html>