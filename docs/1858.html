<html>
<head>
<title>BI on the Lakehouse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">碧湖居</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/looker-with-delta-lake-49f0a084e2e6?source=collection_archive---------1-----------------------#2021-04-17">https://medium.com/google-cloud/looker-with-delta-lake-49f0a084e2e6?source=collection_archive---------1-----------------------#2021-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/25f1f74508ebf54fb64739a9b206be35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDRpn8DwOfISeF7-3HqLaw.png"/></div></div></figure><div class=""/><div class=""><h2 id="2d90" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">如何将Google Looker连接到Databricks Delta Lake</h2></div><p id="8a05" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><a class="ae km" href="https://databricks.com/" rel="noopener ugc nofollow" target="_blank"> Databricks </a>，其lakehouse架构，现在可以在谷歌云平台(GCP)上使用。这意味着您可以在所有主要云上使用您的数据科学笔记本、优化的Apache Spark引擎、SQL Analytics和Delta Lake及其开放格式:Y <em class="kn">您现在可以在您的数据所在的地方进行分析。</em></p><p id="3f38" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Databricks还与GCP云服务紧密集成。对于那些有商业智能或分析背景的人来说，谷歌的Looker和Databricks lakehouse的结合尤其有趣。Looker是Google基于云的商业智能企业平台，让您轻松创建令人惊叹的仪表盘。</p><p id="6f27" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">有了GCP的Databricks，你现在可以直接在湖边小屋建造Looker仪表盘。Delta Lake是一个开放、可靠、高性能、安全的数据存储和管理层，适用于流和批处理操作。</p><p id="a9ca" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">实现本教程中的体系结构，不需要从数据湖复制数据或将数据复制到数据湖中。不需要数据仓库，您的湖边小屋就成了唯一的数据源。</p><p id="54c3" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为了分享我在三角洲湖上建造Looker仪表盘时学到的经验，我制作了以下视频教程。</p><figure class="ko kp kq kr fd hk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="3bab" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><em class="kn">以下步骤提供了对用户有用的其他资源。这些资源支持上面的视频教程，并不意味着是一步一步的指导。</em></p><h1 id="5a55" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">重要的事情先来</h1><h2 id="d0d9" class="lm kv ht bd kw ln lo lp la lq lr ls le jz lt lu lg kd lv lw li kh lx ly lk lz bi translated">谷歌浏览器</h2><p id="32bc" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">当我开始这个项目时，我没有Looker的经验。这个<a class="ae km" href="https://www.youtube.com/watch?v=FBlyD2nCJds" rel="noopener ugc nofollow" target="_blank">视频</a>帮我出入门。为了改善你的外表体验，我的建议是在你开始构建仪表板之前，先学习核心的外表资源和概念。此外，确保你知道<a class="ae km" href="https://docs.looker.com/data-modeling/getting-started/how-project-works" rel="noopener ugc nofollow" target="_blank"> Looker项目是如何运作的</a>。如果你不喜欢视频，请看这里的<a class="ae km" href="https://docs.looker.com/data-modeling/learning-lookml/lookml-terms-and-concepts" rel="noopener ugc nofollow" target="_blank">文档</a>进行概述(下面的截图就是从这里截取的)。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mf"><img src="../Images/396f19e00b04147820d1db0d4c781d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fOna4_anvFhDMmno.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">Google Looker项目、模型、视图、维度、测量、探索</figcaption></figure><h2 id="306d" class="lm kv ht bd kw ln lo lp la lq lr ls le jz lt lu lg kd lv lw li kh lx ly lk lz bi translated">数据布里克斯湖屋</h2><p id="42da" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">lakehouse是一个可扩展的低成本选项，它统一了数据、分析和人工智能。这篇来自Databricks博客的<a class="ae km" href="https://databricks.com/blog/2020/01/30/what-is-a-data-lakehouse.html" rel="noopener ugc nofollow" target="_blank">博文是了解湖边小屋建筑的好方法。</a></p><p id="b0cc" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><a class="ae km" href="https://databricks.com/product/delta-lake-on-databricks" rel="noopener ugc nofollow" target="_blank"> Delta Lake </a>是一个开放格式的事务存储层，构成了<a class="ae km" href="https://databricks.com/blog/2020/01/30/what-is-a-data-lakehouse.html" rel="noopener ugc nofollow" target="_blank"> lakehouse </a>的基础。Delta Lake为您的数据湖提供了可靠性、安全性和性能，适用于流操作和批处理操作，并通过为结构化、半结构化和非结构化数据提供单一存储来消除数据孤岛。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mk"><img src="../Images/12c9231b8ce3325994d78374ec38b0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9y_Po7TVPa9zFqhPBpRKfQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">湖屋:从DWH和数据湖的演变</figcaption></figure><h1 id="46dd" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">获得一个Looker帐户</h1><p id="c53d" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">Looker不属于自由GCP审判。你可以在谷歌市场申请Looker。注意，我不是谷歌:-)，所以我不能帮助这一部分。一旦你有了你的帐户，确保你可以登录。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ml"><img src="../Images/847ae76c567f3d3de5738e0218a044f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_BKXv8BbxAQ_SXPLxRDXQ.png"/></div></div></figure><h1 id="6be5" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">创建数据块工作空间和集群</h1><p id="2ce0" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">创建工作空间在<a class="ae km" href="https://docs.gcp.databricks.com/administration-guide/account-settings-gcp/index.html" rel="noopener ugc nofollow" target="_blank">数据块文档</a>中有详细描述。文档还列出了<a class="ae km" href="https://docs.gcp.databricks.com/getting-started/try-databricks-gcp.html#prerequisites-for-account-and-workspace-creation" rel="noopener ugc nofollow" target="_blank">先决条件</a>，比如配置资源配额或者在Google cloud上启用API。</p><p id="2b74" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Databricks工作区链接到GCP项目。创建工作空间时，您必须<a class="ae km" href="https://support.google.com/googleapi/answer/7014113?hl=en" rel="noopener ugc nofollow" target="_blank"> Google cloud项目ID </a>，可以在Google cloud控制台中通过选择项目信息下的项目名称找到该ID。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mm"><img src="../Images/2bb86c068ced804f33faa46d7ab33c43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IU4U3KAL3oflsJgYtf-yAA.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">使用GCP Looker为BI创建Databricks工作区</figcaption></figure><p id="dd01" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在数据块工作区，创建一个<a class="ae km" href="https://docs.gcp.databricks.com/clusters/create.html" rel="noopener ugc nofollow" target="_blank">数据块集群</a>。</p><h1 id="4195" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">创建或使用增量表</h1><p id="fcfa" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">我们的目标是建立一个Looker仪表板，直接从增量表中访问您的数据。Delta表可以基于<a class="ae km" href="https://docs.gcp.databricks.com/data/data-sources/google/gcs.html" rel="noopener ugc nofollow" target="_blank"> <strong class="js hu"> Google云存储</strong> </a>作为可扩展、高可用、廉价的存储层。使用现有的表或按照视频教程在增量表中创建自己的示例数据。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mn"><img src="../Images/6d883dfc563fbfed65ff244912c62d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hr1qa3JeiiAZEFAdEW3piQ.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">为Looker创建数据块增量表</figcaption></figure><p id="8998" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">要创建视频教程中使用的增量表，请在笔记本单元格中运行下面的Scala代码片段。</p><figure class="ko kp kq kr fd hk"><div class="bz dy l di"><div class="mo kt l"/></div></figure><h1 id="a205" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">创建Spark数据库连接</h1><p id="35c3" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">在Looker控制台中，创建一个<a class="ae km" href="https://docs.databricks.com/integrations/bi/looker.html#step-1-get-databricks-connection-information" rel="noopener ugc nofollow" target="_blank">连接</a>来访问您的集群正在运行的GCP上的Databricks工作区。视频教程将向您展示如何填写所有连接设置参数。</p><p id="7551" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">更新:从21.6版本开始，Looker支持数据库设置的Databricks方言。用这个代替我在动手视频教程中展示的Spark 2.x设置。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/cc2501a21470e641bc26db08445cce6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySk8hI-qtAa193KyD3pizw.png"/></div></div></figure><h1 id="964f" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">创建带有视图的LookerML模型</h1><p id="08b8" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">使用指向您的Databricks集群的Looker数据库连接，为您的数据生成一个LookerML <strong class="js hu">模型</strong>。在模型中，表格被表示为<strong class="js hu">视图</strong>。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mq"><img src="../Images/7128383296449571f05c42293af10721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9XX9o-OZaWVH8gbLx8ebg.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">基于三角洲湖表的Looker模型</figcaption></figure><h1 id="61c0" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">创建Looker仪表板</h1><p id="430f" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">要有创造性:-)钻研你的数据。构建您的<strong class="js hu">外观仪表盘</strong>。我的建议是在你深入研究之前多了解一些关于Looker的知识，例如<a class="ae km" href="https://docs.looker.com/data-modeling/learning-lookml/what-is-lookml" rel="noopener ugc nofollow" target="_blank"> Looker ML </a>的基础知识以及仪表盘中<a class="ae km" href="https://docs.looker.com/data-modeling/learning-lookml/lookml-terms-and-concepts" rel="noopener ugc nofollow" target="_blank"> <em class="kn">尺寸</em>和<em class="kn">尺寸</em> </a>的区别。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mr"><img src="../Images/99f973d5a018c89ea597d7a7d23b9d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbHLEK2-N8YxMBLBFCSMMA.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">基于三角洲湖的Looker仪表盘</figcaption></figure><h1 id="c830" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">旁观者发展与生产模式</h1><p id="0772" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">到目前为止，您已经在<a class="ae km" href="https://docs.looker.com/data-modeling/getting-started/dev-mode-prod-mode" rel="noopener ugc nofollow" target="_blank"> <strong class="js hu">开发模式</strong> </a>中创建了仪表板。开发模式允许您在不影响任何人的情况下对项目进行更改。此模式访问完全独立的项目文件版本，只有您可以查看和编辑。</p><p id="00b5" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在生产模式下使用Looker实例的每个人都以相同的状态访问它的项目。在此模式下，项目文件是只读的。</p><p id="4be9" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Looker使用Git进行版本控制。一旦你<a class="ae km" href="https://docs.looker.com/data-modeling/getting-started/setting-up-git-connection" rel="noopener ugc nofollow" target="_blank">配置了Git连接</a>，你就可以提交修改并把它们推向生产。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ms"><img src="../Images/efb62351c0f694db52ceba3854accf35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGB1IrESozjVceLeULiMxQ.png"/></div></div></figure><h1 id="247e" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">Looker中的混合三角洲湖和大查询仪表板</h1><p id="81b6" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">要将基于BigQuery中的表的图添加到仪表板中，只需在Looker控制台中配置一个BigQuery数据库连接，并使用基于新连接的视图创建一个Looker模型。</p><figure class="ko kp kq kr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mt"><img src="../Images/677b7cfab8b01f78760e26b8b3264927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2j7JkUPVMI6jiRlVCoQWww.png"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">带有Delta Lake和BigQuery的混合外观仪表盘</figcaption></figure><h1 id="9f57" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">旁观者40秒快速旋转</h1><p id="9632" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">基于上面列出的步骤，当《GCP数据报》发行时，我创建了一个looker仪表板。下面的视频捕捉到了这个演示的快速旋转。</p><figure class="ko kp kq kr fd hk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h1 id="e8d1" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">你呢？</h1><p id="0e29" class="pw-post-body-paragraph jq jr ht js b jt ma iu jv jw mb ix jy jz mc kb kc kd md kf kg kh me kj kk kl hb bi translated">我很好奇想了解一下，看看你都造了些什么。请在下面的评论区分享你用Looker和Databricks创建的截图。</p><h1 id="60e5" class="ku kv ht bd kw kx ky kz la lb lc ld le iz lf ja lg jc lh jd li jf lj jg lk ll bi translated">参考</h1><ul class=""><li id="70fd" class="mu mv ht js b jt ma jw mb jz mw kd mx kh my kl mz na nb nc bi translated">订阅<a class="ae km" href="https://www.youtube.com/channel/UC3q8O3Bh2Le8Rj1-Q-_UUbA" rel="noopener ugc nofollow" target="_blank"> Databricks YouTube频道</a>和我们的GCP播放列表。</li></ul></div><div class="ab cl nd ne gp nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hb hc hd he hf"><p id="5452" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="js hu">如果你像我喜欢写这篇文章一样喜欢阅读它，请连接媒体，为这篇文章鼓掌。我在Twitter上花了太多时间——关注更多数据科学、数据工程或AI/ML相关新闻:</strong><a class="ae km" href="https://twitter.com/search?q=frankmunz" rel="noopener ugc nofollow" target="_blank"><strong class="js hu">@ frankmunz</strong></a><strong class="js hu">。</strong></p></div></div>    
</body>
</html>