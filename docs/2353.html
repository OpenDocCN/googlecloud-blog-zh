<html>
<head>
<title>Setting a ⬣ Cloud Build trigger with 🧹Pulumi in 🐍 Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在🧹Pulumi的情况下设置⬣云构建触发器🐍计算机编程语言</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/setting-cloudbuild-with-pulumi-in-python-330e8b54b2cf?source=collection_archive---------1-----------------------#2022-09-12">https://medium.com/google-cloud/setting-cloudbuild-with-pulumi-in-python-330e8b54b2cf?source=collection_archive---------1-----------------------#2022-09-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5eef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">几周前，我爱上了<a class="ae jm" href="https://www.pulumi.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a>:它拥有我想要的Terraform的一切:易于设置，易于配置管理，免费的用户界面，最重要的是…语言支持！普鲁米是继布法罗比萨饼之后最好的发明，它只有一个问题..<a class="ae jm" href="https://github.com/pulumi/pulumi/issues/132" rel="noopener ugc nofollow" target="_blank">没有Ruby支持</a> :/</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jn"><img src="../Images/99bdc972dde6cd00ae8c675e92bc03ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ntcUJiiKZitXeNpS"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">这是MidJourney如何想象谷歌云上的紫色扫帚</figcaption></figure><p id="f130" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无论如何，我非常喜欢⬣ <a class="ae jm" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> GCP </strong> </a>(我不得不承认，它恰好支付我的薪水)<a class="ae jm" href="https://cloud.google.com/build" rel="noopener ugc nofollow" target="_blank">云构建</a>，<a class="ae jm" href="https://cloud.google.com/deploy" rel="noopener ugc nofollow" target="_blank">云部署</a>，以及Google Cloud上的一般CI/CD管道，所以我想尝试一下。Google "<em class="ke">Cloud Build Pulumi</em>"我得到了这篇<a class="ae jm" href="https://www.pulumi.com/docs/guides/continuous-delivery/google-cloud-build/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">的好文章</strong>的JavaScript </a>，它不在我的和弦中。</p><h1 id="d932" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">代码</h1><p id="536f" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di"> M </span> y代码在这里:<a class="ae jm" href="https://github.com/palladius/pulumi/tree/main/examples/python-gcp-cloudbuild-auto-trigger" rel="noopener ugc nofollow" target="_blank">https://github . com/palladius/pulumi/tree/main/examples/python-GCP-cloud build-auto-trigger</a></p><blockquote class="li lj lk"><p id="a662" class="if ig ke ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">注意:👍代码终于正确构建了。耶！</p></blockquote><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lo"><img src="../Images/e912fc4b9cc7fbd5ef3a4912bfd637cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*fP_s5ZT8xVgLhmwTUVexaQ.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">代码今天早上开始工作，今晚我可以睡觉了💤紧的😴</figcaption></figure><h1 id="554f" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">代码有什么特别之处？</h1><p id="cb56" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">代码允许你在<strong class="ih hj"> GCP </strong>上拥有任何<strong class="ih hj"> Pulumi </strong>项目(用Python🐍)来设置自我更新的触发器。对git repo的推送将触发一个构建作业，如果成功的话，这个作业将作为您自己登录到Pulumi并发布一个带有新代码的更新。</p><p id="6407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，例如，如果您提交一个将GCS bucket添加到代码中的更改，几分钟后就会创建GCS bucket，并且README.md将使用构建器参数进行更新:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es lp"><img src="../Images/d8f22a8959c717e136a03a73d9ad237c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNXQK2lvleX_Rm4eafdvYQ.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">以粗体显示，您可以看到由云构建本身更新的3个参数！</figcaption></figure><p id="9e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的代码支持<strong class="ih hj"> Github </strong>(原样)和<strong class="ih hj"> Bitbucket </strong>(代码99%在那里，因为它首先工作！)暂时。</p><p id="d178" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还根据<a class="ae jm" href="https://www.pulumi.com/blog/six-things-about-pulumi-service/" rel="noopener ugc nofollow" target="_blank"> Laura文章</a>定制了消息，在git消息前面加上了一个“<em class="ke">【使用云构建构建】】</em>”(<em class="ke">斜杠N fix </em>)，在本例中:</p><figure class="jo jp jq jr fd js er es paragraph-image"><div class="er es lq"><img src="../Images/d2e89ee8e88e7b23fb200d8ad410f7d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*TZACTfN-4rYOuxIS-Cv1Uw.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated">这是我的云构建脚本调用<em class="kd">“pulumi up”</em>时的提交消息</figcaption></figure><h1 id="fc04" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">普鲁米是什么意思？</h1><p id="5c49" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi jd translated">我一直在尝试谷歌翻译，它看起来可能意味着夏威夷或缅甸(🇲🇲，现在的缅甸)的扫帚柄(🧹)。在那之前，我会用第一个表情符号，直到有人证明我错了。</p><p id="8f57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">编辑</strong>:我来自普鲁米的朋友Aaron确认扫帚，并指向<a class="ae jm" href="http://joeduffyblog.com/2018/06/18/hello-pulumi/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>。</p><h1 id="3894" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">后续步骤</h1><p id="f764" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">我的📝面向未来包括:</p><ul class=""><li id="58f1" class="lr ls hi ih b ii ij im in iq lt iu lu iy lv jc lw lx ly lz bi translated">通过HSM或GCS在GCP上设置正确的密码/状态。</li><li id="b111" class="lr ls hi ih b ii ma im mb iq mc iu md iy me jc lw lx ly lz bi translated">转换成一个模块，这样无论你有什么样的pulumi项目，你都可以用4-5个变量(github用户，github repo，pulumi buidl目录，凭证，..).<br/>我仍然需要看看这是否也是可行的跨语言(非🐍).</li></ul><h1 id="b03f" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">参考</h1><p id="0449" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi jd translated"><span class="l je jf jg bm jh ji jj jk jl di"> O </span>原代码(Cloud Build+node . js):<a class="ae jm" href="https://www.pulumi.com/docs/guides/continuous-delivery/google-cloud-build/" rel="noopener ugc nofollow" target="_blank">https://www . pulumi . com/docs/guides/continuous-delivery/Google-Cloud-Build/</a></p><p id="bf3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的代码(python):<a class="ae jm" href="https://github.com/palladius/pulumi/tree/main/examples/python-gcp-cloudbuild-auto-trigger" rel="noopener ugc nofollow" target="_blank">https://github . com/palladius/pulumi/tree/main/examples/python-GCP-cloud build-auto-trigger</a></p></div></div>    
</body>
</html>