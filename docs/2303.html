<html>
<head>
<title>VertexAI custom training deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VertexAI定制培训部署</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/vertexai-custom-training-deployment-7ad185411a93?source=collection_archive---------3-----------------------#2022-08-15">https://medium.com/google-cloud/vertexai-custom-training-deployment-7ad185411a93?source=collection_archive---------3-----------------------#2022-08-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Vertex AI是Google Cloud中统一的ML平台，类似于AWS中的SageMaker。</p><p id="5b00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我第一次看<a class="ae jd" href="https://cloud.google.com/vertex-ai" rel="noopener ugc nofollow" target="_blank"> VertexAI </a>的时候，我错过了一个快速的可视化展示，展示了定制训练是如何工作的。例如，理解大部分代码应该在由Google Cloud管理的<em class="je">不同的</em>项目中运行，或者如何向VertexAI报告<a class="ae jd" href="https://storage.googleapis.com/gweb-cloudblog-publish/images/beans.max-2200x2200.png" rel="noopener ugc nofollow" target="_blank">血统/元数据</a>是很重要的。</p><p id="fe3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目的是在这里展示它，并辅以简短的解释。</p><h1 id="8d0c" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">概观</h1><h2 id="1e66" class="kd jg hi bd jh ke kf kg jl kh ki kj jp iq kk kl jt iu km kn jx iy ko kp kb kq bi translated">第一天——我们如何看待VertexAI的定制培训</h2><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/059eacdcd7c82509f8cf5931d865b9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yB-VRZcPE9FkRN9FaikPQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">用于培训的VertexAI工作台</figcaption></figure><p id="e863" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每当我们在UI工作台中打开一个新的笔记本时，就会在计算引擎中启动一个VertexAI VM。我们可以在这个VM中运行的Jupyter笔记本中进行训练，或者使用Google云资源来训练模型。本演练假设后一种情况。</p><p id="85ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤:</p><ol class=""><li id="2b67" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc lm ln lo lp bi translated">笔记本中的代码创建了一个VertexAI <a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/datasets/datasets" rel="noopener ugc nofollow" target="_blank">数据集</a>，它是GCP位置或BigQuery关系的包装器。</li><li id="954c" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">我们使用<code class="du lv lw lx ly b">%%writefile</code> Jupyter宏来生成<code class="du lv lw lx ly b">train.py</code>训练脚本。大部分网上的例子都是这样显示的。但是您最好在VM中使用GIT，或者将您的训练代码上传到云存储中。而且，这里最好用<a class="ae jd" href="https://docs.python.org/3/distutils/sourcedist.html" rel="noopener ugc nofollow" target="_blank"> Python源码分发</a>。</li><li id="3143" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">创建培训渠道，并</li><li id="99ec" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc lm ln lo lp bi translated">使用步骤1中的特定<code class="du lv lw lx ly b">dataset_id</code>运行它。下面显示了这里发生的情况。</li></ol><h2 id="ebe8" class="kd jg hi bd jh ke kf kg jl kh ki kj jp iq kk kl jt iu km kn jx iy ko kp kb kq bi translated">ML建筑师如何看待VertexAI的定制培训</h2><p id="27d9" class="pw-post-body-paragraph if ig hi ih b ii lz ik il im ma io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">用户管理的笔记本电脑部署示例。<br/>图中未显示网络细节:</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es me"><img src="../Images/01060dd04fd8a0a1e73667e9ffd480f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wJIwhF0jCQWTOtuJs9cng.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">VertexAI定制训练</figcaption></figure><p id="9a42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">VertexAI提供管理培训。这是在另一个项目中完成的，由GCP管理。一旦我们在步骤4中运行了培训作业，该作业就会进入GCP项目中的作业队列。<br/> GCP用上面步骤2中提供的<code class="du lv lw lx ly b">train.py</code>或Python软件分发代码开始工作。命令参数被传递给每个worker，如Job对象中所述。由VertexAI数据集对象包装的数据位置通过<a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/training/using-managed-datasets#access_a_dataset_from_your_training_application" rel="noopener ugc nofollow" target="_blank">环境变量</a>传递给每个工人的训练脚本。</p><p id="88ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦作业完成，它通常会将结果写入项目中的GCS。</p><p id="e2d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作业可以指定几个工作池，每个工作池有不同的机器/参数。<a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/training/distributed-training#cluster-spec-format" rel="noopener ugc nofollow" target="_blank"> CLUSTER_SPEC </a>包含一个工人的<code class="du lv lw lx ly b">index</code>。在这篇简介中我们不会深入探讨数据并行训练。</p><h1 id="684a" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">为什么要在维特赛训练</h1><p id="019d" class="pw-post-body-paragraph if ig hi ih b ii lz ik il im ma io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">如果我的模型是在小数据上训练的，并且不需要GPU，我应该使用本地Jupyter笔记本吗？</p><p id="5277" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们沿着脊椎动物的方式，我们得到:</p><ul class=""><li id="e360" class="lh li hi ih b ii ij im in iq lj iu lk iy ll jc mf ln lo lp bi translated"><a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/ml-metadata/introduction" rel="noopener ugc nofollow" target="_blank">元数据</a>，特别是使用<a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/vizier/overview" rel="noopener ugc nofollow" target="_blank">维兹尔</a>进行超参数调谐</li><li id="f5a1" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated">元数据中的沿袭信息</li><li id="a0cd" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated">带库伯流量/TFX <a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/pipelines" rel="noopener ugc nofollow" target="_blank">管道的多点作业</a></li><li id="ff5a" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated">整合日志记录/监控</li><li id="c230" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated"><a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/model-registry/introduction" rel="noopener ugc nofollow" target="_blank">车型注册处</a></li><li id="11ef" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated"><a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/explainable-ai/overview" rel="noopener ugc nofollow" target="_blank">可解释的人工智能</a></li><li id="bf08" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated"><a class="ae jd" href="https://cloud.google.com/vertex-ai/docs/datasets/data-labeling-job" rel="noopener ugc nofollow" target="_blank">数据标注</a>工作岗位</li><li id="9e14" class="lh li hi ih b ii lq im lr iq ls iu lt iy lu jc mf ln lo lp bi translated">用于培训、服务和Jupyter笔记本的Docker图像</li></ul><p id="ec92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，将实际的训练代码从笔记本中分离出来会给你的代码提供更好的结构。</p><p id="94d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">缺点是VertexAI Workbench VM的价格。</p><p id="9f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于小型的一次性研究项目，你可能不需要上面的。对于更大/大数据/复杂/资源饥渴的项目，你可能应该使用VertexAI或类似的GCP培训解决方案。</p><p id="d09b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">VertexAI定制培训介绍到此结束。</p></div></div>    
</body>
</html>