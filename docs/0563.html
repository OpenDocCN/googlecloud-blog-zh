<html>
<head>
<title>Deploying your Go app on Google App Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google App Engine上部署您的Go应用</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/deploying-your-go-app-on-google-app-engine-5f4a5c2a837?source=collection_archive---------0-----------------------#2018-04-07">https://medium.com/google-cloud/deploying-your-go-app-on-google-app-engine-5f4a5c2a837?source=collection_archive---------0-----------------------#2018-04-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/2b911cc684c16f70b79c906c4ed60f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*QXEQ6haUGYbH8xRArkrl6A.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">谷歌云平台</figcaption></figure><p id="2700" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">本教程将向您展示如何在GCP应用引擎标准和灵活环境中部署Go应用</em></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="dc2c" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">先决条件</h1><ul class=""><li id="041d" class="ku kv hi is b it kw ix kx jb ky jf kz jj la jn lb lc ld le bi translated">您已经安装了<code class="du lf lg lh li b">gcloud</code>工具</li><li id="2b1e" class="ku kv hi is b it lj ix lk jb ll jf lm jj ln jn lb lc ld le bi translated">您已经安装了<a class="ae lo" href="https://golang.org/doc/install" rel="noopener ugc nofollow" target="_blank"> Go </a></li><li id="e103" class="ku kv hi is b it lj ix lk jb ll jf lm jj ln jn lb lc ld le bi translated">你在GCP有一个项目</li></ul><h1 id="5f64" class="jw jx hi bd jy jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt bi translated">我们开始吧</h1><p id="9baa" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">首先，让我们制作一个目录并输入它:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="900a" class="mf jx hi li b fi mg mh l mi mj">mkdir ~/hello-world-go &amp;&amp; cd hello-world-go</span></pre><p id="a9d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在确保我们将GOPATH设置到这个目录:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="227d" class="mf jx hi li b fi mg mh l mi mj">export GOPATH=$(pwd):$GOPATH</span></pre><p id="7292" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将设置项目目录:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="eee7" class="mf jx hi li b fi mg mh l mi mj">mkdir -p src/go-app &amp;&amp; cd src/go-app</span></pre><p id="2af4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们去获取GCP应用引擎库:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="fcc4" class="mf jx hi li b fi mg mh l mi mj">go get -u google.golang.org/appengine/...</span></pre><p id="4636" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们将我们的项目ID(来自GCP)设置为一个环境变量，并配置<code class="du lf lg lh li b">gcloud</code>来使用它:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="952f" class="mf jx hi li b fi mg mh l mi mj">PROJECT_ID=&lt;project-id&gt;<br/>gcloud config set project $PROJECT_ID</span></pre><h1 id="b33a" class="jw jx hi bd jy jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt bi translated">是时候写一些代码了</h1><p id="565a" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">首先我们需要制作一个<code class="du lf lg lh li b">app.yaml</code>文件来配置你的项目设置:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="7a91" class="mf jx hi li b fi mg mh l mi mj">runtime: go<br/>api_version: go1<br/>env: standard<br/>handlers:<br/>- url: /.*<br/>  script: _go_app</span></pre><p id="d11b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这告诉应用程序引擎我们想要使用Go运行时，我们想要使用标准环境，并为服务器收到请求时设置处理程序。</p><blockquote class="mk ml mm"><p id="ac97" class="iq ir jo is b it iu iv iw ix iy iz ja mn jc jd je mo jg jh ji mp jk jl jm jn hb bi translated">注意第3行，这里写着<code class="du lf lg lh li b"><em class="hi">env: standard</em></code></p></blockquote><p id="2754" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们为我们的服务器创建<code class="du lf lg lh li b">main.go</code>文件:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="0fca" class="mf jx hi li b fi mg mh l mi mj">package main</span><span id="5741" class="mf jx hi li b fi mq mh l mi mj">import (<br/>  "fmt"<br/>  "net/http"<br/>  "google.golang.org/appengine"<br/>)</span><span id="b26b" class="mf jx hi li b fi mq mh l mi mj">func handler(w http.ResponseWriter, r *http.Request) {<br/>  fmt.Fprintln(w, "Hello, world!") // Response to request<br/>}</span><span id="a3ba" class="mf jx hi li b fi mq mh l mi mj">func main() {<br/>  http.HandleFunc("/", handler) // Set endpoint handler<br/>  appengine.Main() // Start the server<br/>}</span></pre><p id="f47b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这首先导入我们需要的库，然后为您点击<code class="du lf lg lh li b">/</code>端点时设置一个处理程序，最后启动服务器。</p><h1 id="a6bd" class="jw jx hi bd jy jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt bi translated">开始部署吧！</h1><p id="496b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">这太简单了，只需运行:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="ee1c" class="mf jx hi li b fi mg mh l mi mj">gcloud app deploy</span></pre><p id="5e1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当它问你<code class="du lf lg lh li b">Do you want to continue (Y/n)?</code>时，确保点击<code class="du lf lg lh li b">Y</code></p><blockquote class="mk ml mm"><p id="3de0" class="iq ir jo is b it iu iv iw ix iy iz ja mn jc jd je mo jg jh ji mp jk jl jm jn hb bi translated">保护提示:如果您想跳过确认，请使用<code class="du lf lg lh li b"><em class="hi">yes | gcloud app deploy</em></code></p></blockquote><p id="6f04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，这应该需要大约30秒来部署(<strong class="is hj">这么快</strong>)。</p><p id="eff5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，运行<code class="du lf lg lh li b">gcloud app browse</code>或打开浏览器进入<a class="ae lo" href="https://go-project69.appspot.com/" rel="noopener ugc nofollow" target="_blank">https://&lt;project-id&gt;. appspot . com/</a></p><h1 id="7030" class="jw jx hi bd jy jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt bi translated">奖金</h1><p id="1d41" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">上面，我们将Go应用程序部署到了App Engine标准环境中。但是现在让我们看看部署到灵活的环境有多容易。</p><p id="02fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还记得我们的<code class="du lf lg lh li b">app.yaml</code>文件吗？让我们改变第三行中的一个词:</p><pre class="lx ly lz ma fd mb li mc md aw me bi"><span id="c300" class="mf jx hi li b fi mg mh l mi mj">runtime: go<br/>api_version: go1<br/>env: flex<br/>handlers:<br/>- url: /.*<br/>  script: _go_app</span></pre><p id="f577" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你能看出区别吗？我们将<code class="du lf lg lh li b">env: standard</code>改为<code class="du lf lg lh li b">env: flex</code></p><p id="aa9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在只需重新运行<code class="du lf lg lh li b">gcloud app deploy</code>并再次点击<code class="du lf lg lh li b">Y</code>进行确认。由于我们正在部署到Flex环境中，这将需要更长的时间(大约3-5分钟)。</p><p id="85b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每种环境都有不同的优势，我不会在这里讨论它们。然而，如果你想深入了解，这里有一个关于<a class="ae lo" href="https://cloud.google.com/appengine/docs/the-appengine-environments" rel="noopener ugc nofollow" target="_blank">选择应用引擎环境</a>的快速指南。</p><h1 id="24dd" class="jw jx hi bd jy jz lp kb kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt bi">👋 ✌️</h1><p id="021b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">感谢阅读！如有疑问，在下方评论！</p></div></div>    
</body>
</html>