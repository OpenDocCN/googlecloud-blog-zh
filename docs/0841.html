<html>
<head>
<title>Leveraging Google Compute Engine for Low-cost GPU Rendering (and Other Fun Exercises in Patience)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用谷歌计算引擎进行低成本的GPU渲染(以及其他有趣的耐心练习)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/leveraging-google-compute-engine-for-low-cost-gpu-rendering-and-other-fun-exercises-in-patience-bf621cd6b0ae?source=collection_archive---------0-----------------------#2018-12-11">https://medium.com/google-cloud/leveraging-google-compute-engine-for-low-cost-gpu-rendering-and-other-fun-exercises-in-patience-bf621cd6b0ae?source=collection_archive---------0-----------------------#2018-12-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0146c661ab7a6bc2da9ff4dda7e9fb13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kb2SUW0YzWlmRr6WfoZlrA.png"/></div></div></figure><p id="e757" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于我的游戏项目<a class="ae jo" href="https://twitter.com/cloutsocks" rel="noopener ugc nofollow" target="_blank"> Elliot &amp; Ko </a>，我倾向于需要大量的前期GPU资源和时间。我没有处理在各种低端设备上实时制作漂亮东西的传统难题，而是选择预渲染极高质量(因此需要大量资源)的渲染，然后将这些渲染作为2D资产与假3D物理进行实时合成。</p><p id="2f4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这一切都很好，除了我的GPU像一个土豆的事实。在借用了一个朋友的更好的硬件(带有一定的讽刺意味，他是一名开发人员Google Compute Engine)之后，我决定直接从源头入手，在云硬件上安装一个低成本的远程系统。</p><h1 id="f1d8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用例一览</h1><ul class=""><li id="ecb5" class="kn ko hi is b it kp ix kq jb kr jf ks jj kt jn ku kv kw kx bi translated">通过远程处理要求苛刻的作业节省时间并释放PC资源(同时节省功耗)</li><li id="713c" class="kn ko hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated">3D渲染或烘焙，尤其是在Blender中</li><li id="d085" class="kn ko hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated">高GPU产量，如后期效果渲染、各种Unity任务(预先计算的照明等。)</li></ul><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/826d3ae0cf011cea20fbb38aabd85a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pglONXzDyO6XNeNE57GLvA.png"/></div></div></figure><h1 id="83a6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">硬件和定价</h1><p id="74ae" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">如果你还不知道，<strong class="is hj">当你第一次注册谷歌的云平台时，谷歌会提供300美元的信用额度。与此同时，<a class="ae jo" href="https://cloud.google.com/blog/products/gcp/introducing-preemptible-gpus-50-off?hl=nl" rel="noopener ugc nofollow" target="_blank">今年早些时候</a>，谷歌以更低的成本推出了“可抢占的”GPU，你可以以美分/小时的价格运行几千美元的硬件，第一次试用在技术上是免费的……谁知道要多久。</strong></p><p id="04c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">成本和可用性<a class="ae jo" href="https://cloud.google.com/compute/pricing#gpus" rel="noopener ugc nofollow" target="_blank">因地区</a>而异，但最终它比亚马逊的“现货实例”更便宜，还有诱人的信用。不过，如果你对AWS感兴趣，这里概述的一切都适用于那里，这里有一个出色的类似草案<a class="ae jo" rel="noopener" href="/@Mikulas/blender-rendering-on-aws-p2-61f7fb8405d8">详细介绍了AWS的设置。</a></p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/ecd55fef14bab53e4940e87e1758f3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-UrlshPQBQnum-9hFEDSEw.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">美国东部地区谷歌定价摘录；右栏是可抢占价格</figcaption></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/640cd27c90f3ba0f56b5991c84b37c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPkGtp2tS3D0jv4pcl21Xg.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">AWS定价，用于比较</figcaption></figure><p id="c7c6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，两项服务的每小时价格，<em class="lr">向上取整</em>。它们的配置选项都非常通用，所以选择一个功能更强大(每小时成本更高)的设置通常会节省成本和时间，只需很少的时间即可完成。这是很容易的游戏，并调整到你喜欢的。</p><p id="11c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们也将在我们的实例中使用Linux，原因有二:它更便宜，而且(通常)更快。这一点在Windows 10上的Blender等特定程序中表现得尤为明显，这些程序会经历一个名为<em class="lr">的Windows显示驱动程序模型</em>的过程，开销很大。也就是说，有人写了一篇关于绕过这个特殊问题的精彩文章<a class="ae jo" href="http://blog.thepixelary.com/post/167616662857/improving-performance-of-blenders-cycles" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/b9f008941625501c5a199f99110fb5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHefxr6ouZOBBDgYsvF8PQ.png"/></div></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/3f8bbb120c8a4b532ed8d1ce312e735d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pArE4zIbMxhp8o4oH5daWw.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">体积照明，反射和盘绕栅栏的细微阴影都将我的渲染时间推到了平均硬件上令人沮丧的高数字</figcaption></figure><h1 id="a290" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">入门指南</h1><p id="c2c9" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">第一步是在谷歌注册<a class="ae jo" href="https://console.cloud.google.com/freetrial" rel="noopener ugc nofollow" target="_blank">，如果你还没有注册的话。瞧啊。$300.你有整整365天的时间来度过。从那里，前往</a><a class="ae jo" href="https://console.cloud.google.com/compute/instances" rel="noopener ugc nofollow" target="_blank">实例控制面板</a>并选择<strong class="is hj">创建实例</strong>，在那里你会看到以下选项菜单:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/ba219abb4a7bda47f277382b85ba7acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*AOL9PJACS6aJMhAL75fJUA.png"/></div></figure><p id="e732" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">给你的实例起一个令人难忘或可区分的名字，比如<em class="lr"> GCE Rendering </em>之类的。之后点击<strong class="is hj">更改</strong>配置操作系统和大小。我选择了Ubuntu 16.04.5 LTS，因为这是我所习惯的，但是如果你更熟悉另一个Linux发行版，那就试试吧！你还需要设置一个磁盘大小——存储空间很便宜，但你仍然要为此付费，所以选择你需要的有一点剩余空间的空间；我选择了15 GB左右，没有一个我接近完成。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/945f07ff6e8ac8227af9639125efd88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*HeznEPgPnGjH6UfGXqjPag.png"/></div></figure><p id="ca4b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来我们可以设置机器类型<em class="lr">和</em>区域；请记住，并非所有硬件都适用于所有地区，而且价格也各不相同。在<a class="ae jo" href="https://cloud.google.com/compute/pricing#gpus" rel="noopener ugc nofollow" target="_blank">谷歌</a>查看，并相应配置；您可以在以后毫不费力地更换虚拟机上的GPU、CPU和RAM，但是更改区域需要您创建一个新的虚拟机实例。就我的目的而言，我去了美国东部地区，这给了我特斯拉K80和更强大的特斯拉P100，这两者对我来说都绰绰有余。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/bda24125acfa50fc1c2a1f73ba321597.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*om_tuaMjfuqRHNpcGbt4nA.png"/></div></figure><p id="3c09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你在寻找机器类型的确切规格，我帮不了你！这完全取决于手头的工作和资源限制。一些作业严重依赖CPU并需要大量内存，其他作业可以充分利用2x或4x GPU设置。事实上，我的实例总是根据任何给定工作的概要进行调整，这确实是处理事情的最佳方式；在作业发生时评估作业、使用情况、限制和执行时间，并根据需要进行调整。我在下面增加了一个<strong class="is hj">剖析</strong>的部分，但是当我们谈论小钱的时候，超过一个小时几乎不是一个昂贵的错误。</p><p id="8f98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，单击<strong class="is hj">管理、安全性、磁盘、网络、单独租赁</strong>扩展一些附加选项。</p><h2 id="adcc" class="lx jq hi bd jr ly lz ma jv mb mc md jz jb me mf kd jf mg mh kh jj mi mj kl mk bi translated">启动脚本</h2><p id="5848" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">粘贴下面的启动脚本(或者你选择的Linux发行版的等效命令，Google有类似的指令<a class="ae jo" href="https://cloud.google.com/compute/docs/gpus/add-gpus#install-gpu-driver" rel="noopener ugc nofollow" target="_blank">这里</a>)。这将在启动时安装CUDA，这对于Nvidia卡上的GPU渲染是绝对必要的。您会注意到，我包含了(但注释掉了)明确设置应用程序时钟速度的最后一行，该速度因硬件而异。Nvidia有一个使用<code class="du ml mm mn mo b">nvidia-smi -q -i 0 -d SUPPORTED_CLOCKS</code> <a class="ae jo" href="https://devblogs.nvidia.com/increase-performance-gpu-boost-k80-autoboost/" rel="noopener ugc nofollow" target="_blank">确定可用速度的指南，这里是</a>。当您找到最大时钟速度时，您可以调整启动脚本来匹配或手动运行命令，但这不是绝对必要的。</p><figure class="le lf lg lh fd ij"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="783a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将此选项<strong class="is hj">转到</strong>上！我希望在这一点上原因很明显。忘记这样做将产生正常的、高得多的利率。</p><h2 id="12b8" class="lx jq hi bd jr ly lz ma jv mb mc md jz jb me mf kd jf mg mh kh jj mi mj kl mk bi translated">自动重启等等</h2><p id="f45a" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">这取决于你，但就我个人而言，我不需要在失败时自动重启。如果远程作业中途停止，在我没有注意到的情况下重启并让硬件闲置，对我没有任何好处。</p><p id="c601" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…我们准备好了！单击创建。一旦准备好了，你就可以使用控制台顶部的开始和停止按钮来打开和关闭它。请注意，当它打开时，您将按小时收费，所以不要忘记明确地管理这一点。不出所料，你需要打开它才能连接。</p><h1 id="866a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">通过命令行和SFTP连接到您的实例</h1><p id="2fb6" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">一旦实例启动并运行，您将获得一个可以用来连接的外部IP。请注意，这在可抢占的创业公司之间是变化的。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/821b2352423a118b8d2935d693e9ba38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*nmP4dP9lrjV1cT1AVmYYMg.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">打开状态，列出外部IP。一个助记符:绿色图标=燃烧绿色货币。</figcaption></figure><p id="5792" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您将需要命令行SSH访问来安装和运行您的程序，并需要SFTP访问来将您的作业文件发送到远程机器并下载结果输出。这篇文章假设你对这两者都有些熟悉，但是如果你遇到困难，就在Twitter 上给我发消息<a class="ae jo" href="http://twitter.com/ElliotAndKo" rel="noopener ugc nofollow" target="_blank">，我会试着扩展它。</a></p><p id="a0c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谷歌似乎不顾一切地鼓吹自己的控制台连接<a class="ae jo" href="https://cloud.google.com/compute/docs/instances/connecting-to-instance" rel="noopener ugc nofollow" target="_blank">这里</a>，但我更喜欢使用外部工具，他们有详细说明<a class="ae jo" href="https://cloud.google.com/compute/docs/instances/connecting-advanced#thirdpartytools" rel="noopener ugc nofollow" target="_blank">这里</a>。在Windows上，对于SSH，这通常是PuTTy或Cmder，对于SFTP，这通常是WinSCP。</p><h1 id="28f0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">搅拌机</h1><p id="c9cc" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">最后，我们来看一个用例！这部分很有趣。继续对你的机器嘘，我们可以安装搅拌机。你将不必与驱动程序和这样的混乱，因为启动脚本为我们处理。</p><p id="09cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我会推荐<strong class="is hj">而不是</strong>使用apt来安装Blender，因为在我写这篇文章的时候，2.79的打包版本有一些主要的渲染工件。你可以选择在<a class="ae jo" href="https://download.blender.org/release/" rel="noopener ugc nofollow" target="_blank">https://download.blender.org/release/</a>发布稳定版本，或者在<a class="ae jo" href="https://builder.blender.org/download/" rel="noopener ugc nofollow" target="_blank">https://builder.blender.org/download/</a>发布前沿版本(新功能，不太稳定)。或者甚至抓几个，尝试不同的结果。我对前者的意见最少。</p><p id="403e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ml mm mn mo b">cd</code>到您选择的目录中(我倾向于使用<code class="du ml mm mn mo b">render/</code>)，然后运行以下代码，适当替换URL:</p><pre class="le lf lg lh fd ms mo mt mu aw mv bi"><span id="5204" class="lx jq hi mo b fi mw mx l my mz">wget ‘<a class="ae jo" href="https://download.blender.org/release/Blender2.79/blender-2.79b-linux-glibc219-x86_64.tar.bz2'" rel="noopener ugc nofollow" target="_blank">https://download.blender.org/release/Blender2.79/blender-2.79b-linux-glibc219-x86_64.tar.bz2'</a><br/>tar -jxvf blender*.tar.bz2</span></pre><p id="e460" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将你的<code class="du ml mm mn mo b">.blend</code>文件上传到容易访问的地方，为了减少上传时间，设置<strong class="is hj">保存时压缩文件</strong>并重新保存。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/8961cf450cf59dbf44593f7c5cfd4a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hNSsr7o1_aVKISpab0HW4A.png"/></div></div></figure><p id="7fb2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Blender允许你运行带有或不带有混合文件的headless命令，你甚至可以配置额外的设置，比如禁用不必要的功能。完整的命令行文档在这里是<a class="ae jo" href="https://docs.blender.org/manual/en/latest/advanced/command_line/arguments.html" rel="noopener ugc nofollow" target="_blank"/>，但是您会注意到我们可以传入一个python脚本来为我们执行一些操作！我倾向于在两个文件中大量使用它:</p><ul class=""><li id="12e5" class="kn ko hi is b it iu ix iy jb na jf nb jj nc jn ku kv kw kx bi translated">一个<code class="du ml mm mn mo b">adjust.py</code>用于进行快速调整，如样本数量、切换图层(或任何2.8等效最终结果)和更多不需要渲染的<strong class="is hj">。这意味着您可以上传文件并动态调整其值，而不必每次更改都重新上传。</strong></li><li id="a546" class="kn ko hi is b it ky ix kz jb la jf lb jj lc jn ku kv kw kx bi translated">用于设置(或覆盖)全局设置和执行渲染作业的<code class="du ml mm mn mo b">render.py</code>。这对于确保启用GPU渲染也是至关重要的，无论您在本地保存文件时的首选项是什么。</li></ul><p id="24b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">举个例子，在2.79中，我大量使用图层来一次渲染出独立的场景元素。偶尔，我喜欢增加样本数量，关闭/打开一些图层，或者调整其他设置，如照明和降噪。要获取特定设置的python属性，您可以在Blender中右键单击它并选择<strong class="is hj">复制数据路径</strong>。</p><figure class="le lf lg lh fd ij"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="8d46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，要用新的设置更新混合文件，我只需运行:</p><p id="4f0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ml mm mn mo b">installdir/blender -b blends/projectname.blend -P “scripts/adjust.py”</code></p><p id="394f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<code class="du ml mm mn mo b">-b</code>在后台运行，使用<code class="du ml mm mn mo b">-P</code>传入python文件执行。</p><p id="3bc4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后是<code class="du ml mm mn mo b">render.py</code>:</p><figure class="le lf lg lh fd ij"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="cf68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…我们可以用它来执行</p><p id="06ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ml mm mn mo b">installdir/blender -b blends/projectname.blend -P “scripts/render.py”</code></p><p id="369c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，它在开始时打印设备及其启用状态。<strong class="is hj">请密切注意这一点！</strong>如果需要验证，可以用<code class="du ml mm mn mo b">#</code>注释掉第23行。如果你想要的GPU设备不可见或没有启用，要么你或Blender做错了什么。你最不希望发生的事情就是经历所有这些麻烦，只为了在GPU发电站上使用CPU渲染！</p><p id="ced4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您将在shell中获得持续的输出，包括对剩余时间的估计等等。如果你想保持渲染运行，即使你的本地机器断开连接，考虑使用<a class="ae jo" href="https://www.ocf.berkeley.edu/~ckuehl/tmux/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> Tmux </strong> </a>！超级好用；键入<code class="du ml mm mn mo b">tmux</code>，照常运行命令，然后<code class="du ml mm mn mo b">ctrl-b, d</code>分离。<code class="du ml mm mn mo b">tmux attach</code>必要时重新连接。</p><p id="6735" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">渲染完成后，它会告诉你的！您将根据您的节点设置获得所有文件，然后您可以通过SFTP将这些文件传输回您的本地机器。完成后，请务必关闭实例的电源！</p><h1 id="f811" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">一致</h1><p id="7518" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我自己没有探索过这个选项，因为我不需要它，但是对于昂贵的过程来说，它肯定是方便的，例如使用光照贴图来烘焙灯光。请注意，只有渐进式GPU Lightmapper利用GPU加速，而标准仅在CPU上运行(尽管如此，对于CPU计算实例而言，这仍是一个很好的用例，而不是GPU)。渐进式GPU光照映射器首先出现在Unity 2018.3中。</p><p id="71c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">工作流程将类似于Blender，使用命令行参数和脚本(用C#而不是Python)的组合来运行一些昂贵的作业并保存。你可以在这里查看命令行选项<a class="ae jo" href="https://docs.unity3d.com/Manual/CommandLineArguments.html" rel="noopener ugc nofollow" target="_blank"/>，还有一些类似于<code class="du ml mm mn mo b">-executeMethod</code>的选项允许你运行编辑器代码。从那里，您可以查阅文档，并找出您希望脚本运行的操作。请确保在脚本结束时保存场景文件！</p><p id="db89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我从未在Linux上运行过Unity，所以我可以谈谈它的性能，甚至它在不同平台上共享项目时的表现，所以使用您的本地操作系统启动一个GCE实例可能是值得的(并相应地更改CUDA驱动程序启动脚本！)</p><figure class="le lf lg lh fd ij"><div class="bz dy l di"><div class="mp mq l"/></div></figure><h1 id="ea47" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">压型</h1><p id="f77d" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">对于Ubuntu上的CPU和内存监控，我倾向于喜欢<a class="ae jo" href="https://pypi.org/project/Glances/" rel="noopener ugc nofollow" target="_blank">眼色</a>！</p><p id="ecb2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于GPU来说，有了<code class="du ml mm mn mo b">nvidia-smi</code>，像<code class="du ml mm mn mo b">watch -n 1 nvidia-smi</code>之类的就简单多了。</p><p id="a2d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一点上，我只是检查使用情况，并确保没有明显的峰值或使用不足！</p><p id="4327" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">说到Blender和它的Cycles渲染器(因为我还没有探索过Eeevee ),我倾向于用基本的GPU/CPU/RAM来渲染场景元素。在任何情况下，我仍然进行概要分析——直接在实例上而不是在本地进行，这样就不会根据我的本地环境做出错误的假设。</p><p id="f27a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我只是快速更改我的<code class="du ml mm mn mo b">render.py</code>或<code class="du ml mm mn mo b">adjust.py </code>来降低整体分辨率，对于过大的场景，可能会将渲染区域设置为一个较小的区域(可能是一个密度很大的区域)，然后运行几分钟，刚好足以了解监控情况，并先发制人地发现我正在使用的特定blender build中的任何异常。我之前暗示过差异，其中一个不稳定的Linux版本在进行混合GPU+CPU渲染时会神秘地变亮某些图块。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/d04583c6042bc4b4981035981d2da912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrLFK2OVausKH_C3qPgdpw.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">GPU/CPU混合渲染中的神秘亮化贴图，但仅在某些Linux版本上。我想知道为什么？</figcaption></figure><p id="4ce7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我重申:经常测试和剖析。</p><h1 id="8711" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结束语</h1><p id="97f9" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我希望这是很有见地的，也许能为你节省一些头痛和时间，就像我一样！如果你有任何问题或者你想看看我记录的其他小事情，给我留言或者关注我的推特@cloutsocks </p><p id="4775" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">快乐渲染！</p></div></div>    
</body>
</html>