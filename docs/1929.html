<html>
<head>
<title>Creating a Dataproc cluster: considerations, gotchas &amp; resources</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Dataproc集群:注意事项、陷阱和资源</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/creating-a-dataproc-cluster-considerations-gotchas-resources-930294ddb7f3?source=collection_archive---------0-----------------------#2021-07-30">https://medium.com/google-cloud/creating-a-dataproc-cluster-considerations-gotchas-resources-930294ddb7f3?source=collection_archive---------0-----------------------#2021-07-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/8ae4634962d92906e1b7d1605258c30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*PFhkWXXBd4P7bYVdJhtqXA.png"/></div></figure><p id="216c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc" rel="noopener ugc nofollow" target="_blank"> Google Cloud Dataproc </a>是一个完全托管和高度可扩展的服务，用于运行Apache Spark、Apache Flink、Presto和30多个开源工具和框架。这个强大而灵活的服务附带了<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/overview#getting-started-with-dataproc" rel="noopener ugc nofollow" target="_blank">创建集群的各种方式</a>。本文讨论了用户在成功创建可靠、可重复和一致的集群时应该考虑的重点领域。</p><p id="6765" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在考虑之前，我想先提供一些提示。请记住，Cloud Dataproc服务具有极大的灵活性，因此可能会遇到很多复杂性。利用迭代测试周期、丰富的文档、<a class="ae jk" href="https://cloud.google.com/dataproc/docs/quickstarts" rel="noopener ugc nofollow" target="_blank">快速入门</a>和<a class="ae jk" href="https://cloud.google.com/free/docs/gcp-free-tier/#free-trial" rel="noopener ugc nofollow" target="_blank"> GCP免费试用</a>。我推荐尝试的几个很棒的特性是<a class="ae jk" href="https://cloud.google.com/dataproc/docs/quickstarts/quickstart-explorer-create" rel="noopener ugc nofollow" target="_blank">API Explorer</a>和UI功能。例如，在GCP控制台-&gt;data proc-&gt;CREATE CLUSTER中，您可以配置您的集群，并且为了方便起见，能够自动生成等效的命令行或等效的REST(无需构建集群):</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jl"><img src="../Images/635cb00dce18ad5c034f4e7d539017bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSQoBb79S1_OjYs6fRU4kA.png"/></div></div></figure><p id="ff19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这可以帮助您自动化测试周期。现在让我们来看一下我们的重点领域。</p><h1 id="3bed" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">考虑因素:</h1><ul class=""><li id="556c" class="ks kt hi io b ip ku it kv ix kw jb kx jf ky jj kz la lb lc bi translated">建立工作关系网</li><li id="0a4a" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">身份和访问管理(IAM)</li><li id="4e73" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">版本控制</li><li id="991a" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">成分</li><li id="7671" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">记录和监控</li><li id="2d6c" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">配置(安全性、群集属性、初始化操作、自动分区放置)</li><li id="a84e" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">Dataproc配额</li><li id="907f" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">Dataproc Hadoop数据存储</li></ul><p id="3f80" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">联网</strong> </a> <strong class="io hj"> - </strong></p><p id="b8ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">由主虚拟机和工作虚拟机组成的Dataproc集群中的<a class="ae jk" href="https://cloud.google.com/compute/docs/instances" rel="noopener ugc nofollow" target="_blank">计算引擎虚拟机实例</a>，<strong class="io hj">必须能够使用ICMP、TCP(所有端口)和UDP(所有端口)相互通信。</strong>用户通常会实施限制性网络策略，以符合组织要求。请务必对照此处列出的<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network" rel="noopener ugc nofollow" target="_blank">实施要求来交叉引用您的网络实施。</a></p><p id="195f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="1ffc" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network#creating_a_vpc_network" rel="noopener ugc nofollow" target="_blank">缺少防火墙规则</a></li><li id="c39b" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/network#creating_a_cluster_that_uses_a_vpc_network_in_another_project" rel="noopener ugc nofollow" target="_blank">缺少IAM权限或角色</a></li><li id="5f85" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://stackoverflow.com/questions/68509537/dataproc-provisioning-timeout-due-to-network-unreachable-to-googleapis-com" rel="noopener ugc nofollow" target="_blank">缺少互联网路由</a>(非默认VPC网络)</li></ul><p id="1890" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">资源</p><ul class=""><li id="a28c" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/network-intelligence-center/docs" rel="noopener ugc nofollow" target="_blank">网络情报中心</a> : <a class="ae jk" href="https://cloud.google.com/network-intelligence-center/docs/connectivity-tests/concepts/overview" rel="noopener ugc nofollow" target="_blank">连通性测试</a></li></ul><p id="221c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/iam/iam" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">【身份与访问管理(IAM) </strong> </a> <strong class="io hj"> - </strong></p><p id="0789" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Dataproc权限允许用户，包括<a class="ae jk" href="https://cloud.google.com/compute/docs/access/service-accounts" rel="noopener ugc nofollow" target="_blank">服务帐户</a>，在Dataproc集群、作业、操作和工作流模板上执行特定的操作。这个重点领域引起了很多关注，因为用户有时会删除角色和权限，以努力遵守最小特权策略。必须根据记录的需求交叉引用IAM实施策略。</p><p id="3ae8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="a9ba" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">缺少IAM权限或角色，例如。<a class="ae jk" href="https://cloud.google.com/compute/docs/access/iam#compute.networkUser" rel="noopener ugc nofollow" target="_blank">网络用户</a>角色为<a class="ae jk" href="https://cloud.google.com/vpc/docs/provisioning-shared-vpc" rel="noopener ugc nofollow" target="_blank">共享VPC </a>网络。</li><li id="42ce" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">已删除的服务帐户(sa)，例如。已删除<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/service-accounts#dataproc_service_accounts_2" rel="noopener ugc nofollow" target="_blank">服务代理</a>账户。</li><li id="6c94" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">误解<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/iam/dataproc-principals" rel="noopener ugc nofollow" target="_blank">用户、控制平面和数据平面身份</a>。</li></ul><p id="4005" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em>—</p><ul class=""><li id="5957" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/iam/docs/troubleshooting-access" rel="noopener ugc nofollow" target="_blank">政策疑难解答</a></li></ul><p id="fe71" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/versioning/overview" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">版本化</strong></a>—</p><p id="dfbb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Dataproc使用图像将有用的Google云平台连接器和Apache Spark &amp; Apache Hadoop组件捆绑到一个包中，该包可以部署在Dataproc集群上。尽管建议为生产环境指定主要.次要映像版本，或者当与特定组件版本的兼容性很重要时，用户有时会忘记这一指导。如何<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/versioning/overview#selecting_versions" rel="noopener ugc nofollow" target="_blank">选择</a>版本的示例:</p><figure class="jm jn jo jp fd ij er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lm"><img src="../Images/1203d22b7704f9544c42559905409a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*n_f24p6-nEANfURUBjmvug.png"/></div></div></figure><p id="15f6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="d0ef" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">未明确设置版本，导致与<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions" rel="noopener ugc nofollow" target="_blank">初始化</a>动作冲突或缺少依赖关系。</li><li id="dc55" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">从基础架构到代码(IAC)的不同映像版本导致作业执行缓慢。</li><li id="75ff" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">确保支持日期。</li></ul><p id="2943" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em> -</p><ul class=""><li id="456a" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions" rel="noopener ugc nofollow" target="_blank"> Dataproc图像版本列表</a></li></ul><p id="bd7b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/components/overview" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">组件</strong> </a> <strong class="io hj"> - </strong></p><p id="c013" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建集群时，标准的Apache Hadoop生态系统组件会自动安装在集群上(参见<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions" rel="noopener ugc nofollow" target="_blank"> Dataproc版本列表</a>)。创建集群时，您可以在集群上安装<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/components/overview#available_optional_components" rel="noopener ugc nofollow" target="_blank">附加组件</a>，称为“可选组件”。该列表意义重大，因为它包括了许多常用组件，如JUPYTER。</p><p id="f380" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="f81a" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">启用<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/accessing/cluster-web-interfaces" rel="noopener ugc nofollow" target="_blank">集群web接口</a>时避免安全漏洞。</li></ul><p id="6940" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em>—</p><ul class=""><li id="9d63" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/accessing/dataproc-gateways" rel="noopener ugc nofollow" target="_blank"> Dataproc组件网关</a></li></ul><p id="624c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/guides/logging" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">记录</strong> </a> <strong class="io hj">和</strong> <a class="ae jk" href="https://cloud.google.com/dataproc/docs/guides/monitoring" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">监控</strong> </a> <strong class="io hj"> - </strong></p><p id="802a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可以在<a class="ae jk" href="https://cloud.google.com/logging/docs" rel="noopener ugc nofollow" target="_blank">云日志</a>中查看、搜索、过滤和归档Dataproc作业和集群日志。<a class="ae jk" href="https://cloud.google.com/monitoring/docs" rel="noopener ugc nofollow" target="_blank">云监控</a>提供云计算应用的性能、正常运行时间和整体健康状况的可见性。健壮的日志记录通常是对各种错误和性能相关问题进行故障排除的核心。</p><p id="6985" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="0ec2" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">创建集群时，必须<strong class="io hj">启用日志记录中的作业驱动程序日志。</strong></li><li id="d84a" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">您必须了解与为Dataproc服务启用<a class="ae jk" href="https://cloud.google.com/dataproc/docs/guides/logging#job_logs_in" rel="noopener ugc nofollow" target="_blank">日志</a>相关的<a class="ae jk" href="https://cloud.google.com/stackdriver/pricing" rel="noopener ugc nofollow" target="_blank">成本</a>。</li><li id="7c00" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">删除Dataproc集群时，作业历史可能会丢失。</li><li id="b298" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">默认情况下，不启用虚拟机内存使用和磁盘使用指标。<a class="ae jk" href="https://stackoverflow.com/questions/68403172/dataproc-vm-memory-and-local-disk-usage-metrics" rel="noopener ugc nofollow" target="_blank">启用</a>。</li></ul><p id="c09d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em></p><ul class=""><li id="9ad9" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/jobs/history-server" rel="noopener ugc nofollow" target="_blank"> Dataproc持久历史服务器</a></li></ul><p id="ad7d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">配置(</strong> <a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">安全</strong> </a> <strong class="io hj">，</strong> <a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">集群属性</strong> </a> <strong class="io hj">，</strong> <a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">初始化动作</strong> </a> <strong class="io hj">，</strong> <a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">自动区放置</strong> </a> <strong class="io hj"> )- </strong></p><p id="f57e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请记住，我强调了需要注意的阻碍集群成功创建的重点领域。这些子类中的每一个都值得仔细考虑和测试。</p><p id="ca89" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="5c67" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security#cross-realm_trust" rel="noopener ugc nofollow" target="_blank">安全性:跨领域信任</a>用于与保存用户主体的外部KDC或活动目录服务器建立跨领域信任。</li><li id="9ff4" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security#high-availability_mode" rel="noopener ugc nofollow" target="_blank">安全性:高可用性模式</a>如果主KDC关闭，Kerberos本身不支持实时复制或自动故障转移。</li><li id="eff3" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security#network_configuration" rel="noopener ugc nofollow" target="_blank">安全性:网络配置</a> Kerberos要求正确设置反向DNS。此外，对于基于主机的服务主体规范化，请确保为群集网络正确设置了反向DNS。</li><li id="d458" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties#cluster_vs_job_properties" rel="noopener ugc nofollow" target="_blank">集群属性:集群与作业属性</a>创建集群时，Apache Hadoop YARN、HDFS、Spark和其他文件前缀属性将应用于集群级别。这些属性中的许多也可以应用于特定的工作。<strong class="io hj">将属性应用到作业时，不使用文件前缀</strong>。</li><li id="730f" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties#service_properties" rel="noopener ugc nofollow" target="_blank">集群属性:Dataproc服务属性</a>这些属性可用于进一步配置您的Dataproc集群的功能。<strong class="io hj">这些集群属性是在集群创建时指定的。集群创建后，不能指定或更新它们。</strong></li><li id="b639" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/init-actions" rel="noopener ugc nofollow" target="_blank">初始化动作</a>经常设置作业依赖关系，比如安装Python包，这样作业就可以提交到集群，而不必在作业运行时安装依赖关系。初始化操作以root用户身份运行。你应该在初始化动作中使用<strong class="io hj">绝对路径</strong>。您可以使用<a class="ae jk" href="https://cloud.google.com/dataproc/docs/guides/dataproc-images" rel="noopener ugc nofollow" target="_blank"> Dataproc自定义图像</a>代替初始化动作来设置作业依赖关系。</li><li id="e358" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">我们鼓励使用<a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone" rel="noopener ugc nofollow" target="_blank">自动区域放置</a>来平衡资源以及避免资源争用。</li></ul><p id="4c56" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em>—</p><ul class=""><li id="10ac" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><a class="ae jk" href="https://web.mit.edu/kerberos/krb5-devel/doc/admin/install_kdc.html" rel="noopener ugc nofollow" target="_blank"> MIT Kerberos文档</a></li><li id="12cf" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties#file-prefixed_properties_table" rel="noopener ugc nofollow" target="_blank">文件前缀属性表</a></li><li id="11df" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties#dataproc_service_properties_table" rel="noopener ugc nofollow" target="_blank"> Dataproc服务属性表</a></li><li id="7238" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">示例初始化动作脚本:<a class="ae jk" href="https://github.com/GoogleCloudDataproc/initialization-actions" rel="noopener ugc nofollow" target="_blank"> GitHub仓库</a>，或者<a class="ae jk" href="https://cloud.google.com/storage" rel="noopener ugc nofollow" target="_blank">云存储</a> —在区域GS://goog-data proc-initial ization-actions-&lt;区域&gt;桶中</li></ul><p id="02d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/quotas" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> Dataproc配额</strong></a>—</p><p id="5385" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Dataproc有API配额限制，这些限制在项目和区域级别强制执行。配额每六十秒(一分钟)重置一次。</p><p id="bff5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="f51f" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">如果超过了Dataproc配额限制，就会生成RESOURCE_EXHAUSTED (HTTP代码429 ),相应的Dataproc API请求将会失败。但是，由于您的项目的Dataproc配额每六十秒刷新一次，您可以在失败后一分钟后重试您的请求。</li></ul><p id="67aa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">资源</em> -</p><ul class=""><li id="ac1f" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">增加资源配额限制:打开Google Cloud<a class="ae jk" href="https://console.cloud.google.com/iam-admin/quotas?_ga=2.197612071.967286393.1627180498-927508651.1613573723&amp;_gac=1.188733914.1627229857.Cj0KCQjwl_SHBhCQARIsAFIFRVV1kVkHnvGbdeelE4ZEXT9mCXMUEuDDD5rUkgGBow0UIlNQHSmCD6waAtpAEALw_wcB" rel="noopener ugc nofollow" target="_blank">IAM&amp;admin→Quotas</a>页面，选择想要修改的资源。然后单击页面顶部的编辑配额以启动配额增加流程。如果您尝试增加的资源没有显示在页面上，并且当前筛选是“使用配额”，请通过切换“配额类型”下拉列表将筛选更改为“所有配额”。</li></ul><p id="4ccb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/dataproc/docs/concepts/dataproc-hdfs" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> Dataproc Hadoop数据存储</strong> </a> -</p><p id="9bd2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Dataproc集成了Apache Hadoop和Hadoop分布式文件系统(HDFS)。Dataproc自动安装HDFS兼容的云存储连接器，这使得云存储可以与HDFS并行使用。通过上传/下载到HDFS或云存储，可以将数据移入和移出集群。</p><p id="99a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="li">抓到你了</em> -</p><ul class=""><li id="82c8" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated"><strong class="io hj">无论是使用HDFS还是云存储进行数据存储，PD大小和类型都会影响性能和虚拟机大小。</strong></li><li id="3b34" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><strong class="io hj">删除集群时，虚拟机启动磁盘也会被删除。</strong></li></ul><p id="6a8a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">资源</p><ul class=""><li id="7c43" class="ks kt hi io b ip iq it iu ix lj jb lk jf ll jj kz la lb lc bi translated">对于没有本地固态硬盘的PD标准，我们强烈建议配置1TB或更大容量，以确保始终如一的高I/O性能。</li><li id="70da" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated">配置磁盘时，请务必检查性能影响。参见<a class="ae jk" href="https://cloud.google.com/compute/docs/disks/performance" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/compute/docs/disks/performance</a>了解磁盘I/O性能信息。</li><li id="ec82" class="ks kt hi io b ip ld it le ix lf jb lg jf lh jj kz la lb lc bi translated"><a class="ae jk" href="https://cloud.google.com/compute/docs/disks/performance#size_price_performance" rel="noopener ugc nofollow" target="_blank">配置您的持久磁盘和实例</a></li></ul><p id="e393" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望这个重点领域的总结有助于您理解在构建可靠的、可重复的和一致的集群时遇到的各种问题。感谢帮助添加内容和审阅本文的人们。</p></div></div>    
</body>
</html>