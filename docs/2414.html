<html>
<head>
<title>Migration path for python based applications in GCP platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP平台中基于python的应用程序的迁移路径</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/migration-path-for-python-based-applications-in-gcp-platform-bac0caf5f7c8?source=collection_archive---------1-----------------------#2022-10-10">https://medium.com/google-cloud/migration-path-for-python-based-applications-in-gcp-platform-bac0caf5f7c8?source=collection_archive---------1-----------------------#2022-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="4ca0" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">数据迁移项目有两个不同的支柱，一个是<strong class="il hj">数据</strong>，另一个是运行在数据之上的<strong class="il hj">应用</strong>。这些应用程序可能具有不同的性质—数据、web、请求-响应模型、微服务..</p><p id="4341" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">在这篇博客中，我们将关注<strong class="il hj">基于python的作业</strong>和<strong class="il hj">的不同迁移模式，它们应该在哪里执行</strong>。</p></blockquote><p id="57fd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在典型的提升-转移迁移中，重点更多的是让事情尽可能在代码变化最小的情况下运行。原因是<strong class="il hj">减少了迁移所需的时间</strong>。</p><p id="3539" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">虽然这是一个合理的理由，因为它会影响迁移的总体成本，但重要的是要理解<strong class="il hj">选择正确的方法</strong>可以带来<strong class="il hj">成本节约</strong>和<strong class="il hj">采用云原生服务的额外好处。</strong></p><p id="d7c4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">方法</strong>应基于诸如<strong class="il hj">长期成本节约、</strong>T22】可扩展性、<strong class="il hj">可用性</strong>和<strong class="il hj">维护简易性</strong>等因素。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/0460892a3d4dac48d2a5ccf4d31e5b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHDE13oOtE0B7733Utwgfw.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">python应用程序的迁移路径</figcaption></figure><h2 id="cac2" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku ji kv kw kx jj ky kz la lb bi translated"><strong class="ak">微服务模式&amp;请求/响应模型</strong></h2><p id="ca5f" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jh le iw ix ji lf ja jb jj lg je jf jg hb bi translated">通常，这些应用负责执行<strong class="il hj">业务特定功能</strong>，如<strong class="il hj">按需生成建议</strong>、<strong class="il hj">洞察</strong>、T36】生成或<strong class="il hj">数据修正反馈循环</strong>。</p><p id="fffb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这些应用程序通常以服务的形式运行。</p><p id="1b6b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这些应用程序的方法将是检查这些应用程序是否可以与<strong class="il hj">容器兼容。</strong></p><p id="1d44" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Google Kubernetes引擎</strong>或<strong class="il hj">云运行</strong>可以用来部署这样的应用。<strong class="il hj"> </strong>另外对于<strong class="il hj">云运行</strong>，参考<strong class="il hj"> </strong> <a class="ae lh" href="https://cloud.google.com/run/docs/container-contract" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj">容器运行时契约模型</strong> </a>了解云运行服务的前提条件。</p><p id="f614" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> GKE </strong>提供<br/> 1。对基础设施和部署的更多控制。<br/> 2。<strong class="il hj">无超时</strong>界限<br/> 3。GKE还采用<strong class="il hj">自动驾驶</strong>模式，减少了维护费用<br/> 4。<strong class="il hj">关于可扩展性和弹性的高级配置</strong>选项</p><p id="3d29" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">云运行</strong>时可以杠杆<br/> 1。<strong class="il hj">基础设施</strong>T5】维护开销不理想<br/> 2。<strong class="il hj">更快的部署</strong>并利用<strong class="il hj">无服务器</strong>部署<br/> 3。不需要GKE <br/> 4的<strong class="il hj">高级功能</strong>。<strong class="il hj">没有交通24/7 <br/> 5。简单应用服务</strong></p><p id="9417" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">有可能使用两种服务的组合来实现期望的结果。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h2 id="f452" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku ji kv kw kx jj ky kz la lb bi translated">运营设施</h2><p id="75aa" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jh le iw ix ji lf ja jb jj lg je jf jg hb bi translated">这些是<strong class="il hj">轻量级和可重用的</strong>应用程序代码，用于执行操作任务，如<strong class="il hj">内务处理</strong>、<strong class="il hj">发送电子邮件通知</strong>、<strong class="il hj">基于事件的功能</strong>、<strong class="il hj">报告交付和FTP功能。</strong></p><p id="af9a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这些应用可以部署在<strong class="il hj">云功能上。</strong></p><p id="0d11" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">云函数第2代</strong>利用底层<strong class="il hj">云运行</strong>并提供<br/> 1。与<strong class="il hj">事件电弧整合触发</strong>和<br/> 2。更大的实例支持<br/> 3。<strong class="il hj">更长的超时持续时间</strong></p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h2 id="7c3e" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku ji kv kw kx jj ky kz la lb bi translated">py-火花码</h2><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es li"><img src="../Images/ce531e1ec6fd89128426266322c3a629.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/0*qidOWE_hwMJXf80c"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">星火生态系统</figcaption></figure><p id="58de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Spark —数据集成和转换<br/> </strong>基于Spark的应用可以是利用Spark流功能的<strong class="il hj">批处理</strong>或<strong class="il hj">微批处理</strong>应用。<br/>py spark代码可以在<strong class="il hj"> Dataproc(托管hadoop集群)</strong>或<strong class="il hj"> Dataproc无服务器选项</strong>上迁移和执行，对代码的改动很小。<strong class="il hj"> <br/> </strong>代码的编排可以使用<strong class="il hj"> dataproc模板</strong>或<strong class="il hj">作曲家DAGS </strong>来执行</p><p id="e583" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Spark — SQL分析<br/> Spark SQL脚本</strong>用于对Hive执行分析。<br/>虽然spark SQL代码可以在Dataproc上轻松执行，但是如果GCP的目标数据仓库是大查询，那么还是值得考虑将<strong class="il hj"> Spark SQL代码</strong>移到<strong class="il hj">大查询SQL </strong>中。<br/>这带来了额外的优势，在大查询中有转换逻辑，并且<strong class="il hj">执行ELT而不是ETL </strong></p><p id="499d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Spark机器学习</strong> <br/> <strong class="il hj"> Spark ML </strong>用于实现机器学习模型。<br/> Dataproc为基于spark的机器学习库提供支持。</p><p id="7ad9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Jupyter笔记本<br/> </strong>还有<strong class="il hj">用例</strong>使用<strong class="il hj">带有spark exploration代码的Jupyter笔记本，</strong>需要托管在GCP平台上。<br/> <strong class="il hj"> Vertex AI </strong>提供托管笔记本，可用于托管内部jupyter笔记本。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h2 id="8485" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku ji kv kw kx jj ky kz la lb bi translated">基于原生Python的功能</h2><p id="bc2b" class="pw-post-body-paragraph ii ij hi il b im lc io ip iq ld is it jh le iw ix ji lf ja jb jj lg je jf jg hb bi translated">应用程序代码库的一部分是python原生代码——pandas、numpy、sklearn，这些代码通常用于类似于<strong class="il hj">数据转换</strong>、<strong class="il hj">特征工程</strong>、<strong class="il hj">数据可视化和excel报表生成等场景。</strong></p><p id="e208" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">该代码可以在<strong class="il hj">临时</strong>或<strong class="il hj">批量</strong>的基础上执行。</p><p id="488b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这些场景通常不适合GKE或云运行的用例。</p><p id="34a1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">对于这样的代码部署，有两个选项可以利用</p><p id="4854" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">选项1 </strong> —如果<strong class="il hj"> cloud composer </strong>是架构的一部分并用于编排，则<strong class="il hj"> python操作符</strong>或<strong class="il hj"> python虚拟环境操作符</strong>可用于执行<strong class="il hj">批处理python工作负载</strong></p><p id="dc07" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这个选项带来了一些负面影响。加载composer资源以执行程序</p><p id="5d58" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">仅当代码的资源需求较少且不影响composer的调度需求时，才使用此选项。</p><p id="3a5c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">选项2——Google云计算</strong>批处理(最近推出)提供了执行这种<strong class="il hj">特别</strong> / <strong class="il hj">预定</strong>批处理代码的机制。</p><p id="845f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">计算批处理的底层实例可以从安装了所有依赖项的i <strong class="il hj">实例模板创建</strong>或作为<strong class="il hj">容器执行。</strong></p><p id="8991" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">该产品仍处于<strong class="il hj">预览阶段</strong></p><p id="7cda" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">谷歌云计算批量提供<br/> 1。完全管理的批处理服务<br/> 2。自动缩放容量<br/> 3。没有用于执行的专用基础设施<br/> 4。现货实例用法<br/> 5。容器执行支持/实例模板支持</p><p id="378b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">选项3</strong>—<strong class="il hj">Vertex AI上的Jupyter笔记本</strong>可用于数据探索和可视化代码。这些通常是由执行数据探索的数据分析师和科学家开发的。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="133e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">参考资料</strong><br/><a class="ae lh" href="https://cloud.google.com/blog/products/containers-kubernetes/when-to-use-google-kubernetes-engine-vs-cloud-run-for-containers" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/blog/products/containers-kubernetes/when-to-use-Google-kubernetes-engine-vs-cloud-run-for-containers</a><br/><a class="ae lh" href="https://cloud.google.com/blog/products/serverless/cloud-functions-2nd-generation-now-generally-available" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/blog/products/server less/cloud-functions-2nd-generally-available</a><br/><a class="ae lh" href="https://kubernetes.io/case-studies/" rel="noopener ugc nofollow" target="_blank">https://kubernetes.io/case-studies/</a><br/><a class="ae lh" href="https://cloud.google.com/blog/products/data-analytics/broadcom-adopts-cloud-based-data-lake-for-security-analytics" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/blog/products/data</a></p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="c9b1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">拉手联动—<a class="ae lh" href="https://www.linkedin.com/in/murli-krishnan-a1319842/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/murli-krishnan-a1319842/</a></p></div></div>    
</body>
</html>