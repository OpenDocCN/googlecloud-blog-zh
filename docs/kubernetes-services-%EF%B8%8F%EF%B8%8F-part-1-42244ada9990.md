# kubernetes æœåŠ¡å…¬å¸ç¬¬ä¸€éƒ¨åˆ†

> åŸæ–‡ï¼š<https://medium.com/google-cloud/kubernetes-services-%EF%B8%8F%EF%B8%8F-part-1-42244ada9990?source=collection_archive---------0----------------------->

## Kubernetes æœ‰å“ªäº›æœåŠ¡ï¼Ÿ

## ä»‹ç»ğŸš©ğŸš©

å„ä½è¯»è€…å¥½ğŸ‘‹:)
â€œKubernetes æœåŠ¡â€æ˜¯ä¸€ä¸ªåˆå¤§åˆé•¿çš„ä¸»é¢˜ã€‚æ‰€ä»¥æˆ‘å†³å®šä¸ºå®ƒå†™ä¸¤éƒ¨åˆ†ã€‚è¿™ä¸ä»…æœ‰åŠ©äºæˆ‘ä½¿æ–‡ç« ç®€æ´æ˜äº†ï¼Œä¹Ÿæœ‰åŠ©äºä½ ä»¬æ›´å¥½ã€æ›´æ·±å…¥åœ°ç†è§£è¿™ä¸ªæ¦‚å¿µã€‚

***åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†è¯•ç€ç†è§£ä¸‹é¢çš„äº‹æƒ…*** :

*   ä»€ä¹ˆæ˜¯ Kubernetes æœåŠ¡ï¼Ÿ
*   Kubernetes çš„æœåŠ¡ç±»å‹ã€‚
*   èŠ‚ç‚¹ç«¯å£æœåŠ¡æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ
*   å¦‚ä½•ä½¿ç”¨ Yaml æ–‡ä»¶åˆ¶ä½œèŠ‚ç‚¹ç«¯å£æœåŠ¡ï¼Ÿ

> å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬çš„æ–‡ç« :)

## å®šä¹‰ğŸ¤“ğŸ¤“

![](img/7df8878a59063aa59e5a7055fcf17a82.png)

Kubernetes æœåŠ¡

Kubernetes ä¸­çš„ ***æœåŠ¡æ˜¯ä¸€ç§æŠ½è±¡çš„æ–¹å¼ï¼Œå°†è¿è¡Œåœ¨ä¸€ç»„ Pods ä¸Šçš„åº”ç”¨ç¨‹åºå…¬å¼€ä¸ºç½‘ç»œæœåŠ¡ã€‚***

ä½¿ç”¨ Kubernetesï¼Œæ‚¨ä¸éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºæ¥ä½¿ç”¨ä¸ç†Ÿæ‚‰çš„æœåŠ¡å‘ç°æœºåˆ¶ã€‚Kubernetes ä¸ºä¸€ç»„ Pods æä¾›å®ƒä»¬è‡ªå·±çš„ IP åœ°å€å’Œä¸€ä¸ª DNS åç§°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œè´Ÿè½½å¹³è¡¡ã€‚

> å¥½äº†ï¼Œå¥½äº†ï¼ŒæŠ€æœ¯å®šä¹‰å¤Ÿäº†ã€‚ğŸ˜
> è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹"**ä»€ä¹ˆæ˜¯æœåŠ¡ï¼Ÿï¼Ÿ**â€œç”¨éå¸¸ç®€å•çš„æœ¯è¯­ã€‚æˆ‘ä»¬èµ°å§ï¼ï¼ğŸ‡

## è®©æˆ‘ä»¬å¼€å§‹å§ï¼ï¼â›ï¸â›ï¸

å‡è®¾åœ¨ä¸€ä¸ª Kubernetes èŠ‚ç‚¹ä¸Šæœ‰ä¸‰ç»„ä¸åŒè±†èšã€‚

*   **å‰ç«¯ pod**ã€åœ¨å…¶ä¸Šè¿è¡Œæœ€ç»ˆç”¨æˆ·å°†ä½¿ç”¨çš„ web åº”ç”¨ç¨‹åºå‰ç«¯éƒ¨åˆ†çš„ podã€‘
*   **åç«¯ pod**ã€åœ¨å…¶ä¸Šè¿è¡Œæœ€ç»ˆç”¨æˆ·å°†ä½¿ç”¨çš„ web åº”ç”¨ç¨‹åºåç«¯éƒ¨åˆ†çš„ podã€‘
*   **æ•°æ®åº“ç›’**ã€è¿è¡Œæ•°æ®åº“åº”ç”¨å®ä¾‹çš„ç›’ï¼Œè´Ÿè´£å­˜å‚¨ web åº”ç”¨çš„æ•°æ®ã€‘

ä¸Šè¿°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¿è¡Œæ­£å¸¸ï¼Œè¿è¡Œåœ¨è¿™äº›èŠ‚ç‚¹ä¸Šçš„åº”ç”¨ç¨‹åºä¹Ÿå¤„äºè‰¯å¥½çŠ¶æ€ã€‚

ä½†æ˜¯æœ‰ ***ä¸€äº›å¯èƒ½å‡ºç°çš„é—®é¢˜*** ğŸ‘€ğŸ‘€ã€‚è®©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹:

1.  æœ€ç»ˆç”¨æˆ·å¦‚ä½•åœ¨å„è‡ªçš„è®¡ç®—æœºä¸­è®¿é—®å‰ç«¯çª—æ ¼ä¸Šè¿è¡Œçš„å‰ç«¯åº”ç”¨ç¨‹åºï¼Ÿï¼Ÿ
2.  **å‰ç«¯ PODs å¦‚ä½•ä¸åç«¯ PODs** é€šä¿¡ä»¥ä½¿æ•´ä¸ªåº”ç”¨ç¨‹åºå®é™…è¿è¡Œï¼Ÿï¼Ÿ
3.  å‰ç«¯ pod å¦‚ä½•ä¸æ•°æ®åº“ pod é€šä¿¡ä»¥è·å–å®ƒä»¬æ‰€éœ€çš„æ•°æ®ï¼Ÿï¼Ÿ

![](img/4863668eaf53396f594da5478c6204c5.png)

Kubernetes æœåŠ¡çš„è¿ä½œ

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬è®¨è®ºè¿‡çš„æ‰€æœ‰ä¸Šè¿°é—®é¢˜ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨â€œKubernetes æœåŠ¡â€è½»æ¾è§£å†³ ***ã€‚***

***Kubernetes æœåŠ¡å¾ˆç®€å•æ¥è¯´ï¼Œ*** éƒ½æ˜¯ Kubernetes å¸®åŠ©æˆ‘ä»¬çš„å¯¹è±¡

1.  ***å‘æœ€ç»ˆç”¨æˆ·å±•ç¤º pod ä¸Šè¿è¡Œçš„åº”ç”¨*** ã€‚
2.  ***å¸®åŠ© pod ä¸ Kubernetes é›†ç¾¤ä¸Šçš„å…¶ä»– pod***è¿›è¡Œé€šä¿¡ï¼Œå³å¸®åŠ© pod ä¹‹é—´çš„è¿æ¥ã€‚
3.  å¸®åŠ©æ”¶é›†ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶å°†è¿™äº›è¯·æ±‚å¹³å‡åˆ†é…ç»™ pod ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œå³ ***å¸®åŠ©è´Ÿè½½å¹³è¡¡ pod ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºçš„ç”¨æˆ·è¯·æ±‚*** ã€‚

> ä¸‡å²ï¼ï¼ğŸ¥³ğŸ¥³:ç°åœ¨æˆ‘ä»¬æ˜ç™½äº†ä»€ä¹ˆæ˜¯æœåŠ¡ï¼Œä»¥åŠå®ƒä»¬èƒ½åšä»€ä¹ˆã€‚
> ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹æœåŠ¡çš„ç±»å‹:)

## Kubernetes æœåŠ¡çš„ç±»å‹ğŸŒğŸŒ

![](img/6ec082ab4c939ad222f0bbc182ce5b2c.png)

Kubernetes æœåŠ¡çš„ç±»å‹

*   **èŠ‚ç‚¹ç«¯å£:**é€šè¿‡æ¯ä¸ªèŠ‚ç‚¹ IP ä¸Šçš„é™æ€ç«¯å£å…¬å¼€æœåŠ¡ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¯¥æœåŠ¡æœ‰åŠ©äºå‘æœ€ç»ˆç”¨æˆ·å±•ç¤º pod ä¸Šè¿è¡Œçš„æœåŠ¡/åº”ç”¨ç¨‹åºã€‚
*   **ClusterIP :** å…¬å¼€åªèƒ½ä»é›†ç¾¤å†…éƒ¨è®¿é—®çš„æœåŠ¡ã€‚ç®€å•åœ°è¯´ï¼Œè¯¥æœåŠ¡å¸®åŠ© pod è®¿é—®è¿è¡Œåœ¨å¦ä¸€ä¸ª pod ä¸Šçš„æœåŠ¡ã€‚(åŠèˆ±é—´é€šä¿¡)
*   **è´Ÿè½½å¹³è¡¡å™¨:**é€šè¿‡äº‘æä¾›å•†çš„è´Ÿè½½å¹³è¡¡å™¨å…¬å¼€æœåŠ¡ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™é¡¹æœåŠ¡é€šè¿‡äº‘æä¾›å•†çš„è´Ÿè½½å¹³è¡¡å™¨æ¥å¸®åŠ©å¹³è¡¡ç”¨æˆ·å¯¹åœ¨ pod ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºçš„è¯·æ±‚ã€‚
*   **ExternalName :** é€šè¿‡ä¸º CNAME è®°å½•è¿”å›å€¼ï¼Œå°†æœåŠ¡æ˜ å°„åˆ°é¢„å®šä¹‰çš„ ExternalName å­—æ®µã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™äº›æœåŠ¡åªä½œä¸ºå…¶ä»–å¸¸è§„æœåŠ¡å·¥ä½œï¼Œä½†æ˜¯å½“æ‚¨æƒ³è¦è®¿é—®è¯¥æœåŠ¡åç§°æ—¶ï¼Œå®ƒä¸æ˜¯è¿”å›è¯¥æœåŠ¡çš„ cluster-ipï¼Œè€Œæ˜¯è¿”å›å…·æœ‰æœåŠ¡çš„`externalName:`å‚æ•°ä¸­æåˆ°çš„å€¼çš„ CNAME è®°å½•ã€‚

## èŠ‚ç‚¹ç«¯å£æœåŠ¡æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿï¼ŸğŸ¤”ğŸ¤”

![](img/d9fb7392a1eba48dc43d4a15eb625f9a.png)

èŠ‚ç‚¹ç«¯å£æœåŠ¡

***è®©æˆ‘ä»¬è¯•ç€ç†è§£ä¸Šå›¾*** ä¸­ ***æ‰€ç¤ºçš„åœºæ™¯ã€‚***

1.  æœ‰ä¸€ä¸ª worker èŠ‚ç‚¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª PODã€‚
2.  POD åœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ª web åº”ç”¨ç¨‹åºã€‚
3.  æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªèŠ‚ç‚¹ç«¯å£æœåŠ¡ï¼Œè¯¥æœåŠ¡å°†èŠ‚ç‚¹ä¸Šçš„ç«¯å£æ˜ å°„åˆ°èŠ‚ç‚¹ä¸Šå­˜åœ¨çš„ç«¯å£ã€‚

***ç°åœ¨*** ***æ¯å½“æœ€ç»ˆç”¨æˆ·æƒ³è¦è®¿é—® POD******ä¸Šè¿è¡Œçš„ web åº”ç”¨ç¨‹åºæ—¶ï¼Œä»¥ä¸‹äº‹æƒ…ä¼šåœ¨åå°å‘ç”Ÿ:***

1.  ç”¨æˆ·åªéœ€åœ¨æ˜ å°„åˆ° POD çš„èŠ‚ç‚¹ç«¯å£å·ä¸Šå‘é€è¯·æ±‚(è¿™é‡Œçš„ç«¯å£æ˜¯ 30008)
2.  æ¥ä¸‹æ¥ï¼ŒèŠ‚ç‚¹ç«¯å£æœåŠ¡æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°è‡ªå·±çš„ç«¯å£ï¼Œå³æœåŠ¡ç«¯å£(è¿™é‡Œçš„ç«¯å£:80)
3.  æ¥ä¸‹æ¥ï¼Œä»æœåŠ¡ç«¯å£å¼€å§‹ï¼Œè¯·æ±‚è¢«æ˜ å°„åˆ° web åº”ç”¨ç¨‹åº POD çš„ç«¯å£(è¿™é‡Œæ˜¯ TargetPort : 80)

> åœ¨è¿™äº›ç®€å•çš„æ­¥éª¤ä¸­ï¼Œä½¿ç”¨**èŠ‚ç‚¹ç«¯å£æœåŠ¡**ã€‚ç”¨æˆ·å¯ä»¥ä»è‡ªå·±çš„è®¾å¤‡ä¸Šè®¿é—® pod ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚

## æˆ‘ä»¬å¦‚ä½•åˆ›å»ºèŠ‚ç‚¹ç«¯å£æœåŠ¡ï¼Ÿï¼ŸğŸ¤¯ğŸ¤¯

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ YAML æ–‡ä»¶åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ç«¯å£æœåŠ¡ã€‚è¦ä½¿ç”¨ YAML åˆ›å»º Kubernetes èŠ‚ç‚¹ç«¯å£æœåŠ¡ï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œä¸ºå®ƒåˆ†é…å¿…è¦çš„è®¿é—®æƒé™ï¼Œç„¶åå®šä¹‰å¿…è¦çš„é”®-å€¼å¯¹ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ç«¯å£æœåŠ¡å®šä¹‰æ–‡ä»¶ *(* ***èŠ‚ç‚¹ç«¯å£æœåŠ¡. yaml*** *)* çš„ä¾‹å­

```
apiVersion: v1 
kind: Service
metadata:  
 name: my-service 
spec:  
 type: NodePort   
 selector:    
  app: echo-hostname    
 ports:
  - nodePort: 30008
    port: 80
    targetPort: 80
```

è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰å¾ˆå¤šæ–¹é¢å’Œç»„ä»¶ã€‚è®©æˆ‘ä»¬é€ä¸€åˆ†æğŸ˜€

*   è®©æˆ‘ä»¬ä»`apiVersion`(é”®å€¼å¯¹)å¼€å§‹ã€‚è¿™ç”¨äºé˜æ˜åœ¨åˆ›å»ºèŠ‚ç‚¹ç«¯å£æœåŠ¡æ—¶ï¼Œæ‚¨å°†åœ¨åå°è¿è¡Œä»€ä¹ˆ API æœåŠ¡å™¨å’Œç‰ˆæœ¬ã€‚
*   æ¥ä¸‹æ¥æ˜¯`kind`,è¡¨ç¤ºè¿™æ˜¯ä¸€ç§å®šä¹‰æ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ä¸€ç§â€œæœåŠ¡â€ã€‚
*   æ¥ä¸‹æ¥æ˜¯`metadata`ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…æ‹¬é¡¹ç›®åç§°çš„å­—å…¸ã€‚å…ƒæ•°æ®å­˜å‚¨åˆ†é…ç»™æ­£åœ¨åˆ›å»ºçš„èŠ‚ç‚¹ç«¯å£æœåŠ¡çš„å€¼ã€‚
*   æœ€åæ˜¯`spec`ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„/åˆ—è¡¨ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­å­˜åœ¨çš„å€¼åŠå…¶å«ä¹‰ã€‚
    `type`:è¿™ä¸ªé”®çš„å€¼ï¼Œå®šä¹‰äº†æ­£åœ¨åˆ›å»ºçš„æœåŠ¡çš„ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªâ€œèŠ‚ç‚¹ç«¯å£â€ã€‚
    `selector`:å®ƒåŸºæœ¬ä¸Šæœ‰ pod çš„æ ‡ç­¾ï¼Œä»è€Œå¸®åŠ©æœåŠ¡è¯†åˆ«å®ƒå¿…é¡»ä½¿ç”¨çš„ podã€‚
    `ports`:åŒ…å«æœåŠ¡å¿…é¡»ä½¿ç”¨çš„ç«¯å£çš„éƒ¨åˆ†ã€‚
    `nodePort`æ‹¥æœ‰ç”¨æˆ·è¯·æ±‚å°†è¦åˆ°è¾¾çš„èŠ‚ç‚¹ä¸Šçš„ç«¯å£å€¼ã€‚å®ƒçš„å€¼å¯ä»¥åœ¨ 30000â€“32767 çš„èŒƒå›´å†…ã€‚
    `port`å…·æœ‰æœåŠ¡å¯¹è±¡ä¸Šçš„ç«¯å£å€¼ï¼Œç”¨æˆ·è¯·æ±‚å°†æ˜ å°„åˆ°è¯¥ç«¯å£ã€‚

æˆ‘ä»¬å·²ç»å®Œæˆäº†èŠ‚ç‚¹ç«¯å£æœåŠ¡å®šä¹‰æ–‡ä»¶ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¿å­˜å¹¶é€€å‡ºæ–‡ä»¶ã€‚

ä½¿ç”¨æ­¤å‘½ä»¤åŸºäºä¸Šè¿° YAML æ–‡ä»¶åˆ›å»ºèŠ‚ç‚¹ç«¯å£æœåŠ¡:

```
kubectl create -f *nodePortService*.yaml
```

ä½¿ç”¨æ­¤å‘½ä»¤æŸ¥çœ‹ç¾¤é›†ä¸Šè¿è¡Œçš„æ‰€æœ‰æœåŠ¡:

```
kubectl get services
```

# æ¥ä¸‹æ¥å‘¢ï¼ŸğŸ‘€ ğŸ‘€

![](img/99ad9f685ca33dfab935696f63da6c5f.png)

> éå¸¸æ„Ÿè°¢ä½ æ¥åˆ°è¿™é‡Œï¼æ˜¯æœ¬æ–‡çš„ç»“å°¾ã€‚æˆ‘ä¼šå¾ˆå¿«å›æ¥å†™è¿™ç¯‡åšå®¢çš„ä¸‹ä¸€éƒ¨åˆ†ã€‚åœ¨è¿™é‡Œæˆ‘å°†æ·±å…¥è§£é‡Šå…¶ä»–ç±»å‹çš„æœåŠ¡ã€‚è¿˜æœ‰å¾ˆå¤šè¦å»çš„åœ°æ–¹ï¼Œè¿™å°†æ˜¯ä¸€æ¬¡æœ‰è¶£çš„æ—…ç¨‹ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å­¦ä¹ å¾ˆå¤šå¾ˆé…·çš„ä¸œè¥¿ã€‚
> 
> é¼“æŒï¼Œè·Ÿæˆ‘æ¥ğŸ™ˆå¦‚æœä½ å–œæ¬¢æˆ‘çš„ä½œå“ï¼Œå¹¶å¸Œæœ›åœ¨æœªæ¥æ›´å¤šåœ°é˜…è¯»æˆ‘çš„ä½œå“:)

å¦‚æœä½ å¯¹è¿™ç¯‡æ–‡ç« æœ‰ä»»ä½•ç–‘é—®ï¼Œæˆ–è€…æƒ³èŠèŠå¤©ï¼Œè¯·éšæ—¶è”ç³»æˆ‘çš„ç¤¾äº¤åª’ä½“è´¦å·

*æ¨ç‰¹â€”*[https://twitter.com/ChindaVibhor](https://twitter.com/ChindaVibhor)

*é¢†è‹±â€”*[*https://www.linkedin.com/in/vibhor-chinda-465927169/*](https://www.linkedin.com/in/vibhor-chinda-465927169/)

## æˆ‘ä»¥å‰å†™çš„æ–‡ç« :

[](/google-cloud/what-are-namespaces-in-kubernetes-d03c76a83d04) [## Kubernetes ä¸­çš„åç§°ç©ºé—´æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿ

### åç§°ç©ºé—´æ˜¯ Kubernetes å¯¹è±¡ï¼Œå®ƒå°†ä¸€ä¸ª Kubernetes é›†ç¾¤åˆ’åˆ†æˆå¤šä¸ªè™šæ‹Ÿé›†ç¾¤ã€‚åœ¨â€¦

medium.com](/google-cloud/what-are-namespaces-in-kubernetes-d03c76a83d04) [](https://faun.pub/kubernetes-object-deployments-1e09cd904963) [## Kubernetes å¯¹è±¡:â˜¸â˜¸éƒ¨ç½²

### Kubernetes ä¸­æœ‰å“ªäº›éƒ¨ç½²ï¼Ÿ

faun.pub](https://faun.pub/kubernetes-object-deployments-1e09cd904963) 

## å‚è€ƒ

[](https://kubernetes.io/docs/concepts/services-networking/service/) [## æœåŠ¡

### å°†è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„åº”ç”¨ç¨‹åºæš´éœ²åœ¨å•ä¸ªå¤–å‘ç«¯ç‚¹ä¹‹åï¼Œå³ä½¿å·¥ä½œè´Ÿè½½è¢«æ‹†åˆ†â€¦

kubernetes.io](https://kubernetes.io/docs/concepts/services-networking/service/) 

æˆ‘ä»ç„¶ä¼šç»§ç»­å‘è¡¨æ–°çš„æ–‡ç« ï¼Œæ¶µç›–æˆ‘æ­£åœ¨æ¢ç´¢çš„ä¸€ç³»åˆ—ä¸»é¢˜ã€‚

é‚£éƒ½æ˜¯ä¹¡äº²ä»¬ï¼ï¼æ¶‚é¸¦:))