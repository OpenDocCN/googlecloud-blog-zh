<html>
<head>
<title>Choosing Between GKE and Cloud Run</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GKE和云运行之间选择</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/choosing-between-gke-and-cloud-run-46f57b87035c?source=collection_archive---------0-----------------------#2022-02-08">https://medium.com/google-cloud/choosing-between-gke-and-cloud-run-46f57b87035c?source=collection_archive---------0-----------------------#2022-02-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="26a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你写了一个应用程序。而且，像2022年编写应用程序的许多开发者一样，你把所有代码都塞进了Docker容器。现在，您会问自己:我应该如何将它部署到GCP？</p><p id="16fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有很多方法可以在GCP上运行容器化的工作负载:在一个<a class="ae jd" href="https://cloud.google.com/compute" rel="noopener ugc nofollow" target="_blank">谷歌计算引擎</a> (GCE)实例上，可能由托管实例组(MIG)支持；<a class="ae jd" href="https://cloud.google.com/appengine/docs/flexible" rel="noopener ugc nofollow" target="_blank"> App引擎Flex</a>；在<a class="ae jd" href="https://cloud.google.com/run" rel="noopener ugc nofollow" target="_blank">云上运行</a>，运行容器的托管服务；或者——也许是最复杂的——在Google Kubernetes引擎(GKE)集群上。</p><p id="428c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了这篇博文的目的，让我们立即从列表中选择两个选项:App Engine和GCE。现在，我们把注意力集中在剩下的两项服务上，在GKE和云运行之间进行选择。那么如何选择呢？</p><h2 id="e6d0" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">没有错误的选择</h2><p id="8ff2" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">请允许我花一点时间对架构选择的现实发表意见，因为它与此相关。</p><p id="3499" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有糟糕的选择——至少没有糟糕的选择。我们已经从我们的列表中删除了几个，理由很充分:AppEngine，因为样板文件和结构级别更高，部分原因是它对编程语言和版本的支持有限(尽管支持自定义运行时环境)；和GCE来避免维护虚拟机操作系统的工作。</p><p id="deb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在大多数情况下，的独特优势和权衡会引导我们完成决策过程，这里的情况也是如此:GKE和Cloud Run是运行容器化应用程序的出色的生产就绪型服务。我们必须简单地根据它们的优点来评价它们。</p><p id="58c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从定义应用程序的需求开始。例如:</p><ul class=""><li id="7848" class="ke kf hi ih b ii ij im in iq kg iu kh iy ki jc kj kk kl km bi translated">容器的操作系统是什么？</li><li id="2727" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">我的申请包含多少个容器？</li><li id="2475" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">应用程序的CPU和内存需求是什么？</li><li id="524b" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">应用程序是无状态的还是有状态的(就底层运行时环境而言)？</li><li id="a4ff" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">应用程序是基于事件的吗？</li><li id="acb9" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">应用程序是同步还是异步响应事件？</li><li id="7cea" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">应用程序将处理什么样的事件？</li><li id="cc29" class="ke kf hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">我需要托管服务吗？</li></ul><p id="4b2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你能回答上面的问题，选择一个运行时是相当容易的！在这种情况下，选择的过程变得更简单，因为有一个服务比另一个服务更受限制，限制了它可以支持的用例的可能数量。</p><h2 id="083d" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">云运行</h2><p id="6b0f" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">虽然它是一个运行容器的非常简单的托管服务，但它是一个更有限的平台——也就是说，它支持最窄的用例集，因此是开始评估的好地方。一般来说，云运行对于同步的、事件驱动的应用程序和微服务非常有用。同步、事件驱动的应用程序的典型例子是web应用程序，但是Cloud Run也支持来自云任务等服务的异步事件。目前(截至2022年8月)，Cloud Run允许应用程序被许多不同的触发器调用:HTTP、gRPC、websockets、Eventarc、Pub/Sub、云调度程序和云任务。</p><h2 id="ad36" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">GKE</h2><p id="719e" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">GKE本质上是托管的、云原生的Kubernetes，一个用于容器的运行时和编排引擎，能够协调容器化的工作负载及其资源的部署。虽然Kubernetes非常能干，但它也很复杂。Kubernetes集群通常由控制平面和工作负载的许多节点组成，因此，在像Kubernetes这样庞大而复杂的系统上运行单个容器的工作负载可能是多余的。</p><p id="9645" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">值得一提的是，管理GKE的复杂性在一定程度上得到了缓解:具有<a class="ae jd" href="https://cloud.google.com/kubernetes-engine/docs/concepts/autopilot-overview" rel="noopener ugc nofollow" target="_blank"> Autopilot </a>的GKE转向了自动化的按需扩展模型，根据给定工作负载的请求资源自动添加和删除节点，使其类似于云运行。然而，即使有自动驾驶仪，你仍然必须写Kubernetes YAML文件部署到GKE与自动驾驶仪。</p><h1 id="41a9" class="ks jf hi bd jg kt ku kv jk kw kx ky jo kz la lb jr lc ld le ju lf lg lh jx li bi translated">决策矩阵</h1><p id="e298" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">对于简单的用例，这个简单的决策树可以帮助您在云运行和GKE之间进行选择。你可能还会发现谷歌简洁明了的<a class="ae jd" href="https://cloud.google.com/run/docs/fit-for-run" rel="noopener ugc nofollow" target="_blank"> <em class="lj">我的应用很适合云运行吗？</em> </a>文档页面相当有用。截至2022年8月的注意事项:下图有点过时，已经更新。Cloud Run现在最多可以支持<a class="ae jd" href="https://cloud.google.com/run/docs/configuring/cpu#setting" rel="noopener ugc nofollow" target="_blank"> 8个vcpu</a>和<a class="ae jd" href="https://cloud.google.com/run/docs/configuring/memory-limits#max" rel="noopener ugc nofollow" target="_blank"> 32 GB内存</a>。</p><figure class="ll lm ln lo fd lp er es paragraph-image"><div class="er es lk"><img src="../Images/d57b9f1b76e5d9cd863e9f87eb3146f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*TsQii6UIlFgeKw0vdPQ0Jw.png"/></div></figure></div></div>    
</body>
</html>