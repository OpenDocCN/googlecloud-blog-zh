<html>
<head>
<title>Configure Cloud DNS as global name resolution service in hybrid environment : GCP, On-premise and GCVE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在混合环境中将云DNS配置为全球域名解析服务:GCP、内部和GCVE</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/configure-cloud-dns-as-global-name-resolution-service-in-hybrid-environment-gcp-on-premise-and-6aee6d0e7e15?source=collection_archive---------2-----------------------#2022-11-16">https://medium.com/google-cloud/configure-cloud-dns-as-global-name-resolution-service-in-hybrid-environment-gcp-on-premise-and-6aee6d0e7e15?source=collection_archive---------2-----------------------#2022-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d8e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，许多企业都在采用混合基础架构运营模式，这种模式为企业提供按需可扩展性、灾难恢复，帮助他们满足安全性和法规遵从性需求，并且具有成本效益。</p><p id="53e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GCP提供计算引擎、Kubernetes引擎、应用引擎、BQ、GCVE和许多其他服务，帮助企业在云上无缝运行他们的应用程序。</p><p id="dd21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您计划将工作负载迁移到GCP和GCVE，那么您可以利用云DNS作为全球地址解析服务。它是高性能DNS服务，提供100%可用性SLA。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/22955eea9e2fe6e59e992cfe5213aa27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4y4WFt6hpnze-_5y5TIjQA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">云DNS作为全球域名解析服务</figcaption></figure><p id="5a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的想法是使用云DNS解决FQDN的GCP和GCVE工作负载，使用本地DNS服务器解决FQDN的本地工作负载。来自GCP和GCVE的任何解决FQDN本地工作负载的请求都应转发到本地DNS服务器，来自本地的任何解决FQDN GCP和GCVE工作负载的请求都应转发到云DNS。</p><h2 id="41d3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">配置步骤</strong></h2><p id="506e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">在主机项目中启用云DNS API，在您的网络(主机VPC)中创建一个专用区域，并添加GCP和GCVE工作负载的记录。</p><pre class="je jf jg jh fd kt ku kv bn kw kx bi"><span id="44d2" class="ky ju hi ku b be kz la l lb lc">gcloud dns managed-zones create NAME \<br/>    --description=DESCRIPTION \<br/>    --dns-name=DNS_SUFFIX \<br/>    --networks=VPC_NETWORK_LIST \<br/>    --labels=LABELS \<br/>    --visibility=private</span></pre><p id="dd2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要解决GCP和GCVE的本地工作负载FQDN，您需要在云DNS中设置出站转发，以将请求转发到本地DNS服务器。</p><pre class="je jf jg jh fd kt ku kv bn kw kx bi"><span id="a125" class="ky ju hi ku b be kz la l lb lc">gcloud dns managed-zones create NAME \<br/>    --description=DESCRIPTION \<br/>    --dns-name=DNS_SUFFIX \<br/>    --networks=VPC_NETWORK_LIST \<br/>    --forwarding-targets=FORWARDING_TARGETS_LIST \<br/>    --private-forwarding-targets=PRIVATE_FORWARDING_TARGETS_LIST \<br/>    --visibility=private</span></pre><p id="98de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许IP范围<strong class="ih hj"> 35.199。192.0/19 </strong>在本地防火墙上，支持云DNS将请求转发到本地DNS服务器。</p><p id="c4c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要从本地解决GCP和GCVE工作负载FQDN，请在云DNS中创建入站转发，以接受来自本地DNS服务器的请求。</p><pre class="je jf jg jh fd kt ku kv bn kw kx bi"><span id="6949" class="ky ju hi ku b be kz la l lb lc">gcloud dns policies create NAME \<br/>    --description=DESCRIPTION \<br/>    --networks=VPC_NETWORK_LIST \<br/>    --enable-inbound-forwarding</span></pre><p id="8a05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当入站服务器策略应用于网络时，云DNS会创建一组区域IP地址，作为本地转发器的目标。</p><pre class="je jf jg jh fd kt ku kv bn kw kx bi"><span id="dfdf" class="ky ju hi ku b be kz la l lb lc">gcloud compute addresses list \<br/>    --filter='purpose = "DNS_RESOLVER"' \<br/>    --format='csv(address, region, subnetwork)'</span></pre><p id="9dfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获取入站转发器入口点列表，并在本地DNS服务器上设置有条件的出站转发。《出埃及记》</p><pre class="je jf jg jh fd kt ku kv bn kw kx bi"><span id="1dea" class="ky ju hi ku b be kz la l lb lc">zone "mydomain.com" {<br/>    type forward;<br/>    forward only;<br/>    forwarders { list of IP addresses};<br/>};</span></pre><p id="14ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在GCVE中部署私有云时，会自动创建一个DNS对等区域。GCP和本地工作负载可以直接解决GCVE管理组件FQDN。您需要创建启用了导入/导出路由的私有服务访问，以便在GCP和GCVE之间建立连接。</p><p id="0611" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于GCVE工作负载，首先在云DNS中设置入站转发，并按照上述步骤获取入站转发器入口点列表，然后<a class="ae ld" href="https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.0/administration/GUID-A0172881-BB25-4992-A499-14F9BE3BE7F2.html" rel="noopener ugc nofollow" target="_blank">在VMware NSX中设置条件转发，将请求转发到云DNS </a>。</p><h2 id="3e4f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated"><strong class="ak">使用云DNS的优势</strong></h2><p id="28ee" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">云DNS提供了区域和策略的集中管理，并使问题的故障排除变得容易。</p><p id="05bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它是高性能DNS服务，提供<a class="ae ld" href="https://cloud.google.com/dns/sla" rel="noopener ugc nofollow" target="_blank"> 100%可用性SLA </a>。</p><p id="f0d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它支持托管DNSSEC，保护您的域免受欺骗和缓存中毒攻击。</p><p id="de8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它与Cloud IAM相集成，为网络管理员提供集中的身份验证和授权。</p></div></div>    
</body>
</html>