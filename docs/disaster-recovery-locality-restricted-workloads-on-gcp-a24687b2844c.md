# 灾难恢复—GCP 上受位置限制的工作负载

> 原文：<https://medium.com/google-cloud/disaster-recovery-locality-restricted-workloads-on-gcp-a24687b2844c?source=collection_archive---------10----------------------->

在 Google Cloud，客户数据的隐私和安全是我们提供的所有服务设计的基础。我们认识到，我们的全球客户基于其地区和行业特定的要求有特定的顾虑。这篇博客讨论了如何使用 Google Cloud 来设计灾难恢复(DR)以满足特定位置的需求。对于某些受监管的行业，工作负载必须符合这些要求。在这种情况下，以下一项或多项要求适用:

*   静态数据必须限制在特定的国家。
*   数据必须在其所在的国家进行处理。
*   只能从预定义的位置访问工作负载。
*   必须使用客户管理的密钥对数据进行加密。

# 术语

在开始为受位置限制的工作负载设计灾难恢复架构之前，最好先回顾一下 Google Cloud 中使用的位置术语。

谷歌云在整个美洲、欧洲和中东以及亚太地区的*个地区*提供服务。区域被进一步划分为*区域*，在那里你可以部署某些谷歌云*资源*，比如虚拟机、Kubernetes 集群或者云 SQL 数据库。Google Cloud 上的资源是多区域的、地区性的或区域性的。

GCP 上不同类型的资源有:

*   多区域资源被设计为冗余的，并且分布在区域内和跨区域。多区域资源可以抵御单个区域的失败。
*   区域资源被冗余地部署在一个区域中的多个区域上，并且对该区域内的一个区域的故障具有弹性。
*   区域资源在单个区域中运行。如果某个区域变得不可用，则该区域中的所有区域资源都不可用，直到服务恢复。将一个区域视为单一故障域。

# 为受位置限制的工作负载规划灾难恢复

## 定义您所在地区的要求

1.  **静态数据在哪里？**答案决定了您可以使用哪些服务，以及您可以采用哪些高可用性(HA)和灾难恢复方法来实现您的 RTO/RPO 值
2.  **您能否使用加密技术来降低需求？**如果您能够通过使用云外部密钥管理器和云密钥管理服务的加密技术来降低位置要求，那么您可以使用多区域和双区域服务，并遵循标准 HA/DR 技术。
3.  数据可以在存放数据的地方之外进行处理吗？您可以使用 [Anthos](https://cloud.google.com/anthos/docs/concepts/overview) 等产品来提供一个混合环境，以满足您的需求或实施特定于产品的控制，例如在一个区域的多个区域中对计算引擎实例进行负载平衡。使用组织策略资源位置约束来限制资源的部署位置。配置 VPC 安全控制边界，以控制谁可以访问数据，并限制哪些资源可以处理数据。
4.  **你需要限制谁可以访问你的应用吗？** Google Cloud 有几个产品和功能可以帮助您限制哪些人可以访问您的应用程序:

*   **身份感知代理。**验证用户的身份，然后决定是否允许该用户访问应用程序。
*   **特定于产品的位置控制。**参考您希望在您的架构中使用的每个产品，以获得适当的位置约束。例如，使用 Anthos 配置管理器将特定于位置的策略应用于 Anthos 管理的 GKE 集群。如果您使用云存储，请在指定区域创建存储桶。

在 Google Cloud，我们知道 Google Cloud 上的数据驻留、运营透明度和隐私是我们客户最关心的问题，我们致力于提供满足这些关键需求和偏好的工具，同时在 GCP 上设置受位置限制的工作负载。

# 数据存储和数据访问

Google Cloud 为您提供了控制数据存储位置的能力。我们的计算和存储服务允许您存储不同地区的客户数据。当您选择在这些位置配置资源时，Google 将只在选定的区域存储静态的客户数据。

Google Cloud 提供了组织策略约束，可以应用于组织、文件夹或项目级别。您可以使用组织策略服务资源位置约束来限制新资源的物理位置。结合云 IAM 配置，帮助您定义细粒度的访问策略并精确控制对 Google Cloud 托管数据的访问，您可以防止您的员工意外地将客户数据存储在错误的 Google Cloud 区域。

Google Cloud 还为您提供了控制网络位置的能力，用户可以通过使用 VPC 服务控件从这些位置访问数据。使用 VPC 服务控制，您可以创建一个服务边界，定义可以访问服务的虚拟边界，防止客户数据被移出这些边界。它还有助于降低风险，如员工访问控制的错误配置或攻击者利用受损帐户。

# 加密密钥管理

对于许多操作，您可能希望在 GCP 各地区之间传输数据。默认情况下，Google Cloud 启用传输加密来加密 Google 设施边界之外的区域间流量。默认情况下，Google Cloud 应用静态加密。为了更好地控制静态数据的加密方式，谷歌云客户可以使用我们的云密钥管理服务(云 KMS)根据客户自己的政策生成、使用、轮换和销毁加密密钥，这种控制我们称为客户管理的加密密钥(CMEK)。如果您使用的是云 KMS，您的加密密钥必须存储在您部署资源的区域中。您还可以选择使用我们的云硬件安全模块(HSM)服务将您的密钥存储在您选择的区域，该服务允许客户在 FIPS 140–2 3 级认证的 HSM 中托管加密密钥并执行加密操作。客户还可以为受支持的服务实施客户提供的加密密钥(CSEK ),以便 GCP 使用客户提供的密钥加密数据，并在客户请求的操作完成后从内存中清除提供的密钥。

# 云管理员访问

在 GCP 上，您可以配置云 IAM 权限来限制您自己的管理员的访问，在项目、文件夹或数据集级别管理适当的访问权限。这包括广泛的权限列表和授予这些权限的预定义角色。您也可以创建自己的自定义角色，其中包含您指定的权限。

# 合规控制和支持

由于我们的客户和监管机构期望对安全性、隐私和合规性控制进行独立验证，因此 Google Cloud 会定期接受几项独立的第三方审计，以提供这种保证。

我们接受审计的一些主要国际和欧洲标准是:

*   国际标准化组织/IEC 27001(信息安全管理)
*   ISO/IEC 27017(云安全)
*   ISO/IEC 27018(云隐私)
*   SOC 240 和 SOC 341 报告

我们也知道，像 GDPR 这样的法规非常重视让企业知道他们的数据是如何处理的，谁有权访问数据，以及如何管理安全事件。值得注意的是，遵守 GDPR 协议是一项共同的责任。谷歌云通常充当客户数据的数据处理器，作为数据处理器，我们只按照您——我们的客户——的指示处理数据。反过来，你拥有你的数据，谷歌云致力于为你提供工具和资源，让你控制你的数据。

# 结论

在 Google Cloud，我们努力让您清楚、详细地了解我们的安全流程和方法，从而赢得并保持您的信任。我们继续投资于数据隐私和安全创新，以预测我们客户的未来需求，以便他们今天就可以迁移到谷歌云，知道他们为未来做好了准备。