<html>
<head>
<title>Send content automatically via a Google Sheet and an Apps Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过谷歌表单和应用程序脚本自动发送内容</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/send-content-automatically-via-a-google-sheet-and-an-apps-script-c65d82284f5f?source=collection_archive---------0-----------------------#2019-08-20">https://medium.com/google-cloud/send-content-automatically-via-a-google-sheet-and-an-apps-script-c65d82284f5f?source=collection_archive---------0-----------------------#2019-08-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/70650f268aa350686ae710c8adf33c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/0*cLnfoIA3tof_a4PB"/></div><figcaption class="im in et er es io ip bd b be z dx translated">托管在<a class="ae iq" href="https://developers.google.com/gsuite/solutions/content-signup" rel="noopener ugc nofollow" target="_blank"> G套件解决方案库</a>上的解决方案</figcaption></figure><h1 id="f8b6" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">简要介绍</h1><p id="3db7" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">如此多的人能够<strong class="jr hj">在网上</strong>创造内容，如<em class="kn">白皮书、电子书、信息视频或博客；</em>围绕不同的话题。因此，在网站、电子邮件签名或即时消息中链接一个<strong class="jr hj">谷歌表单</strong>很方便，可以帮助人们<strong class="jr hj">请求你作为<strong class="jr hj">主题列表</strong>提供的资产</strong>，并让它们自动发送给他们。如果你在谷歌电子表格中添加一个<strong class="jr hj">应用程序脚本</strong>，它会在每次有人使用<strong class="jr hj">谷歌文档</strong>作为其<strong class="jr hj">模板</strong>提交表单和发送电子邮件时自动运行，这是可能的。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h1 id="37ce" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">目的</h1><p id="2449" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在本文中，我将带您了解:</p><ol class=""><li id="2c19" class="ku kv hi jr b js kw jw kx ka ky ke kz ki la km lb lc ld le bi translated">如何<strong class="jr hj">尝试</strong>上面提到的<strong class="jr hj"> Google Sheet、</strong>和<strong class="jr hj"> Apps脚本</strong>。</li><li id="35b9" class="ku kv hi jr b js lf jw lg ka lh ke li ki lj km lb lc ld le bi translated">如何<strong class="jr hj">随意定制</strong> 3件事:表单&amp;代码中的<strong class="jr hj">主题</strong>，邮件<strong class="jr hj">模板</strong>，代码中邮件的<strong class="jr hj">主题</strong>行。</li><li id="28ec" class="ku kv hi jr b js lf jw lg ka lh ke li ki lj km lb lc ld le bi translated">通过<strong class="jr hj">了解</strong>和<strong class="jr hj">代码</strong>和<strong class="jr hj">如何工作</strong>。</li></ol><h1 id="b6d3" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">尝试</h1><p id="81c7" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">1)复制一份<a class="ae iq" href="https://docs.google.com/spreadsheets/d/1vyv-QcQ0wgaGNV7XklZI1jq95Cg_QVBq-o4rhTJqg00/copy" rel="noopener ugc nofollow" target="_blank"><strong class="jr hj"/></a><strong class="jr hj"/>(在你的浏览器中)。它将自动包括一个谷歌表单和你需要的代码，即所谓的应用程序脚本。</p><p id="25a4" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">2)从您的电子表格中点击<strong class="jr hj">工具</strong> &gt; <strong class="jr hj">脚本编辑器</strong>。这将带您进入<em class="kn">应用程序脚本编辑器。</em></p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="497f" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">3)现在<em class="kn">点击<strong class="jr hj">“选择功能”</strong>下拉菜单&gt;选择<strong class="jr hj">“安装触发器”，运行脚本</strong></em>。然后点击运行按钮()。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="b2ee" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">4)当出现提示时，单击<strong class="jr hj">审查权限</strong>并单击<strong class="jr hj">允许</strong>以便脚本可以代表您发送电子邮件。</p><blockquote class="ln lo lp"><p id="bec1" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated">I <strong class="jr hj"/></p></blockquote><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="0534" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">5)授予权限后，将自动为您的工作表创建一个触发器。通过点击脚本编辑器中的<strong class="jr hj">触发器图标</strong>(看起来像一个时钟)暂时访问该触发器。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><blockquote class="ln lo lp"><p id="4762" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated"><strong class="jr hj"> <em class="hi">注意</em> </strong>:如果你多次运行这个脚本，它会生成<em class="hi">多个触发器</em>复制邮件。确保您只运行脚本一次，并且触发器页面上没有多个触发器。如果您不小心创建了更多，只需将鼠标悬停在每个点上并单击<strong class="jr hj"> 3个点</strong> <strong class="jr hj"> &gt; </strong>然后单击<strong class="jr hj">删除即可删除所有其他点。</strong></p></blockquote><p id="f063" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">5)授予权限后，<strong class="jr hj">将</strong>返回到您的<strong class="jr hj">电子表格</strong>并定位到<strong class="jr hj">表单</strong> &gt; <strong class="jr hj">进入实时表单。</strong>这将把你带到谷歌表单，当你分享它的链接时，人们会看到它。<em class="kn">填写</em>所有字段，<em class="kn">确保</em>使用您有权访问的<em class="kn">电子邮件地址</em>，点击<strong class="jr hj">提交</strong>。</p><blockquote class="ln lo lp"><p id="d5ea" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated"><em class="hi">注意:</em>确保输入您可以登录的电子邮件地址。电子邮件将包括您填写的姓名和主题。如果没有选择主题，将不会发送电子邮件。</p></blockquote><p id="f000" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">6)回到你的电子表格。您应该有一个输入了值的行。其中一个栏目叫<strong class="jr hj">确认，</strong>会说<strong class="jr hj">发送。</strong>这确认您在表格中选择的主题已通过电子邮件发送。</p><p id="a891" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">* *等等——我没有看到数据进入我的电子表格，现在该怎么办？</p><blockquote class="ln lo lp"><p id="c6ac" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated"><strong class="jr hj">注意</strong>:如果你<strong class="jr hj">在你的工作表</strong>中没有看到数据，这意味着表格<em class="hi">可能需要重新链接</em> <strong class="jr hj"> <em class="hi">全部是</em> </strong>，所以从你的电子表格中点击<strong class="jr hj">表格</strong> &gt; <strong class="jr hj">进入实时表格。</strong>在表单上，点击<strong class="jr hj">右上角</strong>的<strong class="jr hj">铅笔图标</strong>进入编辑模式。然后点击<strong class="jr hj">响应</strong>选项卡&gt; <strong class="jr hj"> 3点</strong> &gt; <strong class="jr hj">解除链接</strong> <strong class="jr hj">表格</strong> &gt; <strong class="jr hj">确认</strong>动作解除链接。然后点击<strong class="jr hj"> 3点</strong>再点一次&gt; <strong class="jr hj">选择响应目的地</strong> &gt; <strong class="jr hj">选择已有的电子表格</strong> &gt;从驱动器文件中选择弹出的第一个名为<strong class="jr hj">的文件复制(自动复制w/ sheet)表格接收内容</strong> &gt; <strong class="jr hj">选择</strong>。返回电子表格并访问第一个选项卡(创建了一个名为<strong class="jr hj">表单响应2 </strong>的新表)，然后单击<strong class="jr hj">表单</strong> &gt; <strong class="jr hj">从<strong class="jr hj">表单响应2 </strong>转到实时表单</strong>——您的响应应该会立即显示在那里。</p></blockquote><p id="269e" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">7)最后，<strong class="jr hj">登录到您在表单条目中提供的电子邮件</strong>帐户，看看您是否收到了主题行为:<strong class="jr hj">“Howdy”</strong>，邮件正文类似于<a class="ae iq" href="https://docs.google.com/document/d/1HGXj6551jxUqFqxsuYMWovI0_nypSUPIdlc-RXf2pHE/edit#heading=h.t48vj9f6fmak" rel="noopener ugc nofollow" target="_blank"> <strong class="jr hj">这个Google Doc的模板</strong> </a>的电子邮件。</p><h1 id="1fac" class="ir is hi bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo bi translated">选择性地自定义您的脚本</h1><p id="3eda" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><em class="kn"> 1)【可选】</em>发出的电子邮件来自已经设置好的谷歌文档模板。但是，如果您希望自定义该模板，您可以通过<a class="ae iq" href="https://docs.google.com/document/d/1HGXj6551jxUqFqxsuYMWovI0_nypSUPIdlc-RXf2pHE/copy" rel="noopener ugc nofollow" target="_blank">单击此链接</a>制作自己的副本，并将权限设置为<em class="kn">任何人</em>均可查看，除非您的受众是您组织内的人员，请将权限设置为<em class="kn">您组织内的任何人</em>。然后从<em class="kn">浏览器</em>中复制其<em class="kn"> URL地址</em>，并替换脚本代码中<code class="du lt lu lv lw b">EMAIL_TEMPLATE_DOC_URL</code>变量中的URL。</p><blockquote class="ln lo lp"><p id="fc98" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated">注意:Google文档中的{{NAME}}和{{TOPICS}}是占位符，用于插入用户提交表单时选择的主题的名称和内容链接。</p></blockquote><p id="0ffe" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated"><em class="kn"> 2)【可选】</em>如果你想改变你邮件的主题行，替换脚本代码中<code class="du lt lu lv lw b">EMAIL_SUBJECT</code>变量中的文本。</p><p id="710c" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated"><em class="kn"> 3)【可选】</em>如果您希望重命名表单中的主题，在更改它们时，也将新的主题名称粘贴到脚本代码中的<code class="du lt lu lv lw b">topicUrls</code>变量中。</p><blockquote class="ln lo lp"><p id="cbf7" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated"><em class="hi">注意:</em>当<em class="hi">重命名</em>表单中的主题时，确保也在代码中粘贴准确的<em class="hi">主题名称</em>。确保该单词包含在表单的选项中。例如:如果你在表格中将“(营养)纯素食食谱”重命名为“(正念)学习如何在忙碌的世界中冥想”，请确保返回<code class="du lt lu lv lw b">topicUrls</code>变量，并将“营养”替换为“正念”+ <em class="hi">你希望人们收到的链接</em></p></blockquote></div><div class="ab cl lx ly gp lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hb hc hd he hf"><h1 id="5cbd" class="ir is hi bd it iu me iw ix iy mf ja jb jc mg je jf jg mh ji jj jk mi jm jn jo bi translated">代码如何工作</h1><p id="2e92" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">这个解决方案大约。106行代码，包括所有注释:)如果您希望查看整个代码，您可以在此处找到<a class="ae iq" href="https://script.google.com/d/MKmrKMpnw3BTz7ncMEJkDw48neP9a5n81/edit?mid=ACjPJvEho9Nbd6Bl9WdAb9PAA-67V_vdpLpuaDrH42y5sWdyWKmYuUWQfNXQ7IKyU6NfCN4bA57QLWQ5FDo8Sj-iBT5qHCWirEN4KLCEwBCohbqi9DAfWWrH4ZPMhoFXKBwcuSUutrMPxdg&amp;uiv=2" rel="noopener ugc nofollow" target="_blank"/>(或者在前面提到的表格中，如果单击<strong class="jr hj">工具</strong> &gt; <strong class="jr hj">脚本编辑器</strong>)。</p><p id="9534" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated"><strong class="jr hj">第一行通过获取表单中提供的<strong class="jr hj"> URL </strong>、<strong class="jr hj">电子邮件主题</strong>和<strong class="jr hj">主题</strong>及其各自的链接来设置</strong>Google Doc模板。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mj"><img src="../Images/e6d0586013d394094ed16ff5d587df57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRlqMCZS6wjJ1dhkA7dx0A.png"/></div></div></figure><p id="fe0b" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">接下来的几行描述了一个名为`<strong class="jr hj"> installTrigger` </strong>的函数。在应用程序脚本编辑器中运行该函数后，它会自动在应用程序脚本项目中创建一个触发器，该触发器会在用户提交响应时，安排<strong class="jr hj">在其下方运行另一个名为`<strong class="jr hj"> onFormSubmit` </strong>的函数</strong>。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mo"><img src="../Images/19b8ef407d04447a2189f22db2c1d7dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gJacrZa2XuNWir4ae0t5AQ.png"/></div></div></figure><p id="f76c" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated"><strong class="jr hj"> `onFormSubmit` </strong>是一个<strong class="jr hj">函数</strong>，当<strong class="jr hj">用户提交响应</strong>时被调用。当它被调用时，它接收一个事件对象，该对象包含一些细节，比如表单中最近提交的响应、它们在电子表格中的行号等等。注意trim方法用于<strong class="jr hj">删除用户可能意外进入表单的多余空格</strong>。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/273ea21c1adf1c15bcbd52c251a37009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*6Kx1D9zhPhmoWQe4eFMzUQ.png"/></div></figure><p id="6413" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">声明了一个名为topics的变量，它将<strong class="jr hj">检查主题，</strong>如果<strong class="jr hj">有，</strong>被表单提交者<strong class="jr hj">使用for循环</strong>选择。如果<strong class="jr hj">没有主题</strong>被<strong class="jr hj">选择</strong>，则<strong class="jr hj">不会将任何项目</strong>推送到该<strong class="jr hj">变量的列表</strong>，从而阻止下一步发送电子邮件。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/6de5a92cc3ce5aac13df9394161bbdd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*0P1LB8Fz6d5KkGC1rO5C5w.png"/></div></figure><p id="df2e" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">如果选择了<strong class="jr hj">主题</strong>(索引为<em class="kn">大于0 </em>)，那么<strong class="jr hj">电子邮件</strong>将<strong class="jr hj">发送到</strong>，使用的是表格中的地址<strong class="jr hj">和变量`<strong class="jr hj"> emailSubject` </strong>中脚本开头列出的<strong class="jr hj">主题行</strong>。电子邮件的<strong class="jr hj">正文</strong>由一个名为`<strong class="jr hj"> htmlBody` </strong>的变量组成，我们稍后会谈到这个变量。还要注意，当选择主题时，名为`<strong class="jr hj"> status` </strong>的变量存储了关于电子邮件是否已`<strong class="jr hj">发送`</strong>或者是否因为最后没有`<strong class="jr hj">选择主题`</strong>而没有发送电子邮件<strong class="jr hj">的信息。</strong></strong></p><p id="3b51" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated"><strong class="jr hj"> `MailApp` </strong>是一个应用程序脚本<strong class="jr hj">类</strong>，它包含一个名为`<strong class="jr hj">sendmail`</strong>的静态方法，该方法就是这么做的。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/b62c4ee9c5b40736387b12336a39480e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*kUncAu32_gfGPPEhN45nLA.png"/></div></figure><p id="f831" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">这里我们创建一个名为`<strong class="jr hj"> sheet` </strong>的变量，它使用一个名为getActiveSheet的方法来定位您所在的响应表。名为<strong class="jr hj"> row </strong> <strong class="jr hj">的变量定位<strong class="jr hj">新响应</strong>的行</strong>，以便<strong class="jr hj">确保</strong>只处理<strong class="jr hj">该新行</strong>，而<strong class="jr hj">不处理整个电子表格</strong>，否则一旦有<strong class="jr hj">数百个响应</strong>，就会使<strong class="jr hj">大大降低脚本</strong>的速度。变量`<strong class="jr hj"> column` </strong>检查以查看<strong class="jr hj">新响应</strong>的<strong class="jr hj">列位置</strong>是什么，并且<strong class="jr hj">将该数字</strong>加“1 ”,以便定位最近的空列来写入状态。名为status的变量填充同一行的空单元格，以显示是否发送了电子邮件。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es ms"><img src="../Images/1ae7729e54cba260d2361e74000d95a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*M5-WZemOo68US4TtvNhPRQ.png"/></div></div></figure><p id="623e" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">为了<strong class="jr hj">调试的目的</strong>，我们使用<a class="ae iq" href="https://developers.google.com/apps-script/guides/logging" rel="noopener ugc nofollow" target="_blank"> `Logger.log </a>，这是一个Apps脚本类，包含一个日志函数，帮助查看处理的<strong class="jr hj">响应</strong>，以及当您在脚本编辑器中点击<strong class="jr hj">查看&gt;日志</strong>时<strong class="jr hj">是否发送了一封电子邮件</strong>。</p><p id="ae78" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">下一个名为`<strong class="jr hj"> createEmailBody` </strong>的函数表示<strong class="jr hj"> HTML </strong>中的<strong class="jr hj">主题</strong>列表，并使用我之前提到的名为`<strong class="jr hj"> topicsHTML` </strong>的变量来<strong class="jr hj">创建一个列表</strong>(以项目符号形式),其中包含主题名称及其各自的嵌入了的<strong class="jr hj">超链接，以便读者可以点击列出的每个项目并找到内容。</strong></p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/d2d4f832e1f1d4191498cde7fbd3a410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*UV_SHHQVCHj513pn7LSCtQ.png"/></div></figure><p id="fdee" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">变量<strong class="jr hj"> emailBody </strong>中的<strong class="jr hj">波形占位符</strong>称为<strong class="jr hj"> {{NAME}} </strong>和<strong class="jr hj"> {{TOPICS}} </strong>被<strong class="jr hj">替换为<strong class="jr hj">信息</strong> <strong class="jr hj">输入到<strong class="jr hj"> Google Doc </strong>中的表单中作为<strong class="jr hj">模板</strong>(我们将它的URL粘贴在脚本up的第一行</strong></strong></p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mu"><img src="../Images/5fb1ad1159e23b8d365ff826d309d99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hyOmi5OKRDkAzlshhqhdGw.png"/></div></div></figure><p id="20fe" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">最后，docToHtml函数帮助将<strong class="jr hj">谷歌文档模板</strong>下载到邮件正文中。我们<strong class="jr hj">使用UrlFetchApp应用程序脚本库通过<strong class="jr hj"> REST API </strong>获取文档</strong>。</p><p id="c515" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">我们需要通过<strong class="jr hj"> OAuth2.0 </strong>使用<strong class="jr hj">驱动范围权限</strong>进行授权。<strong class="jr hj">认证</strong>通常是一个<strong class="jr hj">繁琐的</strong>过程，但值得庆幸的是<strong class="jr hj"> Apps脚本</strong>为我们提供了ScriptApp.getOAuthToken() <strong class="jr hj">函数</strong>来做到这一点，但我们还需要一定的<strong class="jr hj">范围权限</strong>用于驱动、电子邮件等。我们通过<strong class="jr hj">将</strong>范围添加到<strong class="jr hj"> manifest fil </strong> e来设置这些，它是一个<strong class="jr hj"> JSON </strong>文件，指定了关于项目的基本信息。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mv"><img src="../Images/fed2b374c614d3e053a59bb8c28a4ea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kCQobXOMLJgB1Oy9yy5kQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">清单文件</figcaption></figure><blockquote class="ln lo lp"><p id="fc44" class="jp jq kn jr b js kw ju jv jw kx jy jz lq lk kc kd lr ll kg kh ls lm kk kl km hb bi translated">注意:你可以从脚本编辑器的工作表中选择<strong class="jr hj">视图</strong> &gt; <strong class="jr hj">显示清单文件。</strong></p></blockquote><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/9a1090d2aa3753d38adff88b833a1ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*ouJXfqLNaaQsVnX-z5WWWw.png"/></div></figure></div><div class="ab cl lx ly gp lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hb hc hd he hf"><p id="8366" class="pw-post-body-paragraph jp jq hi jr b js kw ju jv jw kx jy jz ka lk kc kd ke ll kg kh ki lm kk kl km hb bi translated">下一步是什么？从我们的<a class="ae iq" href="https://developers.google.com/gsuite/solutions" rel="noopener ugc nofollow" target="_blank"> G套件解决方案库</a>查看更多您可以使用的解决方案。</p></div></div>    
</body>
</html>