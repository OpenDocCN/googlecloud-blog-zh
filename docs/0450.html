<html>
<head>
<title>Getting started with Google App Engine and Spring Boot in 5 steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过5个步骤开始使用谷歌应用引擎和Spring Boot</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/getting-started-with-google-app-engine-and-spring-boot-in-5-steps-2d0f8165c89?source=collection_archive---------0-----------------------#2017-12-04">https://medium.com/google-cloud/getting-started-with-google-app-engine-and-spring-boot-in-5-steps-2d0f8165c89?source=collection_archive---------0-----------------------#2017-12-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2622" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌云平台(GCP)为开发者构建和部署应用到谷歌应用引擎提供了良好的集成工具。这里有一个教程，可以让你使用Maven通过5个步骤在App Engine上设置和部署你的Spring Boot应用程序。</p><p id="1b43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请给我留下您的任何意见或问题，我会尽力回答。编码快乐！！！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/529be1f3544d153d4ab05968a54a2ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*wBVk5S3Rsjwh2CwNV14yOA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">运行在谷歌应用引擎上的Spring Boot</figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><ol class=""><li id="8cdf" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">基础知识和工具(您需要的)</li></ol><ul class=""><li id="8ea2" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">谷歌云平台帐户，并基本熟悉GCP控制台。</li><li id="5504" class="jw jx hi ih b ii kg im kh iq ki iu kj iy kk jc kf kc kd ke bi translated">Java，Spring Boot，Maven安装在你的机器上。</li><li id="fdbf" class="jw jx hi ih b ii kg im kh iq ki iu kj iy kk jc kf kc kd ke bi translated">GCloud SDK安装在本地计算机上，并进行初始化。</li></ul><p id="8769" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.构建您的基本Spring Boot应用程序</p><ul class=""><li id="1dc5" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">前往<a class="ae kl" href="https://start.spring.io/" rel="noopener ugc nofollow" target="_blank">https://start.spring.io/</a>配置您的Spring Boot项目并下载Maven项目模板。</li><li id="eda6" class="jw jx hi ih b ii kg im kh iq ki iu kj iy kk jc kf kc kd ke bi translated">确保选择Java版本= 8，打包= war，依赖项= Web。本教程使用Group = com.example和Artifact = Name = HelloAppEngine。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es km"><img src="../Images/ae57acd7d0046b05215c260da3935bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*INFku8B3OxoWvnaE9AZ65w.png"/></div></div></figure><ul class=""><li id="4c27" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">您将下载一个zip文件到您的本地计算机，然后解压缩它。在本教程中，解压后你将拥有HelloAppEngine文件夹。</li><li id="7f8a" class="jw jx hi ih b ii kg im kh iq ki iu kj iy kk jc kf kc kd ke bi translated">将文件夹更改为HelloAppEngine，然后编辑HelloAppEngineApplication.java以添加一个新的控制器来返回“你好，Spring Boot！”消息。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="ed6d" class="kw kx hi ks b fi ky kz l la lb">$vi src/main/java/com/example/HelloAppEngine/HelloAppEngineApplication.java</span></pre><ul class=""><li id="a31d" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">用以下内容替换HelloAppEngineApplication.java。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="0ee2" class="kw kx hi ks b fi ky kz l la lb">package com.example.HelloAppEngine;</span><span id="4481" class="kw kx hi ks b fi lc kz l la lb">import org.springframework.boot.SpringApplication;<br/>import org.springframework.boot.autoconfigure.SpringBootApplication;<br/>import org.springframework.web.bind.annotation.*;</span><span id="bd36" class="kw kx hi ks b fi lc kz l la lb"><a class="ae kl" href="http://twitter.com/SpringBootApplicatio" rel="noopener ugc nofollow" target="_blank">@SpringBootApplicatio</a>n<br/><a class="ae kl" href="http://twitter.com/RestController" rel="noopener ugc nofollow" target="_blank">@RestController</a><br/>public class HelloAppEngineApplication {</span><span id="a0b7" class="kw kx hi ks b fi lc kz l la lb">public static void main(String[] args) {<br/>                SpringApplication.run(HelloAppEngineApplication.class, args);<br/>        }</span><span id="2edd" class="kw kx hi ks b fi lc kz l la lb"><a class="ae kl" href="http://twitter.com/GetMapping" rel="noopener ugc nofollow" target="_blank">@GetMapping</a>("/")<br/>        public String hello() {<br/>                return "Hello Spring Boot!";<br/>        }<br/>}</span></pre><ul class=""><li id="8c24" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">运行HelloAppEngine Spring Boot应用程序。然后将本地浏览器指向<a class="ae kl" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a></li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="5663" class="kw kx hi ks b fi ky kz l la lb">cd HelloAppEngine<br/>mvn spring-boot:run</span></pre><ul class=""><li id="8de1" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">您应该会看到您的第一条“你好，Spring Boot”消息。现在，您的Spring Boot应用程序已经在本地运行了。退出应用程序并进入下一步。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ld"><img src="../Images/c95b139dadf9076516a80ec2419ad520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdjUzQnR-a5u-J-yizOmQw.png"/></div></div></figure><p id="8e48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.使您的应用程序与App Engine兼容</p><p id="6ed6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一步将涉及修改Maven插件和编辑pom.xml的一些部分，以便该项目与谷歌应用引擎环境兼容。</p><ul class=""><li id="e683" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">打开pom.xml进行编辑。删除spring-boot-starter-tomcat，并根据提供的内容添加javax.servlet-api依赖项。这是因为谷歌应用引擎使用Jetty，而默认的Spring Boot使用Tomcat。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="b706" class="kw kx hi ks b fi ky kz l la lb">&lt;dependencies&gt;</span><span id="ea31" class="kw kx hi ks b fi lc kz l la lb">   &lt;!-- Remove spring-boot-starter-tomcat dependency <br/>  &lt;dependency&gt;<br/>       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>       &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;<br/>       &lt;scope&gt;provided&lt;/scope&gt;<br/>  &lt;/dependency&gt;<br/>  --&gt;</span><span id="4397" class="kw kx hi ks b fi lc kz l la lb">   &lt;!-- add following dependency under dependencies section --&gt;<br/>   &lt;dependency&gt;<br/>       &lt;groupId&gt;javax.servlet&lt;/groupId&gt;<br/>       &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;<br/>       &lt;version&gt;3.1.0&lt;/version&gt;<br/>       &lt;scope&gt;provided&lt;/scope&gt;<br/>   &lt;/dependency&gt;</span><span id="e6f1" class="kw kx hi ks b fi lc kz l la lb">   &lt;dependency&gt;<br/>       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>       &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;<br/>       &lt;scope&gt;test&lt;/scope&gt;<br/>  &lt;/dependency&gt;</span><span id="8a94" class="kw kx hi ks b fi lc kz l la lb">&lt;/dependencies&gt;</span></pre><ul class=""><li id="07ed" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">添加Maven应用引擎插件</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="a513" class="kw kx hi ks b fi ky kz l la lb">&lt;plugins&gt;<br/>    &lt;!-- add appengine-maven-plugin --&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;com.google.cloud.tools&lt;/groupId&gt;<br/>                &lt;artifactId&gt;appengine-maven-plugin&lt;/artifactId&gt;<br/>                &lt;version&gt;1.3.1&lt;/version&gt;<br/>            &lt;/plugin&gt;<br/>&lt;/plugins&gt;</span></pre><ul class=""><li id="b3dc" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">为部署描述符添加appengine_web.xml。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="7aed" class="kw kx hi ks b fi ky kz l la lb">$ mkdir -p src/main/webapp/WEB-INF/<br/>$ touch src/main/webapp/WEB-INF/appengine-web.xml</span></pre><ul class=""><li id="5ca0" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">将以下上下文添加到appengine-web.xml。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="b4dd" class="kw kx hi ks b fi ky kz l la lb">&lt;appengine-web-app &gt;<br/>  &lt;version&gt;1&lt;/version&gt;<br/>  &lt;threadsafe&gt;true&lt;/threadsafe&gt;<br/>  &lt;runtime&gt;java8&lt;/runtime&gt;<br/>&lt;/appengine-web-app&gt;</span></pre><ul class=""><li id="e63f" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">使用App Engine插件运行您的应用程序。将您的浏览器指向<a class="ae kl" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>，然后您应该会看到默认的Spring Boot页面，就像之前使用Spring Boot插件的步骤一样，但是这次它运行在App Engine本地服务器上。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="89f6" class="kw kx hi ks b fi ky kz l la lb">$ mvn appengine:run</span></pre><p id="80d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.部署到谷歌云</p><p id="5636" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本节将带您在GCP上创建应用程序引擎，并向其部署您的应用程序。所有命令都使用安装在您本地机器上的GCloud SDK，并且已经初始化为您的GCP帐户。</p><ul class=""><li id="cd5a" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">通过console.cloud.google.com在GCP创建您的项目。本教程的项目id为“<strong class="ih hj"> spring-boot-187904 </strong>”。在学习本教程时，您应该参考您的项目id。</li><li id="2f1b" class="jw jx hi ih b ii kg im kh iq ki iu kj iy kk jc kf kc kd ke bi translated">设置项目参数，使用GCloud sdk创建app engine app。确保用您的项目id替换“<strong class="ih hj"> spring-boot-187904 </strong>”。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="59f7" class="kw kx hi ks b fi ky kz l la lb">$ <strong class="ks hj">gcloud config set project spring-boot-187904</strong></span><span id="b6ee" class="kw kx hi ks b fi lc kz l la lb">Updated property [core/project].</span><span id="f41d" class="kw kx hi ks b fi lc kz l la lb">$ <strong class="ks hj">gcloud app create --region us-central</strong><br/>You are creating an app for project [spring-boot-187904].<br/>WARNING: Creating an App Engine application for a project is irreversible and the region<br/>cannot be changed. More information about regions is at<br/>&lt;<a class="ae kl" href="https://cloud.google.com/appengine/docs/locations" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/appengine/docs/locations</a>&gt;.</span><span id="ca0f" class="kw kx hi ks b fi lc kz l la lb">Creating App Engine application in project [spring-boot-187904] and region [us-central]....done.                       <br/>Success! The app is now created. Please use `gcloud app deploy` to deploy your first app.</span></pre><ul class=""><li id="58df" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">使用Maven和App Engine插件将您的应用程序部署到Google App Engine (GAE)</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="e920" class="kw kx hi ks b fi ky kz l la lb">$ mvn <strong class="ks hj">appengine:deploy</strong></span><span id="12c6" class="kw kx hi ks b fi lc kz l la lb">...<br/>#============================================================#<br/>[INFO] GCLOUD: File upload done.<br/>[INFO] GCLOUD: Updating service [default]...<br/>[INFO] GCLOUD: ..............done.<br/>[INFO] GCLOUD: Updating service [default]...<br/>[INFO] GCLOUD: Waiting for operation [apps/spring-boot-187904/operations/64bc4dfd-5fff-4279-bb7f-b6fe2fbb7206] to complete...<br/>[INFO] GCLOUD: ..............done.<br/>[INFO] GCLOUD: done.<br/>[INFO] GCLOUD: Deployed service [default] to [<a class="ae kl" href="https://spring-boot-187904.appspot.com" rel="noopener ugc nofollow" target="_blank">https://spring-boot-187904.appspot.com</a>]<br/>[INFO] GCLOUD: <br/>[INFO] GCLOUD: You can stream logs from the command line by running:<br/>[INFO] GCLOUD:   $ gcloud app logs tail -s default<br/>[INFO] GCLOUD: <br/>[INFO] GCLOUD: To view your application in the web browser run:<br/>[INFO] GCLOUD:   $ gcloud app browse<br/>[INFO] -------------------------------------------------------------<br/>[INFO] BUILD SUCCESS<br/>[INFO] -------------------------------------------------------------<br/>[INFO] Total time: 44.212 s<br/>[INFO] Finished at: 2017-12-03T21:20:31-08:00<br/>[INFO] Final Memory: 33M/246M<br/>[INFO] -------------------------------------------------------------</span></pre><ul class=""><li id="5aae" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">使用浏览器转到[YOUR_PROJECT_ID].appspot.com以访问您的Spring Boot应用程序。您应该会看到默认页面，就像在本地机器上一样。恭喜你，你现在已经可以在GAE上运行你的应用了。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/f8987add1002964fe444448ffa7c0149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aj9qxEtjSRCXymNBCPhkg.png"/></div></div></figure><p id="a50a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.向你的应用添加更多功能并进行更新</p><p id="ea59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一节中，我们将在您的应用程序中添加一些特性，并将其重新部署到GAE。</p><ul class=""><li id="4964" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">向应用程序添加更多控制器和端点。让我们修改默认消息并添加一个时间服务。将以下内容替换为HelloAppEngineApplication.java文件。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="80e1" class="kw kx hi ks b fi ky kz l la lb">package com.example.HelloAppEngine;</span><span id="4226" class="kw kx hi ks b fi lc kz l la lb">import org.springframework.boot.SpringApplication;<br/>import org.springframework.boot.autoconfigure.SpringBootApplication;<br/>import org.springframework.web.bind.annotation.*;</span><span id="22eb" class="kw kx hi ks b fi lc kz l la lb">import java.util.Calendar;<br/>import java.util.Date;</span><span id="7c4b" class="kw kx hi ks b fi lc kz l la lb"><a class="ae kl" href="http://twitter.com/SpringBootApplicatio" rel="noopener ugc nofollow" target="_blank">@SpringBootApplicatio</a>n<br/><a class="ae kl" href="http://twitter.com/RestController" rel="noopener ugc nofollow" target="_blank">@RestController</a><br/>public class HelloAppEngineApplication {</span><span id="3a0d" class="kw kx hi ks b fi lc kz l la lb">public static void main(String[] args) {<br/>                SpringApplication.run(<br/>                           HelloAppEngineApplication.class, args);<br/>        }</span><span id="03fa" class="kw kx hi ks b fi lc kz l la lb"><a class="ae kl" href="http://twitter.com/GetMapping" rel="noopener ugc nofollow" target="_blank">@GetMapping</a>("/")<br/>        public String hello() {<br/>                return "Hello Spring Boot, I'm on App Engine!!!";<br/>        }</span><span id="b547" class="kw kx hi ks b fi lc kz l la lb"><a class="ae kl" href="http://twitter.com/GetMapping" rel="noopener ugc nofollow" target="_blank">@GetMapping</a>("/time")<br/>        public String time() {<br/>                return Calendar.getInstance().getTime().toString();<br/>        }<br/>}</span></pre><ul class=""><li id="d9a1" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">运行它的本地应用引擎插件，并用浏览器测试。你应该看看时间服务。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="f26f" class="kw kx hi ks b fi ky kz l la lb">$ mvn appengine:run</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/f891a9b66fce2a6f752875f70bbbdc08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81YR-Xici7BiddrgUW46TQ.png"/></div></div></figure><ul class=""><li id="511f" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">使用与上一步相同的Maven appengine插件将新版本部署到App Engine。使用浏览器并转到[YOUR_PROJECT_ID].appspot.com，然后您应该会看到一条新消息。请转到[YOUR _ PROJECT _ ID]。app spot . com/time会给您提供当前时间信息。</li></ul><pre class="je jf jg jh fd kr ks kt ku aw kv bi"><span id="452e" class="kw kx hi ks b fi ky kz l la lb">$ mvn <strong class="ks hj">appengine:deploy</strong></span><span id="6c57" class="kw kx hi ks b fi lc kz l la lb">...<br/>#============================================================#<br/>[INFO] GCLOUD: File upload done.<br/>[INFO] GCLOUD: Updating service [default]...<br/>[INFO] GCLOUD: ........done.<br/>[INFO] GCLOUD: Updating service [default]...<br/>[INFO] GCLOUD: Waiting for operation [apps/spring-boot-187904/operations/87ebf5c8-6b33-4806-8342-afa79cf5caef] to complete...<br/>[INFO] GCLOUD: .............done.<br/>[INFO] GCLOUD: .done.<br/>[INFO] GCLOUD: Deployed service [default] to [<a class="ae kl" href="https://spring-boot-187904.appspot.com" rel="noopener ugc nofollow" target="_blank">https://spring-boot-187904.appspot.com</a>]<br/>[INFO] GCLOUD: <br/>[INFO] GCLOUD: You can stream logs from the command line by running:<br/>[INFO] GCLOUD:   $ gcloud app logs tail -s default<br/>[INFO] GCLOUD: <br/>[INFO] GCLOUD: To view your application in the web browser run:<br/>[INFO] GCLOUD:   $ gcloud app browse<br/>[INFO] -------------------------------------------------------------<br/>[INFO] BUILD SUCCESS<br/>[INFO] -------------------------------------------------------------<br/>[INFO] Total time: 01:02 min<br/>[INFO] Finished at: 2017-12-03T21:53:41-08:00<br/>[INFO] Final Memory: 30M/214M<br/>[INFO] -------------------------------------------------------------</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es le"><img src="../Images/892e73f2851ede8e2655155590ad18c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTRmS9TqHIL8kJuOHCp0UA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lf"><img src="../Images/44e0c859e830b3971baeea74c49f9caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XPAF7aInjmV3vKvj_b0RTA.png"/></div></div></figure><ul class=""><li id="a697" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kf kc kd ke bi translated">恭喜你！现在，您已经构建了应用程序，部署并更新了Google App Engine。</li></ul></div></div>    
</body>
</html>