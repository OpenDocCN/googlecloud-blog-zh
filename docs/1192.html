<html>
<head>
<title>Improving Machine Translation with the Google Translation API Advanced</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Google翻译API Advanced改进机器翻译</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/improving-machine-translation-with-the-google-translation-v3-api-9dc2676e7fb9?source=collection_archive---------0-----------------------#2019-11-05">https://medium.com/google-cloud/improving-machine-translation-with-the-google-translation-v3-api-9dc2676e7fb9?source=collection_archive---------0-----------------------#2019-11-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/5e5ba6c830a77b825bdf15d3da15edd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fuNcvHBXiRbTy7_u.jpg"/></div></div></figure><div class=""/><p id="510d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Google的新翻译API Advanced (v3)是什么，你如何使用它来改进机器翻译？</p><p id="078b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你曾经在谷歌搜索中键入“你如何用Y语言说X ”,你可能会遇到<a class="ae jp" href="https://translate.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌翻译</a>——这是一个让你翻译文本、PDF文档或语言之间的语音的功能:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jq"><img src="../Images/499301cdc8b2f39590fca7069b02ea1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtPyhizbCDrpW8ppFGsibA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">你可以通过搜索使用谷歌的翻译模型(如上)，在翻译应用程序中，或者在你的<em class="jz">自己的</em>应用程序中使用谷歌云翻译API。</figcaption></figure><p id="4470" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jp" href="https://cloud.google.com/translate/" rel="noopener ugc nofollow" target="_blank">云翻译API </a>是谷歌的API等价物，可以让你在应用程序中构建翻译。如果你想，比如说，让你的应用程序在世界范围内以多种语言自动使用，这是非常有用的。您可以通过REST端点调用Translate API，或者通过Python、Javascript、Java、Go等语言的库连接到它。</p><p id="0491" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于许多应用程序来说，API是一种快速获得本地化的好方法，尤其是对于一般用户生成的内容(想想博客帖子、推文和评论的自动翻译)。但通用机器学习模型更难做好翻译非常特定领域的语言——技术文档、法律合同、医学期刊等。</p><p id="e4e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本周，谷歌推出了新版本的云翻译API，其中包含新工具，可以帮助开发者更好地调整他们的翻译，特别是针对特定领域的应用程序。这次更新将API分成了两个“版本”第一个是翻译API Basic (v2)，本质上做了旧API做的事情。它将文本翻译成100多种语言，并支持翻译HTML和自动语言检测。与此同时，新版翻译API Advanced (v3)引入了一些新功能，包括批量翻译(用于处理存储在云中的大型文档集)、带词汇表的翻译，甚至使用AutoML翻译用您自己定制的机器学习模型进行预测。</p><p id="51f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将向您展示如何使用Python中的高级翻译API(v3)来微调翻译和大规模翻译文档。</p><h1 id="3c2b" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">设置您的环境</h1><h2 id="3ab4" class="ky kb ht bd kc kz la lb kg lc ld le kk jb lf lg ko jf lh li ks jj lj lk kw ll bi translated">启用身份验证</h2><p id="a715" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">首先，您需要<a class="ae jp" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" rel="noopener ugc nofollow" target="_blank">创建一个新的GCP项目</a>或<a class="ae jp" href="https://console.cloud.google.com/apis/library/translate.googleapis.com?q=translate" rel="noopener ugc nofollow" target="_blank">启用现有项目中的高级翻译API </a>。</p><p id="892f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您需要设置身份验证。高级版要求您使用<a class="ae jp" href="https://cloud.google.com/iam/docs/understanding-service-accounts" rel="noopener ugc nofollow" target="_blank">服务帐户</a>进行身份验证，这是使您的应用程序能够进行身份验证的配置文件或身份。</p><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es lr"><img src="../Images/ab246fb8a54fa0b93bc2a8a1309ad70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*BJNYJE-O3U9SixF0r3JUPw.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">创建新的服务帐户。</figcaption></figure><p id="7fd7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以随意命名该帐户。在“权限”页面上，分配“云翻译API编辑器”角色。最后，在服务帐户创建流程的最后一页，点击“+ Create Key”并下载一个<code class="du ls lt lu lv b">json</code>密钥文件。这个<code class="du ls lt lu lv b">json</code>文件包含了你的应用需要认证的所有信息，所以保持它的私密性(即不要把它包含在前端/面向客户端的代码中)。</p><h2 id="f7e4" class="ky kb ht bd kc kz la lb kg lc ld le kk jb lf lg ko jf lh li ks jj lj lk kw ll bi translated">环境变量</h2><p id="37e6" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">在这篇文章中，我们将从Python调用API。作为使用Python库的标准最佳实践，首先创建一个虚拟环境:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="89ae" class="ky kb ht lv b fi ma mb l mc md">python3 -m venv venv<br/>source venv/bin/activate</span></pre><p id="493d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，安装翻译库:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="45a3" class="ky kb ht lv b fi ma mb l mc md">pip install google-cloud-translate</span></pre><p id="ed1d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如前所述，翻译客户端库使用服务帐户密钥进行身份验证。它期望在环境变量<code class="du ls lt lu lv b">GOOGLE_APPLICATION_CREDENTIALS.</code>中找到该键的路径，如下设置该变量:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="d7ff" class="ky kb ht lv b fi ma mb l mc md">export GOOGLE_APPLICATION_CREDENTIALS="path/to/your_creds_file.json"</span></pre><h1 id="6699" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">翻译文本</h1><p id="0b49" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">在我们开始学习新功能之前，让我们看看如何简单地将文本从一种语言翻译成另一种语言。</p><p id="4ab2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，创建一个新的Python文件，即<code class="du ls lt lu lv b">translation.py</code>。在顶部，导入库:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="43ea" class="ky kb ht lv b fi ma mb l mc md">from google.cloud import translate_v3</span></pre><p id="1b98" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您需要创建一个新的TranslationServiceClient，并用您的<a class="ae jp" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" rel="noopener ugc nofollow" target="_blank"> GCP项目id </a>对其进行配置。下面是翻译文本的代码:</p><figure class="jr js jt ju fd hk"><div class="bz dy l di"><div class="me mf l"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">从英语到西班牙语的基本翻译。注意，字段“source_language_code”是可选的，因为API可以检测输入文本的语言。</figcaption></figure><p id="77e9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它打印:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="7c2b" class="ky kb ht lv b fi ma mb l mc md">Translated text: Probemos la API de traducción en Google Cloud Platform.</span></pre><p id="4192" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意字段<code class="du ls lt lu lv b">source_language_code</code>是可选的，因为API可以自动检测源语言。这意味着您也可以通过检查字段<code class="du ls lt lu lv b">response.translations[0].detected_language_code</code>使用这个库来识别一段文本的语言。源语言和目标语言由它们的<a class="ae jp" href="https://cloud.google.com/translate/docs/languages" rel="noopener ugc nofollow" target="_blank"> BCP 47语言代码</a>指定，这些代码是语言和地区代码的组合(即<code class="du ls lt lu lv b">en-US</code>、<code class="du ls lt lu lv b">fr-CA</code>、<code class="du ls lt lu lv b">es-MX</code>)。</p><h1 id="7256" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">用词汇表翻译</h1><p id="4c5c" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">上面，我们把“让我们试试谷歌云平台上的翻译API”这句话翻译成了西班牙语。结果(“翻译文本:probes la API de traducción en Google Cloud Platform。”)正确地捕捉到了“谷歌云平台是一个专有名词，不应该翻译。但是它把“翻译API”翻译成了“API de traducción”，去掉了大写字母(翻译应该是“API de Traducción”)。或者，由于这是一个特定的GCP产品的名称，我们可能根本不想将“翻译API”翻译成西班牙语。</p><p id="42db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这些情况下，我们希望对特定单词(公司名称、产品名称、专有名词等)的翻译有更多的控制。这就是Translation API Advanced的新术语表特性的用武之地。它允许你上传一个单词对的<code class="du ls lt lu lv b">csv</code>,精确指定单词应该如何翻译。这对于指定单词<em class="jo">何时不应该翻译</em>或者在可选翻译之间进行选择非常有用。</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mg"><img src="../Images/abe63d8759cf43bfbc1e22c73f83100e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RNhkbG600RmahpoW.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">我们指定的词对词典示例，用于指示我们希望如何翻译术语。“位置”和“描述”列是可选的。</figcaption></figure><h2 id="1ab3" class="ky kb ht bd kc kz la lb kg lc ld le kk jb lf lg ko jf lh li ks jj lj lk kw ll bi translated">用词汇表编写翻译函数</h2><p id="c747" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">要在翻译V3 API中使用术语表，您需要:</p><ol class=""><li id="8855" class="mh mi ht is b it iu ix iy jb mj jf mk jj ml jn mm mn mo mp bi translated">创建服务帐户。</li><li id="f7f5" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">创建一个词汇表文件。</li><li id="050e" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">将其上传到一个<a class="ae jp" href="https://cloud.google.com/storage/docs/creating-buckets" rel="noopener ugc nofollow" target="_blank">谷歌云存储(gcs)桶</a>。</li><li id="6b3c" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">使用翻译API创建术语表资源。</li><li id="8669" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">像以前一样进行一个<code class="du ls lt lu lv b">translateText</code>调用，指定一个术语表。</li></ol><p id="94d2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看如何使用术语表文件来防止产品名称“翻译API”被翻译成西班牙语。</p><p id="6632" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">更新权限</strong></p><p id="1615" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了使用术语表，除了<code class="du ls lt lu lv b">Cloud Translation API User</code>角色之外，您需要为您的服务帐户赋予一个新的角色— <code class="du ls lt lu lv b">Storage Object Admin</code>。这将允许您的应用程序访问云存储，查看文件，创建文件以及删除文件。</p><p id="9676" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">创建术语表文件</strong></p><p id="97f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以用许多不同的格式创建一个术语表，但是最简单的方法是用一个简单的T4创建一个“单向术语表”。创建一个名为<code class="du ls lt lu lv b">glossary.csv</code>的文件，并用翻译对填充它，就像这样:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="5625" class="ky kb ht lv b fi ma mb l mc md">Translation API,Translation API<br/>account,cuenta<br/>directions,indicaciones</span></pre><p id="accd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个词汇表文件指定了单词“account”和“directions”应该如何翻译，并指出单词“Translation API”根本不应该翻译。</p><p id="5fe9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">将您的术语表上传到GCS存储桶</strong></p><p id="e7cd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您需要将术语表文件上传到一个<a class="ae jp" href="https://cloud.google.com/storage/docs/creating-buckets" rel="noopener ugc nofollow" target="_blank"> GCS桶</a>。我将把我的存储桶的名称存储在一个环境变量中，如下所示:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="947a" class="ky kb ht lv b fi ma mb l mc md">export GLOSSARY_BUCKET="gs://your_bucket_name"</span></pre><p id="3aef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，<a class="ae jp" href="https://cloud.google.com/storage/docs/reference/libraries" rel="noopener ugc nofollow" target="_blank">在Python </a>中或者从命令行使用<code class="du ls lt lu lv b">gsutil</code>创建一个新的bucket (或者使用一个现有的bucket ):</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="f959" class="ky kb ht lv b fi ma mb l mc md">gsutil makebucket $GLOSSARY_BUCKET  # create bucket<br/>gsutil cp ./glossary.csv $GLOSSARY_BUCKET # uploads file</span></pre><p id="f811" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">创建术语表</strong></p><p id="3ece" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将<code class="du ls lt lu lv b">csv</code>文件上传到云端后，您需要注册一个新的术语表，如下所示:</p><figure class="jr js jt ju fd hk"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="9ed4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面，我们创建了一个新的术语表，id为“my_first_glossary”这个惟一标识符可以是您喜欢的任何名称，稍后您将使用它来访问这个术语表。</p><p id="5943" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">调用<code class="du ls lt lu lv b">translate.types.Glossary.LanguageCodePair</code>表明我们正在使用一个单向词汇表，该词汇表被设计用于从<code class="du ls lt lu lv b">source_language_code</code>到<code class="du ls lt lu lv b">target_language_code</code>的翻译(在我们的例子中，是从英语到西班牙语)。</p><p id="1c3b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，我们还指定了一个用于创建术语表资源的<code class="du ls lt lu lv b">location</code>，在本例中是<code class="du ls lt lu lv b">us-central1</code>。目前，<code class="du ls lt lu lv b">location</code>必须始终设置为<code class="du ls lt lu lv b">us-central1</code>。</p><p id="7849" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您已经创建了第一个术语表。恭喜你。🎊让我们看看如何用它来做更好的翻译。</p><p id="4108" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">用词汇表翻译</strong></p><p id="6bd3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在您已经创建了一个术语表资源，您可以像我们之前做的那样调用<code class="du ls lt lu lv b">translate_text</code>方法，但是包括对您的术语表id的引用:</p><figure class="jr js jt ju fd hk"><div class="bz dy l di"><div class="me mf l"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">用词汇表翻译</figcaption></figure><p id="14c1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个调用与我们之前调用的没有术语表的<code class="du ls lt lu lv b">translate_text</code>相同，有三点不同:</p><ol class=""><li id="d0b8" class="mh mi ht is b it iu ix iy jb mj jf mk jj ml jn mm mn mo mp bi translated">您必须指定一个<code class="du ls lt lu lv b">glossary_config</code></li><li id="0354" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">您必须指定<code class="du ls lt lu lv b">source_langauge_code</code>(对于术语表，该字段不是可选的)</li><li id="e756" class="mh mi ht is b it mq ix mr jb ms jf mt jj mu jn mm mn mo mp bi translated">您必须将位置设置为<code class="du ls lt lu lv b">us-central1</code></li></ol><h2 id="e6d9" class="ky kb ht bd kc kz la lb kg lc ld le kk jb lf lg ko jf lh li ks jj lj lk kw ll bi translated">使用AutoML Translate构建自定义模型</h2><p id="c2a8" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">使用包含单词对的词汇表是快速提高翻译质量的简单方法。但是有时候，你可能没有词汇表，或者不知道你想要控制哪些单词的翻译。或者，你可能会发现你的译文的一般措辞——不是任何特定的单词或短语——听起来很别扭。</p><p id="f520" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，你可以使用名为<a class="ae jp" href="https://cloud.google.com/translate/automl/docs/" rel="noopener ugc nofollow" target="_blank"> AutoML Translation </a>的工具训练自己的<em class="jo">定制</em>机器学习翻译模型。如果您已经有了一组高质量的翻译文档，可以用来训练新模型，那么这个工具就很有意义。</p><p id="a1e9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，在Google Cloud中，我们想看看是否可以训练一个模型来翻译我们的开发人员文档。这是一项艰巨的任务，即使对人来说也是如此，因为软件开发人员的语言相当行话，除非你自己就是开发人员。幸运的是，我们的大部分文档已经被人类翻译了。我们使用这些数据来训练我们自己的AutoML模型。让我们看看怎么做。</p><p id="f42d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">训练定制汽车模型</strong></p><p id="7174" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，在GCP控制台页面，点击进入“人工智能”下的“翻译”工具:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mv"><img src="../Images/b7905b0f57029c2bc3d39a80fd9ee45c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWWz48dy7u2kLi2IzwGPVA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">在GCP控制台页面，向下滚动到“人工智能”并选择“翻译”。</figcaption></figure><p id="1ece" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，您可以选择使用翻译API或AutoML翻译。在“自动翻译”下，单击“开始”</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mw"><img src="../Images/2b68a5743ee91ca440a589815ae40b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_Ius49YJFdbiPWjQOuDEA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">使用自动翻译来训练自定义模型。</figcaption></figure><p id="d7d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，单击“创建新数据集”上传您的培训数据，指定您的源语言和目标语言。您可以导入存储在云桶中的数据或从您的电脑上传<code class="du ls lt lu lv b">csv</code>。</p><p id="82d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我的GCP文档数据，从日语翻译成英语，看起来像:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mx"><img src="../Images/a7243bd9977b0bdde4065dfdadbfd6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKHEnz5qeHl9dwBug06FZg.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">训练数据由现有的人工翻译对组成。</figcaption></figure><p id="63e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">幸运的是，因为我们已经使用人工翻译文档有一段时间了，我们有超过一百万对句子用于训练。</p><p id="42fa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要训练模型，请单击“训练”选项卡，然后单击“开始训练”你将被要求选择一个基本模型，默认是谷歌的通用模型，“谷歌NMT”开始训练模型后，它们将出现在此下拉列表中，因此您可以通过添加新数据来提高已训练模型的性能。点按“开始训练”，然后休息一下。这可能需要一段时间。</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es my"><img src="../Images/318844751219f35b8d505774877b316b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQJNyQALaZBoOhJ5i1YPQw.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">训练一个新模型。这可能需要一段时间！</figcaption></figure><p id="0f13" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你的模型完成训练后，你会收到一封电子邮件。然后，您将能够在“Train”选项卡中看到您的模型的性能:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div class="er es mz"><img src="../Images/94ef65fee12d595187e72c1f0ae69913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*1JmZvTHCZob1SNPdAErA5Q.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">模型性能</figcaption></figure><p id="2bb1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">评估您的定制模型</strong></p><p id="991b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们如何判断我们的定制模型表现如何？一种方法是将AutoML模型的性能与谷歌的基本NMT模型进行比较。我们用一个叫做BLEU(双语评估替角)的指标来做这件事。这里有一篇很棒的文章解释了这个指标<a class="ae jp" href="https://cloud.google.com/translate/automl/docs/evaluate" rel="noopener ugc nofollow" target="_blank"/>，这里有一篇更深入的文章<a class="ae jp" href="https://towardsdatascience.com/evaluating-text-output-in-nlp-bleu-at-your-own-risk-e8609665a213" rel="noopener" target="_blank"/>。简而言之，BLEU score采用地面真实翻译，并将其与机器翻译进行比较。人类和机器输出之间的重叠越多，BLEU分数越高。上面，你可以看到谷歌的基本模型和你的定制模型的BLEU分数以及它们之间的差异，两者都是根据你的数据进行评估的。在我们的例子中，我们通过自己训练一个模型获得了8.02分的提升。</p><p id="b7f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">使用AutoML模型进行翻译</strong></p><p id="f6e6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为健全性检查，您可以跳到“预测”选项卡，直接从AutoML UI翻译句子:</p><figure class="jr js jt ju fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es na"><img src="../Images/00f52843ce020d75e2bd29f1ab49bfd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cj3G23k-Yhfe0w31o3iEjA.png"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">在这里，您可以将您的定制模型的翻译(上图)与基础模型的翻译(下图)进行比较</figcaption></figure><p id="22b2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们看看如何在Python中调用新的定制模型。</p><p id="8805" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，您需要找到刚刚创建的模型的路径。方便的是，如果您向下滚动到代码示例，您可以在UI中的“predict”选项卡(如上图)下找到这个值。你要找的领域是:</p><pre class="jr js jt ju fd lw lv lx ly aw lz bi"><span id="4c8e" class="ky kb ht lv b fi ma mb l mc md">projects/your_project_id/locations/us-central1/models/your_translation_model_path</span></pre><p id="7302" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">把那条路放在手边。</p><p id="88c1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以使用我们的<em class="jo">定制</em>模型进行预测，几乎与我们使用基本模型的方式相同。我们只需要将可选参数“model”添加到我们之前进行的<code class="du ls lt lu lv b">translate_text</code>调用中，并将路径传递给我们的模型:</p><figure class="jr js jt ju fd hk"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="ae4c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">瞧啊。您已经使用定制的AutoML翻译模型翻译了Python中的文本。</p><h2 id="45ef" class="ky kb ht bd kc kz la lb kg lc ld le kk jb lf lg ko jf lh li ks jj lj lk kw ll bi translated">批量翻译</h2><p id="6ed0" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb lo jd je jf lp jh ji jj lq jl jm jn hb bi translated">高级翻译API(V3)的最后一个新特性是能够翻译批量文件。不是用单个字符串调用<code class="du ls lt lu lv b">translate_text</code>，而是指定一组存储在<a class="ae jp" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank"> Google云存储</a>中的文档。您还可以指定希望翻译出现的目标路径:</p><figure class="jr js jt ju fd hk"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="a013" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意，虽然我们在这里等待结果，但是您也可以异步调用<code class="du ls lt lu lv b">batch_translate_text</code>。如果您正在翻译大量文本，并且不想等待呼叫结束，这是有意义的！</p></div><div class="ab cl nb nc gp nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="hb hc hd he hf"><p id="fb07" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简而言之，这就是高级翻译API的新特性。同时，如果您已经在使用翻译API，并且不需要这些功能，Translation Basic可以满足您的需求。</p><p id="71bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">祝你好运，菲利斯·特拉杜西恩多！</p></div></div>    
</body>
</html>