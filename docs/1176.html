<html>
<head>
<title>Wait! What? There’s a new Java client for Bigtable?!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">等等！什么？Bigtable有了新的Java客户端？！</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/wait-what-theres-a-new-java-client-for-bigtable-182af4b59324?source=collection_archive---------4-----------------------#2019-10-21">https://medium.com/google-cloud/wait-what-theres-a-new-java-client-for-bigtable-182af4b59324?source=collection_archive---------4-----------------------#2019-10-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="18f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章是与克里斯汀·奥利里合作创作的。</p><p id="d317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多年来，我们为Bigtable提供的Java客户端是HBase兼容的。然而，最近我们已经看到许多开发人员采用Bigtable，他们不是从HBase过渡，而是Cassandra或其他东西。</p><p id="ab64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以对于不需要HBase兼容性的人来说，使用HBase客户端对于某些操作来说可能过于复杂。这就是为Bigtable开发新的Java客户端的原因。请注意，这并不意味着HBase客户端将被弃用。这两个客户端将并存，您可以选择最适合您的用例的一个。</p><p id="a344" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新客户端的主要特点是:<br/> -更灵活的过滤器<br/> -更少的依赖性<br/> -完全异步和背压感知</p><p id="a986" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一篇剖析新客户端特性的博客文章正在制作中，敬请关注。在这一篇中，我们将关注开发人员。</p><p id="2a6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了获得更多的实践经验，我们决定采用codelab: <a class="ae jd" href="https://codelabs.developers.google.com/codelabs/cloud-bigtable-intro-java/#0" rel="noopener ugc nofollow" target="_blank">云Bigtable </a>简介，由我们的朋友和同事<a class="ae jd" href="https://twitter.com/BillyJacobson" rel="noopener ugc nofollow" target="_blank"> Billy Jacobson </a>创建，它使用HBase客户端并翻译查询，以便它们可以与新客户端一起工作。</p><p id="c6c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">codelab使用一个公共数据集，可以在<a class="ae jd" href="https://www.kaggle.com/stoney71/new-york-city-transport-statistics" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>找到。</p><blockquote class="je"><p id="3092" class="jf jg hi bd jh ji jj jk jl jm jn jc dx translated">该数据集来自纽约市MTA公交车数据流服务。大约以10分钟为增量，每一行中都包含了公交车位置、路线、公交车站等信息。公共汽车时刻表中的预定到达时间也包括在内，以给出公共汽车应该在哪里的指示(比时刻表落后多少，或者准时，或者甚至提前多少)。</p></blockquote><p id="2057" class="pw-post-body-paragraph if ig hi ih b ii jo ik il im jp io ip iq jq is it iu jr iw ix iy js ja jb jc hb bi translated">下面您会看到获取从<code class="du jt ju jv jw b">12:00 am</code>到<code class="du jt ju jv jw b">1:00 am</code>的<code class="du jt ju jv jw b">June 1, 2017</code>上的<code class="du jt ju jv jw b">M86-SBS</code>线路上的公交车数据的查询。一辆id为<code class="du jt ju jv jw b">NYCT_5824</code>的车辆当时在公交线路上。</p><blockquote class="jx jy jz"><p id="24c2" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated"><strong class="ih hj">执行查找</strong></p><p id="bd31" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">您将执行的第一个查询是一个简单的行查找。你会得到2017年6月1日上午12:00到凌晨1:00 M86-SBS线路上一辆公交车的数据。一辆车牌号为NYCT_5824的车当时在公交线路上。</p><p id="9b1e" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">有了这些信息，并知道模式设计(公交公司/公交线路/下舍入到小时/车辆ID的时间戳)，您可以推断出行键是:</p><p id="8e08" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">MTA/M86-SBS/149627520000/NYCT _ 5824</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="a6ab" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">结果应该包含该小时内公共汽车的最近位置。但是您希望看到所有的位置，所以在get请求上设置最大版本数。</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="59f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，让我们看看新的Java客户端会是什么样子</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="0d20" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated"><strong class="ih hj">执行扫描</strong> <br/>现在，让我们查看该小时公交线路的所有数据。扫描代码看起来非常类似于get代码。您给扫描器一个起始位置，然后指出您只需要在时间戳1496275200000表示的小时内的M86-SBS总线的行。</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="d04b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是新Java客户端的相同查询。</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="69ec" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">对这个查询的一个有趣的修改是查看M86-SBS总线的整个月份的数据，这非常容易做到。从起始行和前缀过滤器中删除时间戳以获得结果。</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="1891" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新Java客户端的版本将如下所示。</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="dac2" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated"><strong class="ih hj">引入过滤器</strong> <br/>接下来，您将过滤向东行驶的公交车和向西行驶的公交车</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="0fbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是查询的新Java客户端版本。</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="28d6" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated">要让公共汽车向西行驶，请更改valueFilter中的字符串:</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="8203" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是如何为新的Java客户端更改过滤器。</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><blockquote class="jx jy jz"><p id="ffc8" class="if ig ka ih b ii ij ik il im in io ip kb ir is it kc iv iw ix kd iz ja jb jc hb bi translated"><strong class="ih hj">执行多范围扫描<br/> </strong>对于最后一个查询，您将处理当您关心一个区域中的许多公交线路时的情况:</p></blockquote><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="a5c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，对新客户端进行多范围扫描</p><figure class="ke kf kg kh fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="bb2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">博文中的所有代码都可以在<a class="ae jd" href="https://github.com/dbergqvist/cbt-intro-java/tree/hbase-java" rel="noopener ugc nofollow" target="_blank">这个</a> GitHub repo中找到。如果事情没有按预期进行，请联系<a class="ae jd" href="https://twitter.com/bexie" rel="noopener ugc nofollow" target="_blank"> me </a>。</p></div></div>    
</body>
</html>