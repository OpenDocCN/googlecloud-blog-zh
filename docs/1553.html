<html>
<head>
<title>Multi-Cloud VPN and Multi-Zone Subnetworks — Network Setup for Multi-Cloud Database Deployments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多云VPN和多区域子网—用于多云数据库部署的网络设置</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/multi-cloud-vpn-and-multi-zone-subnetworks-preparation-for-multi-cloud-database-deployments-c43272336a8f?source=collection_archive---------0-----------------------#2020-08-10">https://medium.com/google-cloud/multi-cloud-vpn-and-multi-zone-subnetworks-preparation-for-multi-cloud-database-deployments-c43272336a8f?source=collection_archive---------0-----------------------#2020-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a9e8" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">设置多云VPN的教程</h2></div><h1 id="3a34" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">介绍</h1><p id="9b47" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">这篇博客是关于如何在Google云和AWS之间建立VPN，在每个云中创建多区域子网以及测试任意对任意连接的教程。对于设置的一部分，本博客遵循社区教程<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws" rel="noopener ugc nofollow" target="_blank">AWS</a>的Google Cloud HA VPN互操作性指南，并逐字引用。这个博客超越了社区教程的内容，包括设置子网以及对网络设置进行任意对任意的测试。</p><p id="2d10" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">请预先注意，这是一个一步一步的手动设置，以防您想要理解并自己执行所有需要的步骤。如果你正在寻找一个自动设置，这个博客不适合你。例如，仅使用用户界面建立VPN的帖子是<a class="ae kl" rel="noopener" href="/peek-travel/connecting-an-aws-and-gcp-vpc-using-an-ipsec-vpn-tunnel-with-bgp-f332c2885975">这里是</a>。</p><h1 id="b3e3" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">设置阶段</h1><p id="ca8f" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">这篇博客将设置分为以下几个阶段:</p><ul class=""><li id="2e75" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated"><strong class="jr hj">项目设置</strong>。在Google Cloud中创建项目，在AWS中创建项目。这里不做进一步解释——这些说明假设您在每个云设置中都有一个项目，并且您有权根据需要设置VPN、子网、防火墙规则、计算引擎和其他资源。</li><li id="755b" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated"><strong class="jr hj"> VPN配置</strong>。初始设置阶段是在谷歌云和AWS之间设置一个VPN。这是一套循序渐进的说明。</li><li id="13bd" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated"><strong class="jr hj">子网配置</strong>。下一阶段是设置子网以及防火墙和安全设置。</li><li id="1336" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated"><strong class="jr hj">测试</strong>。最后一个阶段是通过在Google Compute Engine和EC2中创建虚拟机来测试设置，以进行任意对任意ping测试。</li></ul><p id="171b" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">在成功的测试阶段之后，网络设置已经准备好，可以为多种云使用情形和工作负载进行网络设置。</p><h1 id="9727" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">注释</h1><p id="41e1" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">在谷歌云端显示了<code class="du lf lg lh li b">glcoud</code>命令。您必须选择的变量值表示为<code class="du lf lg lh li b">[…]</code>。它们在第一次使用时根据需要引入。您可以通过全局文本替换来一致地替换这些变量，以便一致地准备所有命令。</p><p id="b8f4" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">在AWS端，提供了用户界面说明，这些说明大部分是从<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws" rel="noopener ugc nofollow" target="_blank">Google Cloud HA VPN inter operability guide for AWS</a>中一字不差地摘录下来的，有时会做一些小的修改(为了澄清),并明确标记为<code class="du lf lg lh li b">[[...]]</code>。</p><p id="0604" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">建议您记下所有选择的变量值以及在各种用户界面中输入的名称/值，以记录详细信息。下面是这种方法的一个例子:<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws#configuration_parameters_and_values" rel="noopener ugc nofollow" target="_blank">配置参数和值</a>。另一种方法是创建一个记录所有设置和变量值的电子表格。</p><h1 id="f26b" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">VPN配置</h1><h2 id="2cbf" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在谷歌云项目中</h2><ul class=""><li id="2703" class="kr ks hi jr b js jt jv jw jy lx kc ly kg lz kk kw kx ky kz bi translated">创建一个网络(GCP:谷歌云平台):</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="038e" class="lj iy hi li b fi mi mj l mk ml">gcloud compute networks create [GCP_NETWORK_NAME] \<br/>--subnet-mode custom \<br/>--bgp-routing-mode global</span></pre><ul class=""><li id="5cb2" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">最佳做法是删除项目中的默认网络。这种删除不是必需的，但可以防止意外配置不正确的网络。如果云外壳指示以下情况，您可能必须先删除几个防火墙规则:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="179e" class="lj iy hi li b fi mi mj l mk ml">gcloud compute networks delete default</span><span id="6a95" class="lj iy hi li b fi mm mj l mk ml">// in case you need to delete firewall rules:<br/>gcloud compute firewall-rules delete &lt;firewall-rule-name&gt;</span></pre><ul class=""><li id="217b" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">添加两个子网:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="6f1e" class="lj iy hi li b fi mi mj l mk ml">gcloud compute networks subnets create [GCP_SUBNET_1] \<br/>--network [GCP_NETWORK_NAME] \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--range [GCP_RANGE_SUBNET_1]</span><span id="089b" class="lj iy hi li b fi mm mj l mk ml">gcloud compute networks subnets create [GCP_SUBNET_2] \<br/>--network [GCP_NETWORK_NAME] \<br/>--region [GCP_REGION_SUBNET_2] \<br/>--range [GCP_RANGE_SUBNET_2]</span></pre><ul class=""><li id="ef1d" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">添加VPN网关:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="f50f" class="lj iy hi li b fi mi mj l mk ml">gcloud compute vpn-gateways create [GCP_VPN_GATEWAY] \<br/>--network [GCP_NETWORK_NAME] \<br/>--region [GCP_REGION_SUBNET_1]</span></pre><ul class=""><li id="1039" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">添加路由器:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="7f30" class="lj iy hi li b fi mi mj l mk ml">gcloud compute routers create [GCP_ROUTER] \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--network [GCP_NETWORK_NAME] \<br/>--asn [GCP_ASN]</span></pre><h2 id="14ba" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在AWS项目中</h2><p id="2544" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">注:我在引用文本中的添加或修改用<code class="du lf lg lh li b">[[...]]</code>表示，因此任何与<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws" rel="noopener ugc nofollow" target="_blank">Google Cloud HA VPN operability guide for AWS</a>的偏离都被明确标出。</p><ul class=""><li id="50ea" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建具有默认租赁的VPC</li><li id="259d" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">创建一个AWS[[虚拟专用网]]网关，并将其连接到VPC:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="8ab5" class="lj iy hi li b fi mi mj l mk ml">1. In the AWS dashboard, under <strong class="li hj">Virtual Private Network</strong>, select <strong class="li hj">Virtual Private Gateways</strong>.</span><span id="5cf7" class="lj iy hi li b fi mm mj l mk ml">2. Click <strong class="li hj">Create Virtual Private Gateway</strong></span><span id="218c" class="lj iy hi li b fi mm mj l mk ml">3.<strong class="li hj"> </strong>Enter a <strong class="li hj">Name</strong> for the gateway.</span><span id="70d3" class="lj iy hi li b fi mm mj l mk ml">4. Select <strong class="li hj">Custom ASN</strong> and give the gateway an AWS ASN that doesn’t conflict with the [GCP_ASN].</span><span id="a278" class="lj iy hi li b fi mm mj l mk ml">5. Click <strong class="li hj">Create Virtual Private Gateway</strong>. Click <strong class="li hj">Close</strong>.</span><span id="05de" class="lj iy hi li b fi mm mj l mk ml">6. Attach the gateway to the AWS VPC by selecting the gateway you just created, clicking <strong class="li hj">Actions, Attach to VPC</strong>.</span><span id="6e09" class="lj iy hi li b fi mm mj l mk ml">7. Pull down the menu and select a VPC for this gateway and click <strong class="li hj">Yes, Attach</strong>.</span><span id="917c" class="lj iy hi li b fi mm mj l mk ml">8. Note the ID of the gateway for the steps that follow.</span></pre><ul class=""><li id="a3d9" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建站点到站点连接和客户网关:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="ccb9" class="lj iy hi li b fi mi mj l mk ml">1. In the AWS dashboard, under <strong class="li hj">Virtual Private Network</strong> select <strong class="li hj">Site-to-site VPN connections</strong>.</span><span id="c224" class="lj iy hi li b fi mm mj l mk ml">2. Click <strong class="li hj">Create VPN connection</strong>.</span><span id="4b19" class="lj iy hi li b fi mm mj l mk ml">3. Enter a <strong class="li hj">Name</strong> for the connection.</span><span id="3d8e" class="lj iy hi li b fi mm mj l mk ml">4. Pull down the <strong class="li hj">Virtual Private Gateway</strong> menu and select the ID of the virtual private gateway you just created.</span><span id="ecb6" class="lj iy hi li b fi mm mj l mk ml">5. Under <strong class="li hj">Customer gateway</strong> select <strong class="li hj">New</strong>.</span><span id="e28e" class="lj iy hi li b fi mm mj l mk ml">6. For <strong class="li hj">IP address</strong>, use the public IP address that was automatically generated for Interface: 0 [[label of the interface in the GCP console]] of the HA VPN gateway you created earlier [[in GCP]].</span><span id="948e" class="lj iy hi li b fi mm mj l mk ml">7. For <strong class="li hj">BGP ASN</strong>, use the value for [GCP_ASN].</span><span id="ceb7" class="lj iy hi li b fi mm mj l mk ml">8. Under <strong class="li hj">Routing options</strong> make sure that <strong class="li hj">dynamic</strong> is selected.</span><span id="19a9" class="lj iy hi li b fi mm mj l mk ml">9. For <strong class="li hj">Tunnel 1</strong> and <strong class="li hj">Tunnel 2</strong>, specify the <strong class="li hj">Inside IP CIDR</strong> for your AWS VPC network, which is a BGP IP address from a /30 CIDR in the 169.254.0.0/16 range. For example, 169.254.1.4/30. This address must not overlap with the BGP IP address for the GCP side. When you specify the pre-shared key, you must use the same pre-shared key for the tunnel from the HA VPN gateway side. If you specify a key, AWS doesn’t autogenerate it.</span><span id="1851" class="lj iy hi li b fi mm mj l mk ml">10. Click <strong class="li hj">Create VPN connection</strong>.</span></pre><ul class=""><li id="a791" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建第二个站点到站点的连接(引用的文本还声明创建第二个AWS网关，但这是不可能的。所以我加了<code class="du lf lg lh li b">[[not:...]]</code>表示不应该这样做):</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="1c5b" class="lj iy hi li b fi mi mj l mk ml">Repeat the above steps to create a second [[not: AWS Gateway,]]  site-to-site connection, and customer gateway, but use the IP address generated for HA VPN gateway Interface: 1 [[(label of the interface in the GCP console)]] instead. Use the same [GCP_ASN].</span></pre><ul class=""><li id="a0de" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">下载每个站点到站点连接的AWS配置设置:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="92e7" class="lj iy hi li b fi mi mj l mk ml">1. As of this writing, you can download the configuration settings from your AWS virtual private gateway into a text file that you can reference when configuring HA VPN. You do this after you’ve configured the HA VPN gateway and Cloud Router.</span><span id="77d1" class="lj iy hi li b fi mm mj l mk ml">2. On the AWS <strong class="li hj">VPC Dashboard</strong> screen, in the left navigation bar, select <strong class="li hj">Site-to-Site VPN Connections</strong>.</span><span id="dc71" class="lj iy hi li b fi mm mj l mk ml">3. Check the checkbox for the first VPN connection to download.</span><span id="d8f0" class="lj iy hi li b fi mm mj l mk ml">4. At the top of the screen, click the middle button that reads <strong class="li hj">Download Configuration</strong>. The <strong class="li hj">Download Configuration</strong> button provides only one configuration file, the one for the selected connection.</span><span id="b92d" class="lj iy hi li b fi mm mj l mk ml">5. In the pop-up dialog box, choose <strong class="li hj">vendor: generic</strong>. There is no need to change the rest of the fields, Click the <strong class="li hj">Download</strong> button.</span><span id="be8a" class="lj iy hi li b fi mm mj l mk ml">6. Repeat the above steps, but choose the second VPN connection to download the file.</span></pre><h2 id="79f6" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在谷歌云项目中</h2><p id="3441" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">如下创建外部VPN网关资源(也称为对等VPN网关)。</p><p id="f02d" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">当您为AWS虚拟专用网关创建GCP外部VPN网关资源时，您必须创建四个接口，如AWS拓扑图所示[[in here:<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws" rel="noopener ugc nofollow" target="_blank">Google Cloud HA VPN inter operability guide for AWS</a>]]。</p><p id="0d51" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">注意:为了成功配置，您必须使用您先前下载的两个AWS配置文件中引用的AWS接口的公共IP地址。您还必须将每个AWS公共IP地址与特定的HA VPN接口完全匹配。下面的说明详细描述了这项任务。</p><p id="013f" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">使用以下命令创建外部VPN网关资源。按如下所述更换选项:</p><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="3fb7" class="lj iy hi li b fi mi mj l mk ml">[[The instructions in 1. ... 4. are for the command following 4.:]]</span><span id="1347" class="lj iy hi li b fi mm mj l mk ml">1. For [AWS_GW_IP_0], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Outside IP address, Virtual private gateway</strong>.</span><span id="940f" class="lj iy hi li b fi mm mj l mk ml">2. For [AWS_GW_IP_1], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Outside IP address, Virtual private gateway</strong>.</span><span id="e498" class="lj iy hi li b fi mm mj l mk ml">3. For [AWS_GW_IP_2], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Outside IP address, Virtual private gateway</strong>.</span><span id="6d66" class="lj iy hi li b fi mm mj l mk ml">4. For [AWS_GW_IP_3], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Outside IP address, Virtual private gateway</strong>.</span><span id="4922" class="lj iy hi li b fi mm mj l mk ml">gcloud compute external-vpn-gateways create [GCP_PEER_GW_NAME] \<br/>--interfaces \<br/>0=[AWS_GW_IP_0],1=[AWS_GW_IP_1],2=[AWS_GW_IP_2],3=[AWS_GW_IP_3]</span></pre><ul class=""><li id="5ca0" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">在HA VPN网关上创建VPN隧道</li></ul><p id="b127" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">在之前创建的HA VPN网关上创建四个VPN隧道，每个接口两个。</p><p id="8bf3" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">在创建每个隧道的以下命令中，替换以下配置中注明的选项:</p><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="f84f" class="lj iy hi li b fi mi mj l mk ml">[[The instructions in 1. ... 9. are for the commands following 9.:]]</span><span id="7075" class="lj iy hi li b fi mm mj l mk ml">1. Replace [GCP_TUNNEL_NAME_IF0] with the name of the tunnel to [[e.g.]] tunnel-a-to-aws-connection-0-ip0.</span><span id="1c1e" class="lj iy hi li b fi mm mj l mk ml">2. Replace [GCP_TUNNEL_NAME_IF1] with the name of the tunnel to [[e.g.]] tunnel-a-to-aws-connection-0-ip1.</span><span id="1182" class="lj iy hi li b fi mm mj l mk ml">3. Replace [GCP_TUNNEL_NAME_IF2] with the name of the tunnel to [[e.g.]] tunnel-a-to-aws-connection-1-ip0.</span><span id="3a0d" class="lj iy hi li b fi mm mj l mk ml">4. Replace [GCP_TUNNEL_NAME_IF3] with the name of the tunnel to [[e.g.]] tunnel-a-to-aws-connection-1-ip1.</span><span id="ba13" class="lj iy hi li b fi mm mj l mk ml">5. Replace [GCP_PEER_GW_NAME] with a name of the external peer gateway created earlier.</span><span id="bd83" class="lj iy hi li b fi mm mj l mk ml">6. Replace [IKE_VERS] with 2. Although the AWS virtual private gateway supports IKEv1 or IKEv2, using IKEv2 is recommended. All four tunnels created in this example use IKEv2.</span><span id="0ce5" class="lj iy hi li b fi mm mj l mk ml">7. Replace [AWS_SHARED_SECRET_0] through [AWS_SHARED_SECRET_3] with the shared secret, which must be the same as the shared secret used for the partner tunnel you create on your AWS virtual gateway. See <a class="ae kl" href="https://cloud.google.com/network-connectivity/docs/vpn/how-to/generating-pre-shared-key" rel="noopener ugc nofollow" target="_blank">Generating a strong pre-shared key</a> for recommendations. You can also find the shared secrets in the AWS configuration files that you downloaded earlier.</span><span id="976a" class="lj iy hi li b fi mm mj l mk ml">8. Replace [INT_NUM_0] with the number 0 for the first interface on the HA VPN gateway you created earlier.</span><span id="6d7b" class="lj iy hi li b fi mm mj l mk ml">9. Replace [INT_NUM_1] with the number 1 for the second interface on the HA VPN gateway you created earlier.</span></pre><ul class=""><li id="2ae3" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建到AWS连接0、IP地址0的隧道:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="4306" class="lj iy hi li b fi mi mj l mk ml">gcloud compute vpn-tunnels create [GCP_TUNNEL_NAME_IF0] \<br/>--peer-external-gateway [GCP_PEER_GW_NAME] \<br/>--peer-external-gateway-interface 0 \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--ike-version [IKE_VERS] \<br/>--shared-secret [AWS_SHARED_SECRET_0] \<br/>--router [GCP_ROUTER] \<br/>--vpn-gateway [GCP_VPN_GATEWAY] \<br/>--interface [INT_NUM_0]</span></pre><ul class=""><li id="1e12" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建到AWS连接0、IP地址1的隧道</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="1a25" class="lj iy hi li b fi mi mj l mk ml">gcloud compute vpn-tunnels create [GCP_TUNNEL_NAME_IF1] \<br/>--peer-external-gateway [GCP_PEER_GW_NAME] \<br/>--peer-external-gateway-interface 1 \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--ike-version [IKE_VERS] \<br/>--shared-secret [AWS_SHARED_SECRET_1] \<br/>--router [GCP_ROUTER] \<br/>--vpn-gateway [GCP_VPN_GATEWAY] \<br/>--interface [INT_NUM_0]</span></pre><ul class=""><li id="4fef" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建到AWS连接1、IP地址0的隧道</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="13c3" class="lj iy hi li b fi mi mj l mk ml">gcloud compute vpn-tunnels create [GCP_TUNNEL_NAME_IF2] \<br/>--peer-external-gateway [GCP_PEER_GW_NAME] \<br/>--peer-external-gateway-interface 2 \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--ike-version [IKE_VERS] \<br/>--shared-secret [AWS_SHARED_SECRET_2] \<br/>--router [GCP_ROUTER] \<br/>--vpn-gateway [GCP_VPN_GATEWAY] \<br/>--interface [INT_NUM_1]</span></pre><ul class=""><li id="ce8a" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建到AWS连接1、IP地址1的隧道</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="1076" class="lj iy hi li b fi mi mj l mk ml">gcloud compute vpn-tunnels create [GCP_TUNNEL_NAME_IF3] \<br/>--peer-external-gateway [GCP_PEER_GW_NAME] \<br/>--peer-external-gateway-interface 3 \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--ike-version [IKE_VERS] \<br/>--shared-secret [AWS_SHARED_SECRET_3] \<br/>--router [GCP_ROUTER] \<br/>--vpn-gateway [GCP_VPN_GATEWAY] \<br/>--interface [INT_NUM_1]</span></pre><ul class=""><li id="7930" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">分配BGP IP地址</li></ul><p id="9e74" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">按照以下说明将BGP IP地址分配给云路由器接口和BGP对等接口。</p><p id="67e7" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">对于每个VPN隧道，从您之前下载的AWS配置文件中获取AWS和GCP的BGP IP地址和ASN。</p><p id="e235" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">如下所示，替换GCP侧的选项:</p><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="72e4" class="lj iy hi li b fi mi mj l mk ml">[[The instructions in 1. ... 4. are for the commands following the next two blocks of instructions:]]</span><span id="8c7c" class="lj iy hi li b fi mm mj l mk ml">1. For [GCP_BGP_IP_0], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Customer gateway</strong>.</span><span id="a74d" class="lj iy hi li b fi mm mj l mk ml">2. For [GCP_BGP_IP_1], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Customer gateway</strong>.</span><span id="49e7" class="lj iy hi li b fi mm mj l mk ml">3. For [GCP_BGP_IP_2], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Customer gateway</strong>.</span><span id="6a32" class="lj iy hi li b fi mm mj l mk ml">4. For [GCP_BGP_IP_3], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Customer gateway</strong>.</span></pre><ul class=""><li id="3d8a" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">更换AWS侧的选项，如下所述:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="bb48" class="lj iy hi li b fi mi mj l mk ml">1. For [AWS_BGP_IP_0], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Virtual private gateway</strong>.</span><span id="a660" class="lj iy hi li b fi mm mj l mk ml">2. For [AWS_BGP_IP_1], in the configuration file you downloaded for AWS Connection 0, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Virtual private gateway</strong>.</span><span id="2486" class="lj iy hi li b fi mm mj l mk ml">3. For [AWS_BGP_IP_2], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #1, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Virtual private gateway</strong>.</span><span id="e23d" class="lj iy hi li b fi mm mj l mk ml">4. For [AWS_BGP_IP_3], in the configuration file you downloaded for AWS Connection 1, under <strong class="li hj">IPSec tunnel #2, #3 Tunnel Interface Configuration</strong>, use the IP address under <strong class="li hj">Inside IP address, Virtual private gateway</strong>.</span></pre><ul class=""><li id="a10f" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">[[For]] [AWS_PEER_ASN]在BGP第4小节下使用以下ASN(目前ASN在所有四种情况下都是相同的):</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="dc9e" class="lj iy hi li b fi mi mj l mk ml">1. For [GCP_TUNNEL_NAME_IF0], in the AWS configuration file for AWS Connection 0, use the Virtual Private Gateway ASN under IPSec Tunnel #1.</span><span id="b93b" class="lj iy hi li b fi mm mj l mk ml">2. For [GCP_TUNNEL_NAME_IF1], in the AWS configuration file for AWS Connection 0, use the Virtual Private Gateway ASN under IPSec Tunnel #2.</span><span id="21f2" class="lj iy hi li b fi mm mj l mk ml">3. For [GCP_TUNNEL_NAME_IF2], in the AWS configuration file for AWS Connection 1, use the Virtual Private Gateway ASN under IPSec Tunnel #1.</span><span id="993e" class="lj iy hi li b fi mm mj l mk ml">4. For [GCP_TUNNEL_NAME_IF3], in the AWS configuration file for AWS Connection 1, use the Virtual Private Gateway ASN under IPSec Tunnel #2.</span><span id="54da" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-interface [GCP_ROUTER] \<br/>--interface-name [GCP_ROUTER_INTERFACE_NAME_0] \<br/>--vpn-tunnel [GCP_TUNNEL_NAME_IF0] \<br/>--ip-address [GCP_BGP_IP_0] \<br/>--mask-length 30 \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="5a29" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-bgp-peer [GCP_ROUTER] \<br/>--peer-name [GCP_BGP_PEER_NAME_0] \<br/>--peer-asn [AWS_PEER_ASN] \<br/>--interface [GCP_ROUTER_INTERFACE_NAME_0] \<br/>--peer-ip-address [AWS_BGP_IP_0] \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="55fa" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-interface [GCP_ROUTER] \<br/>--interface-name [GCP_ROUTER_INTERFACE_NAME_1] \<br/>--vpn-tunnel [GCP_TUNNEL_NAME_IF1] \<br/>--ip-address [GCP_BGP_IP_1] \<br/>--mask-length 30 \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="6dd7" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-bgp-peer [GCP_ROUTER] \<br/>--peer-name [GCP_BGP_PEER_NAME_1] \<br/>--peer-asn [AWS_PEER_ASN] \<br/>--interface [GCP_ROUTER_INTERFACE_NAME_1] \<br/>--peer-ip-address [AWS_BGP_IP_1] \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="e28f" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-interface [GCP_ROUTER] \<br/>--interface-name [GCP_ROUTER_INTERFACE_NAME_2] \<br/>--vpn-tunnel [GCP_TUNNEL_NAME_IF2] \<br/>--ip-address [GCP_BGP_IP_2] \<br/>--mask-length 30 \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="51d4" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-bgp-peer [GCP_ROUTER] \<br/>--peer-name [GCP_BGP_PEER_NAME_2] \<br/>--peer-asn [AWS_PEER_ASN] \<br/>--interface [GCP_ROUTER_INTERFACE_NAME_2] \<br/>--peer-ip-address [AWS_BGP_IP_2] \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="64ce" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-interface [GCP_ROUTER] \<br/>--interface-name [GCP_ROUTER_INTERFACE_NAME_3] \<br/>--vpn-tunnel [GCP_TUNNEL_NAME_IF3] \<br/>--ip-address [GCP_BGP_IP_3] \<br/>--mask-length 30 \<br/>--region [GCP_REGION_SUBNET_1]</span><span id="359c" class="lj iy hi li b fi mm mj l mk ml">gcloud compute routers add-bgp-peer [GCP_ROUTER] \<br/>--peer-name [GCP_BGP_PEER_NAME_3] \<br/>--peer-asn [AWS_PEER_ASN] \<br/>--interface [GCP_ROUTER_INTERFACE_NAME_3] \<br/>--peer-ip-address [AWS_BGP_IP_3] \<br/>--region [GCP_REGION_SUBNET_1]</span></pre><ul class=""><li id="a436" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">检查状态:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="c102" class="lj iy hi li b fi mi mj l mk ml">gcloud compute routers get-status [GCP_ROUTER] \<br/>--region [GCP_REGION_SUBNET_1] \<br/>--format='flattened(result.bgpPeerStatus[].name, result.bgpPeerStatus[].ipAddress, result.bgpPeerStatus[].peerIpAddress)'</span></pre><p id="eee1" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">在这一点上，我们不再遵循<a class="ae kl" href="https://cloud.google.com/community/tutorials/using-ha-vpn-with-aws" rel="noopener ugc nofollow" target="_blank">Google Cloud HA VPN operability guide for AWS</a>，因为该教程没有设置子网、虚拟机或多区域子网的防火墙规则以及跨这些子网的任何对任何ping测试。</p><h2 id="3718" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在AWS项目中</h2><ul class=""><li id="4feb" class="kr ks hi jr b js jt jv jw jy lx kc ly kg lz kk kw kx ky kz bi translated">在AWS控制台虚拟私有云下的<strong class="jr hj">段路由表:</strong></li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="8bcf" class="lj iy hi li b fi mi mj l mk ml">1. Select the route table for the VPC you created</span><span id="8427" class="lj iy hi li b fi mm mj l mk ml">2. If it is not named yet, give it a name for ease of identification</span><span id="c581" class="lj iy hi li b fi mm mj l mk ml">3. In the lower part, click the tab called <strong class="li hj">Route Propagation</strong></span><span id="99a5" class="lj iy hi li b fi mm mj l mk ml">4. Select <strong class="li hj">Edit route propagation</strong></span><span id="5f38" class="lj iy hi li b fi mm mj l mk ml">5. Check the checkbox under <strong class="li hj">Propagate</strong></span><span id="6937" class="lj iy hi li b fi mm mj l mk ml">6. Click <strong class="li hj">Save</strong></span></pre><h1 id="b9a5" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">子网配置</h1><h2 id="1a70" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在AWS项目中</h2><p id="efc8" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">在AWS中，子网是区域性资源，而在Google Cloud中，子网是区域性资源。对于HA部署，在Google Cloud中需要一个子网，因为该区域的所有区域都被覆盖。在AWS中，区域中的每个区域都需要为该区域中的资源建立自己的子网。</p><ul class=""><li id="1528" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">为AWS项目区域中的每个区域创建一个子网(如果您希望覆盖所有区域)。在<strong class="jr hj">子网</strong>部分:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="191e" class="lj iy hi li b fi mi mj l mk ml">1. Click on <strong class="li hj">Create subnet</strong></span><span id="afe5" class="lj iy hi li b fi mm mj l mk ml">2. Fill in the required information</span></pre><p id="eefd" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">为了测试连通性:</p><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="0d7e" class="lj iy hi li b fi mi mj l mk ml">1. Create VMs, one in each subnet. In order to ssh into an instance, it needs a public IP. </span><span id="3ef3" class="lj iy hi li b fi mm mj l mk ml">2. When setting up VMs, create a new security group as it will have to be modified specifically for the VPN setup and it allows you to prevent open access from anywhere.</span><span id="e127" class="lj iy hi li b fi mm mj l mk ml">3. Modify the security group related to the EC2 instances in order to allow ingress SSH traffic from your laptop IP</span></pre><p id="0436" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">另外还需要一个互联网网关:<a class="ae kl" href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Internet_Gateway.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/VPC/latest/user guide/VPC _互联网_网关. html </a>。</p><ul class=""><li id="2875" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">创建一个互联网网关。在<strong class="jr hj">部分，互联网网关</strong>:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="ce49" class="lj iy hi li b fi mi mj l mk ml">1. Click <strong class="li hj">Create internet gateway</strong></span><span id="9b38" class="lj iy hi li b fi mm mj l mk ml">2. Attached the internet gateway to the VPC. Select the internet gateway and click <strong class="li hj">Attach to VPC</strong> in the <strong class="li hj">Actions</strong> drop down menu</span><span id="51ad" class="lj iy hi li b fi mm mj l mk ml">3. Select the VPC and attach it to the internet gateway</span></pre><ul class=""><li id="0d2f" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">在<strong class="jr hj">路由表</strong>中:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="c4a7" class="lj iy hi li b fi mi mj l mk ml">1. Select the route table of the VPC</span><span id="1b85" class="lj iy hi li b fi mm mj l mk ml">2. In the tab <strong class="li hj">Subnet Assocations</strong> associate all subnetworks to the routing table of the VPC</span><span id="eddc" class="lj iy hi li b fi mm mj l mk ml">3. In the tab <strong class="li hj">Routes</strong> add the route from 0.0.0.0/0 to the internet gateway</span></pre><p id="7b95" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">为了允许AWS EC2实例相互ping通，AWS安全组需要入口规则，以便允许来自所有子网的入口。为子网添加入口规则后，您可以使用每个实例的私有IP地址从每个实例ping每个实例。对于ping，ICMP入口就足够了。</p><p id="8768" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">为了允许GCP VM实例ping AWS EC2实例，在EC2实例的AWS安全组上，要添加两个入口规则，每个Google Cloud子网一个。</p><p id="e539" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">安全组中总共应该有几个进入规则:</p><ul class=""><li id="77c6" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">每个AWS子网一个</li><li id="37c4" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">每个GCP子网一个</li><li id="0401" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">一个供您的笔记本电脑访问AWS EC2虚拟机</li></ul><p id="6725" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">此时，您可以ssh到您创建的EC2实例，并从另一个实例ping另一个实例。</p><h2 id="dacd" class="lj iy hi bd iz lk ll lm jd ln lo lp jh jy lq lr jj kc ls lt jl kg lu lv jn lw bi translated">在谷歌云项目中</h2><p id="37bf" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">上面创建了两个不同区域中的两个子网。这种设置允许两个区域中的资源相互交互，以便例如实施灾难恢复策略。</p><ul class=""><li id="ffc9" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">为了允许资源通信，必须实施以下防火墙规则:</li></ul><pre class="ma mb mc md fd me li mf mg aw mh bi"><span id="cbf2" class="lj iy hi li b fi mi mj l mk ml">gcloud compute firewall-rules create default-allow-ssh \<br/>--network [GCP_NETWORK_NAME] \<br/>--allow tcp:22 \<br/>--source-ranges 0.0.0.0/0</span><span id="4568" class="lj iy hi li b fi mm mj l mk ml">gcloud compute firewall-rules create default-allow-icmp \<br/>--network [GCP_NETWORK_NAME] \<br/>--allow icmp \<br/>--source-ranges 0.0.0.0/0</span></pre><p id="677c" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">一种立即测试连通性的方法是在两个区域中的每个区域创建一个虚拟机，并让它们互相ping通。如果有效，防火墙规则设置正确。</p><h1 id="63d7" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">测试</h1><p id="7ac6" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">此时，您已经理想地配置了:</p><ul class=""><li id="1475" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">每个GCP子网中有一台虚拟机</li><li id="9adb" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">每个AWS子网中有一个虚拟机</li></ul><p id="65f5" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">从测试的角度来看，在Google Cloud和AWS中，每个虚拟机都应该能够ping通自己和其他虚拟机(也就是完整的网格可达性)。</p><h1 id="bf3c" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">其他连接选项</h1><p id="89d3" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">VPN不是唯一的连接选项。根据需求，尤其是带宽和性能，存在VPN的替代方案。参见这篇博客<a class="ae kl" href="https://cloud.google.com/blog/products/networking/google-cloud-network-connectivity-options-explained" rel="noopener ugc nofollow" target="_blank">连接到谷歌云:你的网络选项解释</a>以及本页<a class="ae kl" href="https://cloud.google.com/hybrid-connectivity" rel="noopener ugc nofollow" target="_blank">谷歌云混合连接</a> y了解详情和决策树。</p><h1 id="4f59" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">摘要</h1><p id="e11f" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">上面的说明</p><ul class=""><li id="bc03" class="kr ks hi jr b js km jv kn jy kt kc ku kg kv kk kw kx ky kz bi translated">在Google云和AWS之间设置VPN</li><li id="c9be" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">在谷歌云中的两个区域各创建了一个子网</li><li id="e264" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">根据您的选择在不同的AWS区域创建了一个或多个子网</li><li id="a1e6" class="kr ks hi jr b js la jv lb jy lc kc ld kg le kk kw kx ky kz bi translated">测试了Google云和AWS中虚拟机的连接性。</li></ul><p id="9fc9" class="pw-post-body-paragraph jp jq hi jr b js km ij ju jv kn im jx jy ko ka kb kc kp ke kf kg kq ki kj kk hb bi translated">此时，您已经有了一个多云、多区域和多分区的设置。您可以在子网中部署额外的资源。如果在资源之间需要额外的网络协议，不要忘记相应地设置防火墙规则。</p><h1 id="8279" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">承认</h1><p id="54fc" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我要感谢阿尼巴尔·圣地亚哥(<a class="mn mo ge" href="https://medium.com/u/e995c6698d2d?source=post_page-----c43272336a8f--------------------------------" rel="noopener" target="_blank">阿尼巴尔·圣地亚哥</a>)为提高这一内容的准确性所做的全面审查和许多评论。</p><h1 id="2a38" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">放弃</h1><p id="91ff" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">Christoph Bussler是谷歌公司(Google Cloud)的解决方案架构师。这里陈述的观点是我自己的，而不是谷歌公司的。</p></div></div>    
</body>
</html>