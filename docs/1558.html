<html>
<head>
<title>Rsync on GCP Compute Engine: When You Can’t Run Your Code Locally (Network Issues)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP计算引擎上的Rsync:当你不能在本地运行你的代码时(网络问题)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/rsync-on-gcp-compute-engine-when-you-cant-run-your-code-locally-network-issues-cb2ff2c9c176?source=collection_archive---------1-----------------------#2020-08-13">https://medium.com/google-cloud/rsync-on-gcp-compute-engine-when-you-cant-run-your-code-locally-network-issues-cb2ff2c9c176?source=collection_archive---------1-----------------------#2020-08-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4744" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我寻求学习一些新技术的过程中，由于网络问题，我遇到了从本地机器连接到我的服务器/实例/数据库的问题。解决这个问题的方法是在同一个网络上的虚拟机上运行我的代码，但是在我发现Rsync之前，把我的代码放到机器上似乎是一个令人沮丧的过程。Rsync是一个命令行应用程序，允许您轻松地在计算机或虚拟机之间传输和同步文件。</p><h1 id="db27" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">创建虚拟机</h1><p id="14db" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">为此，我将使用谷歌云平台，但这种技术应该适用于任何虚拟机。我将创建一个虚拟机，重要的主要设置是网络。您会希望这个网络与其他资源所在的网络相同。这很可能只是违约。</p><div class="kg kh ki kj fd ab cb"><figure class="kk kl km kn ko kp kq paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/5a90f0ee05484cf8f1dcfc99c0d050be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iO25_om7IMxHzouIya8qKA.png"/></div></figure><figure class="kk kl km kn ko kp kq paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/cafc5963fba9a63e0739b5f9927c4e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*F9k3P0tJcTkSLKMSEp365g.png"/></div></figure></div><p id="07cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我点击create并等待实例化。</p><figure class="kg kh ki kj fd kl er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kx"><img src="../Images/c20a514b28cf055b670079749786a23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKdAkJD6SsTZ70Lhvj2Yeg.png"/></div></div></figure><h1 id="4ee8" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">安装rsync并设置SSH</h1><p id="0ff0" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">通过云控制台将SSH连接到您的虚拟机，以执行接下来的步骤。</p><div class="kg kh ki kj fd ab cb"><figure class="kk kl ky kn ko kp kq paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/cb229c9a3b07bda28f356ab526962467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*s6hhA626hPWQSnhYKMYQPg.png"/></div></figure><figure class="kk kl kz kn ko kp kq paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/6aa90f6afde2f4b8fa133f372b6a5c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*BQ5mwZ4LvnxjvwYSvhkAeA.png"/></div></figure></div><p id="4fa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过运行以下命令，在Ubuntu虚拟机上安装rsync:</p><pre class="kg kh ki kj fd la lb lc ld aw le bi"><span id="9f03" class="lf je hi lb b fi lg lh l li lj">sudo apt-get install rsync</span></pre><p id="556e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将您将要用来连接虚拟机的<a class="ae lk" href="https://git-scm.com/book/en/v2/Git-on-the-Server-Generating-Your-SSH-Public-Key" rel="noopener ugc nofollow" target="_blank">公钥</a>(我使用的是<code class="du ll lm ln lb b">~/.ssh/id_rsa.pub</code>)添加到虚拟机的<code class="du ll lm ln lb b">~/.ssh/authorized_keys</code>文件中。如果你愿意，你可以为你的代码创建一个新的目录。</p><pre class="kg kh ki kj fd la lb lc ld aw le bi"><span id="14d5" class="lf je hi lb b fi lg lh l li lj">touch ~/.ssh/authorized_keys<br/>vi ~/.ssh/authorized_keys # paste the key from your local machine in here<br/>mkdir code_goes_here</span></pre><h1 id="8140" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">用rsync设置您的本地计算机</h1><p id="5809" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">现在，回到您的本地机器。在这上面也安装rsync。我在苹果电脑上，所以我用自制软件，但用你喜欢的命令行安装程序。</p><pre class="kg kh ki kj fd la lb lc ld aw le bi"><span id="1b77" class="lf je hi lb b fi lg lh l li lj">brew install rsync</span></pre><p id="ec5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您可以进入代码目录，运行rsync将代码从本地计算机下载到VM。</p><pre class="kg kh ki kj fd la lb lc ld aw le bi"><span id="8a48" class="lf je hi lb b fi lg lh l li lj">cd my_code<br/>rsync -a $PWD/ [YOUR_IP_ADDRESS]:code_goes_here/</span></pre><figure class="kg kh ki kj fd kl er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lo"><img src="../Images/e21c377a99449f740c573f778a4d9350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9n_Dy76CvKPyABgVrLzgA.png"/></div></div></figure><p id="0568" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您遇到权限或公钥被拒绝的问题，请尝试连接到VM以确保一切正常。您可以将特定的公钥和用户名添加到SSH命令中，看看是否有帮助。如果这样做了，将它们添加到您的<code class="du ll lm ln lb b">~/.ssh/config</code>文件中，这样rsync将在连接时自动使用它们。</p><figure class="kg kh ki kj fd kl er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lp"><img src="../Images/d5ccbc8f1e8560eb4e7b82a07ce79b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zcScthWNbpBNQOV2dEdcsQ.png"/></div></div></figure><h1 id="85e9" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">运行您的代码</h1><p id="aa86" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">最后，检查你的虚拟机，你的代码应该在那里！运行代码，如果你需要修改，编辑你的本地文件，rsync并返回你的虚拟机。</p><pre class="kg kh ki kj fd la lb lc ld aw le bi"><span id="de3f" class="lf je hi lb b fi lg lh l li lj">cd code_goes_here<br/>ls # Check that your code is there.<br/>mvn compile exec:java</span></pre></div></div>    
</body>
</html>