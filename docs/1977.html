<html>
<head>
<title>Org Policies by default</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">默认情况下的组织策略</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/org-policies-by-default-3adc0c8925b0?source=collection_archive---------0-----------------------#2021-10-06">https://medium.com/google-cloud/org-policies-by-default-3adc0c8925b0?source=collection_archive---------0-----------------------#2021-10-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c1758e5ce0f2ceaf79d2b4dc9625d6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iaSALE1XUAhvMR1Z"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">娜奥米·奥古斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="7736" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目前(2021年10月)谷歌云中有超过60个<a class="ae iu" href="https://cloud.google.com/resource-manager/docs/organization-policy/org-policy-constraints" rel="noopener ugc nofollow" target="_blank">组织策略</a>。哪些是更重要的支持对象是客户反复提到的话题，尤其是在他们开始云计算之旅的时候。我将在本文中尝试回答这个问题。</p><h1 id="e3d3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">一点背景知识</h1><p id="cdea" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">组织策略是您可以对服务的使用进行设置的限制或约束。例如，您可能希望将公共IP的使用仅限于某些特定的虚拟机(或者不使用)。该限制是在资源层次结构节点上设置的，这意味着您可以在组织、文件夹或项目层进行设置。限制的类型以及如何应用继承在<a class="ae iu" href="https://cloud.google.com/resource-manager/docs/organization-policy/overview" rel="noopener ugc nofollow" target="_blank">公共文档</a>中有很好的解释。</p><p id="ef44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我只提两种类型，<em class="kw">列表</em>和<em class="kw">布尔</em>。列表允许您指定一组允许或拒绝的值，例如允许拥有外部IP的虚拟机。布尔值用来强制执行给定的限制，例如是否可以创建外部服务帐户密钥。</p><h1 id="3116" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">如何选择</h1><p id="e155" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">现在问题来了，还有疑问。Org策略是作为您的团队的护栏，以确保您保持合规并改善您的安全状况。因此，第一种方法可能是:如果是为了更安全，为什么不启用所有这些功能呢？</p><p id="fab8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧，你可能认为你已经解决了决定的问题。我要说恰恰相反，因为现在你有了新的。启用约束意味着决定与您在GCP上的部署、您将使用的服务、您团队的工作流、您针对不同环境的策略相关的事情，并对其进行适当配置。这需要全面的知识，通常需要时间来获得和资源来执行。例如，您可能只允许使用私有操作系统映像，但没有具备创建这些强化映像技能的合适团队。当然，有些政策可能对你没有任何意义，因为你不打算使用它所适用的服务。</p><p id="a5d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么，如何创建一个合理的组织策略列表来考虑呢？我的方法是选择更常见的策略，对于一般公司来说，这是一种估计不太费力就能见效的策略，这意味着许多客户可能会从应用此类策略中受益。</p><p id="d457" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将介绍它们，但不会详细说明它们，您可以在公共文档中找到每个策略的详细信息和一些示例。让我们看看那份名单！</p><h1 id="0307" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">获胜者是…</h1><ul class=""><li id="a07a" class="kx ky hi ix b iy kr jc ks jg kz jk la jo lb js lc ld le lf bi translated"><strong class="ix hj">限制云SQL实例上的公共IP访问</strong> <br/>不言而喻，您应该尽可能让您的系统远离公共访问。主要针对私有连接的规划是必须的。</li><li id="ae07" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">实施公共访问防护</strong> <br/>保护您的云存储数据不被公开，就像保护网络一样。只有经过授权的人而不是所有用户才能访问您的数据。</li><li id="5838" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">实施统一的桶级访问</strong> <br/>确保所有云存储对象都应用了相同的权限，即桶的权限。这将更容易控制和审计每个对象是否有适当的权限。</li><li id="6064" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">禁用虚拟机串口访问</strong> <br/>很少需要一个交互式串口，以及一个获取访问权的攻击媒介。如果你需要它的输出，你可以从云日志中获得。</li><li id="4fdf" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">为虚拟机实例定义允许的外部IP</strong><br/>同样，尽可能将您的系统置于公共范围之外，避免使用公共IP。</li><li id="565b" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">域受限共享<br/> </strong>限制哪些域可以添加到IAM策略并获得对您的资源的权限。只有您组织中的用户应该，您不希望允许随机的gmail帐户访问您的系统，是吗？</li><li id="8fa4" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">禁用服务账户密钥创建</strong> <br/>服务账户密钥代表着很大的责任和安全风险，你应该尽可能使用谷歌管理的密钥。在少数不可能的情况下，你可能想看看这篇文章。</li><li id="c32a" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">禁用服务帐户密钥上传<br/> </strong>使用用户管理的密钥的另一种方法是在本地创建密钥，然后上传到云端。还是那句话，尽量不要依赖。</li><li id="e7c2" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">限制共享VPC项目取消留置权</strong> <br/>共享VPC项目是部署中非常重要的一部分，因为其VPC通常托管许多服务项目。保护自己不要再添加一个步骤(和IAM权限)来删除它。</li></ul><h1 id="95fa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">还有别的吗？</h1><p id="6404" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在阅读了这个列表之后，一个常见的问题是:有这么多的组织策略，你不会启用其他任何东西吗？除了那些您可能不使用的服务之外，还有其他一些策略可能在技术上很有趣，但仍然很难实现，或者被认为没有什么价值。考虑到这些问题，我编制了第二份清单，列出了我认为更相关的问题。</p><ul class=""><li id="09d8" class="kx ky hi ix b iy iz jc jd jg ll jk lm jo ln js lc ld le lf bi translated"><strong class="ix hj"> Google云平台—详细审计日志记录模式</strong> <br/>云存储可以记录请求<em class="kw">和</em>响应，这可能与那些有特定合规要求的行业相关。</li><li id="5a38" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">要求操作系统登录</strong> <br/>操作系统登录是比SSH更高级的登录机器的机制(我需要就此写一篇文章)。我知道改变程序不是一件小事，但这是值得的。</li><li id="453b" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">屏蔽虚拟机</strong> <br/>如果您可以使用<a class="ae iu" href="https://cloud.google.com/compute/docs/images/os-details#security-features" rel="noopener ugc nofollow" target="_blank">屏蔽映像</a>，您可以轻松获得屏蔽虚拟机针对rootkits和远程攻击提供的安全控制优势。</li><li id="2111" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">限制云NAT的使用</strong> <br/>您应该使用云NAT之类的服务来获得外部访问，而不是使用公共IP。尽管如此，这种访问应该受到控制，并且可能只针对某些代理。</li><li id="f325" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">限制非机密计算<br/> </strong> <em class="kw">在云中使用的数据加密</em>是一项非常有趣的功能，尤其是对于受监管的行业和高度敏感的工作负载。谷歌云<a class="ae iu" rel="noopener" href="/google-cloud/confidential-computing-is-cool-1d715cf47683">让实现变得非常简单。</a></li><li id="a4ac" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">定义可信映像项目</strong> <br/>只允许一组精选的操作系统映像，无论是来自您还是由Google提供和维护，这都是提高您的稳定性和安全性的一种方式。</li><li id="c3b7" class="kx ky hi ix b iy lg jc lh jg li jk lj jo lk js lc ld le lf bi translated"><strong class="ix hj">禁用默认服务帐户的自动IAM授权<br/> </strong>具有默认(宽)权限的默认服务帐户适用于测试，但不是生产工作负载的最佳方法。但是，禁用这些授权意味着您需要显式地向每个服务帐户授予所需的权限。</li></ul><h1 id="39aa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">概述</h1><p id="595a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我创建这个列表是为了给你一个建议和一个讨论哪个组织政策更适合你的公司的起点。显然，创建任何列表都会遗漏一些可能满足有效用例的策略。我认为这里列出的大多数都会引起您的业务共鸣，但是您应该查看它们，并考虑任何其他可能适用于您的用例的内容。</p><p id="45f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个合理的方法可能是使用这个列表开始，快速检查后，它是有意义的。然后，随着您继续您的云计算之旅并获得经验，您将会自己了解哪些其他人可能是相关的。我希望我在那段旅程中有所帮助！</p></div></div>    
</body>
</html>