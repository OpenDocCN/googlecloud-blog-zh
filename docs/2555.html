<html>
<head>
<title>Cloud Run VS App Engine: What’s the lowest cost?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">云运行VS App Engine:成本最低是多少？</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/cloud-run-vs-app-engine-whats-the-lowest-cost-6c82b874ed61?source=collection_archive---------0-----------------------#2022-11-26">https://medium.com/google-cloud/cloud-run-vs-app-engine-whats-the-lowest-cost-6c82b874ed61?source=collection_archive---------0-----------------------#2022-11-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="938e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">在本文中，“App Engine”一词仅代表</em> <a class="ae je" href="https://cloud.google.com/appengine/docs/standard" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="jd"> App Engine标准</em></strong></a><strong class="ih hj"><em class="jd"/></strong><em class="jd">版本。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/692fcc26106b08bb557f108ef710f7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9G6fk-veD4fosJ37CsADw.png"/></div></div></figure><p id="e9c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有的云提供商<strong class="ih hj">都提供无服务器服务</strong>。无服务器太棒了！您不需要设置、安装、管理或供应服务器。你只需简单地使用服务，并按使用量付费。</p><p id="6d24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在谷歌云上，有许多服务器服务。在无服务器计算领域，云运行和应用引擎有<strong class="ih hj">相似之处。这显然会导致询问<strong class="ih hj">选择哪个</strong>作为我的用例。</strong></p><p id="6cef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">【探索云跑是否适合你？阅读</strong> <a class="ae je" href="http://bit.ly/CloudRunvCloudFunctions" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">云函数vs .云运行:何时使用一个胜过另一个</strong> </a> <strong class="ih hj">。】</strong></p><p id="d553" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我之前<strong class="ih hj">对比过</strong> <a class="ae je" rel="noopener" href="/google-cloud/cloud-run-vs-cloud-functions-whats-the-lowest-cost-728d59345a2e"> <strong class="ih hj">云运行和云功能</strong> </a>，在成本和功能上，<strong class="ih hj">问云运行和App引擎</strong>同样的问题完全有道理。</p><blockquote class="jr"><p id="2326" class="js jt hi bd ju jv jw jx jy jz ka jc dx translated">所以，我们来对比一下云运行和App Engine。</p></blockquote><h1 id="2356" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">产品的相似性</h1><p id="97e1" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">正如我在简介中已经说过的，<strong class="ih hj"> 2产品在许多领域与</strong>相似(并非详尽):</p><ul class=""><li id="83b5" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">可扩展性至0</li><li id="8c4d" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">最小和最大实例</li><li id="3de2" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">版本控制和流量分割</li><li id="2f8f" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">IAM和访问控制</li><li id="45b2" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">客户管理的运行时服务帐户</li></ul><blockquote class="jr"><p id="4c41" class="js jt hi bd ju jv ls lt lu lv lw jc dx translated">成本和一些附加功能是<strong class="ak">的主要优势</strong>。让我们开始吧。</p></blockquote><h1 id="a206" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">应用引擎:遗产的重量</h1><p id="28f7" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">App Engine是Google Cloud 最古老的服务，发布于2008年，可能是其他许多服务的根源，如云功能、计算引擎或云运行。</p><p id="6291" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">我</em> <a class="ae je" href="https://community.c2cglobal.com/france-106/app-engine-drive-conversation-at-c2c-connect-france-session-on-june-28-3664" rel="noopener ugc nofollow" target="_blank"> <em class="jd">采访了谷歌云的开发者倡导者Wesley Chun </em> </a> <em class="jd">，他很好地解释了这个故事。</em></p><p id="1f0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://cloud.google.com/appengine/pricing" rel="noopener ugc nofollow" target="_blank">定价模式</a>，在<strong class="ih hj">自动缩放模式</strong>(最类似于云运行行为)中，如下所示</p><ul class=""><li id="9fe3" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">实例类型F1(<strong class="ih hj">0.25 vCPU，256Mb </strong>内存):<strong class="ih hj"> $0.05每小时</strong></li><li id="cb70" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">实例<strong class="ih hj">在最近处理的请求</strong>后15分钟计费</li><li id="359a" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">有<strong class="ih hj">28小时空闲</strong>的F1实例相当于<strong class="ih hj">每天(和每个项目)</strong></li></ul><p id="920b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">为了与云运行相媲美，我们将使用</em> <a class="ae je" href="https://cloud.google.com/appengine/docs/standard" rel="noopener ugc nofollow" target="_blank"> <em class="jd"> F4实例类型</em> </a> <em class="jd">，因此</em> <strong class="ih hj"> <em class="jd">内存为1Gb </em> </strong> <em class="jd">。对于F4实例类型，4倍多的CPU导致空闲层缩短4倍，因此7小时。</em></p><h1 id="1477" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km lx ko kp kq ly ks kt ku lz kw kx ky bi translated">云运行:定价模式的新时代</h1><p id="1ccf" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">云跑要现代得多。<strong class="ih hj">发布于2019年</strong>它的定价更加细化。主要的区别是基于请求管理的CPU分配:你只在请求被处理的时候支付资源，之后没有，即使Google Cloud继续保持你的实例温暖。</p><p id="aabe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“按请求”<a class="ae je" href="https://cloud.google.com/run/pricing" rel="noopener ugc nofollow" target="_blank">定价模式</a>如下</p><ul class=""><li id="74d7" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><strong class="ih hj"> 1 vCPU成本:每小时0.0864美元</strong></li><li id="c043" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><strong class="ih hj"> 1Gb内存成本:每小时0.009美元</strong></li><li id="7256" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">该实例在最近处理的请求之后的100毫秒上一轮<strong class="ih hj">计费</strong></li><li id="dff8" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">免费等级适用于账单账户。<em class="jd">在最坏的情况下，</em> <strong class="ih hj"> <em class="jd">我会在比较中忽略它。</em>T45】</strong></li></ul><h2 id="0ebf" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">总是在CPU分配上</h2><p id="a023" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">云运行提供了不同的<a class="ae je" href="https://cloud.google.com/run/docs/configuring/cpu-allocation" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> CPU分配选项</strong> </a>。其中一个就是“<strong class="ih hj">一直开着</strong>”。</p><p id="da7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，当Cloud Run处理完一个请求时，<strong class="ih hj"> CPU会被节流(低于5%) </strong>，无法在实例上处理任何事情。</p><p id="e042" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“始终开启”选项<strong class="ih hj">在没有处理请求时移除CPU节流</strong>，因此<strong class="ih hj">可以继续在实例上执行处理</strong>(后台进程、异步操作等)。<br/>当然，因为<strong class="ih hj"> CPU还是分配</strong>给你服务的，<strong class="ih hj">你就要为它买单</strong>。并且，直到实例关闭(在最近处理的请求之后15分钟)</p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="559b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此<strong class="ih hj">行为与App Engine CPU分配</strong>相同，比较此选项的成本也很有趣。</p><p id="53ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“始终在线”定价模式如下所示</p><ul class=""><li id="ca1b" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><strong class="ih hj"> 1个vCPU成本:每小时0.0648美元</strong></li><li id="a815" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><strong class="ih hj"> 1Gb内存成本:每小时0.007美元</strong></li><li id="39a4" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">该实例在最近处理的请求15分钟后<strong class="ih hj">计费</strong></li><li id="495b" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">免费等级适用于账单账户。<em class="jd">最坏的情况，</em> <strong class="ih hj"> <em class="jd">我会在比较中忽略。</em>T13】</strong></li></ul><h1 id="d6e9" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km lx ko kp kq ly ks kt ku lz kw kx ky bi translated">定价模式比较</h1><p id="fa82" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">比较定价模型并不十分明显。有两个主要区别</p><ul class=""><li id="a50e" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">实例上最新流程请求后的<strong class="ih hj">计费时间</strong></li><li id="7488" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><strong class="ih hj">自由层</strong> <em class="jd">(云运行时忽略)</em></li></ul><p id="d62c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">我忽略了两种产品的“请求量”和“出口”成本</em></p><p id="e5ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，两种产品之间的第一次原始比较可以<strong class="ih hj">揭示第一个差异</strong>:</p><ul class=""><li id="2397" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">“按请求”选项</li></ul><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mv"><img src="../Images/d7f7c378f7c6b9290f6c61cdec44af60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EQ12VnKpuBOA2a5c"/></div></div></figure><p id="b99b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">同样的资源量，云运行比</strong>便宜2倍！</p><ul class=""><li id="f894" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">“永远在线”选项</li></ul><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mw"><img src="../Images/1625e2a3c81231f83ea79623bfd9fe92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BqBp5VxDSCHbN9HJ"/></div></div></figure><p id="2a44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对于同样数量的资源，云运行的成本大约是App Engine的三分之一</strong>！</p><h2 id="3007" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">理论情景</h2><p id="872a" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">成本基于使用的资源(CPU和内存的大小)，但<strong class="ih hj">也基于使用持续时间</strong>。这就是为什么<strong class="ih hj">“行动中”场景对于</strong>陈述使用中的两种产品的主要成本差异非常重要。</p><p id="dad7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我建议<strong class="ih hj">将仅一个实例</strong>的成本与<strong class="ih hj">定义的请求处理持续时间</strong>进行比较，其中<strong class="ih hj">接收周期性请求</strong>(频率可以改变，但<strong class="ih hj">平均分配在1小时</strong>内)。</p><p id="96f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我<strong class="ih hj">在</strong> <a class="ae je" href="https://docs.google.com/spreadsheets/d/16BogxOgGxjvBoUA5dhxWlcMv-bE9gX_86YbjnRzi30A/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这个Google sheet </strong> </a>中建模，用一天中每小时的成本和一个月中每天的成本(两者都是累积的)。<br/>你可以找到<strong class="ih hj"> 2张纸，每个选项一张</strong>:</p><ul class=""><li id="09cc" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">“按请求”选项；默认云运行行为</li><li id="daed" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">“永远在线”选项；设置了无CPU限制选项后</li></ul><p id="3e82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">在您的帐户中复制它以更新值并执行您自己的模拟。</em></p><h2 id="7079" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">自由层优势</h2><p id="b882" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">无论选择什么，App Engine的<strong class="ih hj">明显优势是免费层</strong>。<strong class="ih hj">每天的前7个小时总是空闲的</strong>(在1个实例的情况下)。<em class="jd">见日初平线</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mx"><img src="../Images/7b8243e41f99bff566ed720176629cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8GgQYNT1Ydfvckbt"/></div></div></figure><p id="ecc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://cloud.google.com/free/docs/free-cloud-features#cloud-run" rel="noopener ugc nofollow" target="_blank"> <em class="jd">在云运行</em> </a> <em class="jd">上也存在免费层，但我选择忽略它，因为它是按计费账户(并在几个项目中共同化)而不是按项目。</em></p><h2 id="d7d6" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">“每次请求”期权定价模型</h2><p id="3adc" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">然而，<strong class="ih hj">遗留模式</strong>的重量，尤其是继续支付一个未使用实例<strong class="ih hj">的15分钟完全改变了游戏</strong>。当存在稀疏请求时，App Engine有一个严重的缺点<strong class="ih hj"/><br/><em class="jd">最坏的情况是每15分钟1个100ms的请求(每小时4个)</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/6f88be9a7c54b26307539d64ff139288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ltge1kN9-mCg3xtD"/></div></div></figure></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="8c4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随着请求数量的增加和/或请求处理时间的延长，成本差异不太明显。其实，<strong class="ih hj">所有减少“不劳而获”App引擎实例的案例</strong>。</p><p id="0dd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在App Engine的最佳情况下，我们可以拥有1s的请求处理持续时间和每小时3600个请求，<strong class="ih hj">因此实例得到了充分利用，没有浪费</strong>。</p><p id="2ca5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但即使在这种情况下，在免费层的帮助下，<strong class="ih hj"> App Engine仍然比Cloud Run贵了近50%。</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/4269fd8f319e80e47635a8fdfcb9c138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lz4ggwUUWZXVnVwk"/></div></div></figure></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="c8ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">App Engine的真正优势是当<strong class="ih hj">流量非常稀少并且使用停留在免费层</strong>时。云运行，因为<strong class="ih hj">我选择忽略计费账户所有项目之间共享的自由层</strong>，你<strong class="ih hj">从第一个请求开始支付一点。</strong></p><p id="1951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">拐点大约是每小时1个请求，处理持续时间为287秒</strong>(大约5分钟)</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/763101781e6483c91c9cc74f417a9cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7h-SY-7KXouEK60S"/></div></div></figure><blockquote class="mz na nb"><p id="5b51" class="if ig jd ih b ii ij ik il im in io ip nc ir is it nd iv iw ix ne iz ja jb jc hb bi translated">这完全符合一个小时流程用例！！</p></blockquote><h2 id="e0c6" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">“永远在线”期权定价模型</h2><p id="f7ae" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">为了更接近App Engine的行为,“Always ON”CPU分配选项是继续在请求上下文之外执行处理的解决方案。<br/>顺便说一下，<strong class="ih hj"> CPU仍然被分配给实例，并在最后一次请求后15分钟作为应用程序引擎计费。</strong></p><p id="1a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一次，两个服务的<strong class="ih hj">正常运行时间是相同的</strong>(因为相同的行为)。因此，<strong class="ih hj">只有直接成本和自由层产生差异。</strong></p><p id="174c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是一个100%正常运行时间的例子。<strong class="ih hj">原生成本仍处于云运行的优势</strong></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/36e599e9313af3225a74f0e329e573ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yAuuhudF3a5o_098"/></div></div></figure></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="49a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于免费层，优势还是在App Engine。这一次，<strong class="ih hj">拐点大约是每小时1个请求，处理持续时间为740秒</strong>(大约12分20秒)</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es my"><img src="../Images/8c99ef76e7f2b411ffbc95ebd7f733cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*03RX8t5ryVHV7VlE"/></div></div></figure><p id="6f98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">完全是理论上的，因为App引擎的</em> <strong class="ih hj"> <em class="jd">最大超时是HTTP请求10分钟</em> </strong> <em class="jd">(云运行60分钟)</em></p><h2 id="5585" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">传统优势</h2><p id="2ea5" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">然而，快速得出<strong class="ih hj"> App Engine退出游戏的结论是错误的！！</strong>的确我没有提到一个Cloud Run没有的App Engine真正酷的功能。</p><p id="eb4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用App Engine  可以<a class="ae je" href="https://cloud.google.com/appengine/docs/standard/serving-static-files" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">免费提供静态文件。使用Cloud Run，您必须使用NGINX(或类似工具)构建一个容器来服务静态源，因此会消耗CPU和内存。</strong></a></p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="fde8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了静态文件服务之外，App Engine还提供了更加精细的<a class="ae je" href="https://cloud.google.com/appengine/docs/legacy/standard/python/config/appref#scaling_elements" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">配置来控制和定制自动缩放器</strong> </a> <strong class="ih hj"> </strong>(延迟、CPU、吞吐量、空闲实例)</p><p id="c9ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不知道你是否需要那个级别的配置。<strong class="ih hj">我个人很喜欢“空闲实例”配置，也很怀念Cloud Run上的这个特性。</strong></p><h1 id="abb4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km lx ko kp kq ly ks kt ku lz kw kx ky bi translated">超越成本</h1><p id="f6b5" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我说过，产品<strong class="ih hj">在很多核心特性</strong>上是相似的。然而，Cloud Run更加现代，不会受到传统的影响。因此，<strong class="ih hj">在许多有趣的领域进化得更快更容易。</strong></p><p id="f190" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">App Engine中最近新增了</strong>，比如<a class="ae je" href="https://cloud.google.com/appengine/docs/standard/connecting-vpc#egress" rel="noopener ugc nofollow" target="_blank">出口控制</a>和<a class="ae je" href="https://cloud.google.com/appengine/docs/standard/user-managed-service-accounts" rel="noopener ugc nofollow" target="_blank">用户管理服务账户</a>的使用。他们<strong class="ih hj">帮助App Engine留在比赛中</strong>，但在他们被添加到Cloud Run几个月后</p><h2 id="25dd" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated"><strong class="ak">多区域能力</strong></h2><p id="3f27" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">app Engine<strong class="ih hj">粘在一个区域</strong>。更糟糕的是，如果你在<strong class="ih hj">错误的地区设置了应用引擎，你就不能修改它。<br/> <em class="jd">唯一解决方案:删除你的项目，新建一个！！</em></strong></p><p id="00b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，<strong class="ih hj">云运行是多区域兼容的</strong>，并且耦合到一个<a class="ae je" href="https://cloud.google.com/load-balancing/docs/https/setting-up-https-serverless" rel="noopener ugc nofollow" target="_blank"> HTTPS负载均衡器</a>，离客户端最近的云运行服务为请求服务。<br/> <em class="jd">只需在不同地区使用相同的服务名，</em> <strong class="ih hj"> <em class="jd">路由是自动的！</em> </strong></p><h2 id="461d" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated"><strong class="ak"> CUD和成本优化</strong></h2><p id="e859" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">另一个有趣的选择是，如果你是一个密集使用云运行服务的用户，你可以在你所有的云运行服务中为每个地区提交一个使用量。</p><p id="5fed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你甚至有<strong class="ih hj">一个</strong> <a class="ae je" href="https://cloud.google.com/docs/cuds-recommender" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">推荐器</strong> </a> <strong class="ih hj">帮助你做出正确的云运行CUD选择</strong>来优化你的计费！</p><h2 id="d9cf" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated">资源分配</h2><p id="335b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">因为一个尺寸不能适合所有人，所以定制是最重要的。<a class="ae je" href="https://cloud.google.com/appengine/docs/standard#instance_classes" rel="noopener ugc nofollow" target="_blank"> App Engine根据选择的缩放选项提供4-5个实例类</a>。而<strong class="ih hj">CPU的能力决定了内存大小</strong>(反之亦然)</p><p id="95ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">云运行更方便，可以<strong class="ih hj">独立扩展vCPU(0.25 - &gt; 8)和内存(128Mb - &gt; 32Gb) </strong>。您可以根据自己的需求精确调整实例大小，减少资源浪费。</p><h2 id="936d" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated"><strong class="ak">入口控制</strong></h2><p id="57b7" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">入口控制允许我们<strong class="ih hj">将服务从互联网中移除</strong>。当然URL仍然是公开的，但是<strong class="ih hj">流量来源是受控的</strong>。将入口参数设置为内部，仅允许来自项目和VPC SC的请求，否则会被拒绝。</p><p id="e4fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="https://cloud.google.com/run/docs/securing/ingress" rel="noopener ugc nofollow" target="_blank">云运行</a>，还有云功能，实现这个功能，<strong class="ih hj"> App引擎还没有。</strong></p><h2 id="2abf" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated"><strong class="ak">还有更多……</strong></h2><p id="c57e" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我不会描述所有的差异，但如果你想深入了解云运行的其他酷功能，这里是我最感兴趣的:</p><ul class=""><li id="f663" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><a class="ae je" href="https://cloud.google.com/run/docs/configuring/request-timeout" rel="noopener ugc nofollow" target="_blank"> HTTP请求超时</a></li><li id="9cad" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">挂载本地存储(<a class="ae je" href="https://cloud.google.com/run/docs/tutorials/network-filesystems-fuse" rel="noopener ugc nofollow" target="_blank"> GCS </a>或<a class="ae je" href="https://cloud.google.com/run/docs/tutorials/network-filesystems-filestore" rel="noopener ugc nofollow" target="_blank">文件存储</a></li><li id="7c4a" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="https://cloud.google.com/run/docs/configuring/secrets" rel="noopener ugc nofollow" target="_blank">秘密经理人整合</a></li><li id="2b06" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="https://cloud.google.com/run/docs/configuring/http2" rel="noopener ugc nofollow" target="_blank"> HTTP/2支持</a></li><li id="d6a9" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" rel="noopener" href="/google-cloud/knative-and-cloud-run-portability-in-action-1a655c914318">便携性和功能兼容性</a></li><li id="cd33" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated"><a class="ae je" href="https://cloud.google.com/run/docs/tutorials/eventarc" rel="noopener ugc nofollow" target="_blank"> Eventarc集成</a>(支持125+服务作为事件源)</li></ul><h2 id="c9c3" class="ma kc hi bd kd mb mc md kh me mf mg kl iq mh mi kp iu mj mk kt iy ml mm kx mn bi translated"><strong class="ak">开发者自由</strong></h2><p id="be76" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">无服务器产品，如云功能、App Engine和其他竞争对手的解决方案<strong class="ih hj">总是限制的同义词</strong>:环境运行时、支持的语言、嵌入式库……<br/>例如，<strong class="ih hj"> App Engine </strong> <a class="ae je" href="https://cloud.google.com/appengine/docs/standard#standard_environment_languages_and_runtimes" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">支持6种语言版本的子集</strong> </a> <strong class="ih hj">。</strong></p><p id="3feb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，<strong class="ih hj"> Cloud Run部署容器</strong>，开发者<strong class="ih hj">花一点力气(配置和构建容器)就接管了执行运行时的控制权</strong>，安装的库和二进制，甚至使用的语言，<strong class="ih hj">只要强制执行</strong> <a class="ae je" href="https://cloud.google.com/run/docs/container-contract" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">容器运行时契约</strong> </a> <strong class="ih hj">。</strong></p><h1 id="4b5e" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km lx ko kp kq ly ks kt ku lz kw kx ky bi translated">通向未来之路</h1><p id="7d59" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">尽管有这些巨大的优势(和我的爱)，<strong class="ih hj">云运行并不是所有用例的解决方案。</strong></p><p id="7fff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">小时/日流程用例完美契合App Engine服务</strong>。此外，我推荐的网站托管模式之一是:</p><ul class=""><li id="8e29" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><strong class="ih hj">在App Engine上托管静态文件，免费</strong></li><li id="f73f" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">在云运行上托管动态代码(API、批处理)</li><li id="da97" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">在无服务器服务前设置一个<a class="ae je" href="https://cloud.google.com/load-balancing/docs/negs/serverless-neg-concepts" rel="noopener ugc nofollow" target="_blank">负载均衡器，将流量路由到相应的后端。<em class="jd">添加CDN，云跑多区域部署，云甲让你的网站更上一层楼。</em></a></li></ul><p id="eed2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于<strong class="ih hj">所有其他用例</strong>、<strong class="ih hj">我只能推荐云运行</strong>。对于开发者来说，现代的<strong class="ih hj">架构</strong>、<strong class="ih hj">特性</strong>和<strong class="ih hj">自由</strong>意味着更多的<strong class="ih hj">创新、更快的开发</strong>、<strong class="ih hj">更少的约束</strong>、高度可定制的环境和<strong class="ih hj">因此，最终会有更多的价值。</strong></p><p id="9754" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">…甚至超出了原始成本！</em></p></div><div class="ab cl mo mp gp mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="hb hc hd he hf"><p id="55b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要感谢Steren的评论和那篇文章的想法。</p><p id="2a3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">【你在探索如何用容器保存吗？查看</strong> <a class="ae je" href="http://bit.ly/ContainerCosts" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">云智慧周刊:用容器降低成本的5种方法</strong> </a> <strong class="ih hj">。】</strong></p></div></div>    
</body>
</html>