<html>
<head>
<title>Deploying a Functions (serverless) app on Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Cloud上部署功能(无服务器)应用</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/deploying-a-functions-serverless-app-on-google-cloud-e8f0e3011b2b?source=collection_archive---------2-----------------------#2018-04-19">https://medium.com/google-cloud/deploying-a-functions-serverless-app-on-google-cloud-e8f0e3011b2b?source=collection_archive---------2-----------------------#2018-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/18295f16f94820b3a20a345ab4286acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*6pm1fXg4O8JnHPB6hYa8UA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">谷歌云</figcaption></figure><p id="2700" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">本教程将向您展示如何将功能应用部署到谷歌云</em></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="9a6b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">先决条件</h1><ul class=""><li id="041d" class="ku kv hi is b it kw ix kx jb ky jf kz jj la jn lb lc ld le bi translated">您已经安装了<code class="du lf lg lh li b">gcloud</code>工具</li><li id="e103" class="ku kv hi is b it lj ix lk jb ll jf lm jj ln jn lb lc ld le bi translated">你在GCP有一个项目</li></ul><blockquote class="lp lq lr"><p id="26c1" class="iq ir jo is b it iu iv iw ix iy iz ja ls jc jd je lt jg jh ji lu jk jl jm jn hb bi translated">注意:您必须安装<code class="du lf lg lh li b">gcloud</code>测试版</p></blockquote><p id="cdb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要安装<code class="du lf lg lh li b">gcloud</code>测试版使用:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="52c7" class="md jx hi li b fi me mf l mg mh">gcloud components update &amp;&amp; gcloud components install beta</span></pre><h1 id="5f64" class="jw jx hi bd jy jz mi kb kc kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt bi translated">我们开始吧</h1><p id="9baa" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb mn jd je jf mo jh ji jj mp jl jm jn hb bi translated">首先，让我们制作一个目录并输入它:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="900a" class="md jx hi li b fi me mf l mg mh">mkdir ~/hello_functions &amp;&amp; cd hello_functions</span></pre><p id="6414" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，制作一个<code class="du lf lg lh li b">index.js</code>文件，并将它放入:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="3dcc" class="md jx hi li b fi me mf l mg mh">exports.helloFunctions = (req, res) =&gt; {<br/>  res.send('Hello Functions!');<br/>};</span></pre><p id="0127" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就产生了一个名为<code class="du lf lg lh li b">helloFunctions</code>的函数，它用<code class="du lf lg lh li b">Hello Functions!</code>来响应GET请求</p><h1 id="b139" class="jw jx hi bd jy jz mi kb kc kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt bi translated">就这样？</h1><p id="4e7f" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb mn jd je jf mo jh ji jj mp jl jm jn hb bi translated">是的，差不多。剩下的就让谷歌云来做吧。</p><p id="4041" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">确保您的项目ID(来自GCP)被设置为环境变量，并配置<code class="du lf lg lh li b">gcloud</code>来使用它:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="0e65" class="md jx hi li b fi me mf l mg mh">PROJECT_ID=&lt;project-id&gt;<br/>gcloud config set project $PROJECT_ID</span></pre><p id="3bdb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在部署您的函数应用程序:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="065b" class="md jx hi li b fi me mf l mg mh">gcloud beta functions deploy helloFunctions --trigger-http</span></pre><blockquote class="lp lq lr"><p id="4a52" class="iq ir jo is b it iu iv iw ix iy iz ja ls jc jd je lt jg jh ji lu jk jl jm jn hb bi translated">注意:它可能会要求您启用函数API，请说“是”</p></blockquote><p id="8835" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">部署完成后，您可以通过以下内容找到您的函数的URL:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="ea8a" class="md jx hi li b fi me mf l mg mh">gcloud beta functions describe helloFunctions | grep url</span></pre><p id="d543" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该URL应该类似于:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="04c7" class="md jx hi li b fi me mf l mg mh">https://[GCP-REGION]-[PROJECT_ID].cloudfunctions.net/helloFunctions</span></pre><p id="cdeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在浏览器中打开该URL，您应该会看到<code class="du lf lg lh li b">Hello Functions!</code></p><h1 id="d48c" class="jw jx hi bd jy jz mi kb kc kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt bi translated">本地测试</h1><p id="bab1" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb mn jd je jf mo jh ji jj mp jl jm jn hb bi translated">如果你想在部署之前在本地测试你的功能，<a class="ae lo" href="https://github.com/GoogleCloudPlatform/cloud-functions-emulator" rel="noopener ugc nofollow" target="_blank">云功能模拟器</a>让它变得超级简单！</p><p id="4f07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先安装函数模拟器:</p><p id="402b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lf lg lh li b">npm install -g @google-cloud/functions-emulator</code></p><p id="f798" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后启动它:</p><p id="7f19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lf lg lh li b">functions-emulator start</code></p><p id="a8df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在在本地部署该功能:</p><p id="ca32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lf lg lh li b">functions-emulator deploy helloFunctions --trigger-http</code></p><p id="3114" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并测试它！</p><p id="70e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lf lg lh li b">functions-emulator call helloFunctions</code></p><p id="7292" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该会看到类似这样的内容:</p><pre class="lv lw lx ly fd lz li ma mb aw mc bi"><span id="4b02" class="md jx hi li b fi me mf l mg mh">ExecutionId: d02ce9e7-bf2c-44fb-89ab-ab8445277ecd<br/>Result: Hello Functions!</span></pre><h1 id="24dd" class="jw jx hi bd jy jz mi kb kc kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt bi translated">⒡ → 👋功能</h1><p id="021b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb mn jd je jf mo jh ji jj mp jl jm jn hb bi translated">感谢阅读！如有疑问，在下方评论！</p></div></div>    
</body>
</html>