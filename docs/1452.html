<html>
<head>
<title>Introduction to BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery简介</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/introduction-to-bigquery-d5c93f52b630?source=collection_archive---------0-----------------------#2020-05-31">https://medium.com/google-cloud/introduction-to-bigquery-d5c93f52b630?source=collection_archive---------0-----------------------#2020-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6ced" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">最初发表于</em>【https://pbhadani.com】<em class="jd"/></p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><p id="7691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将谈论谷歌的大数据分析<a class="ae je" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank"> BigQuery </a>服务。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/ec3b6fb89dc1ef31e35ea482f60d121c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QimMY-cnTfQ2LqZ9.jpg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">图片来自<a class="ae je" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae je" href="https://pixabay.com/users/Pexels-2286921" rel="noopener ugc nofollow" target="_blank">像素</a></figcaption></figure><h1 id="fcc6" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">概观</h1><p id="f151" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated"><a class="ae je" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank"> BigQuery </a>是一款基于谷歌云平台的无服务器、高可伸缩、高性价比的企业级现代数据仓库产品。它允许分析师使用ANSI SQL快速分析数Pb的数据，而没有运营开销。</p><h1 id="9a03" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">关键特征</h1><p id="89be" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated"><strong class="ih hj">无服务器:</strong>无运营模式。Google在幕后管理所有的资源供应。</p><p id="ccf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">快速SQL: </strong>支持亚秒级查询响应时间和高并发的ANSI SQL。</p><p id="93fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">托管存储:</strong>数据一旦加载到BigQuery，就以有效的方式存储在由BigQuery管理的&amp;中。</p><p id="f75e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据加密&amp;安全性:</strong>数据静态加密，集成云端IAM，安全性高。</p><p id="ff58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> BigQuery ML: </strong>支持数据科学家和数据分析师使用SQL语法在BigQuery中构建、训练和测试ML模型。</p><p id="e168" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> BigQuery GIS: </strong>通过允许分析和可视化BigQuery中的地理空间数据来实现位置智能。</p><p id="514a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">灵活定价模式:</strong>按需和统一费率定价。最新定价模式，请参考<a class="ae je" href="https://cloud.google.com/bigquery/pricing" rel="noopener ugc nofollow" target="_blank">官方文档</a></p><p id="faeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最新完整列表，请参考<a class="ae je" href="https://cloud.google.com/bigquery#section-9" rel="noopener ugc nofollow" target="_blank">官方文档</a></p><h1 id="54fb" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">如何访问BigQuery？</h1><p id="df39" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">有多种方式可以与BigQuery交互:</p><ul class=""><li id="e5ee" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><a class="ae je" href="https://console.cloud.google.com/bigquery" rel="noopener ugc nofollow" target="_blank">网络用户界面</a></li><li id="1705" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae je" href="https://cloud.google.com/bigquery/docs/bq-command-line-tool" rel="noopener ugc nofollow" target="_blank"> BQ命令行工具</a></li><li id="f410" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae je" href="https://cloud.google.com/bigquery/docs/reference/libraries" rel="noopener ugc nofollow" target="_blank"> BigQuery API客户端库</a></li><li id="8071" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae je" href="https://cloud.google.com/bigquery/docs/reference/rest" rel="noopener ugc nofollow" target="_blank"> BigQuery REST API </a></li><li id="79b1" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><a class="ae je" href="https://cloud.google.com/bigquery#section-11" rel="noopener ugc nofollow" target="_blank">第三方工具</a></li></ul><h1 id="02d7" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用bq与BigQuery交互</h1><h2 id="cf20" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">先决条件</h2><p id="a0c4" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated">本帖假设如下:<br/> 1。我们已经有了一个GCP项目和启用的big query API<a class="ae je" href="https://console.cloud.google.com/flows/enableapi?apiid=bigquery" rel="noopener ugc nofollow" target="_blank"/>。<br/> 2。谷歌云SDK ( <code class="du mh mi mj mk b">gcloud</code>)。如果没有，那就参考我之前的博客-<a class="ae je" href="https://pbhadani.com/posts/getting-started-wth-google-cloud-sdk/" rel="noopener ugc nofollow" target="_blank">Google Cloud SDK入门</a>。</p><h1 id="48c4" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">BigQuery操作</h1><h2 id="13bb" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">创建数据集</h2><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="adc1" class="lt kd hi mk b fi mp mq l mr ms">bq mk bq_dataset</span></pre><h2 id="5349" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">列出数据集</h2><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="fbf2" class="lt kd hi mk b fi mp mq l mr ms">bq ls</span></pre><p id="e81d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="89e7" class="lt kd hi mk b fi mp mq l mr ms">datasetId<br/>--------------<br/>bq_dataset</span></pre><h2 id="f475" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">在数据集中创建表</h2><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="2cdd" class="lt kd hi mk b fi mp mq l mr ms">bq mk <strong class="mk hj">\<br/></strong>--table <strong class="mk hj">\<br/></strong>--expiration <strong class="mk hj">3600</strong> <strong class="mk hj">\<br/></strong>--description <strong class="mk hj">"This is my BQ table"</strong> <strong class="mk hj">\<br/></strong>--label env:dev <strong class="mk hj">\<br/></strong>bq_dataset.first_table <strong class="mk hj">\<br/></strong>col1:STRING,col2:FLOAT,col3:STRING</span></pre><h2 id="bfd7" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">检查BigQuery表</h2><p id="c102" class="pw-post-body-paragraph if ig hi ih b ii la ik il im lb io ip iq lc is it iu ld iw ix iy le ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>我将检查公共数据集中的一个表。</p><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="48bc" class="lt kd hi mk b fi mp mq l mr ms">bq show bigquery-public-data:covid19_jhu_csse.summary</span></pre><p id="dfd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="2a53" class="lt kd hi mk b fi mp mq l mr ms">Table bigquery-public-data:covid19_jhu_csse.summary<br/><br/>Last modified              Schema              Total Rows   Total Bytes   Expiration   Time Partitioning   Clustered Fields      Labels<br/>----------------- ----------------------------- ------------ ------------- ------------ ------------------- ------------------ --------------<br/>07 Jun 10:06:41   |- province_state: string     254940       41005062                                                          freebqcovid:<br/>                |- country_region: string<br/>                |- date: date<br/>                |- latitude: float<br/>                |- longitude: float<br/>                |- location_geom: geography<br/>                |- confirmed: integer<br/>                |- deaths: integer<br/>                |- recovered: integer<br/>                |- active: integer<br/>                |- fips: string<br/>                |- admin2: string<br/>                |- combined_key: string</span></pre><h2 id="ee72" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">运行查询</h2><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="c975" class="lt kd hi mk b fi mp mq l mr ms">bq query --use_legacy_sql=<strong class="mk hj">false</strong> <strong class="mk hj">\<br/>'SELECT<br/>date,<br/>country_region,<br/>SUM(confirmed),<br/>SUM(deaths)<br/>FROM<br/>`bigquery-public-data.covid19_jhu_csse.summary`<br/>GROUP BY<br/>date,<br/>country_region<br/>HAVING date = "2020-05-31"<br/>AND<br/>country_region IN ("India", "US")'</strong></span></pre><p id="9ab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="75a5" class="lt kd hi mk b fi mp mq l mr ms">Waiting on bqjob_r2935edb2e19bc9f_000001728e32aded_1 ... (0s) Current status: DONE<br/>+------------+----------------+---------+--------+<br/>|    date    | country_region |   f0_   |  f1_   |<br/>+------------+----------------+---------+--------+<br/>| 2020-05-31 | US             | 1790172 | 104381 |<br/>| 2020-05-31 | India          |  190609 |   5408 |<br/>+------------+----------------+---------+--------+</span></pre><h2 id="350e" class="lt kd hi bd ke lu lv lw ki lx ly lz km iq ma mb kq iu mc md ku iy me mf ky mg bi translated">清理:删除数据集</h2><pre class="jn jo jp jq fd ml mk mm mn aw mo bi"><span id="fe5e" class="lt kd hi mk b fi mp mq l mr ms">bq rm -r bq_dataset</span></pre><p id="de99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这篇博客能帮助你熟悉BigQuery。</p><p id="92ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有反馈或问题，请通过<a class="ae je" href="https://linkedin.com/in/pradeepbhadani" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae je" href="https://twitter.com/bhadanipradeep" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我。</p></div></div>    
</body>
</html>