<html>
<head>
<title>Launching Neo4j on Google’s Kubernetes Marketplace</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在谷歌的Kubernetes市场上发布Neo4j</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/launching-neo4j-on-googles-kubernetes-marketplace-97c23c94e960?source=collection_archive---------0-----------------------#2018-07-31">https://medium.com/google-cloud/launching-neo4j-on-googles-kubernetes-marketplace-97c23c94e960?source=collection_archive---------0-----------------------#2018-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bd7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在最近的Cloud Next’18大会上，谷歌宣布Kubernetes应用程序在GCP市场可用。其要点是，现在应用程序可以从市场安装到Kubernetes集群中，而无需编写任何YAML。</p><p id="9ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Neo4j是这个项目的合作伙伴之一，所以我想展示一下它在实践中是如何工作的，以及为什么它很酷。今天，我们将从“我没有Kubernetes集群”开始，用大约10分钟的时间在Kubernetes集群中运行Neo4j中的Cypher。我们将使用<a class="ae jd" href="https://console.cloud.google.com/marketplace/details/neo4j-public/causal-cluster-k8s" rel="noopener ugc nofollow" target="_blank"> Neo4j市场入口</a>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/39faa9153139da702a803a217b7d8e62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*Za2xpg7gmwq9OciYPL21TA.png"/></div></div></figure><h1 id="8157" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">创建GKE集群</h1><p id="5e81" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">让我们从<a class="ae jd" href="https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-cluster" rel="noopener ugc nofollow" target="_blank">创建一个谷歌Kubernetes引擎(GKE)集群</a>开始。GKE是谷歌托管的Kubernetes服务。基本上是普通的Kubernetes，带有一些漂亮的附加组件和一个很棒的命令行界面管理外壳。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/3a91d8cf5b66cfd2b58897b3ae43b0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IlPB7jWWdnII34G6p60_6Q.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">成就解锁:闪亮的新kubernetes集群</figcaption></figure><p id="c71e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经准备好了，我们只需在GCP市场查找Neo4j，确保使用“Kubernetes Apps”过滤器。你可以通过这个链接直接跳到正确的位置<a class="ae jd" href="https://console.cloud.google.com/marketplace/details/neo4j-public/causal-cluster-k8s" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/74c4c5e8a69ff1f37a9eed15fbd66009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iB6aoCAAGy3rXzkgF9qTmQ.png"/></div></div></figure><h1 id="63a2" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">部署Neo4j</h1><p id="9746" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">单击此磁贴将进入产品概述页面，页面上有一个大的“配置”按钮，我们将单击该按钮。在该产品概述页面上还有一个链接，链接到Github上的<a class="ae jd" href="https://github.com/neo-technology/neo4j-google-k8s-marketplace/blob/master/user-guide/USER-GUIDE.md" rel="noopener ugc nofollow" target="_blank"> Neo4j on GKE用户指南</a>，以及重新创建该产品的功能所需的所有导航图和模板，或者根据您的需要进行定制。</p><p id="9b10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">配置我们的解决方案，设置集群数据库非常简单，我们只需要选择各种设置。最重要的是“服务器副本”,它控制neo4j集群中有多少核心节点，并读取副本。我将保留默认值，但这对于您集群中的容量来说是值得考虑的。您将开始一个至少有服务器副本+读取副本的有状态集。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kz"><img src="../Images/3a41bb013de688cbe5a1db0ac27954e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZCRD2dMdWMVrPpVGYvbJw.png"/></div></div></figure><p id="8076" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为Neo4j更喜欢固态硬盘，所以在撰写本文时，需要手动完成一个步骤——单击底部附近的“云壳”按钮来设置固态硬盘功能。如果您熟悉Kubernetes，它会创建一个新的存储类并将配置应用到您的集群。该命令是预先填充的，您只需按enter键。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es la"><img src="../Images/43083a0bcbb0db8e7182133366c49a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otZpfiHwD5Gei0OTVMaj5A.png"/></div></div></figure><p id="bbd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，现在我们准备好了，只需点击“部署”,容器立即开始被调度到您的集群上。谷歌会把你带到GKE集群窗口下的“应用程序”标签，向你显示事情进展的状态。当然，您可以深入这些工作负载中的任何一个，并检查单个容器的日志、状态等等。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lb"><img src="../Images/df5c527d5324d7b81cf6da500f761946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*3QzEXXKCx0qMMH-TGXbEJg.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">GKE工作负载菜单显示了我正在部署的核心单元</figcaption></figure><p id="1abc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的集群完成部署后，这是令人满意的状态:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lc"><img src="../Images/4626c65b2bd861397478db88646da055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*Fs0iLI9UbTKAaosTZ0ZY5g.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">准备开始</figcaption></figure><h1 id="0053" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">等等，我的密码是什么？</h1><p id="f791" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">当部署neo4j时，会为您选择并分配一个强密码，然后存储在kubernetes秘密中。您可以直接通过GKE用户界面选择Configuration-&gt; my-graph-neo4j-secrets，然后查看neo4j-password字段，或者您也可以从kubectl获取它，就像在您的云shell中一样:</p><pre class="jf jg jh ji fd ld le lf lg aw lh bi"><span id="26a7" class="li jr hi le b fi lj lk l ll lm">$ kubectl get secrets my-graph-neo4j-secrets -o yaml | grep neo4j-password: | sed 's/.*neo4j-password: *//' | base64 --decode<br/>3lg81oVvGY</span></pre><p id="f723" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(记得用您的部署名称替换“我的图形”)</p><p id="b03d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在可以连接到内部DNS地址:</p><pre class="jf jg jh ji fd ld le lf lg aw lh bi"><span id="237a" class="li jr hi le b fi lj lk l ll lm">$APP_INSTANCE_NAME-neo4j.$NAMESPACE.svc.cluster.local</span></pre><p id="4247" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中$APP_INSTANCE_NAME是部署的名称，$NAMESPACE是部署它的kubernetes名称空间。</p><h1 id="467e" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">创建一个简单的密码外壳</h1><p id="1191" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">启动shell需要将解决方案容器调度到集群中，并运行cypher-shell作为它的入口点，如下所示:</p><pre class="jf jg jh ji fd ld le lf lg aw lh bi"><span id="bad3" class="li jr hi le b fi lj lk l ll lm">$ kubectl run -it --rm cypher-shell \<br/>   --image=gcr.io/cloud-marketplace/neo4j-public/causal-cluster-k8s:3.4 \<br/>   --restart=Never \<br/>   --namespace=default \<br/>   --command -- ./bin/cypher-shell -u neo4j \<br/>   -p "$NEO4J_PASSWORD" \<br/>   -a $APP_INSTANCE_NAME-neo4j.default.svc.cluster.local</span></pre><p id="8229" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你在做生意。</p><h1 id="13c3" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">更多信息</strong></h1><p id="0ead" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">请务必查看github 上的<a class="ae jd" href="https://github.com/neo-technology/neo4j-google-k8s-marketplace/blob/master/user-guide/USER-GUIDE.md" rel="noopener ugc nofollow" target="_blank"> Neo4j on GKE用户指南，了解有关如何使用您的实例、如何设置SSH转发以使用Neo4j浏览器、定制您自己的kubernetes/neo4j解决方案所需的所有模板等更多信息。</a></p><p id="9a1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有任何其他问题，请在<a class="ae jd" href="https://community.neo4j.com/t/launching-neo4j-on-google-kubernetes-marketplace/2376" rel="noopener ugc nofollow" target="_blank"> Neo4j社区网站</a>上与我们一起跟进！</p><p id="402f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开心图黑！</p></div></div>    
</body>
</html>