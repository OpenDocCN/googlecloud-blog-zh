<html>
<head>
<title>Summarizing videos in 300 lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨300è¡Œä»£ç æ€»ç»“è§†é¢‘</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-cloud/%EF%B8%8F-auto-generate-video-summaries-with-a-machine-learning-model-and-a-serverless-pipeline-c2f261c8035c?source=collection_archive---------0-----------------------#2020-05-30">https://medium.com/google-cloud/%EF%B8%8F-auto-generate-video-summaries-with-a-machine-learning-model-and-a-serverless-pipeline-c2f261c8035c?source=collection_archive---------0-----------------------#2020-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="1e81" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">â³2021å¹´10æœˆ8æ—¥æ›´æ–°</h1><ul class=""><li id="9c6b" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">æ›´æ–°<a class="ae jv" href="https://github.com/PicardParis/cherry-on-py/tree/main/gcf_video_summary" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj"> GitHubç‰ˆæœ¬</strong> </a>æœ€æ–°åº“ç‰ˆæœ¬+ Python 3.7 â†’ 3.9</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="2d2d" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ‘‹ä½ å¥½ï¼</h1><p id="663c" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">äº²çˆ±çš„å¼€å‘è€…ä»¬:</p><p id="8f82" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä½ å–œæ¬¢è°šè¯­â€œä¸€å›¾èƒœåƒè¨€â€å—ï¼Ÿæˆ‘æ„¿æ„ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å¯¹<em class="lc">â€œä¸€å›¾æŠµåƒå¸§â€</em>æ˜¯å¦ä¹Ÿé€‚ç”¨ã€‚</p><p id="c72d" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="e973" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">å¦‚ä½•åœ¨ä¸€ç¬é—´ç†è§£ä¸€ä¸ªè§†é¢‘çš„å†…å®¹ï¼Œ</li><li id="edd9" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">åœ¨ä¸åˆ°300è¡Œçš„Python (3.7)ä»£ç ä¸­ã€‚</li></ul><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ll"><img src="../Images/e17571674b294b925c87d0790c527c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sBJJr_f1TVd9Ocwl.jpeg"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">ç”±35ä¸ªåºåˆ—(é•œå¤´)ç»„æˆçš„2'42 "è§†é¢‘ç”Ÿæˆçš„è§†è§‰æ‘˜è¦ã€‚æ‘˜è¦æ˜¯ä¸€ä¸ªç½‘æ ¼ï¼Œå…¶ä¸­æ¯ä¸ªå•å…ƒæ ¼æ˜¯ä¸€å¸§ï¼Œä»£è¡¨ä¸€ä¸ªè§†é¢‘é•œå¤´ã€‚</figcaption></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="d506" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ”­ç›®æ ‡</h1><p id="3f72" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">æœ¬æ•™ç¨‹æœ‰ä¸¤ä¸ªç›®æ ‡ï¼Œä¸€ä¸ªæ˜¯å®è·µç›®æ ‡ï¼Œä¸€ä¸ªæ˜¯æŠ€æœ¯ç›®æ ‡:</p><ol class=""><li id="a463" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq mb js jt ju bi translated">è‡ªåŠ¨ç”Ÿæˆè§†é¢‘çš„å¯è§†æ‘˜è¦</li><li id="fbe1" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">ä½¿ç”¨ä»¥ä¸‹å±æ€§æ„å»ºå¤„ç†ç®¡é“:</li></ol><ul class=""><li id="b0e1" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">æ‰˜ç®¡(éšæ—¶å‡†å¤‡å°±ç»ªï¼Œæ˜“äºè®¾ç½®)</li><li id="6a39" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">å¯æ‰©å±•(èƒ½å¤Ÿå¹¶è¡Œæ‘„å–å¤šä¸ªè§†é¢‘)</li><li id="e7a7" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ä¸ä½¿ç”¨æ—¶ä¸èŠ±è´¹ä»»ä½•ä¸œè¥¿</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="b4c7" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ› ï¸å·¥å…·</h1><p id="f9a0" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ä¸€äº›å·¥å…·å°±è¶³å¤Ÿäº†:</p><ul class=""><li id="bf4a" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">è§†é¢‘å’Œç»“æœçš„å­˜å‚¨ç©ºé—´</li><li id="ca12" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">è¿è¡Œä»£ç çš„æ— æœåŠ¡å™¨è§£å†³æ–¹æ¡ˆ</li><li id="15a1" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ç”¨äºåˆ†æè§†é¢‘çš„æœºå™¨å­¦ä¹ æ¨¡å‹</li><li id="023c" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ä»è§†é¢‘ä¸­æå–å¸§çš„åº“</li><li id="8700" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ç”Ÿæˆå¯è§†æ‘˜è¦çš„åº“</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="4dda" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ§±å»ºç­‘</h1><p id="de6e" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ä¸‹é¢æ˜¯ä½¿ç”¨3ä¸ªè°·æ­Œäº‘æœåŠ¡(<a class="ae jv" href="https://cloud.google.com/storage/docs" rel="noopener ugc nofollow" target="_blank">äº‘å­˜å‚¨</a>ã€<a class="ae jv" href="https://cloud.google.com/functions/docs" rel="noopener ugc nofollow" target="_blank">äº‘åŠŸèƒ½</a>å’Œ<a class="ae jv" href="https://cloud.google.com/video-intelligence/docs" rel="noopener ugc nofollow" target="_blank">è§†é¢‘æ™ºèƒ½API </a>)çš„å¯èƒ½æ¶æ„:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mc"><img src="../Images/75b7a4f08bd6c4006acc7f56e9abf21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WSqvJEpDo9DVkCua.png"/></div></div></figure><p id="ea77" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å¤„ç†ç®¡é“éµå¾ªä»¥ä¸‹æ­¥éª¤:</p><ol class=""><li id="9aad" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq mb js jt ju bi translated">æ‚¨å°†è§†é¢‘ä¸Šä¼ åˆ°ç¬¬ä¸€ä¸ªå­˜å‚¨æ¡¶(å­˜å‚¨æ¡¶æ˜¯äº‘ä¸­çš„å­˜å‚¨ç©ºé—´)</li><li id="4eea" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">ä¸Šä¼ äº‹ä»¶è‡ªåŠ¨è§¦å‘ç¬¬ä¸€ä¸ªåŠŸèƒ½</li><li id="57e8" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">è¯¥å‡½æ•°å‘è§†é¢‘æ™ºèƒ½APIå‘é€è¯·æ±‚ä»¥æ£€æµ‹é•œå¤´</li><li id="6500" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">è§†é¢‘æ™ºèƒ½APIåˆ†æè§†é¢‘å¹¶å°†ç»“æœ(æ³¨é‡Š)ä¸Šä¼ åˆ°ç¬¬äºŒä¸ªå­˜å‚¨æ¡¶</li><li id="0085" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">ä¸Šä¼ äº‹ä»¶è§¦å‘ç¬¬äºŒä¸ªåŠŸèƒ½</li><li id="3ab6" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">è¯¥åŠŸèƒ½ä¸‹è½½æ³¨é‡Šå’Œè§†é¢‘æ–‡ä»¶</li><li id="6ad8" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">è¯¥å‡½æ•°å°†æ‘˜è¦å‘ˆç°å¹¶ä¸Šä¼ åˆ°ç¬¬ä¸‰ä¸ªå­˜å‚¨æ¡¶</li><li id="8057" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated">è§†é¢‘æ‘˜è¦å‡†å¤‡å¥½äº†ï¼</li></ol></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="f52e" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸPythonåº“</h1><p id="3fd8" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">å¼€æºå®¢æˆ·ç«¯åº“è®©æ‚¨å¯ä»¥ç”¨æƒ¯ç”¨çš„Pythonä¸Googleäº‘æœåŠ¡è¿›è¡Œäº¤äº’ã€‚æ‚¨å°†ä½¿ç”¨ä»¥ä¸‹å†…å®¹:</p><p id="f6a7" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><code class="du md me mf mg b">Cloud Storage</code></p><ul class=""><li id="9a74" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">ç®¡ç†ä¸‹è½½å’Œä¸Šä¼ </li><li id="7849" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><a class="ae jv" href="https://pypi.org/project/google-cloud-storage" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/google-cloud-storage</a></li></ul><p id="e4f1" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><code class="du md me mf mg b">Video Intelligence API</code></p><ul class=""><li id="3528" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">æ¥åˆ†æè§†é¢‘</li><li id="0ace" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><a class="ae jv" href="https://pypi.org/project/google-cloud-videointelligence" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/google-cloud-videointelligence</a></li></ul><p id="92d8" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è¿™é‡Œæœ‰ä¸¤ä¸ªé¢å¤–çš„Pythonåº“å¯ä¾›é€‰æ‹©ï¼Œä»¥æ»¡è¶³å›¾å½¢éœ€æ±‚:</p><p id="843a" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><code class="du md me mf mg b">OpenCV</code></p><ul class=""><li id="9fbf" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">æå–è§†é¢‘å¸§</li><li id="1b62" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ç”šè‡³è¿˜æœ‰ä¸€ä¸ªæ— å¤´ç‰ˆæœ¬(æ²¡æœ‰GUIç‰¹æ€§)ï¼Œè¿™æ˜¯æœåŠ¡çš„ç†æƒ³é€‰æ‹©</li><li id="6126" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><a class="ae jv" href="https://pypi.org/project/opencv-python-headless" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/opencv-python-headless</a></li></ul><p id="009a" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><code class="du md me mf mg b">Pillow</code></p><ul class=""><li id="2d21" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">ä¸ºäº†ç”Ÿæˆè§†è§‰æ‘˜è¦</li><li id="0af7" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><code class="du md me mf mg b">Pillow</code>æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„å›¾åƒåº“ï¼Œæ—¢å¹¿æ³›åˆæ˜“äºä½¿ç”¨</li><li id="3401" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><a class="ae jv" href="https://pypi.org/project/Pillow" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/Pillow</a></li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="9b8f" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">âš™ï¸é¡¹ç›®è®¾ç½®</h1><p id="dad6" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">å‡è®¾ä½ æœ‰ä¸€ä¸ªGoogle Cloudè´¦æˆ·ï¼Œä½ å¯ä»¥ç”¨<code class="du md me mf mg b">gcloud</code>å’Œ<code class="du md me mf mg b">gsutil</code>å‘½ä»¤ä»Cloud Shellä¸­è®¾ç½®æ¶æ„ã€‚è¿™è®©æ‚¨å¯ä»¥ä»¥å¯é‡å¤çš„æ–¹å¼ä»å¤´å¼€å§‹ç¼–å†™æ‰€æœ‰å†…å®¹ã€‚</p><h2 id="f7cc" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç¯å¢ƒå˜é‡</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="e2ca" class="mh ig hi mg b fi mz na l nb nc"># Project<br/><strong class="mg hj">PROJECT_NAME="Visual Summary"<br/>PROJECT_ID="visual-summary-REPLACE_WITH_UNIQUE_SUFFIX"<br/></strong># Cloud Storage region (https://cloud.google.com/storage/docs/locations)<br/><strong class="mg hj">GCS_REGION="europe-west1"<br/></strong># Cloud Functions region (https://cloud.google.com/functions/docs/locations)<br/><strong class="mg hj">GCF_REGION="europe-west1"<br/></strong># Source<br/><strong class="mg hj">GIT_REPO="cherry-on-py"<br/>PROJECT_SRC=~/$PROJECT_ID/$GIT_REPO/gcf_video_summary<br/><br/></strong># Cloud Storage buckets (environment variables)<br/><strong class="mg hj">export VIDEO_BUCKET="b1-videos_${PROJECT_ID}"<br/>export ANNOTATION_BUCKET="b2-annotations_${PROJECT_ID}"<br/>export SUMMARY_BUCKET="b3-summaries_${PROJECT_ID}"</strong></span></pre><blockquote class="nd ne nf"><p id="449f" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æ‚¨å¯ä»¥ä½¿ç”¨æ‚¨çš„GitHubç”¨æˆ·åä½œä¸ºå”¯ä¸€çš„åç¼€ã€‚</p></blockquote><h2 id="83d4" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æ–°é¡¹ç›®</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="842b" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud projects create $PROJECT_ID \<br/>  --name="$PROJECT_NAME" \<br/>  --set-as-default</strong></span><span id="dd24" class="mh ig hi mg b fi nj na l nb nc">Create in progress for [https://cloudresourcemanager.googleapis.com/v1/projects/PROJECT_ID].<br/>Waiting for [operations/cp...] to finish...done.<br/>Enabling service [cloudapis.googleapis.com] on project [PROJECT_ID]...<br/>Operation "operations/acf..." finished successfully.<br/>Updated property [core/project] to [PROJECT_ID].</span></pre><h2 id="9327" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">è´¦å•è´¦æˆ·</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="32ff" class="mh ig hi mg b fi mz na l nb nc"># Link project with billing account (single account)<br/><strong class="mg hj">BILLING_ACCOUNT=$(gcloud beta billing accounts list \<br/>    --format 'value(name)')</strong><br/># Link project with billing account (specific one among multiple accounts)<br/>BILLING_ACCOUNT=$(gcloud beta billing accounts list  \<br/>    --format 'value(name)' \<br/>    --filter "displayName='My Billing Account'")<br/><br/><strong class="mg hj">gcloud beta billing projects link $PROJECT_ID --billing-account $BILLING_ACCOUNT</strong></span><span id="94e4" class="mh ig hi mg b fi nj na l nb nc">billingAccountName: billingAccounts/XXXXXX-YYYYYY-ZZZZZZ<br/>billingEnabled: true<br/>name: projects/PROJECT_ID/billingInfo<br/>projectId: PROJECT_ID</span></pre><h2 id="79f6" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">å¤§é‡</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="773c" class="mh ig hi mg b fi mz na l nb nc"># Create buckets with uniform bucket-level access<br/><strong class="mg hj">gsutil mb -b on -c regional -l $GCS_REGION gs://$VIDEO_BUCKET<br/>gsutil mb -b on -c regional -l $GCS_REGION gs://$ANNOTATION_BUCKET<br/>gsutil mb -b on -c regional -l $GCS_REGION gs://$SUMMARY_BUCKET</strong></span><span id="5024" class="mh ig hi mg b fi nj na l nb nc">Creating gs://VIDEO_BUCKET/...<br/>Creating gs://ANNOTATION_BUCKET/...<br/>Creating gs://SUMMARY_BUCKET/...</span></pre><p id="2c4d" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä½ å¯ä»¥åœ¨<a class="ae jv" href="https://console.cloud.google.com/storage/browser" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ä¸­æŸ¥çœ‹å®ƒçš„æ ·å­:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/4d2428a17571f55b249c7e29bad09308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X1EtcCS5kT9NC0mX.png"/></div></div></figure><h2 id="40c5" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æœåŠ¡å¸æˆ·</h2><p id="d3a6" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">åˆ›å»ºæœåŠ¡å¸æˆ·ã€‚è¿™ä»…ç”¨äºå¼€å‘ç›®çš„(ç”Ÿäº§ä¸éœ€è¦)ã€‚è¿™ä¸ºæ‚¨æä¾›äº†åœ¨æœ¬åœ°è¿è¡Œä»£ç çš„å‡­æ®ã€‚</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="8cd3" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">mkdir ~/$PROJECT_ID<br/>cd ~/$PROJECT_ID<br/><br/>SERVICE_ACCOUNT_NAME="dev-service-account"<br/>SERVICE_ACCOUNT="${SERVICE_ACCOUNT_NAME}@${PROJECT_ID}.iam.gserviceaccount.com"<br/>gcloud iam service-accounts create $SERVICE_ACCOUNT_NAME<br/>gcloud iam service-accounts keys create ~/$PROJECT_ID/key.json --iam-account $SERVICE_ACCOUNT</strong></span><span id="6027" class="mh ig hi mg b fi nj na l nb nc">Created service account [SERVICE_ACCOUNT_NAME].<br/>created key [...] of type [json] as [~/PROJECT_ID/key.json] for [SERVICE_ACCOUNT]</span></pre><p id="6c80" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è®¾ç½®<code class="du md me mf mg b">GOOGLE_APPLICATION_CREDENTIALS</code>ç¯å¢ƒå˜é‡ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦æŒ‡å‘æœåŠ¡å¸æˆ·å¯†é’¥ã€‚å½“æ‚¨åœ¨å½“å‰shellä¼šè¯ä¸­è¿è¡Œåº”ç”¨ç¨‹åºä»£ç æ—¶ï¼Œå®¢æˆ·ç«¯åº“å°†ä½¿ç”¨è¿™äº›å‡­æ®è¿›è¡Œèº«ä»½éªŒè¯ã€‚å¦‚æœæ‰“å¼€æ–°çš„shellä¼šè¯ï¼Œè¯·å†æ¬¡è®¾ç½®è¯¥å˜é‡ã€‚</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="822f" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">export GOOGLE_APPLICATION_CREDENTIALS=~/$PROJECT_ID/key.json<br/>cat $GOOGLE_APPLICATION_CREDENTIALS</strong></span><span id="9d5c" class="mh ig hi mg b fi nj na l nb nc">{<br/>  "type": "service_account",<br/>  "project_id": "PROJECT_ID",<br/>  "private_key_id": "...",<br/>  "private_key": "-----BEGIN PRIVATE KEY-----\n...",<br/>  "client_email": "SERVICE_ACCOUNT",<br/>  ...<br/>}</span></pre><p id="71aa" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æˆæƒæœåŠ¡å¸æˆ·è®¿é—®å­˜å‚¨æ¡¶:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="933c" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">IAM_BINDING="serviceAccount:${SERVICE_ACCOUNT}:roles/storage.objectAdmin"<br/>gsutil iam ch $IAM_BINDING gs://$VIDEO_BUCKET<br/>gsutil iam ch $IAM_BINDING gs://$ANNOTATION_BUCKET<br/>gsutil iam ch $IAM_BINDING gs://$SUMMARY_BUCKET</strong></span></pre><h2 id="3c8a" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">èœœèœ‚</h2><p id="8ec0" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œä¼šå¯ç”¨ä¸€äº›API:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="b3d4" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud services list</strong></span><span id="d5e6" class="mh ig hi mg b fi nj na l nb nc">NAME                              TITLE<br/>bigquery.googleapis.com           BigQuery API<br/>bigquerystorage.googleapis.com    BigQuery Storage API<br/>cloudapis.googleapis.com          Google Cloud APIs<br/>clouddebugger.googleapis.com      Cloud Debugger API<br/>cloudtrace.googleapis.com         Cloud Trace API<br/>datastore.googleapis.com          Cloud Datastore API<br/>logging.googleapis.com            Cloud Logging API<br/>monitoring.googleapis.com         Cloud Monitoring API<br/>servicemanagement.googleapis.com  Service Management API<br/>serviceusage.googleapis.com       Service Usage API<br/>sql-component.googleapis.com      Cloud SQL<br/>storage-api.googleapis.com        Google Cloud Storage JSON API<br/>storage-component.googleapis.com  Cloud Storage</span></pre><p id="886a" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å¯ç”¨è§†é¢‘æ™ºèƒ½å’Œäº‘åŠŸèƒ½API:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="4d59" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud services enable \<br/>  videointelligence.googleapis.com \<br/>  cloudfunctions.googleapis.com</strong></span><span id="1931" class="mh ig hi mg b fi nj na l nb nc">Operation "operations/acf..." finished successfully.</span></pre><h2 id="38da" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æºä»£ç </h2><p id="5b9e" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">æ£€ç´¢æºä»£ç :</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="2547" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">cd ~/$PROJECT_ID<br/>git clone </strong><a class="ae jv" href="https://github.com/PicardParis/$GIT_REPO.git" rel="noopener ugc nofollow" target="_blank"><strong class="mg hj">https://github.com/PicardParis/$GIT_REPO.git</strong></a></span><span id="8029" class="mh ig hi mg b fi nj na l nb nc">Cloning into 'GIT_REPO'...<br/>...</span></pre></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="c0f7" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ§ è§†é¢‘åˆ†æ</h1><h2 id="798b" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">è§†é¢‘é•œå¤´æ£€æµ‹</h2><p id="2d8f" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">è§†é¢‘æ™ºèƒ½APIæ˜¯ä¸€ä¸ªé¢„å…ˆè®­ç»ƒå¥½çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¯ä»¥åˆ†æè§†é¢‘ã€‚å¤šä¸ªåŠŸèƒ½ä¹‹ä¸€æ˜¯è§†é¢‘é•œå¤´æ£€æµ‹ã€‚å¯¹äºç¬¬ä¸€ä¸ªäº‘å‡½æ•°ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè°ƒç”¨<code class="du md me mf mg b">annotate_video()</code>çš„æ ¸å¿ƒå‡½æ•°ï¼Œå¸¦æœ‰<code class="du md me mf mg b">SHOT_CHANGE_DETECTION</code>ç‰¹æ€§:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><h2 id="b749" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æœ¬åœ°å¼€å‘å’Œæµ‹è¯•</h2><p id="ecc0" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">åœ¨éƒ¨ç½²è¯¥åŠŸèƒ½ä¹‹å‰ï¼Œæ‚¨éœ€è¦å¼€å‘å’Œæµ‹è¯•å®ƒã€‚åˆ›å»ºä¸€ä¸ªPython 3è™šæ‹Ÿç¯å¢ƒå¹¶æ¿€æ´»å®ƒ:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="51be" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">cd ~/$PROJECT_ID<br/>python3 -m venv venv<br/>source venv/bin/activate</strong></span></pre><p id="2946" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å®‰è£…ä¾èµ–é¡¹:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="942a" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">pip install -r $PROJECT_SRC/gcf1_detect_shots/requirements.txt</strong></span></pre><p id="cb12" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ£€æŸ¥ä¾èµ–å…³ç³»:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="800b" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">pip list</strong></span><span id="9103" class="mh ig hi mg b fi nj na l nb nc">Package                        Version<br/>------------------------------ ----------<br/>...<br/>google-cloud-storage           1.28.1<br/>google-cloud-videointelligence 1.14.0<br/>...</span></pre><p id="a35e" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ä¸»ä½œç”¨åŸŸåœ¨è„šæœ¬æ¨¡å¼ä¸‹æµ‹è¯•å‡½æ•°:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="ce08" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æ‚¨å·²ç»åœ¨shellä¼šè¯ä¸­å¯¼å‡ºäº†<code class="du md me mf mg b">ANNOTATION_BUCKET</code>ç¯å¢ƒå˜é‡ï¼›æ‚¨è¿˜å°†åœ¨ç¨åçš„éƒ¨ç½²é˜¶æ®µå®šä¹‰å®ƒã€‚è¿™ä½¿å¾—ä»£ç å˜å¾—é€šç”¨ï¼Œå¹¶å…è®¸æ‚¨ç‹¬ç«‹äºè¾“å‡ºæ¡¶é‡ç”¨å®ƒã€‚</p></blockquote><p id="72c8" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æµ‹è¯•åŠŸèƒ½:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="ae59" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">VIDEO_PATH="</strong><strong class="mg hj">cloud-samples-data/video</strong><strong class="mg hj">/gbikes_dinosaur.mp4"<br/>VIDEO_URI="gs://$VIDEO_PATH"<br/>python $PROJECT_SRC/gcf1_detect_shots/main.py $VIDEO_URI</strong></span><span id="5bf3" class="mh ig hi mg b fi nj na l nb nc">Launching shot detection for &lt;gs://<!-- -->cloud-samples-data/video<!-- -->/gbikes_dinosaur.mp4&gt;...</span></pre><blockquote class="nd ne nf"><p id="a5e8" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æµ‹è¯•è§†é¢‘<code class="du md me mf mg b">&lt;gbikes_dinosaur.mp4&gt;</code>ä½äºå¤–éƒ¨æ¡¶ä¸­ã€‚è¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºè§†é¢‘æ˜¯å…¬å¼€çš„ã€‚</p></blockquote><p id="443c" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¨ç­‰ç‰‡åˆ»ï¼Œæ£€æŸ¥æ³¨é‡Šæ˜¯å¦å·²ç»ç”Ÿæˆ:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="e820" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gsutil ls -r gs://$ANNOTATION_BUCKET</strong></span><span id="6470" class="mh ig hi mg b fi nj na l nb nc">964  YYYY-MM-DDThh:mm:ssZ  gs://ANNOTATION_BUCKET/VIDEO_PATH.json<br/>TOTAL: 1 objects, 964 bytes (964 B)</span></pre><p id="860e" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ£€æŸ¥æ³¨é‡Šæ–‡ä»¶çš„æœ€å200ä¸ªå­—èŠ‚:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="a2d0" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gsutil cat -r -200 gs://$ANNOTATION_BUCKET/$VIDEO_PATH.json</strong></span><span id="e114" class="mh ig hi mg b fi nj na l nb nc">}<br/>    }, {<br/>      "start_time_offset": {<br/>        "seconds": 28,<br/>        "nanos": 166666000<br/>      },<br/>      "end_time_offset": {<br/>        "seconds": 42,<br/>        "nanos": 766666000<br/>      }<br/>    } ]<br/>  } ]<br/>}</span></pre><blockquote class="nd ne nf"><p id="2ad5" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:è¿™äº›æ˜¯æœ€åä¸€ä¸ªè§†é¢‘é•œå¤´çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚ä¸€åˆ‡ä¼¼ä¹éƒ½å¾ˆå¥½ã€‚</p></blockquote><p id="073f" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å®Œæˆåæ¸…ç†å¹²å‡€:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="458f" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gsutil rm gs://$ANNOTATION_BUCKET/$VIDEO_PATH.json<br/><br/>deactivate<br/><br/>rm -rf venv</strong></span></pre><h2 id="48c9" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">å‡½æ•°å…¥å£ç‚¹</h2><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="1999" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æ¯å½“ä¸€ä¸ªè§†é¢‘è¢«ä¸Šä¼ åˆ°å®šä¹‰ä¸ºè§¦å‘å™¨çš„æ¡¶æ—¶ï¼Œè¿™ä¸ªå‡½æ•°å°†è¢«è°ƒç”¨ã€‚</p></blockquote><h2 id="7243" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">åŠŸèƒ½éƒ¨ç½²</h2><p id="4c02" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">éƒ¨ç½²ç¬¬ä¸€ä¸ªåŠŸèƒ½:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="1ffd" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">GCF_NAME="gcf1_detect_shots"<br/>GCF_SOURCE="$PROJECT_SRC/gcf1_detect_shots"<br/>GCF_ENTRY_POINT="gcf_detect_shots"<br/>GCF_TRIGGER_BUCKET="$VIDEO_BUCKET"<br/>GCF_ENV_VARS="ANNOTATION_BUCKET=$ANNOTATION_BUCKET"<br/>GCF_MEMORY="128MB"<br/><br/>gcloud functions deploy $GCF_NAME \<br/>  --runtime python37  \<br/>  --source $GCF_SOURCE \<br/>  --entry-point $GCF_ENTRY_POINT \<br/>  --update-env-vars $GCF_ENV_VARS \<br/>  --trigger-bucket $GCF_TRIGGER_BUCKET \<br/>  --region $GCF_REGION \<br/>  --memory $GCF_MEMORY \<br/>  --quiet</strong></span></pre><blockquote class="nd ne nf"><p id="7270" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:ä¸ºäº‘å‡½æ•°åˆ†é…çš„é»˜è®¤å†…å­˜æ˜¯256MB(å¯èƒ½çš„å€¼æ˜¯128MBã€256 MBã€512MBã€1024MBå’Œ2048MB)ã€‚ç”±äºè¯¥å‡½æ•°æ²¡æœ‰å†…å­˜æˆ–CPUéœ€æ±‚(å®ƒå‘é€ä¸€ä¸ªç®€å•çš„APIè¯·æ±‚)ï¼Œæœ€å°å†…å­˜è®¾ç½®å°±è¶³å¤Ÿäº†ã€‚</p></blockquote><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="e172" class="mh ig hi mg b fi mz na l nb nc">Deploying function (may take a while - up to 2 minutes)...done.<br/>availableMemoryMb: 128<br/>entryPoint: gcf_detect_shots<br/>environmentVariables:<br/>  ANNOTATION_BUCKET: b2-annotations...<br/>eventTrigger:<br/>  eventType: google.storage.object.finalize<br/>...<br/>status: ACTIVE<br/>timeout: 60s<br/>updateTime: 'YYYY-MM-DDThh:mm:ss.mmmZ'<br/>versionId: '1'</span></pre><blockquote class="nd ne nf"><p id="b75e" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:<code class="du md me mf mg b">ANNOTATION_BUCKET</code>ç¯å¢ƒå˜é‡æ˜¯ç”¨<code class="du md me mf mg b">--update-env-vars</code>æ ‡å¿—å®šä¹‰çš„ã€‚ä½¿ç”¨ç¯å¢ƒå˜é‡å¯ä»¥è®©æ‚¨ç”¨ä¸åŒçš„è§¦å‘å™¨å’Œè¾“å‡ºæ¡¶éƒ¨ç½²å®Œå…¨ç›¸åŒçš„ä»£ç ã€‚</p></blockquote><p id="8337" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸‹é¢æ˜¯å®ƒåœ¨<a class="ae jv" href="https://console.cloud.google.com/functions/list" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ä¸­çš„æ ·å­:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/99791706a19abca834dead8b31894010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IPQ5AixblUiLf8G_.png"/></div></div></figure><h2 id="43a3" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç”Ÿäº§æµ‹è¯•</h2><p id="cd87" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ç¡®ä¿åœ¨ç”Ÿäº§ä¸­æµ‹è¯•è¯¥åŠŸèƒ½ã€‚å°†è§†é¢‘æ‹·è´åˆ°è§†é¢‘æ¡¶ä¸­:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="3ff7" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">VIDEO_NAME="gbikes_dinosaur.mp4"<br/>SRC_URI="gs://</strong><strong class="mg hj">cloud-samples-data/video</strong><strong class="mg hj">/$VIDEO_NAME"<br/>DST_URI="gs://$VIDEO_BUCKET/$VIDEO_NAME"<br/><br/>gsutil cp $SRC_URI $DST_URI</strong></span><span id="aebf" class="mh ig hi mg b fi nj na l nb nc">Copying gs://<!-- -->cloud-samples-data/video<!-- -->/gbikes_dinosaur.mp4 [Content-Type=video/mp4]...<br/>- [1 files][ 62.0 MiB/ 62.0 MiB]<br/>Operation completed over 1 objects/62.0 MiB.</span></pre><p id="9860" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æŸ¥è¯¢æ—¥å¿—ä»¥æ£€æŸ¥è¯¥åŠŸèƒ½æ˜¯å¦å·²è¢«è§¦å‘:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="52d6" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud functions logs read --region $GCF_REGION</strong></span><span id="cfa9" class="mh ig hi mg b fi nj na l nb nc">LEVEL  NAME               EXECUTION_ID  TIME_UTC  LOG<br/>D      gcf1_detect_shots  ...           ...       Function execution started<br/>I      gcf1_detect_shots  ...           ...       Launching shot detection for &lt;gs://VIDEO_BUCKET/VIDEO_NAME&gt;...<br/>D      gcf1_detect_shots  ...           ...       Function execution took 874 ms, finished with status: 'ok'</span></pre><p id="ef8b" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¨ç­‰ç‰‡åˆ»ï¼Œæ£€æŸ¥æ³¨é‡Šå­˜å‚¨æ¡¶:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="0bc5" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gsutil ls -r gs://$ANNOTATION_BUCKET</strong></span></pre><p id="7d92" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ³¨é‡Šæ–‡ä»¶:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="c6d0" class="mh ig hi mg b fi mz na l nb nc">gs://ANNOTATION_BUCKET/VIDEO_BUCKET/:<br/>gs://ANNOTATION_BUCKET/VIDEO_BUCKET/VIDEO_NAME.json</span></pre><p id="ec85" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¬¬ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯æ“ä½œçš„ï¼</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="c4b6" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸï¸è§†è§‰æ‘˜è¦</h1><h2 id="5729" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ä»£ç ç»“æ„</h2><p id="cbcc" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">æœ‰è¶£çš„æ˜¯å°†ä»£ç åˆ†æˆä¸¤ä¸ªä¸»è¦çš„ç±»:</p><ul class=""><li id="0c40" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated"><code class="du md me mf mg b">StorageHelper</code>ç”¨äºæœ¬åœ°æ–‡ä»¶å’Œäº‘å­˜å‚¨å¯¹è±¡ç®¡ç†</li><li id="4423" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated"><code class="du md me mf mg b">VideoProcessor</code>ç”¨äºå›¾å½¢å¤„ç†</li></ul><p id="17af" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªå¯èƒ½çš„æ ¸å¿ƒå‡½æ•°:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="a0d7" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œç”¨<code class="du md me mf mg b">logging.exception()</code>è®°å½•å®ƒä»¬ä»¥è·å¾—ç”Ÿäº§æ—¥å¿—ä¸­çš„å †æ ˆè·Ÿè¸ªæ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚</p></blockquote><h2 id="d66e" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç±»åˆ«<code class="du md me mf mg b">StorageHelper</code></h2><p id="291f" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">è¯¥ç±»ç®¡ç†ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="ebd2" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">è§†é¢‘é•œå¤´æ³¨é‡Šçš„æ£€ç´¢å’Œè§£æ</li><li id="c34a" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">æºè§†é¢‘çš„ä¸‹è½½</li><li id="029f" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ä¸Šä¼ ç”Ÿæˆçš„å¯è§†æ‘˜è¦</li><li id="8bfc" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">æ–‡ä»¶å</li></ul><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="3dc1" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æºè§†é¢‘åœ¨<code class="du md me mf mg b">with</code>è¯­å¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸­å¤„ç†:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="9837" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨:ä¸‹è½½åï¼Œè§†é¢‘å°†ä½¿ç”¨<code class="du md me mf mg b">/tmp</code> RAMç£ç›˜ä¸­çš„å­˜å‚¨ç©ºé—´(æ— æœåŠ¡å™¨åŠŸèƒ½çš„å”¯ä¸€å¯å†™ç©ºé—´)ã€‚æœ€å¥½åœ¨ä¸å†éœ€è¦ä¸´æ—¶æ–‡ä»¶æ—¶å°†å…¶åˆ é™¤ï¼Œä»¥é¿å…å°†æ¥è°ƒç”¨è¯¥å‡½æ•°æ—¶å‡ºç°æ½œåœ¨çš„å†…å­˜ä¸è¶³é”™è¯¯ã€‚</p></blockquote><p id="9053" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä½¿ç”¨æ–¹æ³•<code class="du md me mf mg b">storage.Blob.download_as_string()</code>å’Œ<code class="du md me mf mg b">json.loads()</code>æ£€ç´¢æ³¨é‡Š:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="47a3" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è§£æç”±è¿™ä¸ª<code class="du md me mf mg b">VideoShot</code>åŠ©æ‰‹ç±»å¤„ç†:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="0717" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è§†é¢‘æ‹æ‘„ä¿¡æ¯å¯ä»¥é€šè¿‡getterå’Œgeneratorå…¬å¼€:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="236a" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">é€‰æ‹©å‘½åçº¦å®šæ˜¯ä¸ºäº†åœ¨ä¸åŒçš„å­˜å‚¨æ¡¶ä¹‹é—´ä¿æŒä¸€è‡´çš„å¯¹è±¡è·¯å¾„ã€‚è¿™ä¹Ÿå…è®¸æ‚¨ä»æ³¨é‡ŠURIä¸­æ¨æ–­å‡ºè§†é¢‘è·¯å¾„:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="133b" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è§†é¢‘ç›´æ¥ç”¨<code class="du md me mf mg b">storage.Blob.download_to_filename()</code>ä¸‹è½½:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="ae6b" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç›¸åï¼Œå¯ä»¥ä½¿ç”¨<code class="du md me mf mg b">storage.Blob.upload_from_string()</code>ä¸Šä¼ ç»“æœ:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="b485" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:<code class="du md me mf mg b">from_string</code>åœ¨è¿™é‡Œè¡¨ç¤º<code class="du md me mf mg b">from_bytes</code>(Python 2é—ç•™)ã€‚<code class="du md me mf mg b">Pillow</code>æ”¯æŒä½¿ç”¨å†…å­˜é•œåƒï¼Œé¿å…äº†ç®¡ç†æœ¬åœ°æ–‡ä»¶ã€‚</p></blockquote><p id="cee8" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æœ€åï¼Œè¿™é‡Œæ˜¯æ‘˜è¦æ–‡ä»¶çš„ä¸€ä¸ªå¯èƒ½çš„å‘½åçº¦å®š:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><h2 id="7561" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç±»åˆ«<code class="du md me mf mg b">VideoProcessor</code></h2><p id="2e4e" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">è¯¥ç±»ç®¡ç†ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="81be" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">è§†é¢‘å¸§æå–</li><li id="a1bd" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">å¯è§†åŒ–æ‘˜è¦ç”Ÿæˆ</li></ul><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="0dd8" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ‰“å¼€å’Œå…³é—­è§†é¢‘åœ¨<code class="du md me mf mg b">with</code>è¯­å¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸­å¤„ç†:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="3493" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è§†é¢‘æ‘˜è¦æ˜¯ä¸€ä¸ªå•å…ƒæ ¼ç½‘æ ¼ï¼Œå¯ä»¥ç”¨ä¸¤ä¸ªå‘ç”Ÿå™¨åœ¨å•ä¸ªå¾ªç¯ä¸­æ¸²æŸ“:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="5641" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:<code class="du md me mf mg b">shot_ratio</code>é»˜è®¤è®¾ç½®ä¸º<code class="du md me mf mg b">0.5</code>ï¼Œæå–è§†é¢‘æ‹æ‘„çš„ä¸­é—´å¸§ã€‚</p></blockquote><p id="390c" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¬¬ä¸€ä¸ªç”Ÿæˆå™¨ç”Ÿæˆç»†èƒå›¾åƒ:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="6f3f" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¬¬äºŒä¸ªç”Ÿæˆå™¨äº§ç”Ÿå•å…ƒæ ¼ä½ç½®:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="8eb4" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><code class="du md me mf mg b">OpenCV</code>è½»æ¾æå–ç»™å®šä½ç½®çš„è§†é¢‘å¸§:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="08c4" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">é€‰æ‹©æ‘˜è¦ç½‘æ ¼æ„æˆæ˜¯ä»»æ„çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œç”¨äºç¼–å†™ä¿ç•™è§†é¢‘æ¯”ä¾‹çš„æ‘˜è¦:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="b14d" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æœ€åï¼Œ<code class="du md me mf mg b">Pillow</code>æä¾›äº†å¯¹å›¾åƒåºåˆ—åŒ–çš„å®Œå…¨æ§åˆ¶:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="233c" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:ä½¿ç”¨å†…å­˜ä¸­çš„æ˜ åƒå¯ä»¥é¿å…ç®¡ç†æœ¬åœ°æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨è¾ƒå°‘çš„å†…å­˜ã€‚</p></blockquote><h2 id="951f" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æœ¬åœ°å¼€å‘å’Œæµ‹è¯•</h2><p id="5ae5" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ä¸»ä½œç”¨åŸŸåœ¨è„šæœ¬æ¨¡å¼ä¸‹æµ‹è¯•å‡½æ•°:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="0398" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æµ‹è¯•åŠŸèƒ½:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="3853" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">cd ~/$PROJECT_ID<br/>python3 -m venv venv<br/>source venv/bin/activate<br/><br/>pip install -r $PROJECT_SRC/gcf2_generate_summary/requirements.txt<br/><br/>VIDEO_NAME="gbikes_dinosaur.mp4"<br/>ANNOTATION_URI="gs://$ANNOTATION_BUCKET/$VIDEO_BUCKET/$VIDEO_NAME.json"<br/><br/>python $PROJECT_SRC/gcf2_generate_summary/main.py $ANNOTATION_URI</strong></span><span id="5493" class="mh ig hi mg b fi nj na l nb nc">Downloading -&gt; /tmp/SUMMARY_BUCKET/VIDEO_BUCKET/VIDEO_NAME<br/>Generating summary...<br/>Uploading -&gt; VIDEO_BUCKET/VIDEO_NAME.summary004.jpeg</span></pre><blockquote class="nd ne nf"><p id="8ec4" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨:ä¸Šä¼ çš„è§†é¢‘æ‘˜è¦æ˜¾ç¤º4ä¸ªé•œå¤´ã€‚</p></blockquote><p id="27e9" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ¸…ç†:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="34b9" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">deactivate<br/>rm -rf venv</strong></span></pre><h2 id="f6a8" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">å‡½æ•°å…¥å£ç‚¹</h2><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="e525" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æ¯å½“ä¸€ä¸ªæ³¨é‡Šæ–‡ä»¶è¢«ä¸Šä¼ åˆ°å®šä¹‰ä¸ºè§¦å‘å™¨çš„æ¡¶æ—¶ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚</p></blockquote><h2 id="a0b9" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">åŠŸèƒ½éƒ¨ç½²</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="2b0c" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">GCF_NAME="gcf2_generate_summary"<br/>GCF_SOURCE="$PROJECT_SRC/gcf2_generate_summary"<br/>GCF_ENTRY_POINT="gcf_generate_summary"<br/>GCF_TRIGGER_BUCKET="$ANNOTATION_BUCKET"<br/>GCF_ENV_VARS="SUMMARY_BUCKET=$SUMMARY_BUCKET"<br/>GCF_TIMEOUT="540s"<br/>GCF_MEMORY="512MB"<br/><br/>gcloud functions deploy $GCF_NAME \<br/>  --runtime python37  \<br/>  --source $GCF_SOURCE \<br/>  --entry-point $GCF_ENTRY_POINT \<br/>  --update-env-vars $GCF_ENV_VARS \<br/>  --trigger-bucket $GCF_TRIGGER_BUCKET \<br/>  --region $GCF_REGION \<br/>  --timeout $GCF_TIMEOUT \<br/>  --memory $GCF_MEMORY \<br/>  --quiet</strong></span></pre><p id="cf6e" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ³¨æ„äº‹é¡¹:</p><ul class=""><li id="caf3" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">äº‘å‡½æ•°çš„é»˜è®¤è¶…æ—¶æ˜¯60ç§’ã€‚å½“æ‚¨éƒ¨ç½²ä¸€ä¸ªå¯èƒ½éœ€è¦é•¿æ—¶é—´å¤„ç†çš„åå°å‡½æ•°æ—¶ï¼Œå°†å…¶è®¾ç½®ä¸ºæœ€å¤§å€¼(540ç§’= 9åˆ†é’Ÿ)ã€‚</li><li id="6e45" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ä½ è¿˜éœ€è¦ä¸ºè§†é¢‘å’Œå›¾åƒå¤„ç†å¢åŠ ä¸€ç‚¹å†…å­˜ã€‚æ ¹æ®è§†é¢‘çš„å¤§å°å’Œè¾“å‡ºæ‘˜è¦çš„æœ€å¤§åˆ†è¾¨ç‡ï¼Œæˆ–è€…å¦‚æœæ‚¨éœ€è¦æ›´å¿«åœ°ç”Ÿæˆæ‘˜è¦(å†…å­˜å¤§å°å’ŒvCPUé€Ÿåº¦ç›¸å…³)ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ›´é«˜çš„å€¼(1024MBæˆ–2048MB)ã€‚</li></ul><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="3e47" class="mh ig hi mg b fi mz na l nb nc">Deploying function (may take a while - up to 2 minutes)...done.<br/>availableMemoryMb: 512<br/>entryPoint: gcf_generate_summary<br/>environmentVariables:<br/>  SUMMARY_BUCKET: b3-summaries...<br/>...<br/>status: ACTIVE<br/>timeout: 540s<br/>updateTime: 'YYYY-MM-DDThh:mm:ss.mmmZ'<br/>versionId: '1'</span></pre><p id="a96d" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸‹é¢æ˜¯å®ƒåœ¨<a class="ae jv" href="https://console.cloud.google.com/functions/list" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ä¸­çš„æ ·å­:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/09759d1e834a26df4ec881a97442992e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ci683g0AQEorLvDE.png"/></div></div></figure><h2 id="5e04" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç”Ÿäº§æµ‹è¯•</h2><p id="9211" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ç¡®ä¿åœ¨ç”Ÿäº§ä¸­æµ‹è¯•è¯¥åŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨ç¬¬äºŒä¸ªå­˜å‚¨æ¡¶ä¸­ä¸Šä¼ æ³¨é‡Šæ–‡ä»¶:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="a824" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">VIDEO_NAME="gbikes_dinosaur.mp4"<br/>ANNOTATION_FILE="$VIDEO_NAME.json"<br/>ANNOTATION_URI="gs://$ANNOTATION_BUCKET/$VIDEO_BUCKET/$ANNOTATION_FILE"<br/>gsutil cp $ANNOTATION_URI .<br/>gsutil cp $ANNOTATION_FILE $ANNOTATION_URI<br/>rm $ANNOTATION_FILE</strong></span></pre><blockquote class="nd ne nf"><p id="2fdc" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:è¿™å°†é‡ç”¨å…ˆå‰çš„æœ¬åœ°æµ‹è¯•æ³¨é‡Šæ–‡ä»¶å¹¶è¦†ç›–å®ƒã€‚è¦†ç›–æ¡¶ä¸­çš„æ–‡ä»¶ä¹Ÿä¼šè§¦å‘é™„åŠ çš„å‡½æ•°ã€‚</p></blockquote><p id="8d5e" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç­‰å¾…å‡ ç§’é’Ÿï¼Œå¹¶æŸ¥è¯¢æ—¥å¿—ä»¥æ£€æŸ¥è¯¥åŠŸèƒ½æ˜¯å¦å·²è¢«è§¦å‘:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="4d0e" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud functions logs read --region $GCF_REGION</strong></span><span id="ab16" class="mh ig hi mg b fi nj na l nb nc">LEVEL  NAME                   EXECUTION_ID  TIME_UTC  LOG<br/>...<br/>D      gcf2_generate_summary  ...           ...       Function execution started<br/>I      gcf2_generate_summary  ...           ...       Downloading -&gt; /tmp/SUMMARY_BUCKET/VIDEO_BUCKET/VIDEO_NAME<br/>I      gcf2_generate_summary  ...           ...       Generating summary...<br/>I      gcf2_generate_summary  ...           ...       Uploading -&gt; VIDEO_BUCKET/VIDEO_NAME.summary004.jpeg<br/>D      gcf2_generate_summary  ...           ...       Function execution took 11591 ms, finished with status: 'ok'</span></pre><p id="90da" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç¬¬äºŒä¸ªåŠŸèƒ½æ­£åœ¨è¿è¡Œï¼Œç®¡é“å·²ç»åˆ°ä½ï¼ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨ç¬¬ä¸€ä¸ªæ¡¶ä¸­å¤åˆ¶æ–°è§†é¢‘æ¥è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚</p><h2 id="6b00" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">ç»“æœ</h2><p id="9a37" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">å°†ç”Ÿæˆçš„æ‘˜è¦ä¸‹è½½åˆ°æ‚¨çš„è®¡ç®—æœºä¸Š:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="cd37" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">cd ~/$PROJECT_ID<br/>gsutil cp -r gs://$SUMMARY_BUCKET/**.jpeg .<br/>cloudshell download *.jpeg</strong></span></pre><p id="cc6e" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä»¥ä¸‹æ˜¯<code class="du md me mf mg b">gbikes_dinosaur.mp4</code> (4ä¸ªæ£€æµ‹åˆ°çš„é•œå¤´)çš„è§†è§‰æ‘˜è¦:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ll"><img src="../Images/a4e29826d6cbe5cf2e4521c8049142e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5kElus_pB3EIoDxU.jpeg"/></div></div></figure><p id="ee83" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ‚¨ä¹Ÿå¯ä»¥ä»<a class="ae jv" href="https://console.cloud.google.com/storage/browser/" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ç›´æ¥é¢„è§ˆæ–‡ä»¶:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/1eeb933ad7ad66a345d3c01646a1b1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3iMF9kMT7x7xgtWq.png"/></div></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="596a" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ’Pyä¸Šçš„æ¨±æ¡ƒğŸ</h1><p id="5864" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ç°åœ¨ï¼Œè›‹ç³•ä¸Šçš„ç³–è¡£(æˆ–è€…æˆ‘ä»¬ç”¨æ³•è¯­è¯´çš„â€œé¦…é¥¼ä¸Šçš„æ¨±æ¡ƒâ€)â€¦</p><p id="cb11" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">åŸºäºç›¸åŒçš„æ¶æ„å’Œä»£ç ï¼Œæ‚¨å¯ä»¥æ·»åŠ ä¸€äº›åŠŸèƒ½:</p><ul class=""><li id="9102" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">è§¦å‘å…¶ä»–æ¡¶ä¸­è§†é¢‘çš„å¤„ç†</li><li id="8fb5" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ç”Ÿæˆå¤šç§æ ¼å¼çš„æ‘˜è¦(å¦‚JPEGã€PNGã€WEBP)</li><li id="076e" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ç”ŸæˆåŠ¨ç”»æ‘˜è¦(ä¹Ÿæœ‰å¤šç§æ ¼å¼ï¼Œå¦‚GIFã€PNGã€WEBP)</li></ul><p id="2c86" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸°å¯Œæ¶æ„ä»¥å¤åˆ¶2ä¸ªé¡¹ç›®:</p><ul class=""><li id="54a2" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">è§†é¢‘é•œå¤´æ£€æµ‹åŠŸèƒ½ï¼Œä½¿å…¶ä½œä¸ºHTTPç«¯ç‚¹è¿è¡Œ</li><li id="9ddc" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">å¤„ç†åŠ¨ç”»å›¾åƒçš„æ‘˜è¦ç”ŸæˆåŠŸèƒ½</li></ul><p id="c26b" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">è°ƒæ•´ä»£ç ä»¥æ”¯æŒæ–°åŠŸèƒ½:</p><ul class=""><li id="db65" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">ç”¨äºç”Ÿæˆé™æ€æˆ–åŠ¨æ€æ‘˜è¦çš„<code class="du md me mf mg b">animated</code>å‚æ•°</li><li id="1147" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">ä»¥å¤šç§æ ¼å¼ä¿å­˜å’Œä¸Šä¼ ç»“æœ</li></ul><h2 id="c8e9" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">æ¶æ„(ç¬¬2ç‰ˆ)</h2><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mc"><img src="../Images/8840f846967d8cbe723fd3fa5487cb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VQdimtG1UCuy4KkK.png"/></div></div></figure><ul class=""><li id="7deb" class="jd je hi jf b jg kx ji ky jk ld jm le jo lf jq jr js jt ju bi translated">A.è§†é¢‘é•œå¤´æ£€æµ‹ä¹Ÿå¯ä»¥é€šè¿‡HTTP GETè¯·æ±‚æ‰‹åŠ¨è§¦å‘</li><li id="e6b7" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">B.é™æ€å’ŒåŠ¨æ€æ‘˜è¦åœ¨ä¸¤ä¸ªå‡½æ•°ä¸­å¹¶è¡Œç”Ÿæˆ</li><li id="8605" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq jr js jt ju bi translated">C.æ‘˜è¦ä»¥å¤šç§å›¾åƒæ ¼å¼ä¸Šä¼ </li></ul><h2 id="ad52" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">HTTPå…¥å£ç‚¹</h2><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="a129" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:è¿™æ˜¯ä¸<code class="du md me mf mg b">gcf_detect_shots</code>ç›¸åŒçš„ä»£ç ï¼Œå¸¦æœ‰ä»GETè¯·æ±‚ä¸­æä¾›çš„è§†é¢‘URIå‚æ•°ã€‚</p></blockquote><h2 id="35e6" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">åŠŸèƒ½éƒ¨ç½²</h2><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="c6c9" class="mh ig hi mg b fi mz na l nb nc">GCF_NAME="gcf1_detect_shots_http"<br/>GCF_SOURCE="$PROJECT_SRC/gcf1_detect_shots"<br/>GCF_ENTRY_POINT="gcf_detect_shots_http"<br/>GCF_TRIGGER_BUCKET="$VIDEO_BUCKET"<br/>GCF_ENV_VARS="ANNOTATION_BUCKET=$ANNOTATION_BUCKET"<br/>GCF_MEMORY="128MB"<br/><br/>gcloud functions deploy $GCF_NAME \<br/>  --runtime python37  \<br/>  --source $GCF_SOURCE \<br/>  --entry-point $GCF_ENTRY_POINT \<br/>  --update-env-vars $GCF_ENV_VARS \<br/>  --trigger-http \<br/>  --region $GCF_REGION \<br/>  --memory $GCF_MEMORY \<br/>  --quiet</span></pre><p id="dcb5" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸‹é¢æ˜¯å®ƒåœ¨<a class="ae jv" href="https://console.cloud.google.com/functions/list" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ä¸­çš„æ ·å­:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/06d4abe164a2b1a15a1ae305a85e40cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4fPdiARXnY-_41-C.png"/></div></div></figure><h2 id="63c8" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">åŠ¨ç”»æ”¯æŒ</h2><p id="ee12" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">åœ¨æ ¸å¿ƒåŠŸèƒ½ä¸­å¢åŠ ä¸€ä¸ª<code class="du md me mf mg b">animated</code>é€‰é¡¹:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="718c" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å®šä¹‰æ‚¨æœ‰å…´è¶£ç”Ÿæˆçš„æ ¼å¼:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="802f" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ·»åŠ æ”¯æŒä»¥ä¸åŒæ ¼å¼ç”Ÿæˆé™æ€å’ŒåŠ¨æ€æ‘˜è¦:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="e0e2" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">åºåˆ—åŒ–ä»ç„¶å¯ä»¥åœ¨å•ä¸ªå‡½æ•°ä¸­è¿›è¡Œ:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><blockquote class="nd ne nf"><p id="d50f" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:<code class="du md me mf mg b">Pillow</code>æ˜¯é€šç”¨å’Œä¸€è‡´çš„ï¼Œå…è®¸é‡è¦å’Œå¹²å‡€çš„ä»£ç åˆ†è§£ã€‚</p></blockquote><p id="0574" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å‘<code class="du md me mf mg b">StorageHelper</code>ç±»æ·»åŠ ä¸€ä¸ª<code class="du md me mf mg b">animated</code>å¯é€‰å‚æ•°:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="9fed" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æœ€åï¼Œåœ¨å…¥å£ç‚¹æ·»åŠ ä¸€ä¸ª<code class="du md me mf mg b">ANIMATED</code>å¯é€‰ç¯å¢ƒå˜é‡:</p><figure class="lm ln lo lp fd lq"><div class="bz dy l di"><div class="nl nm l"/></div></figure><h2 id="4972" class="mh ig hi bd ih mi mj mk il ml mm mn ip jk mo mp it jm mq mr ix jo ms mt jb mu bi translated">åŠŸèƒ½éƒ¨ç½²</h2><p id="454e" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">ä½¿ç”¨é™„åŠ çš„<code class="du md me mf mg b">ANIMATED</code>ç¯å¢ƒå˜é‡å¤åˆ¶ç¬¬äºŒä¸ªå‡½æ•°:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="1565" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">GCF_NAME="gcf2_generate_summary_animated"<br/>GCF_SOURCE="$PROJECT_SRC/gcf2_generate_summary"<br/>GCF_ENTRY_POINT="gcf_generate_summary"<br/>GCF_TRIGGER_BUCKET="$ANNOTATION_BUCKET"<br/>GCF_ENV_VARS1="SUMMARY_BUCKET=$SUMMARY_BUCKET"<br/>GCF_ENV_VARS2="ANIMATED=1"<br/>GCF_TIMEOUT="540s"<br/>GCF_MEMORY="2048MB"<br/><br/>gcloud functions deploy $GCF_NAME \<br/>  --runtime python37  \<br/>  --source $GCF_SOURCE \<br/>  --entry-point $GCF_ENTRY_POINT \<br/>  --update-env-vars $GCF_ENV_VARS1 \<br/>  --update-env-vars $GCF_ENV_VARS2 \<br/>  --trigger-bucket $GCF_TRIGGER_BUCKET \<br/>  --region $GCF_REGION \<br/>  --timeout $GCF_TIMEOUT \<br/>  --memory $GCF_MEMORY \<br/>  --quiet</strong></span></pre><p id="c7b0" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä¸‹é¢æ˜¯å®ƒåœ¨<a class="ae jv" href="https://console.cloud.google.com/functions/list" rel="noopener ugc nofollow" target="_blank">äº‘æ§åˆ¶å°</a>ä¸­çš„æ ·å­:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/aff146adcee461ba070dd13060c6af21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JgdtT1hHxExMKhg1.png"/></div></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="9924" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ‰æœ€ç»ˆæµ‹è¯•</h1><p id="961c" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">HTTPç«¯ç‚¹å…è®¸æ‚¨ç”¨GETè¯·æ±‚è§¦å‘ç®¡é“:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="29e4" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">GCF_NAME="gcf1_detect_shots_http"<br/>VIDEO_URI="gs://</strong><strong class="mg hj">cloud-samples-data/video</strong><strong class="mg hj">/visionapi.mp4"<br/>GCF_URL="https://$GCF_REGION-$PROJECT_ID.cloudfunctions.net/$GCF_NAME?video_uri=$VIDEO_URI"<br/><br/>curl $GCF_URL -H "Authorization: bearer $(gcloud auth print-identity-token)"</strong></span><span id="05d7" class="mh ig hi mg b fi nj na l nb nc">Launched shot detection for video_uri &lt;VIDEO_URI&gt;</span></pre><blockquote class="nd ne nf"><p id="8f5f" class="ki kj lc jf b jg kx kk kl ji ky km kn ng kz kp kq nh la ks kt ni lb kv kw jq hb bi translated">æ³¨æ„:æµ‹è¯•è§†é¢‘<code class="du md me mf mg b">&lt;visionapi.mp4&gt;</code>ä½äºä¸€ä¸ªå¤–éƒ¨å­˜å‚¨æ¡¶ä¸­ï¼Œä½†å¯ä»¥å…¬å¼€è®¿é—®ã€‚</p></blockquote><p id="e626" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">æ­¤å¤–ï¼Œå°†ä¸€ä¸ªæˆ–å¤šä¸ªè§†é¢‘å¤åˆ¶åˆ°è§†é¢‘æ¡¶ä¸­ã€‚æ‚¨å¯ä»¥æ‹–æ”¾è§†é¢‘:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/f8f936189d1adc5499dc691f55b5f06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2piYMwPyLnx4sP61.gif"/></div></div></figure><p id="f6a5" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ç„¶åè§†é¢‘è¢«å¹¶è¡Œå¤„ç†ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ—¥å¿—:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="62de" class="mh ig hi mg b fi mz na l nb nc">LEVEL NAME                           EXECUTION_ID ... LOG<br/>...<br/>D     gcf2_generate_summary_animated f6n6tslsfwdu ... Function execution took 49293 ms, finished with status: 'ok'<br/>I     gcf2_generate_summary          yd1vqabafn17 ... Uploading -&gt; b1-videos.../JaneGoodall.mp4.summary035_still.png<br/>I     gcf2_generate_summary_animated qv9b03814jjk ... shot_ratio: 43%<br/>I     gcf2_generate_summary          yd1vqabafn17 ... Uploading -&gt; b1-videos.../JaneGoodall.mp4.summary035_still.webp<br/>D     gcf2_generate_summary          yd1vqabafn17 ... Function execution took 54616 ms, finished with status: 'ok'<br/>I     gcf2_generate_summary_animated g4d2wrzxz2st ... shot_ratio: 71%<br/>...<br/>D     gcf2_generate_summary          amwmov1wk0gn ... Function execution took 65256 ms, finished with status: 'ok'<br/>I     gcf2_generate_summary_animated 7pp882fz0x84 ... shot_ratio: 57%<br/>I     gcf2_generate_summary_animated i3u830hsjz4r ... Uploading -&gt; b1-videos.../JaneGoodall.mp4.summary035_anim.png<br/>I     gcf2_generate_summary_animated i3u830hsjz4r ... Uploading -&gt; b1-videos.../JaneGoodall.mp4.summary035_anim.webp<br/>D     gcf2_generate_summary_animated i3u830hsjz4r ... Function execution took 70862 ms, finished with status: 'ok'<br/>...</span></pre><p id="bb09" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">åœ¨ç¬¬ä¸‰ä¸ªæ¡¶ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°æ‰€æœ‰é™æ€å’ŒåŠ¨æ€æ‘˜è¦:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es nk"><img src="../Images/ae909eabb7d1e5a94bf452fb10152e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NTDWw5uXmNWsWr6n.png"/></div></div></figure><p id="517b" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä½ å·²ç»çœ‹åˆ°äº†ä½œä¸ºæœ¬æ•™ç¨‹ä»‹ç»çš„<code class="du md me mf mg b">&lt;JaneGoodall.mp4&gt;</code>çš„é™æ€æ‘˜è¦ã€‚åœ¨åŠ¨ç”»ç‰ˆæœ¬ä¸­ï¼Œåªæœ‰6å¸§ï¼Œä½ ä¼šå¯¹<a class="ae jv" href="https://storage.googleapis.com/cloud-samples-data/video/JaneGoodall.mp4" rel="noopener ugc nofollow" target="_blank">çš„æ•´ä¸ªè§†é¢‘</a>æœ‰æ›´å¥½çš„äº†è§£:</p><figure class="lm ln lo lp fd lq er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es ll"><img src="../Images/8fa83f631fd18de398472e3eb4621037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O18noPhqhyceU85Q.gif"/></div></div></figure><p id="eaa6" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">å¦‚æœæ‚¨ä¸æƒ³ä¿ç•™æ‚¨çš„é¡¹ç›®ï¼Œæ‚¨å¯ä»¥åˆ é™¤å®ƒ:</p><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="0a4c" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">gcloud projects delete $PROJECT_ID</strong></span></pre></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="09a6" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">â•è¿˜æœ‰ä¸€ä»¶äº‹</h1><pre class="lm ln lo lp fd mv mg mw mx aw my bi"><span id="f9cf" class="mh ig hi mg b fi mz na l nb nc"><strong class="mg hj">first_line_after_licence=16<br/>find $PROJECT_SRC -name '*.py' -exec tail -n +$first_line_after_licence {} \; | grep -v "^$" | wc -l</strong></span><span id="6f5d" class="mh ig hi mg b fi nj na l nb nc">289</span></pre><p id="8e6d" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated">ä½ ç”¨ä¸åˆ°300è¡ŒPythonä»£ç å°±å®Œæˆäº†æ‰€æœ‰å·¥ä½œã€‚å°‘å°è¯ï¼Œå°‘bugï¼</p><p id="94b6" class="pw-post-body-paragraph ki kj hi jf b jg kx kk kl ji ky km kn jk kz kp kq jm la ks kt jo lb kv kw jq hb bi translated"><strong class="jf hj">ğŸ”¥ğŸä»»åŠ¡å®Œæˆï¼ğŸğŸ”¥</strong></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="04f5" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ––å†è§</h1><p id="1241" class="pw-post-body-paragraph ki kj hi jf b jg jh kk kl ji jj km kn jk ko kp kq jm kr ks kt jo ku kv kw jq hb bi translated">æˆ‘å¸Œæœ›ä½ èƒ½æ¬£èµè¿™ç¯‡æ•™ç¨‹ï¼Œå¹¶ä¹æ„é˜…è¯»ä½ çš„åé¦ˆã€‚ä¹Ÿå¯ä»¥<a class="ae jv" href="https://twitter.com/PicardParis" rel="noopener ugc nofollow" target="_blank">åœ¨Twitterä¸Šå…³æ³¨æˆ‘</a>ã€‚</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="48aa" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">â³æ›´æ–°</h1><ul class=""><li id="bda9" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated"><strong class="jf hj">2021â€“10â€“08</strong>:æ›´æ–°<a class="ae jv" href="https://github.com/PicardParis/cherry-on-py/tree/main/gcf_video_summary" rel="noopener ugc nofollow" target="_blank"> GitHubç‰ˆæœ¬</a>æœ€æ–°åº“ç‰ˆæœ¬+ Python 3.7 â†’ 3.9</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="70f5" class="if ig hi bd ih ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc bi translated">ğŸ“œåŒæ ·åœ¨è¿™ä¸ªç³»åˆ—ä¸­</h1><ol class=""><li id="ca83" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq mb js jt ju bi translated">æ€»ç»“è§†é¢‘</li><li id="14bb" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated"><a class="ae jv" rel="noopener" href="/google-cloud/video-object-tracking-as-a-service-18eb4227df34?source=friends_link&amp;sk=c9602c33c77aa950a59282b6de5c0c57">è·Ÿè¸ªè§†é¢‘å¯¹è±¡</a></li><li id="efe5" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated"><a class="ae jv" rel="noopener" href="/google-cloud/face-detection-and-processing-in-300-lines-of-code-38dc51a115d4?source=friends_link&amp;sk=cc252ab86eab9ed2e8583963d0598661">äººè„¸æ£€æµ‹å’Œå¤„ç†</a></li><li id="b6e5" class="jd je hi jf b jg lg ji lh jk li jm lj jo lk jq mb js jt ju bi translated"><a class="ae jv" rel="noopener" href="/google-cloud/deploy-a-coloring-page-generator-in-minutes-with-cloud-run-bff59e59d890?source=friends_link&amp;sk=a3d6e22e7e77828e411592f46025531e">å¤„ç†å›¾åƒ</a></li></ol></div></div>    
</body>
</html>