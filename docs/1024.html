<html>
<head>
<title>Google Cloud Platform for SQL Practitioners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向SQL从业者的谷歌云平台</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-platform-for-sql-practitioners-2b2e4507535e?source=collection_archive---------3-----------------------#2019-06-06">https://medium.com/google-cloud/google-cloud-platform-for-sql-practitioners-2b2e4507535e?source=collection_archive---------3-----------------------#2019-06-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b925cd06b3b78e19ff6650e69cfe7c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*we-raG22_rP5UbV6aoGw3w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片借用自<a class="ae iu" href="https://cloud.google.com/blog/products/databases/google-cloud-databases-named-a-leader-in-the-forrester-wave-database-as-a-service-q2-2019" rel="noopener ugc nofollow" target="_blank">谷歌云平台博客</a></figcaption></figure><p id="5bdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文的目的是概述谷歌云平台(GCP)中的SQL特性。本文面向当前使用SQL并希望了解当前在Google云平台上使用SQL技能的选项的任何人。</p><h1 id="eefe" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Windows Server上的MS SQL Server</h1><p id="0bf5" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果你想在GCP上运行MS SQL Server，你有几个选择，IaaS BYOL、IaaS和完全托管。在GCP的Windows Server上运行MSSQL Server有几个好处:</p><ul class=""><li id="9ebd" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated"><a class="ae iu" href="https://cloud.google.com/blog/products/gcp/three-steps-to-compute-engine-startup-time-bliss-google-cloud-performance-atlas?m=1" rel="noopener ugc nofollow" target="_blank">最快的实例启动时间</a></li><li id="129d" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><a class="ae iu" href="https://cloud.google.com/products/networking/" rel="noopener ugc nofollow" target="_blank">快速高性能全球网络</a></li><li id="9e69" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">快速磁盘吞吐性能—固态硬盘持久磁盘(高IOPS)</li><li id="4152" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">本地连接的SSD上的Tempdb和windows分页文件(最高IOPS)</li><li id="6dde" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">自定义实例大小</li></ul><h2 id="0d00" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">自带执照(IaaS BYOL)</h2><p id="f203" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果您的组织有限制物理硬件使用的许可要求或服务提供商许可协议(SPLA)，您可以使用<a class="ae iu" href="https://cloud.google.com/compute/docs/instances/windows/bring-your-own-license/bringing-your-own-license-sole-tenant-nodes" rel="noopener ugc nofollow" target="_blank">谷歌计算引擎(GCE)的单一租户节点</a>。这些实例允许您将自定义映像导入GCE，使用它来启动一个实例，并启用就地重启，以便VM在同一物理服务器上重启。通过使用单一租户节点，您可以确保虚拟机运行在完全专用于您的硬件上，同时限制物理核心的使用。为了证明您的服务器用于报告堆栈，驱动程序监控允许<a class="ae iu" href="https://cloud.google.com/compute/docs/instances/windows/bring-your-own-license/determining-server-usage" rel="noopener ugc nofollow" target="_blank">确定用于报告和导出服务器id的服务器使用</a>。<a class="ae iu" href="https://cloud.google.com/compute/docs/instances/windows/ms-licensing" rel="noopener ugc nofollow" target="_blank">关于使用现有微软应用许可的更多信息</a>。</p><h2 id="bb77" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">按实例成本支付许可费(IaaS)</h2><p id="052e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果您没有物理硬件许可证要求，您可以用您的实例成本支付Google云平台上的<a class="ae iu" href="https://cloud.google.com/sql-server/" rel="noopener ugc nofollow" target="_blank"> SQL Server。这是在GCP上开始使用SQL Server的最简单的方法，不需要前期成本和按秒计费。这是一个灵活的许可选项，允许您像购买云基础架构一样购买许可，按需购买，按需付费。</a></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/10063558b8db1a7054aa9b0748f84cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/0*fJvVS0l1h08mzDC_"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">谷歌云平台上的SQL Server映像(2019年6月)</figcaption></figure><h2 id="7204" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">针对SQL Server的云SQL(完全托管)</h2><p id="1577" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果您希望在一个完全托管的服务中运行SQL server，其中提供商负责为您管理实例,<a class="ae iu" href="https://cloud.google.com/sql/" rel="noopener ugc nofollow" target="_blank"> Cloud SQL for SQL Server </a>正在发布，并且在撰写本文时处于alpha阶段。云SQL负责备份、复制、修补和更新，并具有读取副本以进行横向扩展等功能。云SQL有10TB的存储限制，因此如果您需要超过10TB，您需要考虑其他选项(或者清理您的数据库:)。</p><p id="4901" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多关于谷歌云平台上的SQL server<a class="ae iu" href="https://cloud.google.com/sql-server/" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><h1 id="e574" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用SQL的数据仓库和处理</h1><p id="3f1a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我们之前讨论了SQL的MSSQL server关系事务处理用例。现在，我们将介绍在GCP上使用SQL进行分析处理。</p><p id="8cc5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Bigquery是一个非常强大的无服务器、高度可扩展的数据仓库，内置在Google云平台上的内存BI引擎和机器学习。BigQuery的理念是专注于分析，而不是基础设施。</p><p id="6cba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">企业使用BigQuery来获得洞察力，并对千兆字节到千兆字节的数据运行极快的SQL查询。要了解关于BigQuery的更多信息，请查看产品页面<a class="ae iu" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank">这里</a>。在本文的剩余部分，我们将介绍一些SQL从业者可能感兴趣的BigQuery的更具体的特性。</p><h2 id="d685" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">BigQuery标准SQL</h2><p id="c5f5" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">如果您是一名经验丰富的SQL管理员，您可以使用您的SQL经验来操作BigQuery。BigQuery有一个名为<a class="ae iu" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/" rel="noopener ugc nofollow" target="_blank">标准SQL </a>的模式，它符合SQL 2011标准，支持嵌套和重复数据，允许用户定义函数和DML。</p><p id="910b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您是SQL管理员，您可以在BigQuery中使用SQL查询进行数据转换、分析，甚至是机器学习。</p><p id="cb52" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">MS SQL Server和标准SQL的语法和功能非常相似，在大多数情况下，您将在查询中更改函数或数据类型，如<a class="ae iu" href="https://www.w3schools.com/sql/func_sqlserver_dateadd.asp" rel="noopener ugc nofollow" target="_blank">DATEADD</a>vs<a class="ae iu" href="https://www.w3schools.com/sql/func_mysql_date_add.asp" rel="noopener ugc nofollow" target="_blank">DATE _ ADD</a>。</p><p id="82a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Sqllines.com有很好的SQL Server向MySQL迁移参考资源<a class="ae iu" href="http://www.sqlines.com/sql-server-to-mysql" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5110" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SQL server:</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="c3af" class="lk ju hi me b fi mi mj l mk ml">WHEN (PurchaseDate &lt; DATEADD(MM,+1,GETDATE()) AND (PERIOD_DATE__A &gt;= DATEADD(MM,+1,GETDATE()) OR A.PERIOD_DATE__A IS NULL))</span></pre><p id="b62b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SQL标准:</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="8256" class="lk ju hi me b fi mi mj l mk ml">WHEN (DATE(PurchaseDate) &lt; DATE_ADD(Current_Date, Interval 1 month) AND ( a.PERIOD_DATE__A &gt;= CAST(DATE_ADD(current_date, Interval 1 month) AS string) OR a.PERIOD_DATE__A = ‘’) )</span></pre><p id="3d6b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多关于标准SQL参考资料<a class="ae iu" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/" rel="noopener ugc nofollow" target="_blank">请点击</a>。</p><h2 id="0945" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">大查询机器学习</h2><p id="0390" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><a class="ae iu" href="https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro" rel="noopener ugc nofollow" target="_blank"> BigQuery ML (BQML) </a>使用户能够使用标准SQL查询在BigQuery中创建和执行机器学习(ML)模型。BQML使得数据分析团队可以访问ML，并使SQL从业者能够使用现有的技能构建模型。</p><p id="9adc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大型数据集上的ML通常需要python经验和ML框架知识。在组织中，这些要求仅限于一小部分个人，在许多情况下，组织的现有数据团队还不具备这些技能。这些组织中有许多数据分析师了解他们公司的数据，但他们的机器学习和编程技能有限或缺乏。</p><p id="247c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">分析师可以使用BigQuery ML在BigQuery中构建和评估ML模型。分析师不再需要将少量数据导出到电子表格或其他应用程序中，或者等待数据科学团队提供有限的资源。</p><p id="dd3e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么SQL从业者可以在BigQuery中完成什么类型的洞察和机器学习呢？为了开始理解BigQuery ML，可以使用来自多个BigQuery数据集数据来训练和预测模型。</p><p id="d66a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">BigQuery ML支持的机器学习模型类型:</p><ul class=""><li id="6f77" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">用于预测的线性回归。例如，未来某一天某一商品的销售额。</li><li id="0f74" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">用于分类的二元逻辑回归。例如，确定客户是否会购买。</li><li id="a367" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">分类的多类逻辑回归。例如，预测输入的低值、中值或高值。</li><li id="c559" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">用于数据分割的k-均值聚类。例如，识别客户群。</li></ul><p id="f33f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了模型(数据集)并运行了<a class="ae iu" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate" rel="noopener ugc nofollow" target="_blank"> ML之后。评估</a>函数查询，您可以使用您的模型使用<a class="ae iu" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-predict" rel="noopener ugc nofollow" target="_blank"> ML来预测结果。预测</a>功能。</p><p id="c054" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">示例查询:</p><pre class="lz ma mb mc fd md me mf mg aw mh bi"><span id="527e" class="lk ju hi me b fi mi mj l mk ml">#standardSQL<br/>SELECT<br/> country,<br/> SUM(predicted_label) as total_predicted_purchases<br/>FROM<br/> ML.PREDICT(MODEL `bqml_tutorial.sample_model`, (<br/>SELECT<br/> IFNULL(device.operatingSystem, “”) AS os,<br/> device.isMobile AS is_mobile,<br/> IFNULL(totals.pageviews, 0) AS pageviews,<br/> IFNULL(geoNetwork.country, “”) AS country<br/>FROM<br/> `bigquery-public-data.google_analytics_sample.ga_sessions_*`<br/>WHERE<br/> _TABLE_SUFFIX BETWEEN ‘20170701’ AND ‘20170801’))<br/>GROUP BY country<br/>ORDER BY total_predicted_purchases DESC<br/>LIMIT 10</span></pre><p id="a215" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果:</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/52471a58f0f755e8e62baeb928e435f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9C0911e4sGT0O4U3"/></div></div></figure><p id="56f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是基于谷歌分析数据的预测购买总量。</p><p id="9f3e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多关于BigQuery ML <a class="ae iu" href="https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro" rel="noopener ugc nofollow" target="_blank">的信息，请点击这里</a>。</p><h2 id="3d6f" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">云数据流SQL</h2><p id="a455" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><a class="ae iu" href="https://cloud.google.com/dataflow/docs/guides/sql/dataflow-sql-intro" rel="noopener ugc nofollow" target="_blank">云数据流SQL </a>允许您使用SQL查询在BigQuery UI中开发和运行云数据流作业。数据流SQL使用<a class="ae iu" href="https://beam.apache.org/documentation/dsls/sql/overview/" rel="noopener ugc nofollow" target="_blank"> Beam SQL </a>，这对SQL从业者来说很重要，因为以前你只能用Java、Python或Go语言编写Apache Beam或数据流管道。这个功能为SQL从业者开辟了一个全新的数据处理领域。</p><p id="9eec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你能用它做什么:</p><ol class=""><li id="f697" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js mn lc ld le bi translated">从SQL中的BigQuery UI开发和运行流管道</li><li id="99a2" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js mn lc ld le bi translated">将流(来自云发布订阅)与快照数据集(大查询表)连接</li><li id="7f4a" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js mn lc ld le bi translated">将结果写入用于分析和仪表板的BigQuery表中</li></ol><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/2ce81ff0171e844b6752d1b576848a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XDxLaQTwzG9KBF_x"/></div></div></figure><p id="735f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目前，您只能从PubSub主题或BigQuery表中读取数据，并向BigQuery表中写入数据，但是我确信将来会启用更多的数据源和目的地。</p><p id="a87d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">云数据流SQL的一些可能用例</p><ul class=""><li id="f5d0" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">通过PubSub将AppEngine中的应用程序事件与BigQuery中的其他监控系统数据集结合起来，以获得更丰富的系统洞察力</li><li id="f9c5" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">将<a class="ae iu" href="https://developers.google.com/analytics/devguides/reporting/realtime/v3/" rel="noopener ugc nofollow" target="_blank"> Google Analytics实时报告API </a>与营销分析BigQuery中的CRM或销售表数据相结合</li></ul><p id="42de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你对SSIS有经验，并且正在寻找一个基于UI的ETL服务，也可以考虑<a class="ae iu" href="https://cloud.google.com/data-fusion/" rel="noopener ugc nofollow" target="_blank">云数据融合</a>。虽然目前它不包括SQL功能，但它是一个免费的GCP本地ETL管道服务。</p><p id="f7ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文旨在概述GCP的一些SQL选项，展示SQL在Google Cloud上是如何以多种方式得到支持的。最后，本周<a class="ae iu" href="https://cloud.google.com/blog/products/databases/google-cloud-databases-named-a-leader-in-the-forrester-wave-database-as-a-service-q2-2019" rel="noopener ugc nofollow" target="_blank">谷歌云数据库提名了Forrester Wave数据库即服务的领导者，Q2 2019 </a>。</p><p id="5bb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这篇文章有助于展示SQL从业者可以在Google云平台上尝试的一些选项！</p></div></div>    
</body>
</html>