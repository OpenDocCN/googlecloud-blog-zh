<html>
<head>
<title>GCP: Secret Manager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP:秘密经理</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcp-secret-manager-c043e73679d5?source=collection_archive---------2-----------------------#2020-05-29">https://medium.com/google-cloud/gcp-secret-manager-c043e73679d5?source=collection_archive---------2-----------------------#2020-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/9e567080a476ef72821312583274ee0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*LC0r1LvfSuNnvMQ_LvQYow.png"/></div></figure><p id="0643" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">几个月前，谷歌与我们分享了一项名为Secret Manager的服务。它已经酝酿了一段时间，街上已经在谈论了。</p><p id="f431" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">坦率地说，GCP的秘密管理(用户名、密码、密钥等)简直是一场噩梦。围绕这一问题的解决方案涉及加密和解密层，并不时使用一两个第三方工具来使其工作。你可以想象，这里有很多挑战。首先，复杂的层次和工具的捆绑需要管理时间和精力，而没有人真正拥有这些时间和精力。当您试图让您的应用程序具有可移植性时，这个问题变得更加复杂。谁在何时访问什么的可见性和透明度差也是一个问题。正如你已经知道的，移动按键一点也不好玩。</p><p id="6063" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如此忠于生态系统的开发者们试图用云KMS来解决这个问题。</p><p id="c939" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">平心而论，<a class="ae jk" href="https://cloud.google.com/kms" rel="noopener ugc nofollow" target="_blank">云KMS </a>在这里确实尝试过创新，但是，总感觉像一个方塞在一个圆洞里。它很笨重，使用起来很复杂，而且总是带你进行不必要的冒险。你可能读到这里会想，这是一个人的观点，但实际上不是。谷歌自己也承认:</p><blockquote class="jl"><p id="193b" class="jm jn hi bd jo jp jq jr js jt ju jj dx translated">一个密钥管理系统，如<a class="ae jk" href="https://cloud.google.com/kms" rel="noopener ugc nofollow" target="_blank">云KMS </a>，允许你管理加密密钥，并使用它们来加密或解密数据。但是，您不能查看、提取或导出密钥材料本身。</p><p id="6c82" class="jm jn hi bd jo jp jq jr js jt ju jj dx translated">同样，您可以使用密钥管理系统在传输或存储敏感数据之前对其进行加密。然后，您可以在使用敏感数据之前对其进行解密。以这种方式使用密钥管理系统来保护秘密更加复杂并且效率更低。</p></blockquote><p id="b1f8" class="pw-post-body-paragraph im in hi io b ip jv ir is it jw iv iw ix jx iz ja jb jy jd je jf jz jh ji jj hb bi translated">这并不是说<a class="ae jk" href="https://cloud.google.com/kms" rel="noopener ugc nofollow" target="_blank">云KMS </a>是一个无用的工具。不要！只是，虽然它是一个伟大的工具，但并不是所有的用例都适合KMS。有时你只需要访问你的秘密，你不想所有的加密解密业务。</p><p id="0deb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你使用过<a class="ae jk" href="https://www.vaultproject.io/" rel="noopener ugc nofollow" target="_blank"> Hashicorp金库</a>，你就知道你到底错过了什么。</p><p id="1f94" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">输入秘密经理！</p><figure class="ka kb kc kd fd ij"><div class="bz dy l di"><div class="ke kf l"/></div></figure><blockquote class="kg kh ki"><p id="867b" class="im in kj io b ip iq ir is it iu iv iw kk iy iz ja kl jc jd je km jg jh ji jj hb bi translated">Secret Manager允许您以二进制blobs或文本字符串的形式存储、管理和访问<a class="ae jk" href="https://cloud.google.com/secret-manager/docs/overview#secret" rel="noopener ugc nofollow" target="_blank">机密</a>。有了适当的权限，您可以查看机密的内容。</p></blockquote><p id="6396" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里有很多好处。秘密现在可以锚定在一个集中的真相源中，使用一个完全托管的服务。除此之外，我们现在可以接入<a class="ae jk" href="https://cloud.google.com/iam" rel="noopener ugc nofollow" target="_blank">云IAM </a>来管理授权。这是“便携性”事业的巨大胜利。</p><p id="9f04" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们也谈一谈版本控制。CI/CD(持续集成和持续交付)管道已经使版本化有点像主食。今天，一般的构建管道会有从<code class="du kn ko kp kq b">dev</code>到<code class="du kn ko kp kq b">prod</code>的多个版本，以及介于两者之间的所有版本。因为这样的数据库将是不同的，密钥将是唯一的，用户名将是共享的，并且密码将是不同的。为了便于集中管理，一个键-值对可以有一个带有多个值的键(根据定义，它们是一对……没有吗？).无论如何，这个特性是必要的还是我们都有点多余的？绝对有必要！同一个密钥需要不同的凭证的情况有很多次。例如，作为一种最佳实践，有一句名言是这样说的，“不要使用开发人员证书去开发！”。或者反之亦然！因此，在CI/CD管道中，您可能希望将所有东西都隔离开来，但保留静态变量。</p><p id="59c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">话虽如此，如果你想看看秘密经理的行动，这里有一个<a class="ae jk" rel="noopener" href="/google-cloud/gcp-deploying-to-app-engine-from-github-using-cloud-build-df2582f968c7">运行的例子</a>。我在一个相对便携的解决方案上使用了spring cloud和Secret Manager，以及Spring-Cloud-GCP-Secret-Manager。这里Secret Manager的必要性在于，我们需要将数据库机密附加到Github上的公共repo上托管的CI/CD构建管道中。测试和工作像一个魅力！</p></div></div>    
</body>
</html>