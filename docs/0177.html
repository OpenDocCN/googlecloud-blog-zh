<html>
<head>
<title>Paying it Forward — How BigQuery’s Data Ingest Breaks Tech Norms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向前支付BigQuery的数据摄取如何打破技术规范</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/paying-it-forward-how-bigquerys-data-ingest-breaks-tech-norms-8bfe2341f5eb?source=collection_archive---------3-----------------------#2016-12-13">https://medium.com/google-cloud/paying-it-forward-how-bigquerys-data-ingest-breaks-tech-norms-8bfe2341f5eb?source=collection_archive---------3-----------------------#2016-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c35a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery是一项有趣的服务，深深地将T1嵌入到谷歌的T2数据中心T3和T4网络T5技术中。因此，当在更深层次上与大多数其他技术进行比较时，人们很难理解BigQuery的技术优势。因此，我将在一系列博客文章中描述BigQuery的各个方面。</p><p id="90f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天我将讨论批量数据接收BigQuery中数据接收的独特工作方式，为什么它如此不同，以及为什么它在实践中如此重要。</p><p id="54e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。批量摄取不会占用您的查询容量</strong></p><p id="ad77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据接收需要资源—传输数据的网络、加密、转换、优化和压缩数据的CPU和RAM，以及将数据写入存储的IO。在红移、雪花和Hadoop等更传统的大数据技术中，数据接收会消耗部署在集群中的资源。事实上，消耗的资源越多，摄取的速度就越快。</p><p id="c776" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题是，这些CPU/RAM资源通常相对昂贵，否则将专门用于分析。所以你摄入的越多，留给分析的空间就越少。从这个意义上说，批量摄取成本不可预测地与分析能力混为一谈。管理接收和分析的资源和成本共租是一场现实的噩梦。</p><p id="b517" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，BigQuery的批处理摄取消耗的资源完全独立于查询资源。也就是说，无论您将多少数据接收到BigQuery中，您执行SQL的能力都不会减少一点。用户也不会为这些资源买单——big query相信提前付费，因为这些前期投资稍后会以更多存储和更多分析使用的形式回报。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/a284d917ee909c4ff3a865015b718bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E62mVKY3ThD_GMroqj7e9g.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">引擎盖下的BigQuery。注意“批量加载”和“计算”框之间的距离！</figcaption></figure><p id="f576" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在比较BigQuery与其他技术的接收性能时，在给定集群规模的情况下，声称具有一定的负载性能是不够的。必须包括一个重要的概念——资源成本。毕竟，如果摄取机制只是为了装载数据而衡量数据库达到100%利用率的情况，那么比较它们又有什么用呢？</p><p id="75a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就把我们带到了…</p><p id="cd0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。批量摄取是免费的</strong></p><p id="145e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在有了大胆断言的先决背景。与其他技术不同，BigQuery的批量加载机制是完全免费的。</p><p id="df64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发现，其他技术要求用户通过集群成本本身为摄取提供资金。这很难量化，特别是因为集群通常被假定为主要用于查询操作(以及存储，如果计算和存储没有分离的话，还有红移)。对于像雅典娜这样的新来者，摄取是通过在S3上创建和维护文件的生产和数据管理开销来资助的。</p><p id="90b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一点值得重复——big query的批量摄取是免费的。</p><p id="639b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。批量加载操作是原子的</strong></p><p id="3612" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是BigQuery数据加载机制的微妙之处——如果您的加载失败，100%都会失败。不需要清理—只需重试加载作业或对其进行故障排除。同样，没有竞争条件或飞行中的争吵。当一个大查询负载报告成功时，100%的负载同时成功。这些东西在实际场景中真的很重要。</p><p id="3922" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。BigQuery在加载过程中会消耗大量的CPU和RAM</strong></p><p id="c7bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经讨论过BigQuery load不使用专用于查询能力的CPU和RAM资源。然而，在幕后，BigQuery确实利用了大量的CPU和RAM资源，以尽可能最佳的方式加载数据。<a class="ae jd" href="https://cloud.google.com/blog/big-data/2016/04/inside-capacitor-bigquerys-next-generation-columnar-storage-format" rel="noopener ugc nofollow" target="_blank"> BigQuery的电容存储格式</a>做了大量的数据分析和自以为是的优化，不仅在负载上，而且在此后持续进行。所有这些复杂性对最终用户是隐藏的，完全由Google管理。</p><p id="5a1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。批量摄取几乎不受限制</strong></p><p id="5543" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为BigQuery的加载路径是完全免费的，所以BigQuery确实有一些合理的配额和限制。默认情况下，客户每天应该能够接收几十TB的数据。</p><p id="574f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也就是说，一些BigQuery客户每天吸收超过1pb的数据。与所有共享的免费资源一样，您只需在这样做之前与我们交流:)</p><p id="2c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。联合查询是付费批量摄取</strong></p><p id="c454" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery能够直接从GCS查询数据。这个查询路径包含了典型的查询开销。</p><p id="cfa2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也就是说，如果您将BigQuery-on-GCS查询的结果写入BigQuery本身，您将获得一个等同于您所服从的系统——付费批量摄取。这是一个突破常规负载控制的好方法。</p><p id="5d2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="1e2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery的架构有点独特，它主要依赖于谷歌的Dremel和T2的巨像，并通过T4的Borg和Petabit的Jupiter网络连接起来。</p><p id="db71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，BigQuery的属性经常被误解。在批量接收路径上，BigQuery在几个方面有所不同:<br/> -接收不影响查询能力<br/> -接收完全免费<br/> -接收操作是原子的<br/> - BigQuery在加载时自动优化您的数据，并在此后持续优化<br/> - BigQuery的批量接收规模可达每天数Pb<br/>-big query的query-on-GCS模型可作为非常快速的付费接收</p><p id="3a5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你发现上面的每一个词都有用。接下来，我将介绍并发和多租户。提示— <a class="ae jd" href="https://cloud.google.com/blog/big-data/2016/08/in-memory-query-execution-in-google-bigquery" rel="noopener ugc nofollow" target="_blank">流水线执行</a>是大数据领域的下一件大事！</p></div></div>    
</body>
</html>