<html>
<head>
<title>Google OAuth credential: going deeper, the hard way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌OAuth认证:深入，艰难的方式</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-oauth-credential-going-deeper-the-hard-way-f403cf3edf9d?source=collection_archive---------1-----------------------#2021-02-12">https://medium.com/google-cloud/google-oauth-credential-going-deeper-the-hard-way-f403cf3edf9d?source=collection_archive---------1-----------------------#2021-02-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/205f44512be72569d90217c5878e9179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zysA6dOHYpyc_voU6A6fQ.png"/></div></div></figure><p id="91ee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谷歌云的安全性至关重要，但奇怪的是，这却是一个不受欢迎的话题。其实，<strong class="is hj">安全往往是个无聊的话题</strong>！为了填补这个空白，我写了一些关于IAM服务的两个限制的文章，以及关于服务帐户凭证API 提供的变通方法和新的<a class="ae jo" rel="noopener" href="/google-cloud/service-account-credentials-api-a-solution-to-different-issues-dc7434037115">用例的文章。在这两种情况下，我主要关心的仍然是相同的:<strong class="is hj">避免用户下载服务帐户密钥文件</strong>以提高安全性。</a></p><p id="3753" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然而，最新的<a class="ae jo" href="https://cloud.google.com/blog/topics/developers-practitioners/dont-fear-authentication-google-drive-edition" rel="noopener ugc nofollow" target="_blank">关于访问</a><a class="jp jq ge" href="https://medium.com/u/87b2115d4438?source=post_page-----f403cf3edf9d--------------------------------" rel="noopener" target="_blank"> Gabe Weiss </a> <strong class="is hj">的Drive API 的博文使用了服务账户密钥文件</strong>。这就是我联系他的原因，讨论非常有趣。</p><h1 id="4515" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">Gabe用例</h1><p id="c36d" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn hb bi translated">在他的博客文章中，Gabe展示了如何访问Google Drive文件夹。<strong class="is hj">这个文件夹可能是机密的</strong>或者，至少，你不希望任何开发者访问它。<br/>事实上，如果您<strong class="is hj">授予文件夹</strong>上的用户帐户，API和<strong class="is hj">也可以通过浏览器</strong>进行访问，这是一个问题，也是您不想要的。</p><p id="d788" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，解决方案是<strong class="is hj">将访问授权授予第三方</strong>，不是用户帐户，而是服务帐户。因此，要使用这个账户，<strong class="is hj">你需要有你这边的凭证</strong>并使用它们</p><blockquote class="ku kv kw"><p id="f209" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated"><em class="hi">服务账户密钥文件！</em></p></blockquote><p id="af51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">是的，用例是有效的</strong>，并且可以为任何Google Workspace产品复制:访问Google文档、工作表、幻灯片、..</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="c8c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好吧，但是在我的理想世界里，你有一个Google驱动文件夹用于开发/测试，还有一个，机密的，用于生产。这有两个原因</p><ol class=""><li id="02cc" class="li lj hi is b it iu ix iy jb lk jf ll jj lm jn ln lo lp lq bi translated">如果<strong class="is hj">用户是一个坏演员</strong>并且<strong class="is hj">想要读取文件夹内的文件</strong>，他们可以通过API访问它们。最后，问题是一样的:用户可以访问文件夹内容，<strong class="is hj">只是下载内容不太容易！</strong></li><li id="7fe0" class="li lj hi is b it lr ix ls jb lt jf lu jj lv jn ln lo lp lq bi translated"><strong class="is hj">更糟糕的是，</strong>如果用户使用服务帐户访问文件夹文件，您<strong class="is hj">只能在日志</strong>中看到服务帐户电子邮件，而看不到用户凭证。设计隐藏的<strong class="is hj">坏演员</strong>！</li></ol><p id="e178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是为什么，我想告诉你如何实现同样的<strong class="is hj">访问谷歌驱动文件夹，但使用用户凭证</strong>。<br/> <strong class="is hj"> <em class="kx">而这种方式绝对不容易！！</em> </strong></p><h1 id="1cdd" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">代码示例更新</h1><p id="f19f" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn hb bi translated">在深入之前，我想更新Gabe提出的代码<strong class="is hj">，使其更加“可移植”</strong>，我的意思是依靠<a class="ae jo" href="https://cloud.google.com/docs/authentication/production" rel="noopener ugc nofollow" target="_blank"> ADC(应用程序默认凭证)</a>。这个解决方案让Google Auth library <strong class="is hj">挑选运行时环境</strong>上可用的凭证，因此，您不必根据环境更新您的代码。</p><p id="bfc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">凭据恢复按以下顺序执行</p><ol class=""><li id="a8b5" class="li lj hi is b it iu ix iy jb lk jf ll jj lm jn ln lo lp lq bi translated">检查<code class="du lw lx ly lz b"><strong class="is hj">GOOGLE_APPLICATION_CREDENTIALS</strong></code> <strong class="is hj">环境变量</strong>是否存在。如果是这样，请使用它(并且应该引用一个凭据文件，如服务帐户密钥文件)。<br/> <em class="kx">这个模式是为了覆盖其他2个，对于没有GCP的环境</em> <br/>如果没有，转到下一个。</li><li id="40e2" class="li lj hi is b it lr ix ls jb lt jf lu jj lv jn ln lo lp lq bi translated">检查<a class="ae jo" href="https://cloud.google.com/compute/docs/storing-retrieving-metadata" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">元数据服务器</strong> </a> <strong class="is hj">是否存在于</strong>环境中。此功能允许使用Google Cloud产品中加载的服务帐户。<br/> <em class="kx">此模式是为GCP运行时环境做的</em> <br/>如果不是，转到下一步</li><li id="2baa" class="li lj hi is b it lr ix ls jb lt jf lu jj lv jn ln lo lp lq bi translated">在“已知位置”中查找在本地环境上创建的<strong class="is hj">用户凭证文件。这个文件是用命令<code class="du lw lx ly lz b">gcloud auth application-default login</code> <br/> <em class="kx">生成的。这个模式是为您的本地开发环境</em>而做的</strong></li></ol></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="94a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将代码样本分为两步</p><ol class=""><li id="85ae" class="li lj hi is b it iu ix iy jb lk jf ll jj lm jn ln lo lp lq bi translated">首先，<strong class="is hj">用<code class="du lw lx ly lz b">GOOGLE_APPLICATION_CREDENTIALS</code>环境变量设置环境</strong></li></ol><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="4a99" class="mi js hi lz b fi mj mk l ml mm">export <!-- -->GOOGLE_APPLICATION_CREDENTIALS=&lt;/path/to/&gt;<!-- -->drive_icons_sa.json</span></pre><p id="7464" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.然后是代码，以同样的方式在你的工作站和谷歌云产品的服务账户<strong class="is hj">上运行。</strong></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="f3de" class="mi js hi lz b fi mj mk l ml mm">from googleapiclient.discovery import build<br/>drive_service = build('drive', 'v3')</span></pre><p id="86fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">是的，只有2行！！让图书馆为你工作！</strong> <br/> <em class="kx">您可以添加Gabe文章中提供的子示例，然后打印结果来验证脚本的正确工作。</em></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="e50e" class="mi js hi lz b fi mj mk l ml mm"><em class="kx">children = drive_service.files().list(q=f"mimeType = 'application/vnd.google-apps.folder' and '{marketing_icon_folder_id}' in parents", fields='files(name, id)').execute()<br/>print(children)</em></span></pre><p id="baaa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">测试并验证</strong>是否按预期工作。</p><h1 id="d06e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">使用用户凭证的漫长旅程</h1><p id="75f4" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn hb bi translated">如前所述，首先要做的事情，是<strong class="is hj">取消设置环境变量</strong>T3。</p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="e117" class="mi js hi lz b fi mj mk l ml mm">unset <!-- -->GOOGLE_APPLICATION_CREDENTIALS</span></pre><p id="67f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并且<strong class="is hj">在“众所周知的位置”创建用户凭证文件</strong></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="9af5" class="mi js hi lz b fi mj mk l ml mm">gcloud auth application-default login</span></pre><p id="08d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成流程并测试python脚本。<br/> <strong class="is hj">您得到一个错误</strong>，因为您的用户凭证<strong class="is hj">没有正确的范围</strong>。</p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="58a4" class="mi js hi lz b fi mj mk l ml mm">Insufficient Permission: Request had insufficient authentication scopes.</span></pre></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="a5dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将节省您的时间，不要尝试他在凭证上明确设置范围的Gabe代码:它对用户凭证不起作用。</p><p id="5f19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的技巧<strong class="is hj">是在生成</strong>凭证令牌时限定用户凭证的范围。</p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="3829" class="mi js hi lz b fi mj mk l ml mm">gcloud auth application-default login \<br/>  --scopes='<a class="ae jo" href="https://www.googleapis.com/auth/drive'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive'</a></span></pre><p id="c4ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kx">如果您使用此凭证访问google cloud资源，请添加Google Cloud作用域，就像这样</em></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="f7a7" class="mi js hi lz b fi mj mk l ml mm">scopes='<a class="ae jo" href="https://www.googleapis.com/auth/drive','https://www.googleapis.com/auth/cloud-platform'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive','https://www.googleapis.com/auth/cloud-platform'</a></span></pre><p id="12b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kx">你可以添加所有你需要的范围:工作表、文档等等</em></p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="322d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，现在，再试一次python代码。<br/>和<strong class="is hj">再次失败</strong>，出现一个奇怪的错误:</p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="013f" class="mi js hi lz b fi mj mk l ml mm">Access Not Configured. Drive API has not been used in project 764086051850 before or it is disabled. Enable it ....</span></pre><blockquote class="ku kv kw"><p id="8a5b" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated">漫长的路从这里开始…</p></blockquote><h1 id="d7b5" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">深入了解认证</h1><p id="7001" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn hb bi translated">这个项目编号<code class="du lw lx ly lz b">764086051850</code>是什么？当你点击提供的链接时，这是被禁止的！你可以检查你所有的项目，你不会发现它！</p><blockquote class="mn"><p id="5cd1" class="mo mp hi bd mq mr ms mt mu mv mw jn dx translated">你使用了一个不属于你的项目，你需要在一个不可及的项目上激活驱动API。他妈的怎么回事？？？</p></blockquote><p id="a3ef" class="pw-post-body-paragraph iq ir hi is b it mx iv iw ix my iz ja jb mz jd je jf na jh ji jj nb jl jm jn hb bi translated">如果你在“众所周知的地点”仔细查看你的用户凭证</p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="6b38" class="mi js hi lz b fi mj mk l ml mm">#Linux<br/>cat ~/.config/gcloud/application_default_credentials.json</span><span id="9d5c" class="mi js hi lz b fi nc mk l ml mm">#Windows powershell<br/>cat $env:APPDATA/gcloud/application_default_credentials.json</span></pre><p id="bcf7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以看到这个<code class="du lw lx ly lz b">client_id</code></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="3f51" class="mi js hi lz b fi mj mk l ml mm">764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com</span></pre><p id="71cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，如果您知道<strong class="is hj"> OAuth2认证流程</strong>，那么需要在授权服务器上提供一个<code class="du lw lx ly lz b">client_id</code>和一个<code class="du lw lx ly lz b">client_secret</code>。在那里，平台对请求授权的客户端(这里是gcloud SDK)进行身份验证，并继续这个过程。您选择您的帐户，验证授权，然后获得授权令牌。<br/>客户端应用(这里是gcloud SDK)获取授权令牌并对其进行验证。作为回答，它接收一个<code class="du lw lx ly lz b">access_token</code>和一个<code class="du lw lx ly lz b">refresh_token</code>。</p><p id="e2c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kx"/><code class="du lw lx ly lz b">client_id</code><em class="kx">、</em> <code class="du lw lx ly lz b">client_secret</code> <em class="kx">和</em> <code class="du lw lx ly lz b">refresh_token</code> <em class="kx">保存在您的“知名位置”文件</em>中</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="3bbf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">问题是:因为它是来自谷歌云内部项目的<strong class="is hj"> a </strong> <code class="du lw lx ly lz b"><strong class="is hj">client_id</strong></code> <strong class="is hj">，请求中引用的就是这个项目。<br/> <em class="kx">当然，你没有访问它来启用驱动API </em></strong></p><blockquote class="mn"><p id="f09d" class="mo mp hi bd mq mr ms mt mu mv mw jn dx translated">那么现在，如何在你的项目中使用一个<code class="du lw lx ly lz b">client_id</code>？</p></blockquote><p id="366c" class="pw-post-body-paragraph iq ir hi is b it mx iv iw ix my iz ja jb mz jd je jf na jh ji jj nb jl jm jn hb bi translated">gcloud CLI允许您使用参数<code class="du lw lx ly lz b">--cliend-id-file</code>来完成此操作</p><blockquote class="mn"><p id="6f8f" class="mo mp hi bd mq mr ms mt mu mv mw jn dx translated">但是如何生成客户端ID文件呢？</p></blockquote><p id="9fd3" class="pw-post-body-paragraph iq ir hi is b it mx iv iw ix my iz ja jb mz jd je jf na jh ji jj nb jl jm jn hb bi translated">为此，您可以进入控制台中的<code class="du lw lx ly lz b">APIs &amp; Services</code>，点击<code class="du lw lx ly lz b">Credentials</code></p><figure class="ma mb mc md fd ij er es paragraph-image"><div class="er es nd"><img src="../Images/9b50d413d5c5ecbdd817b69461a33ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*DmlAczFDBX1cAYV9svKbnA.png"/></div></figure><p id="5548" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后是<code class="du lw lx ly lz b">OAuth client ID</code>类型的<code class="du lw lx ly lz b">Create Credential</code></p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/70830179c80d5cce528d479c1d85ca9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PUcPfPs_xSWfqnAQW491hA.png"/></div></div></figure><p id="5c39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到这里，就很明显了。<strong class="is hj">接下来要小得多。</strong></p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="093c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您必须<strong class="is hj">选择一个应用类型</strong>。<em class="kx">好运，挑一个！！如果你没有选择正确的，你会有这样的问题</em></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="0e28" class="mi js hi lz b fi mj mk l ml mm">Only client IDs of type 'installed' are allowed, but encountered type '...'</span></pre><blockquote class="mn"><p id="7112" class="mo mp hi bd mq mr nf ng nh ni nj jn dx translated">列表中的<strong class="ak">申请类型</strong> <code class="du lw lx ly lz b"><strong class="ak">installed</strong></code> <strong class="ak">是什么？</strong></p></blockquote><p id="df87" class="pw-post-body-paragraph iq ir hi is b it mx iv iw ix my iz ja jb mz jd je jf na jh ji jj nb jl jm jn hb bi translated">所以，选择<code class="du lw lx ly lz b">Desktop app</code>！</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/cd7e59b69da7ba00d7dd8fc614931d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7gHiNfmj60sssNuP7NL5Q.png"/></div></div></figure><p id="6bdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">命名您的密钥并创建它。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="0607" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，您可以通过点击右侧的下载图标来下载您的密钥。</p><figure class="ma mb mc md fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nl"><img src="../Images/85e0f643c8fa817991648c2d73253b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBmGoxR-U-KVxKp7ld6nEg.png"/></div></div></figure><p id="ceeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">保存文件。<em class="kx">现在你已经下载了一个秘密！！！但是它只能用于验证用户，而不能作为服务帐户密钥文件访问资源。</em></p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="01a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">你拥有所有的棋子！是时候为您的项目生成正确范围的凭证了！</strong></p><pre class="ma mb mc md fd me lz mf mg aw mh bi"><span id="d8eb" class="mi js hi lz b fi mj mk l ml mm">gcloud auth application-default login \<br/>  --scopes='<a class="ae jo" href="https://www.googleapis.com/auth/drive'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive'</a><br/>  --client-id-file=/path/to/client-id-file.json</span></pre><p id="39e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kx">你会得到安全警告，因为</em> <code class="du lw lx ly lz b"><em class="kx">client</em></code> <em class="kx">被授权服务器正式重新确认。继续，并验证所有步骤。</em></p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="1187" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并再次测试python脚本。<br/> <em class="kx">别忘了和你当前的用户邮箱共享目标文件夹！</em></p><p id="5b90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">嘣，那就行了！！</p><h1 id="ba74" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">选择正确的流程</h1><p id="182c" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn hb bi translated">现在你有了！！但是我的感觉减轻了。</p><ul class=""><li id="f294" class="li lj hi is b it iu ix iy jb lk jf ll jj lm jn nm lo lp lq bi translated">一方面，您有一个带有服务帐户密钥文件的<strong class="is hj">快速简单路径</strong>。虽然没有我想象的那么干净，但是这个警告很容易向开发者解释，因为他们会保守这个秘密。</li><li id="a7b5" class="li lj hi is b it lr ix ls jb lt jf lu jj lv jn nm lo lp lq bi translated">另一方面，你有一个<strong class="is hj">更安全的机制，没有秘密</strong>共享和参与，但是<strong class="is hj">完全不可能由开发者单独</strong>实现。</li></ul><p id="4eae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安全性是最重要的，但是如果<strong class="is hj">完成简单的任务成为一个挑战，它将被用户绕过</strong>以满足他们的最后期限和期望。</p><p id="bad3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">权衡并不简单，一个<strong class="is hj">更好的技术安全解决方案并不总是带来更好的整体安全性</strong>。明智选择！</p></div></div>    
</body>
</html>