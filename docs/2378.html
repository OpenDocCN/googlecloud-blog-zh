<html>
<head>
<title>Jobs and Deployment Strategies on Google Kubernetes Engine (GKE)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌Kubernetes引擎(GKE)上的工作和部署策略</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/jobs-and-deployment-strategies-on-google-kubernetes-engine-gke-4b37047c2cf1?source=collection_archive---------2-----------------------#2022-09-23">https://medium.com/google-cloud/jobs-and-deployment-strategies-on-google-kubernetes-engine-gke-4b37047c2cf1?source=collection_archive---------2-----------------------#2022-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/d2425356611502711c8d8609c0b75597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*dTLPBHYk2SArfRbsQM9rzA.png"/></div></figure><div class=""/><p id="84c2" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">大家好。我希望你一切都好。在这篇文章中，我想解释Kubernetes中的工作和部署策略，以及如何在GKE实现它们。</p><p id="0e24" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在深入主题之前，我假设您已经知道Kubernetes是什么，它是如何工作的，以及围绕它们的术语/概念。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><blockquote class="jr"><p id="c027" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">订阅我的YouTube频道，<a class="ae kb" href="https://www.youtube.com/c/TheCloudPilot" rel="noopener ugc nofollow" target="_blank">云飞行员</a></p></blockquote></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="237e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们先来看看Kubernetes都有哪些工作。</p><h1 id="2ee4" class="kc kd hp bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Kubernetes的工作</h1><p id="6de6" class="pw-post-body-paragraph im in hp io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">作业创建一个或多个pod来执行任务，并将继续重试执行，直到执行了指定的完成次数。当达到指定的成功完成次数时，作业被视为完成。删除作业将清理它创建的窗格。暂停作业将删除其活动窗格，直到作业再次恢复。</p><blockquote class="lf lg lh"><p id="b97c" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">您还可以并行运行作业。</p></blockquote><p id="a5e2" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们刚刚看到了工作在Kubernetes是如何工作的。我们可以随时运行它们。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><blockquote class="jr"><p id="acd9" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">但是如果我们能把它们安排在一个特定的时间呢？</p></blockquote></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><h1 id="6af2" class="kc kd hp bd ke kf lm kh ki kj ln kl km kn lo kp kq kr lp kt ku kv lq kx ky kz bi translated">克朗乔布</h1><p id="cd99" class="pw-post-body-paragraph im in hp io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">CronJob是一种可以安排在特定时间或定期运行的作业。它用于执行定期计划的操作，如备份和生成报告。每个任务都应该配置为无限期重复。每天拍摄快照，以及在每月的某一天进行备份都是CronJobs的例子(或者说是用例)。</p><p id="eab7" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们知道了什么是jobs和cronjobs，让我们看看它是如何在谷歌Kubernetes引擎(GKE)中完成的。</p><ol class=""><li id="c4c7" class="lr ls hp io b ip iq it iu ix lt jb lu jf lv jj lw lx ly lz bi translated">第一步是创建一个GKE集群并进入该集群。(<strong class="io hq">参考</strong> <a class="ae kb" href="https://www.youtube.com/watch?v=AGkTioTba3E&amp;ab_channel=TheCloudPilot" rel="noopener ugc nofollow" target="_blank"> <strong class="io hq">我这里视频</strong> </a>)</li><li id="5ab6" class="lr ls hp io b ip ma it mb ix mc jb md jf me jj lw lx ly lz bi translated">现在，让我们为作业创建一个job.yaml文件。<em class="li">我正在创建的作业计算π到2000位，并将其打印出来。</em></li></ol><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es mf"><img src="../Images/fbcb57f18ad0be25843a518a4d129325.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*M2XY9sJ1Yy7dnxUG07llhg.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">job.yaml</figcaption></figure><p id="58cb" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用配置创建YAML文件后，运行:</p><blockquote class="lf lg lh"><p id="831b" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f job.yaml</p></blockquote><p id="4c09" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将看到作业已创建。</p><p id="0f13" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要查看作业的已完成窗格，请运行:</p><blockquote class="lf lg lh"><p id="ba93" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl获取豆荚</p></blockquote><p id="acb7" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将列出作业为执行任务而创建的窗格。我们可以使用以下命令检查pod的日志:</p><blockquote class="lf lg lh"><p id="9c99" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl日志<podname/></p></blockquote><p id="1b35" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将显示输出。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><blockquote class="lf lg lh"><p id="316e" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">要并行运行作业，将<strong class="io hq">并行度:&lt;要并行运行的作业数量&gt; </strong>添加到作业模板的规格部分。</p><p id="b6e3" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">为了指定作业的成功，将<strong class="io hq">完成:&lt;完成数量&gt; </strong>添加到作业模板的spec部分。</p></blockquote></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="36dc" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们看看CronJob是如何实现的。要创建每分钟打印当前时间和hello消息的Cronjob，请使用以下代码:</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es mo"><img src="../Images/562f4e129656ef1936b5f028b13a0b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*B7d9mQb_yzlccj9uDLHC9Q.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">cronjob.yaml</figcaption></figure><blockquote class="lf lg lh"><p id="a26d" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">参考<a class="ae kb" href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#cron-schedule-syntax" rel="noopener ugc nofollow" target="_blank">这里的<strong class="io hq"> Cron调度语法</strong>T3】</a></p></blockquote><p id="2317" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用配置创建YAML文件后，运行:</p><blockquote class="lf lg lh"><p id="22da" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f cronjob.yaml</p></blockquote><p id="03a4" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您将看到作业已创建。</p><p id="197d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要查看作业的已完成窗格，请运行:</p><blockquote class="lf lg lh"><p id="a2a9" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl获取豆荚</p></blockquote><p id="5198" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这将列出作业为执行任务而创建的窗格。我们可以使用以下命令检查pod的日志:</p><blockquote class="lf lg lh"><p id="fd06" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl日志<podname/></p></blockquote><p id="70f5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> <em class="li">这将显示输出。这就是你如何在GKE创造工作和cronjobs。</em> </strong>现在，我们将看看Kubernetes上的部署策略，看看它们如何在GKE上实施。</p><h1 id="853c" class="kc kd hp bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">部署</h1><p id="ea33" class="pw-post-body-paragraph im in hp io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">当我们使用pod时，当资源数量增加时，很难独自管理它们。因此，我们需要一些东西来帮助我们保持资源的期望状态。这就是部署发挥作用的地方。</p><blockquote class="jr"><p id="881d" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">部署为pod和副本集提供声明性更新。</p></blockquote><p id="9b70" class="pw-post-body-paragraph im in hp io b ip mp ir is it mq iv iw ix mr iz ja jb ms jd je jf mt jh ji jj hb bi translated">一旦我们使用标签将pod定义模板与部署关联，它将开始管理模板中提到的带有标签的所有pod。</p><p id="dbc4" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在部署中更新应用程序时，主要使用两种策略来保持应用程序正常运行，并最大限度地减少停机时间。这些是①<strong class="io hq">金丝雀</strong>；以及(2) <strong class="io hq">蓝绿调配</strong>。</p><h2 id="588e" class="mu kd hp bd ke mv mw mx ki my mz na km ix nb nc kq jb nd ne ku jf nf ng ky nh bi translated">金丝雀部署</h2><blockquote class="lf lg lh"><p id="0768" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">在canary部署中，在向所有用户发布之前，您需要为一部分用户创建一个增量部署。</p></blockquote><p id="387e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">例如，假设您有一个需要推出新版本的应用程序。使用canary部署策略，您可以创建一个新的部署，并将您的一部分流量定向到新创建的部署进行测试。一旦新部署被测试为稳定，就将最新版本部署到其他部署，将流量路由回这些部署，并删除临时创建的canary部署。</p><p id="4489" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面这张图片可能会给你一些启发:</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="er es ni"><img src="../Images/7032e77fc5e64d2a64b1ca212e6664c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbcECVmCoCrNbVo6iAqb3g.jpeg"/></div></div></figure><h2 id="307b" class="mu kd hp bd ke mv mw mx ki my mz na km ix nb nc kq jb nd ne ku jf nf ng ky nh bi translated">蓝绿色部署</h2><blockquote class="lf lg lh"><p id="6930" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">在蓝绿色部署中，使用新版本创建整个部署，并将流量导向新版本，然后删除旧部署。</p></blockquote><p id="d7c6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">例如，您有一个应用程序的两个版本，它服务于第一个版本。在蓝绿色策略中，您将为第二个版本创建一个新部署，并将流量重定向到第二个部署，并删除第一个部署。</p><p id="aad0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面这张图片可能会给你一些启发:</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="er es nn"><img src="../Images/8fe52a4e48a8c52f48345a2088c7ff4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKDYDiiQ6NNjNFj93Jp0DA.jpeg"/></div></div></figure><p id="5f1c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在你已经理解了这个想法，让我们看看如何在GKE上实现它。</p><h1 id="a2c8" class="kc kd hp bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">GKE的金丝雀部署</h1><p id="32f7" class="pw-post-body-paragraph im in hp io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">使用deployment.yaml文件创建部署，使用canary.yaml文件创建canary部署。</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es no"><img src="../Images/7b4d59ac7b0ada84f59c3851692f3ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*_aAcVcACmIbQCP92xrWBFQ.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">部署. yaml</figcaption></figure><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es np"><img src="../Images/36489166a552700a75ec45211ea97f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*gWEm3WwW7Ovm_PzLLVaW0w.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">canary.yaml</figcaption></figure><p id="3f5b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们运行命令:</p><blockquote class="lf lg lh"><p id="a2ae" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f deployment.yaml</p><p id="a851" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f canary.yaml</p></blockquote><p id="183c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了向nginx部署公开服务，使用选择器“nginx”创建一个service.yaml文件。</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es nq"><img src="../Images/c2b64fafbf68d2a9204d157f9406cc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*PsSuFOxS4fU47y2TEad71Q.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">service.yaml</figcaption></figure><p id="ba5c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，运行:</p><blockquote class="lf lg lh"><p id="427d" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f service.yaml</p></blockquote><p id="7900" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们将金丝雀部署引入到服务中。为此，将选择器“nginx”更改为“canary ”,如下所示:</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="er es nr"><img src="../Images/755084d95cbe875c452b0d2afd1dc3a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*azHTifhN7b0ZfXlwa6MFgg.png"/></div></div></figure><p id="c76f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要重新配置服务，请运行:</p><blockquote class="lf lg lh"><p id="ba54" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f service.yaml</p></blockquote><p id="6752" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将带有选择器“nginx”的部署部署到最新版本后，恢复service.yaml文件中的更改，并再次运行apply命令。</p><p id="12bc" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在您已经有了更新的应用程序，您可以删除canary部署了。GKE就是这样部署金丝雀的。</p><h1 id="8bae" class="kc kd hp bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">蓝绿在GKE的部署</h1><p id="a953" class="pw-post-body-paragraph im in hp io b ip la ir is it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj hb bi translated">使用deployment.yaml文件创建标签为“blue”的部署。</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es ns"><img src="../Images/c967d348ede0564d141f55d98ccc4354.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*YfzofgrWp9e8cgZzQb4oMQ.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx translated">blue.yaml</figcaption></figure><p id="751e" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，让我们运行命令:</p><blockquote class="lf lg lh"><p id="2f13" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f blue.yaml</p><p id="1465" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f green.yaml</p></blockquote><p id="4586" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了向蓝色部署公开服务，创建一个带有选择器“blue”的service.yaml文件。</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es nt"><img src="../Images/8becafbdc6ca1a124f3d9f73461c88cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*1EjvppPK9zUOhu77Z2fEqA.png"/></div></figure><p id="f544" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">service.yaml文件准备就绪后，运行:</p><blockquote class="lf lg lh"><p id="2e1b" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f service.yaml</p></blockquote><p id="136a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，使用deployment.yaml创建一个绿色部署</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es ns"><img src="../Images/c967d348ede0564d141f55d98ccc4354.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*YfzofgrWp9e8cgZzQb4oMQ.png"/></div></figure><p id="bc03" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一旦绿色部署就绪，将选择器“蓝色”更改为“绿色”，如下所示:</p><figure class="mg mh mi mj fd hk er es paragraph-image"><div class="er es nu"><img src="../Images/f0fc6aae1f14f9c13614ce99f23bf2ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*FUeA9uCJqq9pTbyyCtbzXQ.png"/></div></figure><p id="7d82" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要重新配置服务，请运行:</p><blockquote class="lf lg lh"><p id="f29c" class="im in li io b ip iq ir is it iu iv iw lj iy iz ja lk jc jd je ll jg jh ji jj hb bi translated">kubectl apply -f service.yaml</p></blockquote><p id="f02a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将带有选择器“nginx”的部署部署到最新版本后，恢复service.yaml文件中的更改，并再次运行apply命令。</p><p id="7378" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> <em class="li">现在您已经将服务定向到绿色部署，并且可以删除蓝色部署。这就是蓝绿部署在GKE的实施方式。</em> </strong></p><p id="b0cd" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望这对你有所帮助。祝你愉快。回头见！</p></div></div>    
</body>
</html>