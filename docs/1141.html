<html>
<head>
<title>BigQuery Drop or Change Column</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery删除或更改列</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/bigquery-drop-or-change-column-43409ae12bc4?source=collection_archive---------0-----------------------#2019-09-06">https://medium.com/google-cloud/bigquery-drop-or-change-column-43409ae12bc4?source=collection_archive---------0-----------------------#2019-09-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="ae4d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">更新</h1><p id="0e48" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">BigQuery的DDL now <strong class="jf hj">是否支持更改表。请看<a class="ae kb" href="https://cloud.google.com/bigquery/docs/managing-table-schemas" rel="noopener ugc nofollow" target="_blank">这里</a>。本文的其余部分将向您展示一些替换表格的技巧。然而，替换表格将破坏任何<a class="ae kb" href="https://cloud.google.com/bigquery/docs/time-travel" rel="noopener ugc nofollow" target="_blank">时间旅行</a>，因此建议使用原生功能，而不是创建或替换表格。</strong></p><h1 id="2096" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">旧内容—改用原生功能</h1><p id="c321" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">BigQuery DDL不支持更改表，但支持重写表。你可以用这个来达到同样的效果。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/c309f4043e90eb96a7c20b6b96245666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*jpmXsJMjoaoTNbv7hwXTjQ.png"/></div></figure><h2 id="ea21" class="kk ig hi bd ih kl km kn il ko kp kq ip jo kr ks it js kt ku ix jw kv kw jb kx bi translated">创建表格</h2><p id="763e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">例如，如果您按如下方式创建一个表:</p><pre class="kd ke kf kg fd ky kz la lb aw lc bi"><span id="32d6" class="kk ig hi kz b fi ld le l lf lg">CREATE OR REPLACE TABLE `transactions.test_table` AS<br/>SELECT<br/>  '' AS a,<br/>  1 AS b,<br/>  TRUE AS c<br/>LIMIT<br/>  0;</span></pre><p id="1be2" class="pw-post-body-paragraph jd je hi jf b jg lh ji jj jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka hb bi translated">您将有三列(a、b、c ),分别具有不同的类型(字符串、整数、布尔)。</p><h2 id="ab40" class="kk ig hi bd ih kl km kn il ko kp kq ip jo kr ks it js kt ku ix jw kv kw jb kx bi translated">将b列改为浮点型</h2><pre class="kd ke kf kg fd ky kz la lb aw lc bi"><span id="1a5a" class="kk ig hi kz b fi ld le l lf lg">CREATE OR REPLACE TABLE `transactions.test_table` AS<br/>SELECT<br/>  * EXCEPT (b),<br/>  CAST(b AS FLOAT64) AS b<br/>FROM<br/>  `transactions.test_table`;</span></pre><h2 id="d816" class="kk ig hi bd ih kl km kn il ko kp kq ip jo kr ks it js kt ku ix jw kv kw jb kx bi translated">删除列c</h2><pre class="kd ke kf kg fd ky kz la lb aw lc bi"><span id="0ea4" class="kk ig hi kz b fi ld le l lf lg">CREATE OR REPLACE TABLE `transactions.test_table` AS<br/>SELECT<br/>  * EXCEPT (c)<br/>FROM<br/>  `transactions.test_table`;</span></pre><h2 id="5a5d" class="kk ig hi bd ih kl km kn il ko kp kq ip jo kr ks it js kt ku ix jw kv kw jb kx bi translated">小心点！</h2><p id="e9b3" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">截至本文撰写之时，这将<strong class="jf hj">移除任何表历史</strong>，因此要非常小心您正在做的事情。请确保在生产环境中运行之前备份您的关键数据并测试您的SQL。</p></div></div>    
</body>
</html>