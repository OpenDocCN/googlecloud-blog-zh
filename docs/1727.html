<html>
<head>
<title>Day #12 with Cloud Workflows: loops and iterations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">云工作流第12天:循环和迭代</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/day-12-with-cloud-workflows-loops-and-iterations-a28826974163?source=collection_archive---------2-----------------------#2020-12-23">https://medium.com/google-cloud/day-12-with-cloud-workflows-loops-and-iterations-a28826974163?source=collection_archive---------2-----------------------#2020-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个云工作流系列的前几集中，我们已经了解了用于在步骤之间移动的<a class="ae jd" href="http://glaforge.appspot.com/article/day-3-with-cloud-workflows-variable-assignment-and-expressions" rel="noopener ugc nofollow" target="_blank">变量赋值</a>、和<a class="ae jd" href="http://glaforge.appspot.com/article/day-4-with-cloud-workflows-jumping-with-switch-conditions" rel="noopener ugc nofollow" target="_blank">切换条件等数据结构</a>，以及用于执行一些计算的<a class="ae jd" href="http://glaforge.appspot.com/article/day-3-with-cloud-workflows-variable-assignment-and-expressions" rel="noopener ugc nofollow" target="_blank">表达式</a>，其中可能包括一些内置函数。</p><p id="25cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了所有这些之前的知识，我们现在有了所有的工具来创建循环和迭代，例如，迭代一个数组的元素，也许用不同的参数调用一个API几次。所以让我们来看看如何创建这样的迭代！</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div></figure><p id="35ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们准备一些变量赋值:</p><pre class="je jf jg jh fd jl jm jn jo aw jp bi"><span id="b30a" class="jq jr hi jm b fi js jt l ju jv">- define:<br/>    assign: <br/>        - array: ['Google', 'Cloud', 'Workflows']<br/>        - result: ""<br/>        - i: 0</span></pre><ul class=""><li id="92b0" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">数组变量将保存我们将要迭代的值。</li><li id="568a" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">结果变量包含一个字符串，我们将把数组中的每个值追加到这个字符串中。</li><li id="cd7e" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">I变量是一个索引，用来知道我们在数组中的位置。</li></ul><p id="38f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，就像在编程语言的for循环中一样，我们需要为循环的结束准备一个条件。我们将在一个专门的步骤中完成:</p><pre class="je jf jg jh fd jl jm jn jo aw jp bi"><span id="dbf3" class="jq jr hi jm b fi js jt l ju jv">- checkCondition:<br/>    switch:<br/>        - condition: ${i &lt; len(array)}<br/>          next: iterate<br/>    next: returnResult</span></pre><p id="6bee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用内置的len()函数定义了一个开关，其中的条件表达式将当前索引位置与数组长度进行比较。如果条件为真，我们将进入迭代步骤。如果为false，我们将转到结束步骤(这里称为returnResult)。</p><p id="fa58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们处理迭代体本身。这里非常简单，因为我们只是给变量赋值:我们将数组的第I个元素添加到结果变量中，然后将索引增加1。然后，我们返回到checkCondition步骤。</p><pre class="je jf jg jh fd jl jm jn jo aw jp bi"><span id="130f" class="jq jr hi jm b fi js jt l ju jv">- iterate:<br/>    assign:<br/>        - result: ${result + array[i] + " "}<br/>        - i: ${i+1}<br/>    next: checkCondition</span></pre><p id="ed92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，如果我们要做一些更复杂的事情，例如用数组的元素作为参数调用HTTP端点，我们将需要两个步骤:一个用于实际的HTTP端点调用，一个用于递增索引值。然而，在上面的例子中，我们只对变量赋值，所以我们在这个简单的赋值步骤中完成了整个迭代。</p><p id="7846" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当执行checkCondition步骤时，如果不满足条件(即我们已经到达数组的末尾)，然后我们被重定向到returnResult步骤:</p><pre class="je jf jg jh fd jl jm jn jo aw jp bi"><span id="2001" class="jq jr hi jm b fi js jt l ju jv">- returnResult:<br/>    return: ${result}</span></pre><p id="004c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后一步只是返回结果变量的值。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="fe5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kr">原载于</em><a class="ae jd" href="http://glaforge.appspot.com/article/day-12-with-cloud-workflows-loops-and-iterations" rel="noopener ugc nofollow" target="_blank"><em class="kr">http://glaforge.appspot.com</em></a><em class="kr">。</em></p></div></div>    
</body>
</html>