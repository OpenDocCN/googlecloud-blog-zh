<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-storage-object-life-cycle-management-part-2-80a864d0b168?source=collection_archive---------3-----------------------#2022-11-28">https://medium.com/google-cloud/google-cloud-storage-object-life-cycle-management-part-2-80a864d0b168?source=collection_archive---------3-----------------------#2022-11-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><p id="6c8b" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">Google云存储—对象生命周期管理—第2部分</p><p id="4ed5" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">本文是正在进行的系列文章中的第二篇。这个故事的第一部分可在<a class="ae if" rel="noopener" href="/google-cloud/google-cloud-storage-object-life-cycle-management-part-1-5da48da8854a">谷歌云存储—对象生命周期管理—第1部分</a>获得</p><p id="6c6d" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">在第1部分中，我们了解了为什么一个组织应该提出一个数据/对象生命周期管理策略，以及如何使用Google Cloud console实现同样的策略。</p><p id="ef92" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">在这一部分，我们将看看如何以编程方式配置Google云存储的对象生命周期管理(OLM)。在这个博客的讨论中，我们将使用编程语言Java。</p><h1 id="e26d" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">程序化对象生命周期管理:</h1><p id="9f8d" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">例如，在第1部分中，我们有一个场景，一个名为MyMusic的组织使用OLM策略有效地节省了在Google云存储中存储文件的成本。</p><p id="9c68" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">随着时间的推移，这个组织取得了巨大的成功。他们开始与多个乐队合作。随着波段越来越多，他们创建的存储桶数量开始增加，因为他们为每个波段创建了一个存储桶。随着存储桶数量的增加，他们发现很难为每个存储桶手动创建OLM策略。</p><p id="251f" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">因此，他们需要一种编程方式，通过这种方式，他们能够创建OLM策略并管理这些策略。</p><h1 id="7f33" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">设置项目:</h1><p id="4e57" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">为了能够谷歌云存储API，我们需要导入以下依赖关系。写这篇博客时，2.13.1是谷歌云存储工具的最新版本。设置时，请参考最新版本。</p><p id="edfc" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">创建一个Java Maven项目，并在其pom.xml中添加以下依赖项</p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="77c6" class="js ih hi jo b be jt ju l jv jw">&lt;dependency&gt;<br/> &lt;groupId&gt;com.google.cloud&lt;/groupId&gt;<br/> &lt;artifactId&gt;google-cloud-storage&lt;/artifactId&gt;<br/> &lt;version&gt;2.13.1&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><h1 id="7db5" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">场景:</h1><p id="2e4e" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">我们将讨论以下以编程方式添加生命周期管理规则的场景。</p><ol class=""><li id="dd2a" class="jx jy hi hj b hk hl ho hp hs jz hw ka ia kb ie kc kd ke kf bi translated">添加包含年龄、前缀、后缀等条件的新生命周期规则</li><li id="97b5" class="jx jy hi hj b hk kg ho kh hs ki hw kj ia kk ie kc kd ke kf bi translated">更新现有的生命周期规则-年龄条件。</li><li id="9070" class="jx jy hi hj b hk kg ho kh hs ki hw kj ia kk ie kc kd ke kf bi translated">更新现有生命周期规则—对于前缀—更新/添加前缀。</li></ol><p id="be12" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">下表详细介绍了每种情况下的规则。</p><figure class="jj jk jl jm fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kl"><img src="../Images/27d1ca3d181226e3f58d11a14f7af66f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8tVToqxrfPNIi2BWFtxu1w.png"/></div></div></figure><h1 id="f1eb" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">对象生命周期管理规则的程序化管理</h1><p id="8cec" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">下面列出了上述每个场景的示例代码。</p><p id="eb02" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">场景:<strong class="hj kt">添加一个新的生命周期</strong></p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="8541" class="js ih hi jo b be jt ju l jv jw">LifecycleRule lcr1 = new LifecycleRule(<br/> LifecycleAction.newDeleteAction(),<br/> LifecycleCondition.newBuilder().setAge(50)<br/>            .setMatchesPrefix(Arrays.asList(“delete”, “del”))<br/>            .setMatchesSuffix(Arrays.asList(“.mv”))<br/> .build());<br/><br/>LifecycleRule lcr2 = new LifecycleRule(<br/> LifecycleAction.newDeleteAction(),<br/> LifecycleCondition.newBuilder().setAge(100)<br/>            .setMatchesPrefix(Arrays.asList(“remove”, “rem-”))<br/>            .setMatchesSuffix(Arrays.asList(“.mv”))<br/> .build());<br/><br/>bucketRetreived.toBuilder().setDeleteRules(null)<br/> .setLifecycleRules(ImmutableList.of(lcr1, lcr2)).build()<br/> .update();<br/><br/>bucketRetreived = storage.get(bucketName);<br/><br/><br/>for (LifecycleRule lcr : bucketRetreived.getLifecycleRules()){<br/> System.out.println(“Condition : “ + lcr.getAction());<br/> System.out.println(“Condition Age: “ + lcr.getCondition().getAge());<br/> System.out.println(“Condition Prefix: “ + lcr.getCondition().getMatchesPrefix());<br/> System.out.println(“Condition Suffix: “ + lcr.getCondition().getMatchesSuffix());<br/>} </span></pre><p id="ab68" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">场景:<strong class="hj kt">更新现有生命周期规则的条件(年龄)</strong></p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="dcb8" class="js ih hi jo b be jt ju l jv jw">List&lt;LifecycleRule&gt; lcrList = (List&lt;LifecycleRule&gt; ) bucketRetreived.getLifecycleRules();<br/>List&lt;LifecycleRule&gt; lcrListUpdated = new ArrayList&lt;LifecycleRule&gt;();<br/>for (LifecycleRule lcr : lcrList){<br/> LifecycleRule lcrUpdated = new LifecycleRule(<br/> LifecycleAction.newDeleteAction(),<br/> LifecycleCondition.newBuilder().setAge(lcr.getCondition().getAge() — 5 )<br/>        .setMatchesPrefix(lcr.getCondition().getMatchesPrefix())<br/>        .setMatchesSuffix(lcr.getCondition().getMatchesSuffix())<br/> .build());<br/> lcrListUpdated.add(lcrUpdated);<br/>}<br/>bucketRetreived.toBuilder().setDeleteRules(null)<br/> .setLifecycleRules(lcrListUpdated)<br/> .build()<br/> .update();</span></pre><p id="54e9" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">场景:<strong class="hj kt">更新现有生命周期规则的条件(前缀)</strong></p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="2da2" class="js ih hi jo b be jt ju l jv jw"><br/>List&lt;LifecycleRule&gt; lcrList = (List&lt;LifecycleRule&gt; ) bucketRetreived.getLifecycleRules();<br/>List&lt;LifecycleRule&gt; lcrListUpdated = new ArrayList&lt;LifecycleRule&gt;();<br/>for (LifecycleRule lcr : lcrList){<br/><br/> List&lt;String&gt; prefixList = new ArrayList&lt;&gt;( <br/>                              lcr.getCondition().getMatchesPrefix());<br/> prefixList.add(“remove-”);<br/> <br/> LifecycleRule lcrUpdated = new LifecycleRule(<br/> LifecycleAction.newDeleteAction(),<br/> LifecycleCondition.newBuilder().setAge(lcr.getCondition().getAge() )<br/>      .setMatchesPrefix(prefixList)<br/>      .setMatchesSuffix(lcr.getCondition().getMatchesSuffix())<br/> .build());<br/> lcrListUpdated.add(lcrUpdated);<br/>}<br/>bucketRetreived.toBuilder().setDeleteRules(null)<br/> .setLifecycleRules(lcrListUpdated)<br/> .build()<br/> .update();</span></pre><p id="bb46" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">注意:对于对Bucket的每次更新调用，我们需要显式调用<em class="ku"> setDeleteRules(null)。</em></p><h1 id="01fe" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">监控GCS时段OLM生命周期活动:</h1><p id="0eb6" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">审计日志对于理解在我们感兴趣的资源上执行的操作非常重要。Google Cloud提供了一个广泛的审计日志机制，通过它可以跟踪任何资源上的所有操作。</p><p id="080c" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">此处的文档参考提供了审核日志审核日志的详细视图:</p><p id="9981" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated"><a class="ae if" href="https://cloud.google.com/logging/docs/audit/understanding-audit-logs#api" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/logging/docs/audit/understanding-audit-logs # API</a></p><p id="06ca" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">由于OLM操作是由Google云存储监控在后台执行的，因此OLM的操作与在其他资源上执行的常规操作略有不同。让我们了解如何通过各种方法监控OLM行动。</p><h1 id="851a" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">OLM行动监控方法:</h1><p id="0377" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">OLM生命周期操作不会作为审计日志的一部分进行跟踪。因此，如果您在审计日志中搜索OLM操作，您将无法找到这些操作。这看起来很奇怪，因为你想确保谷歌云在后台执行的所有操作都有记录。但是有一条出路。Google云存储提供了以下选项来跟踪OLM操作。</p><ol class=""><li id="1e08" class="jx jy hi hj b hk hl ho hp hs jz hw ka ia kb ie kc kd ke kf bi translated">云存储使用日志</li><li id="ae36" class="jx jy hi hj b hk kg ho kh hs ki hw kj ia kk ie kc kd ke kf bi translated">云存储的发布订阅通知</li></ol><p id="b2b2" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">我们将看到如何设置的详细步骤，您可以设置您的</p><h1 id="25de" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">云存储使用日志:</h1><p id="0cd0" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">设置使用日志的详细信息如下:</p><p id="3ab8" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">【https://cloud.google.com/storage/docs/access-logs T2】号</p><p id="6217" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">这里列出了轻松设置云存储日志所需的命令要点。</p><p id="dd45" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">一旦对象生命周期管理执行了操作，需要一个小时才能在日志中反映出来。因此，在采取行动的时间和在日志中反映出来的时间之间会有延迟。</p><p id="4465" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">示例设置:</p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="997d" class="js ih hi jo b be jt ju l jv jw">gsutil mb gs://mymusic_logs<br/>gsutil iam ch group:cloud-storage-analytics@google.com:legacyBucketWriter gs://mymusic_logs<br/>gsutil logging set on -b gs://mymusic_logs gs://band_boon_light<br/>gsutil logging get gs://band_boon_light</span></pre><p id="a2ce" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">一旦为这个桶设置了使用日志，对于每个操作，您可以开始看到在这个示例中的使用日志桶(gs://band_boon_light)中创建的日志。</p><p id="dcef" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">一旦生成了日志，就可以通过在这些日志上建立一个大的查询表来方便地查询这些日志。设置BigQuery表不在本博客的讨论范围之内。但同样可以从这个链接引用:【https://cloud.google.com/storage/docs/access-logs#BigQuery】T4</p><h1 id="da22" class="ig ih hi bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">云存储的发布订阅通知:</h1><p id="dc20" class="pw-post-body-paragraph hg hh hi hj b hk je hm hn ho jf hq hr hs jg hu hv hw jh hy hz ia ji ic id ie hb bi translated">第二种方法是使用云存储的Pubsub通知，这也是我审计日志的首选方法。通过启用云存储的发布订阅通知，云存储上的所有操作都将被发送到一个主题。下面列出了启用发布订阅通知的步骤。</p><p id="ac9f" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">通知可以按如下方式启用:</p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="b5e3" class="js ih hi jo b be jt ju l jv jw">gcloud storage buckets notifications create gs://band_boon_light — topic=mymusic_topic — event-types=OBJECT_DELETE</span></pre><p id="5675" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">在这个场景中，我们只跟踪由OLM执行的删除事件。为了跟踪其他动作，您需要向该命令添加其他事件类型。一旦这个命令被执行，云存储将开始发布OLM和其他动作的通知到提到的主题mymusic_topic。该命令还将在您已配置的项目的Pubsub服务中为您创建一个主题。</p><p id="d549" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">下一步是为上述主题创建订阅，并使其成为BQ订阅。有了它，您将能够自动创建一个将数据直接写入BigQuery的管道。一旦数据被写入一个大的查询表，你就可以很容易地开始查询。</p><p id="6563" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">但是在创建BQ订阅之前，您需要用下面的模式创建一个BQ表，以便数据可以无缝地写入BQ表。</p><p id="921f" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">BQ表的模式需要配置如下。您需要确保各列的拼写如下所述。如果模式中有小的变化，那么在创建BQ订阅时就会出现问题。</p><figure class="jj jk jl jm fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kv"><img src="../Images/8c85eb030add7b5766df8ef14b33409b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kZOvDYnnPXbaOLZ8"/></div></div></figure><p id="4ce7" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">一旦如上所述创建了BigQuery表，就需要为Topic创建下面的BQ订阅:</p><figure class="jj jk jl jm fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kw"><img src="../Images/46f9b78510813e63b09b74caf53f0bce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZyEyVNJbKZlgouC8"/></div></div></figure><p id="e27a" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">确保选择主题模式并在选项中写入元数据。这将确保将消息属性和有效负载都记录到表中。</p><p id="6222" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">为目标时段设置对象生命周期管理。</p><figure class="jj jk jl jm fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/ef5e2dcca1ad6413de77aedfff672928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GTliWSz5vlD1DObi"/></div></div></figure><p id="a362" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">在本例中，为其设置OLM策略的存储桶是band_boon_light。</p><p id="0916" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">创建了2个前缀规则:</p><blockquote class="ky kz la"><p id="93dd" class="hg hh ku hj b hk hl hm hn ho hp hq hr lb ht hu hv lc hx hy hz ld ib ic id ie hb bi translated">要在创建30天后删除带有前缀“临时编辑”的任何对象</p><p id="86a4" class="hg hh ku hj b hk hl hm hn ho hp hq hr lb ht hu hv lc hx hy hz ld ib ic id ie hb bi translated">向Coldline创建5天后带有前缀“原始”的电影对象</p></blockquote><p id="af8e" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">为了能够查看日志:您是否需要等到OLM管理对对象采取了操作。</p><p id="ff3e" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">当Bucket中发生任何操作时，您可以查询BigQuery表。</p><p id="38f8" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">可以查询大查询表的示例查询:</p><pre class="jj jk jl jm fd jn jo jp bn jq jr bi"><span id="1541" class="js ih hi jo b be jt ju l jv jw">SELECT distinct JSON_EXTRACT(attributes, “$.bucketId”) AS Bucket_id, <br/>JSON_EXTRACT(attributes, “$.objectId”) AS Object_id, <br/>JSON_EXTRACT(attributes, “$.eventType”) AS event <br/>from `mymusic_dataset.mymusic_olm_tables`</span></pre><p id="e663" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">虽然为云存储使用Pubsub通知的方法简单明了，但是这种方法的主要缺点是，它不记录执行操作的用户。因此，如果您需要跟踪执行操作的人，无论是用户、服务帐户还是OLM，您都无法认同这种方法。在这种情况下，您需要使用云存储使用日志方法。</p><p id="25e0" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">此外，由于创建了Pubsub主题并使用BigQuery写入数据，这种方法的成本略有增加。但是你可以使用下面的控制措施来降低成本。</p><p id="b860" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">成本控制措施:</p><blockquote class="ky kz la"><p id="ef66" class="hg hh ku hj b hk hl hm hn ho hp hq hr lb ht hu hv lc hx hy hz ld ib ic id ie hb bi translated">由于我们只为OBJECT_DELETE操作设置通知，发布的数据量将会大大减少。</p><p id="0f1d" class="hg hh ku hj b hk hl hm hn ho hp hq hr lb ht hu hv lc hx hy hz ld ib ic id ie hb bi translated">由于数据保留在BQ中，因此在Pubsub中不需要保留期</p></blockquote><p id="cecf" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">根据OLM操作监控的优势和要求，您需要选择您需要使用的方法。</p><p id="f595" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">最后，MyMusic组织能够建立一个常规流程，使用该流程，他们能够以编程方式设置OLM规则，通过这些规则，他们能够根据使用情况有效地管理Google云存储中的对象。这也有助于他们优化成本。</p><p id="5f65" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">感谢您花时间阅读这两部分的博客。希望这有助于您理解如何使用OLM策略来优化Google云存储中的数据。</p><p id="c693" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">参考资料:</p><p id="cbda" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated"><a class="ae if" href="https://cloud.google.com/storage/docs/lifecycle#tracking" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/storage/docs/lifecycle#tracking</a></p><p id="ba7b" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">https://cloud.google.com/storage/docs/access-logs<a class="ae if" href="https://cloud.google.com/storage/docs/access-logs" rel="noopener ugc nofollow" target="_blank"/></p><p id="ca8d" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated">【https://cloud.google.com/storage/docs/pubsub-notifications T4】</p><p id="b17a" class="pw-post-body-paragraph hg hh hi hj b hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ie hb bi translated"><a class="ae if" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/json_functions" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/JSON _ functions</a></p></div></div>    
</body>
</html>