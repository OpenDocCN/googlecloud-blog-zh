<html>
<head>
<title>Migrating a Monolith to Google Kubernetes Engine (GKE) — What to migrate first?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Monolith迁移到Google Kubernetes引擎(GKE)——先迁移什么？</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-what-to-migrate-first-8242b57e35c2?source=collection_archive---------2-----------------------#2020-03-02">https://medium.com/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-what-to-migrate-first-8242b57e35c2?source=collection_archive---------2-----------------------#2020-03-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3c29" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在云中烹饪</h2></div><p id="7deb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作者:<a class="ae jt" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">普里扬卡·韦尔加迪亚</a>，<a class="ae jt" href="https://twitter.com/carterthecomic" rel="noopener ugc nofollow" target="_blank">卡特·摩根</a></p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/c4bcbde49cdae22ad3e3f5c644ded927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aogq0U1NY2JEfA9jWI4-8g.gif"/></div></div></figure><h1 id="d36c" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">介绍</h1><p id="84c0" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated"><strong class="iz hj"><em class="ld"/></strong><a class="ae jt" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e"><strong class="iz hj"><em class="ld">获取云端烹饪</em></strong></a><strong class="iz hj"><em class="ld"/></strong>是一个<a class="ae jt" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e">博客</a>和<a class="ae jt" href="https://www.youtube.com/playlist?list=PLIivdWyY5sqIOyeovvRapCjXCZykZMLAe" rel="noopener ugc nofollow" target="_blank">视频</a>系列，帮助企业和开发者在Google Cloud上构建商业解决方案。在这第三个迷你系列中，我们将讲述<strong class="iz hj"> <em class="ld">将一个整体迁移到谷歌Kubernetes引擎(GKE) </em> </strong>。将整体迁移到微服务可能会令人生畏。一旦你决定接受它，你需要考虑什么？继续阅读…</p><p id="9606" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这些文章中，我们将带您了解将monolith迁移到微服务的整个过程、迁移流程、首先迁移什么、迁移的不同阶段以及如何处理数据迁移。我们将以一个真实的客户故事来结束这一切，在一个真实的应用程序中完成这些步骤。</p><p id="5657" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是这部迷你剧的所有文章，供你查阅。</p><ol class=""><li id="2aa8" class="le lf hi iz b ja jb jd je jg lg jk lh jo li js lj lk ll lm bi translated"><a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-an-overview-785f2cbe5c62">将一块巨石迁移到GKE:概述</a></li><li id="1175" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-migration-process-2de2f51986a2">将一块巨石迁移到GKE:迁移过程</a></li><li id="e56d" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-migrate-in-stages-7286ec26689c">将整块材料迁移到GKE:分阶段迁移</a></li><li id="24c8" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated">将一块巨石迁移到GKE:先迁移什么？(本文)</li><li id="9625" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-data-migration-ef8ebccef6b0">将一个整体迁移到GKE:数据迁移</a></li><li id="af26" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-customer-story-c35c320325eb">将一个整体迁移到GKE:客户案例</a></li></ol><p id="1b74" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将带您了解如何决定首先迁移什么。所以，继续读下去吧！</p><h1 id="cd56" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">你会学到什么</h1><ul class=""><li id="ce11" class="le lf hi iz b ja ky jd kz jg ls jk lt jo lu js lv lk ll lm bi translated">如何选择要首先迁移的功能</li><li id="770c" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">如何将业务流程、团队、运营和设计纳入您的分析</li><li id="a568" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">如何将功能从您的传统环境迁移到新的基于云的微服务环境</li></ul><h1 id="f9ec" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">先决条件</h1><p id="8f44" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">开始之前，了解以下内容会有所帮助:</p><ul class=""><li id="026f" class="le lf hi iz b ja jb jd je jg lg jk lh jo li js lv lk ll lm bi translated">谷歌云的基本概念和结构，这样你就可以识别产品的名称。</li><li id="de63" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">本<a class="ae jt" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e">之前的视频在云系列</a>中获取烹饪。</li></ul><h1 id="99f9" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">看看这个视频</h1><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="lw lx l"/></div></figure><h1 id="598f" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">如何选择要首先迁移的要素？</h1><p id="b94b" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">很容易让人一头扎进去，尽快开始迁移特性。与其这样做，不如花点时间来评估系统的以下方面，从长远来看，这会给你带来最大的好处:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div class="er es ly"><img src="../Images/072d1498a87e70af3944e155571fcfea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*HltLsGnhwhe6YDUr-6RzFg.png"/></div><figcaption class="lz ma et er es mb mc bd b be z dx translated">首先，可能很难知道要迁移什么。别害怕，我们有一个配方给你用。来源:<a class="ae jt" href="https://pixabay.com/vectors/question-worry-wonder-unsure-310891/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/vectors/question-worry-wonder-uncertain-310891/</a></figcaption></figure><p id="209d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从一个<strong class="iz hj">业务流程评估</strong>开始。不要忘记，这将是一次学习经历，会有错误可以借鉴。因此，最初的工作不应该涉及业务关键系统，但它们仍然应该代表团队学习的重要用例。</p><p id="460f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从设计和开发的角度来看，你希望挑选那些依赖关系最少并且在必要时最容易重构的特性。必要时，还要考虑开发或重构的成本和复杂性。</p><p id="4af8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从<strong class="iz hj">运营</strong>的角度来看，考虑能够承受切换窗口停机时间的特性。如果您需要最小化停机时间，迁移需要高可用性的功能可能意味着额外的工作。</p><p id="58b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，选择有明确流程的<strong class="iz hj">团队</strong>来领导最初的工作。因为您希望他们为迁移之旅带路，并了解他们将遇到新的挑战，他们必须找到解决方案。</p><blockquote class="md"><p id="625b" class="me mf hi bd mg mh mi mj mk ml mm js dx translated">第一次迁移的理想特性需要很少的重构，是无状态的，没有外部数据需求，并且很少或没有依赖性。</p></blockquote><p id="1da2" class="pw-post-body-paragraph ix iy hi iz b ja mn ij jc jd mo im jf jg mp ji jj jk mq jm jn jo mr jq jr js hb bi translated">考虑到所有这些因素，这种方法需要“分而治之”的方法，我们首先找到一个“具有挑战性但有意义”的特性进行迁移。该特性必须有足够的意义和挑战性，以便成为测试和改进我们关于迁移的假设的有用方法。</p><p id="4339" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看一个例子来说明这一点。</p><h1 id="ef3b" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">迁移计划示例</h1><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ms"><img src="../Images/10d0966da23e8d097be418cc2cc57728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8V7BnZsCjruEPYQFvna4rQ.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated">一个配方就是一个攻击计划。现在我们来看一个创建迁移特性的例子。来源:<a class="ae jt" href="https://pixabay.com/vectors/recipe-label-icon-symbol-spoon-575434/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/vectors/recipe-label-icon-symbol-spoon-575434/</a></figcaption></figure><p id="8af2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">想想我们在<strong class="iz hj"> <em class="ld">的朋友——冰淇淋理论</em> </strong>和他们的迁徙(来自上一篇文章<a class="ae jt" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-migrate-in-stages-7286ec26689c">)。</a></p><p id="adf8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为他们正在考虑将他们的网站完全迁移到微服务，对他们来说，一个好的迁移顺序是首先迁移前端；然后想想无状态特性；接下来可能是具有独立数据集的功能，例如列出他们的实体商店的服务；最后是共享数据集的特性，比如平台本身的业务逻辑。</p><p id="fa70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">平台前端，随后是任何无状态功能，如货币兑换系统，首先是因为它们通常没有多少依赖项，并且通常需要有限的重构，因为在“初始迁移”方法中，后端API仍然由本地或另一个云上托管的传统数据中心或运行时提供。</p><p id="f71f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在无状态特性之后，数据集不依赖于其他数据集的组件，例如列出实体商店的服务，是下一个要迁移的。这些更容易提取并转移到现代存储系统，如用于托管数据存储的<strong class="iz hj">云存储</strong>或<strong class="iz hj">云Firestore </strong>，用于关系数据的<strong class="iz hj">云SQL </strong>，或用于基于文档的noSQL数据的<strong class="iz hj">云Firestore </strong>。</p><p id="dbd6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，具有共享数据集的功能，如电子商务平台的业务逻辑，是最难迁移的，因为需要跨传统和新服务的一致性、分布、访问和延迟。</p><p id="bb56" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于数据迁移并不简单，我们将在下一篇文章中专门讨论它，敬请关注。</p><h1 id="96a6" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">结论</h1><p id="a6be" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">当您计划您的迁移时，很容易从那些无关紧要的特性开始迁移。这可能是一个立竿见影的效果，但从长远来看，可能不会给你的项目带来最大的好处。您应该花时间评估每个特性并为它们的迁移创建一个计划，而不是直接投入到迁移中。</p><blockquote class="md"><p id="2b5c" class="me mf hi bd mg mh mi mj mk ml mm js dx translated"><em class="mt">在开始迁移之前，花时间评估您的特性业务流程、团队、设计&amp;开发和运营，将极大地帮助您的迁移过程。</em></p></blockquote><p id="bf91" class="pw-post-body-paragraph ix iy hi iz b ja mn ij jc jd mo im jf jg mp ji jj jk mq jm jn jo mr jq jr js hb bi translated">如果您希望将一个整体应用迁移到微服务，那么您已经有了决定首先迁移哪些特性的方法。请继续关注<a class="ae jt" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e">云烹饪系列</a>中的更多文章，并查看以下参考资料了解更多详情。</p><h1 id="92e0" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">后续步骤和参考:</h1><ul class=""><li id="23c4" class="le lf hi iz b ja ky jd kz jg ls jk lt jo lu js lv lk ll lm bi translated">在谷歌云的媒介上关注这个博客系列。</li><li id="19db" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">参考:<a class="ae jt" href="https://cloud.google.com/solutions/migrating-a-monolithic-app-to-microservices-gke" rel="noopener ugc nofollow" target="_blank">GKE解决方案的整体到微服务</a>。</li><li id="0195" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">Codelab: <a class="ae jt" href="https://codelabs.developers.google.com/codelabs/cloud-monolith-to-microservices-gke/#0" rel="noopener ugc nofollow" target="_blank">将一个整体迁移到GKE的微服务上</a></li><li id="6837" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">关注<a class="ae jt" href="https://www.youtube.com/watch?v=pxp7uYUjH_M" rel="noopener ugc nofollow" target="_blank">获取云端烹饪</a>视频系列，订阅谷歌云的YouTube频道</li><li id="54fa" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">想要更多的故事？查看我的<a class="ae jt" rel="noopener" href="/@pvergadia/">媒体</a>，<a class="ae jt" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">在twitter上关注我</a>。</li><li id="1ab1" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lv lk ll lm bi translated">请和我们一起欣赏这部迷你剧，并了解更多类似的谷歌云解决方案:)</li></ul></div></div>    
</body>
</html>