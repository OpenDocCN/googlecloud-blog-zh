<html>
<head>
<title>Going Cloud with SQL Server: Google Cloud Options</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SQL Server实现云:Google云选项</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/going-cloud-with-sql-server-google-cloud-options-6cd44bb52bef?source=collection_archive---------0-----------------------#2022-05-02">https://medium.com/google-cloud/going-cloud-with-sql-server-google-cloud-options-6cd44bb52bef?source=collection_archive---------0-----------------------#2022-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="620b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">本博客由</em> <a class="ae je" rel="noopener" href="/@pop.dbig"> <strong class="ih hj"> <em class="jd">和</em></strong></a><em class="jd">【(pop.dbig@gmail.com】</em>共同撰写和发表</p><p id="14d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗨伙计们！这一切都是关于使用GCP选项将SQL Server迁移到云，这是一个很长的争论:)请坚持到最后，以获得有趣的结论并参与后续步骤…</p><p id="4e61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jf translated"><span class="l jg jh ji bm jj jk jl jm jn di"> G </span>云计算、向云迁移、云上的数据和向云的集成、云的存在——这些是我们这些天听到的关于数据管理或处理应用的词汇。这仅仅意味着组织正在将其数字资产全部或部分转移到云中。这也可能意味着从一个云迁移到另一个云。“云计算”的诸多优势，仅举几例:</p><ol class=""><li id="6c4e" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">消除运营开销</li><li id="4bf2" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">卓越的灵活性和敏捷性(因为易于部署、无前期成本、无基础架构维护/成本、经济实惠)</li><li id="71a7" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">经济高效(只为您使用的东西付费)</li><li id="7b8d" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">可量测性</li><li id="c015" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">监控等</li></ol><p id="366d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客包含了在GCP上托管SQL Server的概念。以下解决方案的设计重点是可伸缩性、迁移工作和易维护性。</p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="bfca" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">在云上托管SQL Server的方法</h1><ul class=""><li id="d93c" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc lm ju jv jw bi translated"><em class="jd">计算引擎中的SQL Server</em></li><li id="8120" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated"><em class="jd">针对SQL Server的云SQL</em></li><li id="432b" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated"><em class="jd">使用Docker容器/持久存储</em></li></ul></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="b817" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">1.计算引擎中的SQL Server</h1><ul class=""><li id="e8e4" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc lm ju jv jw bi translated">部署和配置类似于传统的内部数据库基础架构</li><li id="849d" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">通过这种方式进行设计，可以利用垂直扩展、持久磁盘/预定义机器、负载平衡(如果我们要使用多实例数据库设计)</li></ul><h2 id="5d49" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">所需的虚拟机最低规格</h2><p id="a663" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">内存:4GB <br/>处理器:x64，2.0GHz <br/>存储:最低6GB</p><ul class=""><li id="bbe7" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">服务器故障可能是由以下原因造成的</li><li id="2b36" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">计算SLA 99.99%(多区域)正常运行时间和单实例99.5%</li><li id="4ba7" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">设计不良的虚拟机(由个人选择的配置)可能会导致SQL Server性能不佳</li><li id="e4d7" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">预迁移成本和设计规划至关重要</li><li id="9887" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">计算引擎实例的价格因配置而异，如果我们在配置时不知道详细的设计，我们可能会付出更多</li><li id="41f2" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">资源利用不足/过度利用也是可能的</li></ul><p id="6b42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> POC —计算引擎中的SQL Server</strong></p><p id="8cbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤:</strong></p><ul class=""><li id="7a64" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated"><strong class="ih hj"> <em class="jd"> GCP控制台&gt;导航菜单&gt;计算引擎&gt; VM实例&gt;创建实例</em> </strong></li><li id="3324" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">我们可以选择基于Linux或Windows的启动映像，因为SQL Server可以在两种操作系统中运行</li><li id="45fe" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">如果我们希望通过GUI工具RDP到虚拟机并维护SQL Server，可以使用桌面友好的windows虚拟机</li><li id="f5ed" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">在启动菜单上，我们可以从各种操作系统中进行选择，包括(但不限于)，<br/> Ubuntu <br/> Windows Server(许可证需单独购买)<br/>Windows Server上的SQL Server(许可证需单独购买)</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es me"><img src="../Images/0131bc513b87d1961cd5be29eb932650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ejo872LzAry6a2tSR6IfLQ.png"/></div></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">启动盘创建:选择操作系统</figcaption></figure><ul class=""><li id="2996" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">创建虚拟机(对于POC，我们选择了基于Linux的Ubuntu(18.04)，因为它是免费的)</li><li id="fbab" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">一旦创建了一个虚拟机，SSH进入虚拟机并更新包管理器，然后安装SQL Server</li><li id="8485" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">要安装SQL Server，必须在虚拟机上运行以下命令集:</li></ul><p id="6107" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://packages.microsoft.com/keys/microsoft.asc|须藤apt-key add -</p><p id="0ad6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sudo add-apt-repository " $(wget-qO-https://packages . Microsoft . com/config/Ubuntu/18.04/MSSQL-server-2019 . list)"</p><p id="92dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sudo apt-get更新→更新软件包管理器</p><p id="c5e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sudo apt-get Install-y MSSQL-Server→安装SQL Server</p><p id="c643" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sudo /opt/mssql/bin/mssql-conf设置→配置SQL Server</p><ul class=""><li id="c8f9" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">防火墙必须配置为允许虚拟机实例的SQL Server端口(默认端口-1433)上的传入连接</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mu"><img src="../Images/a67f41dcb5ce05571ec5d48f453740a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HbgLTyviIHbdQNifZZvcQA.png"/></div></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">注意:我们可以通过使用网络标签将防火墙规则添加到特定的虚拟机</figcaption></figure><ul class=""><li id="6b5d" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">现在，我们可以在SSMS和其他工具中使用公共IP和SQL用户凭据连接到SQL Server</li><li id="2c6e" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">数据库创建、DAC文件部署、数据库备份都已经过测试，工作正常，没有任何问题</li></ul><p id="458e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:DAC文件是数据层应用程序，它是整个数据库模型的压缩文件，包括表、视图、实例对象、用户登录等对象。</p><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mv"><img src="../Images/18eabba43722b66874b881b5e8cebe1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w60Cf4r8dJZXZjCPIyYJZA.png"/></div></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">使用SSMS通过客户端计算机连接GCP虚拟机实例上的SQL Server</figcaption></figure><h2 id="cb64" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">使用案例:</h2><ul class=""><li id="b52e" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc lm ju jv jw bi translated">当数据库管理团队习惯于传统的数据库管理方式，而数据库管理员尚未采用云生态系统时，建议使用这种类型的SQL Server部署</li><li id="c8c0" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">这是我们获得基于GUI的服务器管理工具(windows VM)的最简单的方法</li></ul><p id="46ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最佳实践:</strong></p><ol class=""><li id="bba2" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">如果您只是为开发/测试环境创建一个临时服务器，那么不推荐使用这种方法。请注意，这个选项会带来相对较高的操作开销</li><li id="76d0" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">对于开发/测试环境，我们建议使用Linux操作系统、Docker上的SQL Express/SQL容器映像。这样我们可以降低许可成本</li><li id="e8f9" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">确保你有完整的设计，包括技术细节，如数量，时间表，交易等。在配置此选项之前已计划好</li></ol></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="6faa" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak"> 2。用于SQL Server的云SQL</strong></h1><p id="5b9d" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">Cloud SQL for SQL Server是一项托管数据库服务，可帮助您在Google Cloud上设置、维护、管理和管理您的SQL Server数据库。</p><ul class=""><li id="14fd" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">云SQL是来自GCP的完全托管的SQL服务器</li><li id="cd17" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">此外，CloudSQL是Google推荐的最佳实践，而不是在计算引擎中部署SQL Server，因为它真正体现了迁移到云的好处，并减少了数据库的任何管理</li><li id="1336" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">不到5分钟，我们就可以创建云SQL并迁移现有数据库，还可以自动扩展</li><li id="17cc" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">最多可添加96个处理器内核、超过624 GB的RAM和64 TB的存储空间</li></ul><p id="e5ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤:</strong></p><ul class=""><li id="ff2c" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated"><strong class="ih hj">T3【GCP】控制台&gt;导航菜单&gt; SQL &gt;创建实例T5】</strong></li><li id="a8b2" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">根据需要选择SQL Server版本和其他配置</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mw"><img src="../Images/9e7b439ff1a650d9230cddff75ff39da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0ubDxgdzsyieX3ds_Nv-w.png"/></div></div></figure><ul class=""><li id="fcfe" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">可以从预定义的开发人员/生产实例配置中选择SQL实例</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mx"><img src="../Images/d15b96627f1757811abab9cc024c6110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VNDLnAM4h9zCW6bstxPiQ.png"/></div></div></figure><ul class=""><li id="3ab4" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">此外，SQL实例计算大小和内存是可定制的</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mx"><img src="../Images/d15b96627f1757811abab9cc024c6110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VNDLnAM4h9zCW6bstxPiQ.png"/></div></div></figure><ul class=""><li id="af69" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">创建实例后，我们可以通过生成的公共IP连接到SQL Server</li></ul><p id="3420" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong></p><ul class=""><li id="211c" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">默认情况下，CloudSQL会阻止来自外部IP的连接，因此我们必须将客户机或web应用程序IP添加到授权的网络中</li><li id="c6e5" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">请确保添加ipv4和公共IP，私有IPv4将会出错</li><li id="97f9" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">授权公共网络有一些例外情况，请参考本产品文档了解详情:<a class="ae je" href="https://cloud.google.com/sql/docs/mysql/authorize-networks#limitations" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/SQL/docs/MySQL/authorize-networks #限制</a></li><li id="ecd9" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">我们可以通过使用内置的数据库认证来认证用户</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es my"><img src="../Images/6c846caaefc38ed561d09527fe4245ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HX_nat1y9MXkZ31fUApBVw.png"/></div></div></figure><ul class=""><li id="eb25" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">一旦配置完成，我们就可以像连接本地SQL服务器一样连接到CloudSQL Server</li><li id="e336" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated"><strong class="ih hj">连接</strong>可由以下人员授权</li></ul><p id="f1ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">面向Java和Python的云SQL身份验证代理和云SQL连接器库<br/>自管理SSL/TLS证书<br/>授权网络</p><ul class=""><li id="c41b" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated"><strong class="ih hj"> SQL连接</strong>可以使用sqlcmd、SSMS、Azure data studio、OLEDB等。</li><li id="0fc8" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated"><strong class="ih hj">访问控制</strong>可以在两个级别限制对数据库的访问——实例级和数据库级</li></ul><p id="6bf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实例级是您连接到云SQL <br/>的任何客户端的访问授权。数据库级是使用服务器级角色访问您实例中的数据</p><ul class=""><li id="02b5" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated"><strong class="ih hj">数据驻留</strong>、本地化和隐私指的是关于数据的物理位置和当地法规对您的数据的要求。云SQL通过3种方式帮助您应对数据驻留的挑战:</li></ul><p id="f2ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">存储数据:配置数据的存储位置(使用区域配置)<br/>加密数据:控制加密密钥的存储位置(使用客户管理的加密密钥)<br/>访问数据:控制对数据的访问(使用访问批准、透明和密钥访问调整方法)</p><ul class=""><li id="7ad8" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated"><strong class="ih hj">使用脚本、DAC包和备份文件创建数据库</strong>可以在云SQL实例中完成</li><li id="f72e" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">一些基本的<strong class="ih hj"/><strong class="ih hj">SQL Server功能</strong>如数据库创建/删除、数据库备份、用户管理可以在<em class="jd"> GCP控制台</em>本身完成，但不推荐，有许多SQL Server管理员工具可供选择</li></ul><h2 id="3321" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">最佳实践:</h2><ul class=""><li id="dee0" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc lm ju jv jw bi translated">在配置和部署SQL Server之前，请确定数据负载的容量</li><li id="784a" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">尽可能使用较小的云实例，而不是大型的整体实例</li><li id="ac2c" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">观察数据库表的数量对实例响应时间的影响</li><li id="5ef5" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">使用连接池进行高效的资源管理</li><li id="7757" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">几笔小交易胜过一笔大交易</li></ul></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="1fb4" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak"> 3。使用Docker容器</strong></h1><ul class=""><li id="bcad" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc lm ju jv jw bi translated">微软在docker Hub中提供了基于容器的SQL Server for Linux的官方Docker镜像</li><li id="5357" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">我们可以提取该映像并立即启动SQL Server实例</li><li id="2c55" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">我们还可以备份现有的数据库，并用这些备份创建一个docker映像，这样创建的所有容器都将复制相同的数据，而无需任何额外的同步和迁移</li><li id="3682" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">容器存储不是持久的，所以我们必须为数据库使用容器卷/外部存储(持久磁盘),否则我们必须设计数据库的自动备份/恢复</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es mz"><img src="../Images/2905a52f99c4c6ed5db8523e3f7fbdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35QoBUtC5i0jgShU_lbOAg.png"/></div></div></figure><ul class=""><li id="cd77" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">对不同的SQL Server实例使用相同的外部存储在理论上也是可行的。这可以使SQL Server更加可靠，并且可以横向扩展，从而最大限度地减少云开支</li><li id="1c0b" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc lm ju jv jw bi translated">我们还可以通过各种方法(SSMS、sqlcmd、VS代码和其他数据分析工具)以最少的工作量连接到容器外部的SQL Server</li></ul><h2 id="efd5" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">需求(linux容器)</h2><p id="7037" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">内存:2 GB <br/>文件系统:XFS或EXT4 <br/>磁盘空间:6 GB <br/>处理器速度:2 GHz <br/>处理器内核:2核<br/>处理器类型:仅兼容x64</p><ul class=""><li id="3807" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc lm ju jv jw bi translated">通过使用GKE和可伸缩的持久存储来编排容器，我们可以在Google cloud上设计一个抗故障的、高度可用的SQL Server</li></ul><figure class="mf mg mh mi fd mj er es paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="er es na"><img src="../Images/edc833ba175628ac821b039fd90dc7a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5VLxlRz3pdpBhuk67ZAt1A.png"/></div></div></figure><p id="b7a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图显示了两个不同的SQL容器，它们使用相同的容器卷(持久存储)但端口不同(1436/1437)，因此我们也可以使用GKE对SQL Server进行负载平衡</p><h2 id="3496" class="ln kk hi bd kl lo lp lq kp lr ls lt kt iq lu lv kx iu lw lx lb iy ly lz lf ma bi translated">码头集装箱的缺点:</h2><ol class=""><li id="b72a" class="jo jp hi ih b ii lh im li iq lj iu lk iy ll jc jt ju jv jw bi translated">理论上，我们可以在几分钟内在网络存储或本地存储中创建多个具有相同配置的SQL Server，但SQL数据库文件和SQL Server实例是按1:1的比例映射的，因此在同一存储中跨多个实例不会横向扩展数据库</li><li id="8324" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">我们可以在不同的机器上(甚至在Google云计算引擎中)轻松复制容器化的SQL Server实例(不是实时的，而是基于快照的)及其数据，我们必须为每台机器配置端口设置和防火墙规则，以便进行远程访问</li><li id="e2f4" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">与CloudSQL相比，运营开销很高，运营成本不可预测</li></ol></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="7094" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">判决</h1><p id="9922" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">在本博客中提出的3个选项中，云SQL被证明是最简单、最省力、最快和可靠的方法，其99.95%的正常运行时间百分比SLO、灵活的组件式定价结构(1。CPU和内存，2。存储和网络，3。许可)，它高度可扩展到高达64 TB的可用存储容量，并能够根据需要自动增加存储大小！！</p></div><div class="ab cl kc kd gp ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hb hc hd he hf"><h1 id="d31a" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">下一步是什么？</h1><p id="8fe9" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq mb is it iu mc iw ix iy md ja jb jc hb bi translated">为什么不回到上面的选项，自己试试，如果有想法/建议，随时联系/评论？</p><p id="7b7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为跟进，给这些后续阅读更多的乐趣:</p><ol class=""><li id="7e36" class="jo jp hi ih b ii ij im in iq jq iu jr iy js jc jt ju jv jw bi translated">云SQL库和示例:<a class="ae je" href="https://cloud.google.com/sql/docs/sqlserver/admin-api/libraries" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/SQL/docs/SQL server/admin-API/Libraries</a></li><li id="756e" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">使用谷歌云部署多区域灾难恢复<a class="ae je" href="https://cloud.google.com/architecture/deploying-microsoft-sql-server-multi-regional-disaster-recovery" rel="noopener ugc nofollow" target="_blank">https://Cloud . Google . com/architecture/deploying-Microsoft-SQL-server-Multi-Regional-Disaster-Recovery</a></li><li id="3e82" class="jo jp hi ih b ii jx im jy iq jz iu ka iy kb jc jt ju jv jw bi translated">https://www.linkedin.com/in/abiramisukumaran<br/><a class="ae je" href="https://www.linkedin.com/in/kppnesh" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/kppnesh</a>联系我们</li></ol></div></div>    
</body>
</html>