<html>
<head>
<title>Analyzing Coronavirus Epitopes Data with BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用BigQuery分析冠状病毒表位数据</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/analyzing-coronavirus-epitopes-data-with-bigquery-acab260529f5?source=collection_archive---------0-----------------------#2020-07-19">https://medium.com/google-cloud/analyzing-coronavirus-epitopes-data-with-bigquery-acab260529f5?source=collection_archive---------0-----------------------#2020-07-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5d5b9656c433ac3b04d4a6fcbac8d81e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*63QNeM1cFmG7IovupzVreQ.png"/></div></div></figure><p id="bc59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">免疫表位数据库(IEDB)是由NIAID资助的免费资源。为了使数据更容易查询和分析，谷歌云正在BigQuery 中公开这些数据。BigQuery有一个<a class="ae jo" href="https://towardsdatascience.com/bigquery-without-a-credit-card-discover-learn-and-share-199e08d4a064" rel="noopener" target="_blank">沙箱</a>，通过它你可以试用它，而不必注册谷歌云(或者提供信用卡)。</p><h1 id="4abc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">疫苗用肽(蛋白)预测简介</h1><p id="9515" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">针对抗原的药物和疫苗开发有许多研究领域，在这个例子中是针对病毒的。基本上，免疫系统识别称为肽的病毒蛋白的一部分，其中识别过程通过将病毒肽结合到称为人类白细胞抗原(HLA)的人类分子上来促进。这种结合使病毒对免疫系统“可见”。</p><h2 id="ba1b" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">主要挑战</h2><p id="b158" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">鉴于肽和分子的巨大多样性，寻找产生稳定和安全候选物的结合成为一项不平凡的任务。过去对不同抗原和疾病(如SARS和MERS)研究有助于了解哪种HLA分子可能是良好的候选分子。同样，了解蛋白质的线性和三维特性有助于缩小肽的选择范围。</p><p id="4750" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">IEDB数据库提供了肽表位数据和抗原研究分析的丰富集合。在本文中，我们将使用BigQuery来了解HLA和肽信息，并建立一个机器学习模型来预测结合分类，以了解肽如何与给定的HLA分子结合，从而为疫苗测试生成强有力的候选物。</p><h1 id="40f4" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">了解关键数据实体</h1><p id="69d2" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">表位数据集包含许多表格，以提供关于已通过研究的测定的信息。在本节中，我们将探索关键表。抗原_完整表提供了给定抗原的检测和表位数量的参考。让我们从几个问题开始探索一个数据集:对于感兴趣的生物体，例如“冠状病毒”，哪种抗原具有最多数量的表位？前往https://console.cloud.google.com/bigquery的<a class="ae jo" href="https://console.cloud.google.com/bigquery" rel="noopener ugc nofollow" target="_blank">并输入:</a></p><p id="7f1b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">从“big query-public-data . immune _ epitope _ db . Antigen _ full _ v3`<br/>中选择<br/>抗原名称，<br/> sum(表位数量)作为表位<br/>其中生物体名称类似于“%冠状病毒%”<br/>按抗原名称分组<br/>按表位排序DESC </em></p><p id="bec2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询将返回类似的结果，如下所示:</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/9f14092306ff62ba926226b07b0a5d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t6D_Ibye3h_x_enu0ux87g.png"/></div></div></figure><p id="2082" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果表明，大多数表位研究试验是针对刺突糖蛋白，因为生物体是冠状病毒类型。让我们进一步探索:在冠状病毒的结合亲和力数据中，哪种MHC等位基因具有最多的参考价值？</p><p id="0a6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">选择<br/>等位基因_名称作为等位基因，<br/>计数(*)作为计数<br/>来自` big query-public-data . immune _ epitage _ db . MHC _ ligand _ full `<br/>其中<br/>object _ type = ' Linear peptide '<br/>和生物体_名称如' %coronavirus%' <br/>和抗原_名称如' Spike%' <br/>按等位基因_名称分组<br/>按计数排序</em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/8fc6f22d4ec50277162d9b268821beb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*Asp3G5PDcG2nPHxdE1UW6w.png"/></div></figure><p id="0888" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询结果显示，在给定的数据集中，肽结合信息的前三个等位基因来自HLA-A和HLA-DRB的等位基因类型。但是与这些等位基因结合的是什么类型的肽，对于配体-肽结合参考，刺突蛋白的线性肽的最有效长度是多少？</p><p id="a442" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">选择<br/>长度(描述)为peptide_mers，<br/> count(*)为counts <br/>来自` big query-public-data . immune _ epitage _ db . MHC _ ligand _ full `<br/>其中<br/>object _ type = ' Linear peptide '<br/>和生物体_name like '%coronavirus%' <br/>和抗原_name like 'Spike%' <br/>分组按1 <br/>排序按计数desc </em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/d6a5662aebf111084148b5ee3bb5bc8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*mseo8vFmEzfEvaZ0hJsaaw.png"/></div></figure><p id="4f63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询结果显示，对于刺突蛋白类型的冠状病毒肽，大多数结合亲和力数据可用于肽长度为9和10。这表明，作为候选疫苗的一个例子，人们可能希望集中于对9或10聚体肽的进一步研究和测试。基于以上两个疑问，刺突蛋白的9或10聚体肽与HLA等位基因的结合亲和力有多强？根据定量测量，按高阳性结合率到阴性结合率的顺序列出结果。</p><p id="8832" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">选择<br/>抗原名称、<br/>描述为肽、<br/>亲本蛋白、<br/>检测组为结合类型、<br/>等位基因名称为等位基因、<br/>定性测量、<br/>定量测量为结果分数<br/>来自` big query-public-data . immune _ epitage _ db . MHC _ ligand _ full`<br/>其中<br/> object_type = '线性肽'<br/>和生物体名称类似' %冠状病毒% '= '定性结合'<br/>和等位基因名称如' HLA-%' <br/>和抗原名称如' Spike%' <br/>和长度(描述)在(9，10) <br/>中按结果分数排序</em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/81ede90115ec16de0202c18e7295d0b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rlfW827s8LgToJri1nIjRA.png"/></div></div></figure><h1 id="8d58" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用BQ建立机器学习模型</h1><p id="9afb" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">用BigQuery构建ML模型就像写SQL语句一样简单；使ML建模对SQL开发人员和分析师来说都是可访问的。在这个例子中，我们将创建一个简单的分类模型来预测给定的肽是否与特定的HLA等位基因有很强的结合亲和力。</p><p id="58d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下语句通过选择特定mers的等位基因和肽的特征列，使用逻辑回归创建分类模型，以分类肽是否是疫苗测试的良好候选。仅过滤长度为9或10聚体的肽的数据。此外，由于我们可以运行多个样本，我们按照80%的数据随机抽取样本进行学习。您需要一个项目和数据集来运行和保存模型，以下语句将“corona”作为数据集名称:</p><p id="3d3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">创建或替换模型` corona . classification _ MODEL _ p2`<br/>TRANSFORM(Qualitative _ Measure，Description，Allele_Name，<br/> ML。MIN _ MAX _ SCALER(Quantitative _ measurement)OVER()AS RS<br/>)<br/>OPTIONS<br/>(<br/>model _ type = ' logistic _ reg '，<br/>input _ label _ cols =[' Qualitative _ Measure ']<br/>)<br/>AS<br/>SELECT<br/>Qualitative _ Measure，Description，等位基因_Name，Quantitative _ measurement<br/>FROM<br/>` big query-public-data . immunicipate _ db . MHC _ ligand _ full `<br/>其中length(长度</em></p><p id="80b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的陈述中可以看出，您不仅可以创建机器学习模型，还可以将特征工程作为模型输入定义的一部分。我们将定量测量标准化为其相对于最小-最大值的偏差。这使得在预测过程中不需要额外的数据操作，因为模型会处理来自行输入的格式/特征数据。从BQ Web UI中，您可以检查刚刚创建的模型的准确性和混淆矩阵。</p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/4efdc130bfff1e1b7ecfab6674e80bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkndPocwEPaMp_GSFFtEyQ.png"/></div></div></figure><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/e9cf95430a2202e49471d8be0f3bf106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7-tVj1vRBvxJtGxzqmzfQ.png"/></div></div></figure><p id="4be7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">也可以运行ML。评估使用SQL语句查询模型统计信息的函数，如下所示:</p><p id="6ed6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">从ML中选择<br/> * <br/>。评估(MODEL ` corona . class ification _ MODEL _ P1 `)</em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/eab107cb6dd6760faef3d36b28162d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMQRjg2-eNMJ2lH0K7XZSw.png"/></div></div></figure><p id="b099" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦模型准备好了，让我们运行一个预测语句来检查我们的ML模型的执行情况。运行以下SQL语句，使用我们数据集中的随机样本运行预测:</p><p id="6d1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lg">从ML中选择<br/>预测_定性_测量，预测_定性_测量_概率，定性_测量作为原始_结果<br/>。PREDICT(MODEL ` corona . classification _ MODEL _ p2 '，(<br/> SELECT Qualitative_Measure，Description，Allele_Name，Quantitative _ measurement<br/>FROM ` big query-public-data . immune _ epitage _ db . MHC _ ligand _ full `<br/>其中(9，10)中的length(Description)<br/>和organism _ Name like ' % corona virus % '<br/>和rand()&lt;0.0009)</em></p><figure class="li lj lk ll fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/034f487d644b2a8e2a823f59fe41b0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXrx3ZXIwJwpctrN7UQXVw.png"/></div></div></figure><p id="37f5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询结果显示预测的定性分类，您可以根据原始值观察其概率。这样的推论对于缩小疫苗测试候选人的范围以加快整个研究周期非常有用。ML建模和测试是一个迭代的过程。人工智能管道是谷歌人工智能平台的管道框架，帮助您优化和有效地操作您的ML流程。有关带有工作示例的系列研究故事，<a class="ae jo" href="https://medium.com/google-ai-platform-for-predicting-peptide-for" rel="noopener">请访问出版物</a>！</p><p id="69dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意安全！</p><h1 id="7085" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结束语和行动项目</h1><ol class=""><li id="10cc" class="lt lu hi is b it kn ix ko jb lv jf lw jj lx jn ly lz ma mb bi translated">使用BigQuery，可以创建一个Pb级的数据仓库，以获得超强的查询性能。BQ不仅提供可扩展的存储和计算，还提供了一种使用SQL语句构建和使用ML模型的简单方法。点击了解更多关于<a class="ae jo" href="https://cloud.google.com/bigquery-ml/docs/bigqueryml-intro" rel="noopener ugc nofollow" target="_blank"> BQML的信息。</a></li><li id="21ba" class="lt lu hi is b it mc ix md jb me jf mf jj mg jn ly lz ma mb bi translated">构建和使用ML只是整个数据管道和研究流程中的一个小任务。为了优化你的整体数据和ML管道，你可以利用谷歌云的人工智能平台管道。你可以在这里了解<a class="ae jo" href="https://cloud.google.com/ai-platform/pipelines/docs" rel="noopener ugc nofollow" target="_blank"> AI管道。你可以通过</a><a class="ae jo" href="https://github.com/testpilot0/covid/blob/master/Google%20AI%20Platform%20Pipelines_%20Predicting%20COVID%20Peptide%20Vaccine%20Candidates.pdf" rel="noopener ugc nofollow" target="_blank"> github资源</a>阅读并使用上述疫苗研究流程的例子。</li><li id="0d1b" class="lt lu hi is b it mc ix md jb me jf mf jj mg jn ly lz ma mb bi translated">BigQuery是免费的，不需要信用卡(在免费层内)。如果您添加信用卡<strong class="is hj">，确保</strong>到<a class="ae jo" href="https://stackoverflow.com/questions/52831056/how-do-i-turn-on-cost-controls-on-bigquery" rel="noopener ugc nofollow" target="_blank">设置成本控制</a>。</li></ol><p id="0efc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不代表我的雇主。这不是谷歌的官方工作。当然，剩下的任何错误都是我的。</p></div></div>    
</body>
</html>