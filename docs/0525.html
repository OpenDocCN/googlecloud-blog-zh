<html>
<head>
<title>GCP’s Standard Tier networking performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP的标准层网络性能</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcps-standard-tier-networking-performance-c66350cf4763?source=collection_archive---------0-----------------------#2018-02-22">https://medium.com/google-cloud/gcps-standard-tier-networking-performance-c66350cf4763?source=collection_archive---------0-----------------------#2018-02-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/d9dc4b6b7d36750855f51f34b01f8003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8gFMHNLtQJj-DnrepTSjw.jpeg"/></div></div></figure><div class=""/><p id="a0fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你仔细观察，你的大部分网络数据在优先级上可能并不一致。如果您有一些优先级较低的异步内容，并且并不真正需要2TB/s的传输速度，那么为了传输这些数据而支付2TB的连接就没有什么意义了。这就是GCP新的<strong class="is hu">标准层</strong>网络的用武之地；它比<strong class="is hu">高级层提供更低的吞吐量和更高的延迟。</strong></p><p id="9e02" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你究竟为什么想要一个性能较低的网络？</p><p id="d5d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单:<strong class="is hu">成本更低</strong>。</p><p id="9bf3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你在过去十年左右的时间里一直关注我的工作，你就会知道我非常喜欢使用正确的工具来完成正确的工作，尤其是在成本和性能方面。因此，能够查看您的数据，并调整它所拥有的网络体验类型(以及这需要您付出的代价)，这是一个非常酷的想法，适用于各种情况。</p><p id="c6b0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，在我们兴奋之前，让我们先回答几个问题:为什么标准层与高级层不同，我们看到的性能差异是什么？</p><figure class="jo jp jq jr fd hk"><div class="bz dy l di"><div class="js jt l"/></div><figcaption class="ju jv et er es jw jx bd b be z dx translated">忙到没时间看书？检查TL；上面的DR视频！</figcaption></figure><h1 id="bc0b" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">什么是标准层？</h1><p id="3e47" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">为了描述这一点，让我们首先从<strong class="is hu">高级层</strong>的工作原理开始。简而言之，高级层通过减少在公共互联网上的旅行时间来实现改进的网络性能；数据包进入(并离开)谷歌的网络，尽可能靠近<strong class="is hu">用户</strong>，然后在到达虚拟机之前在谷歌的主干网上传输。</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es lb"><img src="../Images/d86f52d03bd409a39aac193d9f413ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*PDfuAvrTlXJ0lBXMuoEolw.png"/></div></figure><p id="3947" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一方面，标准层允许数据包尽可能靠近虚拟机进入谷歌的网络，花更多的时间在公共互联网上传输。</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es lb"><img src="../Images/8ae9a062606a2f49c67f6b70ab669aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*cxAtyRVTvc1WHwMrvOjLXg.png"/></div></figure><p id="81de" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑到这一点，标准层和高级层之间的区别就变得非常明显了。</p><p id="5e82" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">高级</strong>层数据包在谷歌网络上花费<em class="lc">更多</em>时间，因此性能更好(但成本<em class="lc">更多</em>)。</p><p id="510a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">标准</strong>层数据包在谷歌网络上花费<em class="lc">更少</em>时间，因此性能更差(但花费<em class="lc">更少</em>！)</p><p id="feba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为开发人员，这意味着您应该问两个问题:性能差异有多大，成本差异有多大？</p><h1 id="cf19" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">测试性能差异</h1><p id="8ca5" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">随着客户端和虚拟机之间的物理距离的增加，这两个层之间的性能差异变得惊人地明显，因此，为了测试性能，让我们来看看最佳和最差的性能场景。</p><h1 id="09b9" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">最坏的情况:跨越海洋</h1><p id="95ef" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">为了测试这一点，我在<strong class="is hu">美国中心1 </strong>中设置了两个虚拟机，并将其中一个配置为高级层，另一个配置为标准层。然后，在法兰克福的一台非GCP机器上，从每个实例中获取100k的图像500次。</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/423dfd46b8b8fd0f4a38f12da5e12a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NRt8sKgKfgEsCxPz7sz-Pg.png"/></div></div></figure><p id="3c9a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该图显示，对于重复读取，高级层平均比标准层快41%。在进行更高容量的吞吐量测试时，我们也看到了大约46%的差异:</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es le"><img src="../Images/a1083295e96704b66a97fce4c208fe7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*u_0rytUZMGTun4lab90YaQ.png"/></div></figure><h1 id="0a54" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">最佳情况—同一地区</h1><p id="8343" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">显然，在海洋上抓取是网络测试的最坏情况。所以让我们来看看<em class="lc">最好的</em>情况是什么样的。让我们把客户机尽可能移近我们的中心，而不要让<em class="lc">真正进入</em>GCP网络。</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es lf"><img src="../Images/d1f74cc638e5851d396979f1c938dd74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*wGklQzToo9Bhk0duBiGuOQ.png"/></div></figure><p id="0a2f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种最佳情况下，我们可以看到标准层的性能非常接近高级层，尽管它有点不可靠(较大的较长读取集)。</p><p id="ee3a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的吞吐量看起来也很接近，标准在这个测试中只低8%。</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div class="er es le"><img src="../Images/54b12c0ffa9bed6cf838bf2649264999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*9wCSlrzifG5wjVjVTAkqtQ.png"/></div></figure><h1 id="532a" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">什么时候应该使用标准层？</h1><p id="b633" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">到目前为止，大部分云性能地图集内容都直接关注于提高GCP应用程序性能所需做的事情。</p><p id="15f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是当涉及到高级/标准层时，您真的应该问问自己"<em class="lc">我需要多高的性能，以此换取成本可以吗？</em>”</p><p id="190f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我会向你推荐这张方便的图表(在<a class="ae lg" href="https://cloudplatform.googleblog.com/2017/08/introducing-Network-Service-Tiers-your-cloud-network-your-way.html" rel="noopener ugc nofollow" target="_blank">原始博客文章</a>中提供)来帮助你解决这个问题:</p><figure class="jo jp jq jr fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lh"><img src="../Images/f1944d9b822ba2c157249d0b65af3db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-83-ja5NWZza1HSbAMRyig.png"/></div></div></figure><h1 id="7d32" class="jy jz ht bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">另一个旋钮转动。</h1><p id="34f8" class="pw-post-body-paragraph iq ir ht is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">从我的测试来看，标准层相当惊人。如果我在同一个地理区域传输数据，考虑到降低的入口成本，性能下降8%是完全值得的。同样，最坏情况下的性能差异对于非关键数据(例如，用户提交日志信息或批处理工作数据)来说听起来是一个很好的折衷，尤其是在降低成本的情况下！</p><p id="6ef9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lc">重复免责声明</em>:在撰写本文时(2018年2月22日)，<strong class="is hu"> GCP的分层网络仍处于alpha阶段</strong>，因此许多东西都在不断变化，并将会改变(例如，定价差异尚未公布)。因此，请留意<a class="ae lg" href="https://cloud.google.com/network-tiers/" rel="noopener ugc nofollow" target="_blank"> GCP网络服务等级</a>页面，了解更多信息。</p><p id="dafb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此之前，我对新的网络服务层感到兴奋。对于希望在云应用的性能和成本之间找到另一个平衡点的个人来说，这是一个很好的新选择。</p></div></div>    
</body>
</html>