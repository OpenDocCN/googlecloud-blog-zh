<html>
<head>
<title>Migrating a Monolith to Google Kubernetes Engine (GKE) — Customer Story</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Monolith迁移到Google Kubernetes引擎(GKE) —客户案例</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-customer-story-c35c320325eb?source=collection_archive---------1-----------------------#2020-03-24">https://medium.com/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-customer-story-c35c320325eb?source=collection_archive---------1-----------------------#2020-03-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cd54" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在云中烹饪</h2></div><h1 id="62d9" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">介绍</h1><p id="4c1b" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated"><strong class="jr hj"><em class="kl"/></strong><a class="ae km" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e"><strong class="jr hj"><em class="kl">云上做饭</em></strong></a><strong class="jr hj"><em class="kl"/></strong>是一个<a class="ae km" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e">博客</a>和<a class="ae km" href="https://www.youtube.com/playlist?list=PLIivdWyY5sqIOyeovvRapCjXCZykZMLAe" rel="noopener ugc nofollow" target="_blank">视频</a>系列，帮助企业和开发者在Google Cloud上构建商业解决方案。在这第三个迷你系列中，我们将讲述<strong class="jr hj"> <em class="kl">将一个整体迁移到谷歌Kubernetes引擎(GKE) </em> </strong>。将整体迁移到微服务可能会令人生畏。一旦你决定接受它，你需要考虑什么？继续阅读…</p><p id="d715" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">在这些文章中，我们将带您了解将monolith迁移到微服务的整个过程、迁移流程、首先迁移什么、迁移的不同阶段以及如何处理数据迁移。这些文章的灵感来自于<a class="ae km" href="https://cloud.google.com/solutions/migrating-a-monolithic-app-to-microservices-gke" rel="noopener ugc nofollow" target="_blank">这篇解决方案文章</a>。我们将以一个真实的客户故事来结束这一切，在一个真实的应用程序中完成这些步骤。</p><p id="88f7" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">以下是这部迷你剧的所有文章，供你查阅。</p><ol class=""><li id="ce6a" class="ks kt hi jr b js kn jv ko jy ku kc kv kg kw kk kx ky kz la bi translated"><a class="ae km" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-an-overview-785f2cbe5c62">将一块巨石迁移到GKE:概述</a></li><li id="566c" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk kx ky kz la bi translated"><a class="ae km" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-migration-process-2de2f51986a2">将一块巨石迁移到GKE:迁移过程</a></li><li id="ca31" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk kx ky kz la bi translated">将一块巨石迁移到GKE:分阶段迁移</li><li id="f200" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk kx ky kz la bi translated">将一块巨石迁移到GKE:先迁移什么？</li><li id="03c8" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk kx ky kz la bi translated"><a class="ae km" rel="noopener" href="/google-cloud/migrating-a-monolith-to-google-kubernetes-engine-gke-data-migration-ef8ebccef6b0">将一个整体迁移到GKE:数据迁移</a></li><li id="d98c" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk kx ky kz la bi translated">将一个整体迁移到GKE:客户故事(<strong class="jr hj">本文</strong>)</li></ol><p id="8b47" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">在本文中，我们将探索一个使用<a class="ae km" href="http://xmatters.com" rel="noopener ugc nofollow" target="_blank"> xMatters </a>的真实世界用例，以及他们如何从基于Google Kubernetes引擎的整体架构迁移到基于微服务的架构。所以，继续读下去吧！</p><h1 id="5e91" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">你会学到什么</h1><ul class=""><li id="0394" class="ks kt hi jr b js jt jv jw jy lg kc lh kg li kk lj ky kz la bi translated">执行从整体到微服务的端到端迁移的技巧</li></ul><h1 id="62b0" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">先决条件</h1><ul class=""><li id="61aa" class="ks kt hi jr b js jt jv jw jy lg kc lh kg li kk lj ky kz la bi translated">谷歌云的基本概念和结构，这样你就可以识别产品的名称。</li><li id="9a9f" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">查看云系列中<a class="ae km" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e"> Get Cooking的介绍。</a></li></ul><h1 id="ecc2" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">看看这个视频</h1><figure class="lk ll lm ln fd lo"><div class="bz dy l di"><div class="lp lq l"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">采访xMatters的monolith到微服务迁移之旅</figcaption></figure><h1 id="77ec" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">问题:</h1><p id="85db" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">我有机会和来自xMatters的<a class="lv lw ge" href="https://medium.com/u/4333bce42d4a?source=post_page-----c35c320325eb--------------------------------" rel="noopener" target="_blank"> Travis DePuy </a>坐在一起。以下是我们关于他们迁移之旅的对话:</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es lx"><img src="../Images/529c64f09eeaf6800fa550e44132ac42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tPqtvy75_Sm0oSm3.png"/></div></div></figure><p id="e8d3" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::什么是xMatters，这个工具是做什么的？</p><p id="e611" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我们帮助保持数字服务的正常运行。当东西爆炸时，我们帮助最小化爆炸半径。我们通过跟踪当前的随叫随到资源并在正确的时间向正确的人提供关键信息来做到这一点。</p><p id="db59" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">这里我们看到xMatters流设计器画布的一部分，显示了Stackdriver警报工作流。第一步是入站HTTP触发器，它解析有效负载并开始工作。然后我们开始用一些Stackdriver可能没有的元数据来丰富警报。在这种情况下，我们从GitHub和Jenkins获得最后的提交和部署信息。最后，这里的最后一步是实际触发xMatters事件并通知人们。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es me"><img src="../Images/6dc00c83425c103e133afab65b2192cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CctCgj4dr1aGkcVO8tBM5w.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">来自Stackdriver的入站触发器及其在xMatters Canvas中的解析方式</figcaption></figure><p id="4c96" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">现在我们看到Dan在他的移动设备上收到了Stackdriver通知。他查看来自Stackdriver的股票信息，但之后他可以查看来自GitHub和Jenkins的丰富数据。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div class="er es mf"><img src="../Images/9400b6236df2bd22cb76899cfda97a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*x8kEcE6mnUwmXsvs17EQUA.png"/></div></figure><p id="b522" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">他有几个不同的响应选项，稍后我会详细介绍，但他认为这已经足够严重，我们需要从当前的绿色部署恢复到蓝色部署。所以他选择了响应选项，并添加了可选的注释。</p><p id="cf54" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">回到xMatters画布，我们看到当用户选择相关的响应选项时启动的各种流。每个组织都有重大事故，都有处理这些事故的流程。在这种情况下，我们看到xMatters将自动创建一个吉拉问题，然后是一个状态页事件，最后是一个Slack通道，这样团队就可以开始协作了。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mg"><img src="../Images/04545f3101578ffc33c6fe586946b137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z928DsDHWeEKwphfjBw-Fg.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">xMatters画布</figcaption></figure><p id="4945" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">我们还看到了Dan选择的回滚到蓝色，并且我们看到在使用Kubernetes命令触发重新部署之前创建了一个新的吉拉问题。jira问题有助于跟踪谁在何时触发了部署，然后还可以作为未来调查的记录。</p><p id="1e6f" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">最后一个是我最喜欢的，使用一个剧本工具，比如Ansible。我们可以启动现有的行动手册来尝试解决这个问题。</p><p id="b5ce" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">有无限的可能性，所有这些都可以根据组织的具体流程进行定制。</p><p id="9350" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka: xMatters在出现诸如流量高峰或错误率等情况时向正确的团队提供通知。</p><p id="b108" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:是的，任何时候你有一个应用程序需要接触到人，这就是我们可以提供价值的地方。但是通知只是更大工作流程中的一小部分。一旦你收到通知，你需要去寻找其他各种细节，然后根据严重程度或其他因素采取行动。而这一切都是手工劳动，被称为<strong class="jr hj"><em class="kl"/></strong>。这是重要的工作，但是会占用你手头工作的时间。为了响应这一点和我们客户的需求，我们构建了一个工作流平台，在发送通知之前丰富警报，但同时也提供响应选项来自动完成这项工作。</p><p id="4cf1" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓priyanka::x matters是否提供了创新的DevOps团队工具，以在当今高度分散的IT环境中维护运营可见性和控制？</p><p id="ab4e" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:没错，我们还从事各种行业的工作，包括:医疗保健、零售、制造和金融，以支持许多使用案例，如:开发运维、SRE、重大事故和事故响应。</p><p id="79bc" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka:How:你能定义一下整体架构和基于微服务的架构之间的区别吗</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div class="er es mh"><img src="../Images/5e41d8267ea991abae34c425b0406390.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*h3v4x2WjuNhswOIwPCD-Yw.jpeg"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图尔杜肯——巨石</figcaption></figure><p id="6632" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·崔维斯:嗯，想象一个像火鸭一样的庞然大物，你知道那种美味的怪物肉吗？这是一只塞在鸭子里的鸡，以及所有塞在火鸡里的东西。一个整体是手工制作的，并交付给运营团队，然后安装和部署。新版本是新的工件，需要新的程序和过程。但愿你不想改变什么。你必须把所有的东西都拆开，然后重新编译成一个大怪物。所有的片段都是高度交织在一起，高度相互依赖的。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div class="er es mi"><img src="../Images/ebaf70273182899b110d28e9a21c1b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*dnLHnnQJNmFNTIm8KMbkcQ.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">纸杯蛋糕——微服务</figcaption></figure><p id="403e" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">反过来，你可以把微服务想象成几种不同口味的纸杯蛋糕。你有几个不同的食谱，如果你决定需要调整一个食谱，制作新的面糊并放入你的烤模中。然后你把它们推广给你的客户，他们都会得到你提供的最新最好的好处。每种配方都可以独立于其他配方进行调整。</p><p id="de27" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka:哇！那是我听过的最美味的微服务解释！似乎xMatters最初是从monolith的角度接近云的，随着时间的推移，遇到了挑战，导致决定转向基于微服务的架构。其中有哪些挑战？</p><p id="ca84" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:每个客户都在运行一个非常独特的实例，这导致监控和调试成为一场噩梦。此外，新客户的加入需要几天时间，随着我们发布新功能和淘汰旧操作系统，基础架构也随之改变，这成为一个非常定制的解决方案。我们还发现，我们的运营团队专注于构建基础设施平台，而不是与开发人员一起构建应用程序。</p><p id="1bf5" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::单一应用程序的主要挑战是——运营效率低下、监控和调试噩梦以及长时间的客户入职。我很好奇，基础设施和应用程序最初的整体状态是什么样的？</p><p id="f4f8" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我们最初是一个内部应用程序，所以有一个大的整体是有意义的。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mj"><img src="../Images/b866ea7c235c5d0761efcf55118152bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gOlbbPXB_fWJgZbk6Z6vZQ.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">迁移前的xMatters整体架构</figcaption></figure><p id="3f18" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">随着我们的客户开始接受云过渡，我们也开始接受，很自然地，我们将我们的monolith安装到我们物理维护的服务器中。</p><p id="6456" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">我们在世界各地的6个数据中心拥有空间，很快我们的服务迅速发展到500台运行OpenStack和自主开发的平台即服务的服务器。</p><p id="c6c5" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">这需要管理5000多台虚拟机！</p><p id="9176" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka: 5000台虚拟机太多了！这是你决定转向谷歌云的原因吗？</p><p id="ae41" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·崔维斯:是的，我们意识到这是不可持续的。我们真的只想构建一个企业应用程序，而不是照看硬件。</p><p id="ad93" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::当你开始考虑基于微服务的架构时，你心中的最终目标是什么？</p><p id="bc78" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:主要是规模。我们知道维护5000台虚拟机是不可扩展的，而且有如此多的冗余。每个实例都有自己的web ui版本、自己的通知服务、自己的调度服务。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mk"><img src="../Images/a8ce5db586aeb4037650ee63393fc5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*71xCO22ncK_su0tSJ9kyNA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">应用网关将调用路由到不同的微服务</figcaption></figure><p id="9abd" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::是的，当你刚接触微服务时，应用网关方法非常有用。这是如何部署在Google Cloud上的？</p><p id="7ca6" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我们使用谷歌DNS进行IP地址查找，然后用户设备，比如浏览器和移动设备，最终到达全球负载均衡器。然后，它们通过我们的应用网关进行路由，这是一个自行开发的应用，由一些不同的服务组成，包括consul和HA代理以及我们自己的配置工具。这使得我们可以轻松地将设备路由到适当区域的适当数据，并提供服务发现。</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es ml"><img src="../Images/50a85eef80b2179076ad64f8a3f0e7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HIy_S82cFcQjLSyzXimZWA.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">如何设置微服务架构的高级视图</figcaption></figure><p id="2848" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">主要应用微服务运行在Google Kubernetes的容器中。这些容器都存储在Google容器注册表中。数据后端由PostgreSQL配合Kafka和RabbitMQ组成，运行在Google Compute Engine上。以及使用Prometheus、Splunk和Stackdriver进行监控。</p><p id="65b5" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::那么，GKE是微服务和数据后端GCE的明星。</p><p id="7d19" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::那么，你是如何制定计划来打破这种垄断的，你是不是先挑选出一些服务来进行迁移？</p><p id="ef9b" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:嗯，我们从一些显而易见的方面开始，比如各种用户界面、API和我们的集成构建器服务。在我们进行的过程中，我们发现了其他有意义的逻辑分离，例如警报抑制和随叫随到调度的事件处理。通知和数据处理的时机也成熟了。</p><p id="83d7" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::是的，我在大多数应用程序的开发过程中遇到的最大挑战是数据依赖性。您是如何处理高度依赖共享数据的服务的？</p><p id="10d5" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:依赖是不可避免的。微服务很少能完全独立运行。我们确保和其他人一起发布服务。</p><p id="76c5" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::所以，基本上是在早期确定服务之间的依赖关系，然后计划微服务推出的节奏，这是基于这些依赖关系的。这绝对是一次相当大规模的迁移，一定花了很长时间？</p><p id="01c6" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·崔维斯:事实上，没那么糟。我们用了大约12个月完成了它。这很好，因为我们的数据中心合同即将续签，要么花钱续签，要么把所有东西都拿出来。</p><p id="465c" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">凭借GCP环境的灵活性，我们能够进行软部署，并保持我们现有的数据中心基础设施并行运行，我们这样做了大约6个月。</p><p id="063d" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::是的，这在任何移民中都是非常重要的一点。随着您慢慢地将一项项服务迁移到云中，您将在一个混合平台上运行一段时间。</p><p id="0ce7" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我认为对我们来说，成功的最大贡献之一是，一旦基础设施到位，我们就制定了监控和可观察性。这对于通知我们变化的影响，尤其是了解我们变化的影响是至关重要的。</p><p id="8a5d" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka: Stackdriver成为你最好的朋友，这样的观察和监测。当你进行这些渐进的改变时，Google Kubernetes引擎(GKE)在这个过程中扮演了什么角色？</p><p id="eaf2" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我们使用sidecar模式，这有助于我们利用在Splunk以及其他可观察性应用程序上的投资。使用sidecars意味着我们可以自信地根据我们的需求变化交换其他应用程序。</p><p id="3c01" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::在微服务中运行应用程序最大的挑战是什么？</p><p id="7278" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:两件事，学习服务所有权的诀窍和有效地部署这些服务。</p><p id="bda4" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::这个变化对车队来说一定是新的。您如何确保开发和运营团队对这些变化感到满意？</p><p id="c110" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:杰斯·亨布尔讲述了当你把人们从他们行为的后果中抽象出来时，不良行为是如何发生的。因此，我们将团队与他们构建的服务联系起来。这让他们拥有自己构建的代码，并使它们与其服务级别目标保持一致。</p><p id="dedf" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::是的，这种主人翁意识创造了奇迹，让团队对他们的SLO负责。</p><p id="96b1" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">现在您已经完成了这个迁移过程，这个迁移是如何被证明是有帮助的呢？</p><p id="d323" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:更快乐的客户，意味着更快乐的团队和更少的熬夜，以及应用程序整体复杂性的降低。</p><p id="9e06" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">根据经验，我们发现由于微服务架构以及Google Cloud提供的网络，性能提高了43%。正如我提到的，我们有更快乐的团队，但是我们计算出事故减少了60%!</p><p id="2b31" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka:快乐团队，快乐客户，事故减少60%，绩效提高43%！听起来我赢了！</p><p id="9120" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">你认为xMatters团队的下一步是什么？</p><p id="b78e" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">🅰️·特拉维斯:我们会关注服务网格。现在，服务通过应用程序网关相互对话，因此让它们直接相互对话并成为真正的服务网格可能会为我们带来一些额外的改进。</p><p id="830b" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">❓Priyanka::是的，像Istio这样的服务网格似乎是连接、保护、控制和观察服务的合乎逻辑的下一步。</p><p id="ceff" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">谢谢特拉维斯，这是非常有见地的！</p><h1 id="ca50" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">结论</h1><p id="cfbd" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">要点是——将一个整体迁移到GKE的微服务是一个复杂的过程，不会在一夜之间发生——事先规划(我的服务将如何通信——我将如何管理数据——首先迁移什么)有助于确保这一过程顺利进行。</p><p id="db32" class="pw-post-body-paragraph jp jq hi jr b js kn ij ju jv ko im jx jy kp ka kb kc kq ke kf kg kr ki kj kk hb bi translated">如果您正在寻求将现有的单一平台迁移到云中，那么您已经从xMatters中获得了诀窍！敬请关注<a class="ae km" rel="noopener" href="/@pvergadia/get-cooking-in-cloud-an-introduction-5b3b90de534e">云烹饪系列</a>中的更多文章，并查看下面的参考资料了解更多细节。</p><h1 id="4842" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">后续步骤和参考:</h1><ul class=""><li id="f976" class="ks kt hi jr b js jt jv jw jy lg kc lh kg li kk lj ky kz la bi translated">在<a class="ae km" href="https://medium.com/google-cloud" rel="noopener">谷歌云平台媒体</a>上关注这个博客系列。</li><li id="d20e" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">参考:<a class="ae km" href="https://cloud.google.com/solutions/migrating-a-monolithic-app-to-microservices-gke" rel="noopener ugc nofollow" target="_blank">整体到GKE解决方案</a>的微服务。</li><li id="9336" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">Codelab: <a class="ae km" href="https://codelabs.developers.google.com/codelabs/cloud-monolith-to-microservices-gke/#0" rel="noopener ugc nofollow" target="_blank">将一个整体迁移到GKE的微服务上</a></li><li id="28fb" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">关注<a class="ae km" href="https://www.youtube.com/watch?v=pxp7uYUjH_M" rel="noopener ugc nofollow" target="_blank">获取云端烹饪</a>视频系列，订阅谷歌云平台YouTube频道</li><li id="7bac" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">想要更多的故事？查看我的<a class="ae km" rel="noopener" href="/@pvergadia/">媒体</a>，<a class="ae km" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">在twitter上关注我</a>。</li><li id="271e" class="ks kt hi jr b js lb jv lc jy ld kc le kg lf kk lj ky kz la bi translated">请和我们一起欣赏这部迷你剧，并了解更多类似的谷歌云解决方案:)</li></ul></div></div>    
</body>
</html>