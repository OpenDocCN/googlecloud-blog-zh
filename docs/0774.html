<html>
<head>
<title>Continuous Delivery of HashiCorp Vault on Google Kubernetes Engine: Google Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Kubernetes引擎上持续交付hashi corp Vault:Google架构</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/continuous-delivery-of-hashicorp-vault-on-google-kubernetes-engine-google-architecture-4fb88900d23d?source=collection_archive---------1-----------------------#2018-09-27">https://medium.com/google-cloud/continuous-delivery-of-hashicorp-vault-on-google-kubernetes-engine-google-architecture-4fb88900d23d?source=collection_archive---------1-----------------------#2018-09-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="78ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这是一个系列的第二部分:</strong> <a class="ae jd" rel="noopener" href="/@blzysh/continuous-delivery-of-hashicorp-vault-on-google-kubernetes-engine-bcbf4e75f0f6"> <strong class="ih hj">指数</strong> </a></p><h1 id="dea4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">概述:</h1><p id="9a9d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这是一个高层次的观点和一些使用的谷歌资源的细节。体系结构中的SLO和故障点的信息。</p><h1 id="f061" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><a class="ae jd" href="https://cloud.google.com/kubernetes-engine" rel="noopener ugc nofollow" target="_blank">谷歌Kubernetes引擎</a>:</h1><blockquote class="kh ki kj"><p id="13b2" class="if ig kk ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">Google Kubernetes引擎为使用Google基础设施部署、管理和扩展您的容器化应用程序提供了一个托管环境。</p></blockquote><p id="4404" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过创建区域集群，您可以:</p><ul class=""><li id="95bb" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated"><em class="kk">从单个区域故障中恢复—因为您的主节点和应用节点在整个区域内可用，而不是在单个区域内可用，所以即使整个区域出现故障，您的Kubernetes集群仍然可以完全正常运行。</em></li><li id="bbfe" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated"><em class="kk">主升级期间无停机时间——Kubernetes引擎在所有Kubernetes主升级期间最大限度地减少停机时间，但对于单个主升级，一些停机时间是不可避免的。通过使用区域集群，控制面板保持在线和可用，即使在升级期间也是如此。</em></li></ul><p id="cc2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://cloud.google.com/kubernetes-engine/sla" rel="noopener ugc nofollow" target="_blank"> Kubernetes SLA </a></p><ul class=""><li id="7e47" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">控制平面:&gt; =99.95%(区域)</li><li id="af25" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">库伯内特空气污染指数:&gt; =99.5%</li></ul><p id="487e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">节点使用底层虚拟机实例<a class="ae jd" href="https://cloud.google.com/compute/sla" rel="noopener ugc nofollow" target="_blank"> GCE SLA </a>，当实例跨同一区域中的2个或更多区域部署时，目标SLO为99.99%。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="b97b" class="je jf hi bd jg jh lj jj jk jl lk jn jo jp ll jr js jt lm jv jw jx ln jz ka kb bi translated"><a class="ae jd" href="https://cloud.google.com/storage" rel="noopener ugc nofollow" target="_blank">谷歌云存储</a>:</h1><blockquote class="kh ki kj"><p id="3a9e" class="if ig kk ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">云存储允许在全球范围内随时存储和检索任意数量的数据。您可以将云存储用于一系列场景，包括为网站内容提供服务、存储用于归档和灾难恢复的数据，或者通过直接下载向用户分发大型数据对象。</p></blockquote><p id="260a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://cloud.google.com/storage/sla" rel="noopener ugc nofollow" target="_blank">云存储SLA </a></p><ul class=""><li id="f310" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">多区域:&gt; = 99.95%</li></ul></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="eaeb" class="je jf hi bd jg jh lj jj jk jl lk jn jo jp ll jr js jt lm jv jw jx ln jz ka kb bi translated"><a class="ae jd" href="https://cloud.google.com/kms" rel="noopener ugc nofollow" target="_blank">谷歌云KMS </a>:</h1><blockquote class="kh ki kj"><p id="6134" class="if ig kk ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">云KMS允许您将加密密钥保存在一个中央云服务中，供其他云资源和应用程序直接使用。</p></blockquote><p id="7064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://cloud.google.com/kms/sla" rel="noopener ugc nofollow" target="_blank">云KMS SLA </a></p><ul class=""><li id="e8eb" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">KMS: &gt;=99.5%</li></ul><h1 id="7609" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">谷歌架构图:</h1><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lo"><img src="../Images/4fc65e700d41da2489ba25d7a9daf4c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tx2lK8QwB4bAAy9Eu4DuBg.png"/></div></div></figure></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h1 id="9cfe" class="je jf hi bd jg jh lj jj jk jl lk jn jo jp ll jr js jt lm jv jw jx ln jz ka kb bi translated">谷歌SLO:</h1><figure class="lp lq lr ls fd lt er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es ma"><img src="../Images/bff9dbf448c7505964b016cee75d3e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14Huvk6haFZbZar08s336Q.png"/></div></div></figure><p id="1c29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kk">注:这是一个估计，总体SLO实际上更高，见下面的KMS信息。</em></p><h1 id="cf30" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">故障点:</h1><p id="ad21" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这不包括已经应用于产品SLO的任何底层基础架构。</p><h2 id="1ee1" class="mb jf hi bd jg mc md me jk mf mg mh jo iq mi mj js iu mk ml jw iy mm mn ka mo bi translated">谷歌云KMS</h2><p id="d0a9" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">这只是一个启动运行时依赖项。保险库需要<a class="ae jd" href="https://www.vaultproject.io/docs/commands/operator/init.html" rel="noopener ugc nofollow" target="_blank">初始化</a>和<a class="ae jd" href="https://www.vaultproject.io/docs/concepts/seal.html#unsealing" rel="noopener ugc nofollow" target="_blank">解封</a>，以便创建主密钥和解密数据。</p><ul class=""><li id="bc91" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">初始化是保险存储的存储后端准备接收数据的过程。由于Vault服务器在HA模式下共享相同的存储后端，因此您只需初始化一个Vault即可初始化存储后端。</li><li id="b6a4" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">解封是构建读取解密密钥以解密数据所必需的主密钥的过程，从而允许访问保险库。</li></ul><p id="2159" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kk">如果谷歌云KMS宕机，我们所有的Vault服务器宕机，Vault将无法初始化或解封，应用程序将无法在实例启动或自动扩展期间从Vault中检索任何数据。</em> </strong></p><h2 id="8ff4" class="mb jf hi bd jg mc md me jk mf mg mh jo iq mi mj js iu mk ml jw iy mm mn ka mo bi translated">谷歌云存储</h2><p id="b0e2" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">多区域云存储用于Vault后端。</p><p id="a560" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kk">如果Google云存储关闭，Vault将不可用。</em>T11】</strong></p><h2 id="65c3" class="mb jf hi bd jg mc md me jk mf mg mh jo iq mi mj js iu mk ml jw iy mm mn ka mo bi translated">谷歌Kubernetes引擎</h2><p id="9d16" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">一开始将使用一个区域性的Kubernetes集群，如果需要，以后可以扩展到多个区域。</p><p id="a8a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Vault只能在具有<a class="ae jd" href="https://www.hashicorp.com/go/vault-enterprise" rel="noopener ugc nofollow" target="_blank"> enterprise </a>版本的多区域中运行。</p><p id="174e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最小节点池大小为每个区域一个/最大3个。<em class="kk">豆荚复制品尺寸3。</em></p><ul class=""><li id="3865" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">只要至少有一个节点和单元处于运行状态，节点和单元的丢失将导致很少甚至没有服务中断。</li><li id="4288" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">只要至少有一个区域处于运行状态，丢失一个区域几乎不会导致服务中断。</li></ul><p id="7301" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kk">区域故障期间保险库将不可用。</em>T19】</strong></p><h1 id="37e9" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">注意事项:</h1><p id="c18e" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated"><strong class="ih hj"> <em class="kk">如果服务无法连接，依赖于Vault的应用程序可能希望服务启动失败。<br/>下面是一个Spring的例子:</em> </strong> <a class="ae jd" href="http://cloud.spring.io/spring-cloud-vault/2.0.x/single/spring-cloud-vault.html#vault.config.fail-fast" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="kk"> Config客户端快速失败</em> </strong> </a></p><p id="2b9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/@blzysh/continuous-delivery-of-hashicorp-vault-on-google-kubernetes-engine-kubernetes-architecture-c94fb5e513b1"> <strong class="ih hj">第三部分- &gt; </strong> </a></p></div></div>    
</body>
</html>