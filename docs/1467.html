<html>
<head>
<title>.NET Functions Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">。网络功能框架</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/net-functions-framework-a039d6d38348?source=collection_archive---------2-----------------------#2020-06-09">https://medium.com/google-cloud/net-functions-framework-a039d6d38348?source=collection_archive---------2-----------------------#2020-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/830c8fe413bb5c9d68c55faf8b3a7f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pfpbbIq8uPk1DoiaHb4F0Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">。网芯+云跑</figcaption></figure><p id="a960" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">介绍。NET函数框架。</p><p id="3b55" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇博文中，我们将介绍。NET Functions Framework，并向您展示如何在Google Cloud上轻松部署安全的功能。</p><h1 id="18f6" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">设置</h1><p id="eaf9" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">安装<a class="ae kv" href="https://dotnet.microsoft.com/download" rel="noopener ugc nofollow" target="_blank">。网芯SDK 3.1 </a>。</p><p id="b587" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">安装后，您应该可以访问CLI，包括handy。NET模板来快速入门。</p><h1 id="e70e" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">快速入门</h1><p id="e852" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">将Google Cloud Functions模板包安装到。网络工具:</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="afa3" class="li jt hi kz b fi lj lk l ll lm">dotnet new -i Google.Cloud.Functions.Templates::1.0.0-alpha07</span></pre><p id="a3a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后使用。网络模板:</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="5446" class="li jt hi kz b fi lj lk l ll lm">mkdir HelloFunctions<br/>cd HelloFunctions<br/>dotnet new gcf-http</span></pre><p id="e2ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这将在当前目录中创建<code class="du kw kx ky kz b">HelloFunctions.csproj</code>和<code class="du kw kx ky kz b">Function.cs</code>。</p><h2 id="fcdd" class="li jt hi bd ju ln lo lp jy lq lr ls kc jf lt lu kg jj lv lw kk jn lx ly ko lz bi translated">本地测试</h2><p id="1fea" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在本地运行该功能:</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="ef45" class="li jt hi kz b fi lj lk l ll lm">dotnet run</span></pre><p id="ed4f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">进入<em class="ma"> </em> <code class="du kw kx ky kz b"><em class="ma">127.0.0.1:8080</em></code>调用该功能。</p><p id="9cfa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您现在使用。NET函数框架！</p><h1 id="39b3" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">添加Dockerfile文件</h1><p id="5371" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">要在容器中运行这个应用程序，我们需要一个新文件，<code class="du kw kx ky kz b">Dockerfile</code>:</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="mb mc l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">Dockerfile文件</figcaption></figure><p id="a744" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这个docker文件声明我们希望我们的容器使用。NET核心，安装依赖项和应用程序代码，构建并运行我们的dll。</p><h1 id="9e23" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">部署到云运行</h1><p id="7b65" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">部署您的功能Google Cloud并不太难。在我们的终端中，我们将指示<code class="du kw kx ky kz b">gcloud</code>执行to命令:</p><ol class=""><li id="68d0" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated">使用<em class="ma">云构建</em>来构建容器</li><li id="accf" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">使用<em class="ma">云运行</em>运行容器</li></ol><p id="c3e2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了简单起见，我们将当前项目存储在bash变量<code class="du kw kx ky kz b">GCP_PROJECT</code>中。</p><p id="bd01" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们构建并部署<em class="ma">安全</em>容器，确保我们使用相同的项目:</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="mb mc l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">设置项目，构建，然后运行。</figcaption></figure><h2 id="7940" class="li jt hi bd ju ln lo lp jy lq lr ls kc jf lt lu kg jj lv lw kk jn lx ly ko lz bi translated">发送经过身份验证的HTTP请求</h2><p id="0aa7" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">我们部署了一个拒绝未授权请求的安全web服务。这对于像内部API和云发布/订阅处理程序这样的服务来说非常好。</p><p id="95ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们试图卷曲我们的服务的URL，我们将得到一个<code class="du kw kx ky kz b">Error: Forbidden</code>消息。</p><p id="7f04" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">那么我们如何调用我们的服务呢？</p><p id="751c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们可以简单地将HTTP头中的授权承载令牌传递给我们的云运行服务:</p><figure class="la lb lc ld fd ij"><div class="bz dy l di"><div class="mb mc l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">获取Run服务的URL，然后用您的gcloud ID令牌将其卷曲。</figcaption></figure><p id="afe0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">卷曲网址，你会看到回应:</p><pre class="la lb lc ld fd le kz lf lg aw lh bi"><span id="2e6b" class="li jt hi kz b fi lj lk l ll lm">Hello, Functions Framework.</span></pre><h2 id="177d" class="li jt hi bd ju ln lo lp jy lq lr ls kc jf lt lu kg jj lv lw kk jn lx ly ko lz bi translated">感谢阅读</h2><p id="f785" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">感谢您快速了解。NET函数框架。</p><p id="91b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您现在可能有兴趣在上注册Google Cloud功能的早期访问计划。网络:</p><ul class=""><li id="3cf6" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mr mj mk ml bi translated"><a class="ae kv" href="https://docs.google.com/forms/d/e/1FAIpQLSe7qB5vNrgFtZZ3ZUfIwkbsDMGsA1fXY52GzmGmnhwdReHuOQ/viewform" rel="noopener ugc nofollow" target="_blank">💜谷歌表单:谷歌云功能开启。净</a></li></ul><p id="3cb7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">或者，您可能有兴趣浏览源代码或为。网络功能框架:</p><ul class=""><li id="2d9a" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mr mj mk ml bi translated"><a class="ae kv" href="https://github.com/GoogleCloudPlatform/functions-framework-dotnet" rel="noopener ugc nofollow" target="_blank">📂github.com/GoogleCloudPlatform/functions-framework-dotnet</a></li></ul></div></div>    
</body>
</html>