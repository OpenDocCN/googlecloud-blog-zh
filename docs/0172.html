<html>
<head>
<title>Cats vs. Dogs with Reddit, Google BigQuery, Cloud Vision API and Cloud Dataflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Reddit、Google BigQuery、云视觉API和云数据流，猫对狗</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/cats-vs-dogs-with-reddit-google-bigquery-cloud-vision-api-and-cloud-dataflow-cb2d83d18a9c?source=collection_archive---------4-----------------------#2016-11-25">https://medium.com/google-cloud/cats-vs-dogs-with-reddit-google-bigquery-cloud-vision-api-and-cloud-dataflow-cb2d83d18a9c?source=collection_archive---------4-----------------------#2016-11-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7db6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿！</p><p id="379b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢可爱动物的精彩图片，那么你可能已经知道有一个包含大量此类图片的子网站<a class="ae jd" href="https://www.reddit.com/r/aww/" rel="noopener ugc nofollow" target="_blank">https://www.reddit.com/r/aww/</a></p><p id="abca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看着一只像人一样坐着的猫，我问自己是否有可能找出谁更可爱:猫还是狗。</p><p id="8b52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明，如果你能访问谷歌云，这没什么大不了的。</p><p id="e9e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计划是:</p><ol class=""><li id="8006" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">从https://www.reddit.com/r/aww/<a class="ae jd" href="https://www.reddit.com/r/aww/" rel="noopener ugc nofollow" target="_blank">获取500张最新图片</a></li><li id="41f0" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">将它们发送到云视觉API并取回标签</li><li id="21b6" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">数数猫和狗的标签</li><li id="6ce0" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">利润！</li></ol><p id="a9a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是<a class="js jt ge" href="https://medium.com/u/279fe54c149a?source=post_page-----cb2d83d18a9c--------------------------------" rel="noopener" target="_blank"> Felipe Hoffa </a>已经提供了reddit的数据集，所以我们不需要上传数据到BigQuery。</p><p id="76a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询非常简单:</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="ce33" class="kd ke hi jz b fi kf kg l kh ki">SELECT url FROM [fh-bigquery:reddit_posts.2016_08] WHERE subreddit="aww" and url contains 'imgur' order by created_utc desc LIMIT 500</span></pre><p id="5f1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Imgur图像，只是为了简化数据流的代码。</p><p id="4671" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">管道看起来像:</p><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="be05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CountLabels转换:</p><figure class="ju jv jw jx fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="77d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在GitHub上找到整个项目:</p><div class="km kn ez fb ko kp"><a href="https://github.com/EgorZhuk/reddit-cats-dogs/blob/master/src/main/java/org/egorzhuk/reddit/catsdogs/CountCatsDogs.java" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">EgorZhuk/Reddit-猫-狗</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">在GitHub上创建一个帐户，为reddit-cats-dogs的发展做出贡献。</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">github.com</p></div></div><div class="ky l"><div class="kz l la lb lc ky ld le kp"/></div></div></a></div><p id="b309" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">生成虚拟机、从BigQuery读取数据、下载图像、用计算机视觉标记它们并发送回BigQuery需要8分钟。我相信在我的管道中还有很多需要改进的地方。</p><figure class="ju jv jw jx fd kj er es paragraph-image"><div class="er es lf"><img src="../Images/393afba9e99b137233519b2d31668a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*JRk_7QfOScKX-bDr9rNQ-Q.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">数据流管道</figcaption></figure><p id="dc96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，是时候查询结果表了</p><pre class="ju jv jw jx fd jy jz ka kb aw kc bi"><span id="7ca1" class="kd ke hi jz b fi kf kg l kh ki">SELECT cats, dogs FROM<br/>(SELECT SUM(count) as dogs FROM [bq-playground-1366:reddit.cats_dogs_result] where description contains ‘dog’ or description contains ‘puppy’),<br/>(SELECT SUM(count) as cats FROM [bq-playground-1366:reddit.cats_dogs_result] where description contains ‘cat’ or description contains ‘kitten’)</span></pre><figure class="ju jv jw jx fd kj er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ll"><img src="../Images/e41d75c4afbbef7f0bd357a0533a9f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*rickM4Jw6sEkbYm52Ge_2w.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">猫对狗</figcaption></figure><p id="9d73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在可以肯定地说，狗比猫可爱得多。</p></div></div>    
</body>
</html>