<html>
<head>
<title>Google Cloud Run — Deploying Containerized Applications to a Serverless Environment ⚡</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google cloud run——将容器化应用部署到⚡的无服务器环境中</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/deploy-serverless-container-google-cloud-run-68d716af7716?source=collection_archive---------0-----------------------#2019-05-18">https://medium.com/google-cloud/deploy-serverless-container-google-cloud-run-68d716af7716?source=collection_archive---------0-----------------------#2019-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/34804762c1ca4e1699b316e980303e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*d2mG-Y-sQZ5vjnhg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">云运行</figcaption></figure><p id="eada" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://cloud.google.com/run" rel="noopener ugc nofollow" target="_blank"> Cloud Run </a>是一个托管计算平台，使您能够运行无状态容器。</p><p id="e963" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">云运行是无服务器的:它将所有基础设施管理抽象化，因此您可以专注于最重要的事情—构建优秀的应用程序。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/8eea45f4e0737bb9423ed7dd1fb8dea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xYXCk5ZVx7nnFMIY.png"/></div></div></figure><p id="0496" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">它是从<a class="ae js" href="https://cloud.google.com/knative/" rel="noopener ugc nofollow" target="_blank"> Knative </a>构建的，让你选择运行完全由云运行管理的容器，或者在你的<a class="ae js" href="https://cloud.google.com/kubernetes" rel="noopener ugc nofollow" target="_blank"> Google Kubernetes Engine </a>集群中运行GKE上的云运行。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="f8b4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我们将:</p><ol class=""><li id="3232" class="ka kb hi iw b ix iy jb jc jf kc jj kd jn ke jr kf kg kh ki bi translated">设置云外壳</li><li id="37e2" class="ka kb hi iw b ix kj jb kk jf kl jj km jn kn jr kf kg kh ki bi translated">演示项目文件和Dockerfile文件</li><li id="fd32" class="ka kb hi iw b ix kj jb kk jf kl jj km jn kn jr kf kg kh ki bi translated">使用云构建构建我们的Docker映像，并将其推送到Google容器注册表</li><li id="84b8" class="ka kb hi iw b ix kj jb kk jf kl jj km jn kn jr kf kg kh ki bi translated">使用Google Cloud Shell和Container Registry接口从Google Container Registry部署到云运行</li></ol></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><h1 id="7b1e" class="kv kw hi bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">设置云外壳</h1><p id="d715" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">我将使用<a class="ae js" href="https://cloud.google.com/shell/" rel="noopener ugc nofollow" target="_blank"> Google Cloud Shell </a>来管理Google Cloud Platform上的资源，假设您已经在PC上安装了它。</p><pre class="ju jv jw jx fd ly lz ma mb aw mc bi"><span id="2d7a" class="md kw hi lz b fi me mf l mg mh">gcloud auth login<br/>gcloud config set project &lt;PROJECT_ID&gt;<br/>gcloud config set compute/zone us-central1-f<br/>gcloud services enable run.googleapis.com<br/>gcloud components install beta</span></pre><p id="615b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">其中<project_id>是您的GCP项目ID。</project_id></p><h1 id="79c6" class="kv kw hi bd kx ky mi la lb lc mj le lf lg mk li lj lk ml lm ln lo mm lq lr ls bi translated">演示项目文件和Dockerfile文件</h1><p id="1275" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">本文的演示项目文件将只是<code class="du mn mo mp lz b">index.js</code>和<code class="du mn mo mp lz b">package.json</code>。我们还会有一个<code class="du mn mo mp lz b">Dockerfile</code>来树立我们的形象。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="mq jz l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">GitHub上的演示项目文件</figcaption></figure><p id="838c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请随意使用您自己的项目文件。</p><p id="55db" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mr">我们不会在PC上构建Docker映像，Google Cloud Build允许我们使用Docker文件构建Docker映像，我们已经有了Docker文件，然后</em>将映像推送到容器注册表😊</p><h1 id="ec21" class="kv kw hi bd kx ky mi la lb lc mj le lf lg mk li lj lk ml lm ln lo mm lq lr ls bi translated">使用云构建构建Docker映像，并将其推送到Google容器注册表</h1><p id="1bd9" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">让我们使用<a class="ae js" href="https://cloud.google.com/cloud-build" rel="noopener ugc nofollow" target="_blank"> Google Cloud Build </a>来构建我们的Docker映像，并将该映像推送到容器注册中心。两者都可以通过简单地运行以下命令来完成:</p><pre class="ju jv jw jx fd ly lz ma mb aw mc bi"><span id="be97" class="md kw hi lz b fi me mf l mg mh">gcloud builds submit --tag gcr.io/[PROJECT_ID]/quickstart-image .</span></pre><p id="d791" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就是这样！我们已经建立了我们的码头形象，现在在集装箱注册。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/e3e8e882a30294e24f45797ee94a50c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TEj0Yov0CtmuDXoS.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">集装箱登记上的码头图像</figcaption></figure><p id="7565" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mr">注意，如果您正在构建更大的图像，您可以传递一个超时参数，例如:</em> <code class="du mn mo mp lz b"><em class="mr">--timeout=600s</em></code></p><h1 id="f893" class="kv kw hi bd kx ky mi la lb lc mj le lf lg mk li lj lk ml lm ln lo mm lq lr ls bi translated">部署到从Google容器注册表运行的云</h1><p id="5ffd" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">我们既可以从云外壳部署，也可以直接从容器注册界面部署。</p><h1 id="fb1a" class="kv kw hi bd kx ky mi la lb lc mj le lf lg mk li lj lk ml lm ln lo mm lq lr ls bi translated">从云外壳部署</h1><pre class="ju jv jw jx fd ly lz ma mb aw mc bi"><span id="9e28" class="md kw hi lz b fi me mf l mg mh">gcloud beta run deploy --image gcr.io/&lt;PROJECT-ID&gt;/quickstart-image</span></pre><p id="15b3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将被要求输入<em class="mr">服务名</em>和其他一些选项。如果成功，您将获得服务URL😀</p><h1 id="e5e9" class="kv kw hi bd kx ky mi la lb lc mj le lf lg mk li lj lk ml lm ln lo mm lq lr ls bi translated">从容器注册界面部署</h1><p id="f18f" class="pw-post-body-paragraph iu iv hi iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr hb bi translated">点击图像名称，通过选择选项列表中的<code class="du mn mo mp lz b">Deploy to Cloud Run</code>部署<em class="mr">最新的</em>。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/842d7c79e14f297258add429dda2fc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FPwI7WUtdStZUUJE.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">部署到云运行</figcaption></figure><p id="749d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们还需要定义<em class="mr">服务名</em>和认证选项。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/7795214b1d57769e4d13a0ec27eb9632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/0*I_nmnUJKamrpXtys.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">创建服务</figcaption></figure><p id="61d2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">云运行还允许我们为部署定义额外的选项，如<em class="mr">环境变量</em>、<em class="mr">内存分配。</em></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/a67ed4ed169efbbb788cadb32f1ea8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/0*-RWAdeJjwqzW6Q_w.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">云运行的附加选项</figcaption></figure><p id="b7b7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">点击<code class="du mn mo mp lz b">Create</code>，喝一口果汁。瞧啊。<br/>我们的容器化应用运行在云上，无需服务器😀</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/f983bcccd3a3aab7614c6ee7619d394c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zs5A2LROaGctJYhN.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae js" href="https://app-nchqhrxakq-uc.a.run.app/" rel="noopener ugc nofollow" target="_blank">https://app-nchqhrxakq-UC . a . run . app</a></figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/38b2cf13ae8699904773ed748fb25d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySW0EXMo3_qWaYnvVmkh4A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae js" href="https://app-nchqhrxakq-uc.a.run.app/" rel="noopener ugc nofollow" target="_blank">https://app-nchqhrxakq-UC . a . run . app</a></figcaption></figure><p id="8271" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">不使用服务时，云运行不收费。<br/>您可以使用自定义域，而不是Cloud Run为部署的服务提供的默认地址。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="db2f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Cloud Run也运行在Google Kubernetes引擎上，这为您管理基础设施提供了更大的灵活性。下面的推文对此给出了更多的见解。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="mx jz l"/></div></figure><p id="b1be" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">关于云运行的其他资源::<br/>📚<a class="ae js" href="https://cloud.google.com/run/" rel="noopener ugc nofollow" target="_blank">云运行产品概述</a> <br/>📯<a class="ae js" href="https://cloud.google.com/blog/products/serverless/announcing-cloud-run-the-newest-member-of-our-serverless-compute-stack" rel="noopener ugc nofollow" target="_blank">云润发布博文</a> <br/>📹<a class="ae js" href="https://youtu.be/xVuuvZkYiNM" rel="noopener ugc nofollow" target="_blank">云润发射下一个19</a>T25】💻<a class="ae js" href="https://github.com/steren/awesome-cloudrun" rel="noopener ugc nofollow" target="_blank">牛逼云跑</a>t28】⚡<a class="ae js" href="https://cloudevents.io/" rel="noopener ugc nofollow" target="_blank">云事件</a>t31】☁️<a class="ae js" href="https://knative.dev/" rel="noopener ugc nofollow" target="_blank">牛逼</a></p><blockquote class="my"><p id="6af0" class="mz na hi bd nb nc nd ne nf ng nh jr dx translated"><em class="ni">感谢通读！如果我错过了任何步骤，如果有些事情不太适合你，或者如果这个指南有帮助，请告诉我。</em></p></blockquote><p id="a69f" class="pw-post-body-paragraph iu iv hi iw b ix nj iz ja jb nk jd je jf nl jh ji jj nm jl jm jn nn jp jq jr hb bi translated"><a class="ae js" href="https://blog.mercurie.ng/google-cloud-run-deploying-containerized-application-to-serverless-enviroment/" rel="noopener ugc nofollow" target="_blank">最初发布于Mercurie博客</a></p></div></div>    
</body>
</html>