<html>
<head>
<title>Handle multiple Google Cloud Shell using Windows Terminal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Windows终端处理多个Google Cloud Shell</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/handle-multiple-google-cloud-shell-using-windows-terminal-f5ce0573eaf4?source=collection_archive---------0-----------------------#2021-03-22">https://medium.com/google-cloud/handle-multiple-google-cloud-shell-using-windows-terminal-f5ce0573eaf4?source=collection_archive---------0-----------------------#2021-03-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1c1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> Windows终端</em>是2019年5月公布的一个<em class="jd">微软</em> <a class="ae je" href="https://github.com/microsoft/terminal/" rel="noopener ugc nofollow" target="_blank">开源项目</a>。第一个稳定版本于2020年5月发布；作为一个基于Windows的用户，我很抱歉这几个月忽略了它，它确实是一个有用的工具，具有高度可定制的界面。</p><p id="3933" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为埃森哲谷歌事业群工作时，由于客户安全限制，我的日常活动被分成几个GCP项目和不同的谷歌账户是很常见的。</p><p id="9db9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">终端</em>提供了一个有趣的功能:<strong class="ih hj">配置文件</strong>。</p><p id="9fd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">终端</em>将提供开箱即用的一些动态生成的配置文件:</p><ul class=""><li id="540f" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated"><em class="jd"> Cmd提示</em></li><li id="4235" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated"><em class="jd"> Windows Powershell </em></li><li id="8da6" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">天蓝色的云壳</li><li id="d844" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">您在<em class="jd">窗口</em>中安装的任何WSL</li></ul><p id="e160" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而且它还允许您定义不同配置文件，您可以从一个简单的访问选择列表中直接启动这些配置文件:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/b5284cb9627f0473820ad2d465cffba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*edwhRWw65dnif5rvTjELyg.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">决赛成绩</figcaption></figure><p id="13df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见，我能够为几个项目/账户定义几个<em class="jd">谷歌云外壳</em>配置文件。我发现这非常方便，让我们看看如何做。</p><h1 id="ce10" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">要求</h1><ul class=""><li id="e03e" class="jf jg hi ih b ii lh im li iq lj iu lk iy ll jc jk jl jm jn bi translated">Windows 10 1903(内部版本18362)或更高版本</li><li id="2bea" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated"><a class="ae je" href="https://www.microsoft.com/en-us/p/windows-terminal/9n0dx20hk701?activetab=pivot:overviewtab" rel="noopener ugc nofollow" target="_blank"> Windows终端</a></li><li id="4fcc" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated"><a class="ae je" href="https://cloud.google.com/sdk/docs/quickstart" rel="noopener ugc nofollow" target="_blank">谷歌云SDK </a></li><li id="138c" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated"><a class="ae je" href="https://www.microsoft.com/en-us/p/ubuntu/9nblggh4msv6?activetab=pivot:overviewtab" rel="noopener ugc nofollow" target="_blank"> Ubuntu WSL </a> ( <em class="jd">不完全是我的喜好:)</em>)</li></ul><h1 id="2223" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">步伐</h1><h2 id="460a" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated">登录您的帐户</h2><p id="f81b" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">打开WSL并登录到您的google帐户:</p><pre class="ju jv jw jx fd md me mf mg aw mh bi"><span id="5b4a" class="lm kk hi me b fi mi mj l mk ml">gcloud auth login {user_email}</span></pre><p id="e869" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">跟随浏览器中的链接，并向提示提供验证码。</p><h2 id="21ae" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated"><strong class="ak">定义切换脚本</strong></h2><p id="62df" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">让我们定义一个shell脚本来使用脚本参数切换帐户/项目，并使用<em class="jd"> Google Cloud SDK </em>启动一个指向<em class="jd"> Google Cloud Shell </em>的ssh会话:</p><pre class="ju jv jw jx fd md me mf mg aw mh bi"><span id="28e5" class="lm kk hi me b fi mi mj l mk ml">#!/bin/bash<br/>gcloud auth login $1<br/>gcloud config set project $2</span><span id="b395" class="lm kk hi me b fi mm mj l mk ml">gcloud cloud-shell ssh</span></pre><p id="4d6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以<em class="jd"> set-gcloud-env.sh </em>保存到~文件夹</p><h2 id="f90c" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated">生成guid</h2><p id="cebc" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">打开一个<em class="jd"> Windows Powershell </em>并使用命令:</p><pre class="ju jv jw jx fd md me mf mg aw mh bi"><span id="f3a8" class="lm kk hi me b fi mi mj l mk ml">[guid]::NewGuid()</span></pre><p id="6745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为下一步保存结果。</p><h2 id="53ea" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated">定义终端配置文件</h2><p id="ee48" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">从<em class="jd">终端</em>的选择列表中打开settings，这将导致一个<em class="jd"> setting.json </em>文件，让我们将一个具有所需属性的新元素添加到json对象的<em class="jd"> profiles.list </em>部分:</p><pre class="ju jv jw jx fd md me mf mg aw mh bi"><span id="355b" class="lm kk hi me b fi mi mj l mk ml">{</span><span id="f997" class="lm kk hi me b fi mm mj l mk ml">"guid": "{{guid_generated}}",</span><span id="be08" class="lm kk hi me b fi mm mj l mk ml">"name": "{client} {project_name}",</span><span id="06ce" class="lm kk hi me b fi mm mj l mk ml">"commandline": "wsl ~/set-gcloud-env.sh {user_email} {project_name}",</span><span id="3b40" class="lm kk hi me b fi mm mj l mk ml">"hidden": false</span><span id="e6ae" class="lm kk hi me b fi mm mj l mk ml">}</span></pre><p id="3c89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存<em class="jd"> settings.json </em>，不需要重启终端。</p><h2 id="f4a2" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated">结果</h2><p id="c663" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">从选择列表中点击上一步创建的配置文件:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es mn"><img src="../Images/9ae421eab7953791c319b57f9c391f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*geigw3a2Ppo5DxRqXPNTvQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">已连接到已配置的云外壳配置文件:)</figcaption></figure><p id="2a5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们成功地创建了一个工作的<em class="jd"> Google Cloud Shell </em>概要文件！</p><p id="7a74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一次连接会提示输入密码，生成个人ssh密钥并将公钥发布到<em class="jd">谷歌云外壳</em>，它还会修改你的<em class="jd"> ~/。ssh/已知_主机</em>。</p><p id="49a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对任何需要的轮廓重复上述步骤</strong>。</p><h2 id="31c7" class="lm kk hi bd kl ln lo lp kp lq lr ls kt iq lt lu kx iu lv lw lb iy lx ly lf lz bi translated">用户化</h2><p id="f283" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated"><em class="jd">终端</em>提供许多可定制的花哨属性，如:</p><ul class=""><li id="3e2b" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">图标</li><li id="d158" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">tabColor</li><li id="8fab" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">丙烯电容</li><li id="10e5" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi">…</li></ul><p id="892d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里找到关于可定制属性<a class="ae je" href="https://aka.ms/terminal-profile-settings" rel="noopener ugc nofollow" target="_blank">的文档。</a></p><h1 id="9f03" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">铌</h1><p id="d23e" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">与浏览器会话一样，<em class="jd"> Google Cloud </em>将保留您配置的机器，如果它在一段时间内不活动。在这种情况下，您需要使用选择列表重新启动配置文件，以便请求新的会话。</p><p id="0a97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再见。👋</p><p id="b76c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">铝</p><h1 id="ceaf" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">裁判员</h1><p id="9e37" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq ma is it iu mb iw ix iy mc ja jb jc hb bi translated">[1] <a class="ae je" href="https://aka.ms/terminal-documentation" rel="noopener ugc nofollow" target="_blank">终端文档</a></p><p id="ecb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2] <a class="ae je" href="https://github.com/microsoft/terminal/" rel="noopener ugc nofollow" target="_blank">终端github项目</a></p><p id="a3d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[3] <a class="ae je" href="https://aka.ms/terminal-profile-settings" rel="noopener ugc nofollow" target="_blank">终端的配置文件属性</a></p><p id="4f4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">【4】<a class="ae je" href="https://cloud.google.com/sdk/gcloud/reference/cloud-shell/ssh" rel="noopener ugc nofollow" target="_blank">g cloud云壳ssh命令</a></p></div></div>    
</body>
</html>