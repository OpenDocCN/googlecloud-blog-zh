<html>
<head>
<title>Hosting a static website on Google Cloud using Google Cloud Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌云存储在谷歌云上托管静态网站</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/hosting-a-static-website-on-google-cloud-using-google-cloud-storage-ddebcdcc8d5b?source=collection_archive---------0-----------------------#2019-08-17">https://medium.com/google-cloud/hosting-a-static-website-on-google-cloud-using-google-cloud-storage-ddebcdcc8d5b?source=collection_archive---------0-----------------------#2019-08-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="76e9" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在云中烹饪</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b1672f093ec244b078aefe83ec74e2dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxCIEg-zrRU-y8GLnWP7DQ.png"/></div></div></figure><h1 id="bdab" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">介绍</h1><p id="0f7b" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在这个迷你系列中，我们将介绍如何在谷歌云上创建网站。这是该系列的第二篇文章。</p><ol class=""><li id="b27b" class="kx ky hi kd b ke kz kh la kk lb ko lc ks ld kw le lf lg lh bi translated"><a class="ae li" rel="noopener" href="/@pvergadia/hosting-web-applications-on-google-cloud-an-overview-46f5605eb3a6">在谷歌云上托管网络应用:概述</a></li><li id="3e63" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw le lf lg lh bi translated">使用Google云存储在Google Cloud上托管一个web应用程序(本博客)</li><li id="68d4" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw le lf lg lh bi translated"><a class="ae li" rel="noopener" href="/google-cloud/hosting-a-website-on-google-cloud-using-cloud-run-a65343a98fce">使用Cloud Run在Google Cloud上托管web应用</a></li><li id="5af4" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw le lf lg lh bi translated"><a class="ae li" rel="noopener" href="/@pvergadia/hosting-a-website-on-google-cloud-using-google-compute-engine-c6fe84d76f51">使用谷歌计算引擎在谷歌云上托管网络应用</a></li><li id="e73c" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw le lf lg lh bi translated"><a class="ae li" rel="noopener" href="/p/d21d6ce3e837/">在谷歌计算引擎上扩展web应用</a></li><li id="3fe1" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw le lf lg lh bi translated"><a class="ae li" rel="noopener" href="/faun/case-study-hosting-scalable-web-apps-on-google-cloud-c0bb675812c8">案例研究</a></li></ol><p id="f4d8" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">假设你是一家小公司，想建立一个基本的网站。你不期望有很大的流量，也不想花很多钱来上网。因此，请继续阅读，了解如何通过部署静态网站从小处着手。</p><h1 id="0ff8" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">你会学到什么</h1><ul class=""><li id="6b1e" class="kx ky hi kd b ke kf kh ki kk lr ko ls ks lt kw lu lf lg lh bi translated">在谷歌云上创建静态网站</li><li id="a1af" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">将您的域名指向GCS</li><li id="4f82" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">创建存储桶，使用访问控制上传和共享文件</li><li id="9e55" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">设置索引页后缀和错误页</li><li id="ba7d" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">测试网站</li></ul><h1 id="6daa" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">先决条件</h1><ul class=""><li id="4b7d" class="kx ky hi kd b ke kf kh ki kk lr ko ls ks lt kw lu lf lg lh bi translated">阅读<a class="ae li" rel="noopener" href="/@pvergadia/hosting-web-applications-on-google-cloud-an-overview-46f5605eb3a6">第一篇文章</a>，它涵盖了关于在Google Cloud上建立网站的高级概念。</li></ul><h1 id="aefe" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">看看这个视频</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><h1 id="9a4d" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">什么是静态网站？</h1><p id="b47a" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">静态网站<strong class="kd hj"> </strong>对于像博客这样的网站来说是一个很好的选择——页面在发布后很少改变，或者没有任何动态生成的内容。静态网页可以包含HTML、CSS和JavaScript等客户端技术。它们不能包含动态内容，如服务器端脚本，如PHP。</p><h1 id="5990" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">如何在谷歌云上创建静态网站</h1><p id="1f76" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在我们开始之前，我们需要确保我们在谷歌云控制台中设置正确。确保以下事项:</p><ul class=""><li id="c4f5" class="kx ky hi kd b ke kz kh la kk lb ko lc ks ld kw lu lf lg lh bi translated">您已经创建了一个GCP项目</li><li id="6396" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">建立一个记帐帐户</li><li id="d329" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">您拥有或管理一个域名(这应该是顶级域名)。要验证您是否管理该域，请检查此处的<a class="ae li" href="https://cloud.google.com/storage/docs/domain-name-verification#verification" rel="noopener ugc nofollow" target="_blank"/>。</li></ul><p id="46ee" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">既然我们已经介绍了物流，那么设置静态web应用程序有四个步骤。</p><h2 id="c29b" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">步骤1:将您的域指向GCS</h2><p id="6bc5" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">第一步是将您的域连接到云存储。为此，创建一个指向c.storage.googleapis.com的CNAME记录。您的域名注册服务可以在这方面提供帮助。</p><blockquote class="ml mm mn"><p id="5414" class="kb kc mo kd b ke kz ij kg kh la im kj mp lo km kn mq lp kq kr mr lq ku kv kw hb bi translated"><a class="ae li" href="http://www.example.com" rel="noopener ugc nofollow" target="_blank">www.example.com</a>c.storage.googleapis.com<strong class="kd hj">CNAME</strong>。</p></blockquote><h2 id="0b9b" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">步骤2:创建链接到您的域的存储桶</h2><p id="4a7f" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">第二步是创建一个谷歌云存储桶。要做到这一点，浏览到谷歌云控制台，点击云存储，然后点击创建桶。确保存储桶名称与为您的域创建的CNAME相匹配。在这种情况下，存储桶应该被命名为【www.example.com】</p><h2 id="3711" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">第三步:上传并分享你网站的文件</h2><p id="69b7" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">第三步是上传你希望你的网站提供的文件。我们可以用两种方法之一来做这件事。</p><p id="ab13" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">首先，通过使用谷歌云控制台直接上传文件。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ms"><img src="../Images/65fddf4487f78f19d3ff66b10a13b6c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JDbCVbuyaZqbkSYp"/></div></div></figure><p id="8b64" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">第二，使用gsutil命令行，这对于已经有网站的用户来说非常有用。</p><p id="38eb" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated"><em class="mo">gsutil</em><strong class="kd hj"><em class="mo">rsync</em></strong><em class="mo">-R local-dir GS://www . example . com</em></p><h2 id="41f1" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">访问控制:</h2><p id="f0f4" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">一旦文件上传，我们需要确保它们被正确共享以供访问。您可以公开存储桶中的所有文件，也可以将单个对象设置为可通过您的网站访问。一般来说，让bucket中的所有文件都可以访问会更容易、更快。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mt"><img src="../Images/dbb38c1b235679127ae63fc643220b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qU9rQYupS3uWk4qi"/></div></div></figure><p id="6f41" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">在这一点上，我们基本上有一个功能正常的静态网站，但建议分配一个<strong class="kd hj">索引页面后缀</strong>和一个<strong class="kd hj">自定义错误页面</strong>来更好地指导用户。</p><h2 id="e956" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">索引页后缀和自定义错误页:</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mu"><img src="../Images/2f30c3e52d396d6f02fe28cedf47c4e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64BCRr3u1xvIYXn9ArkNxA.png"/></div></div><figcaption class="mv mw et er es mx my bd b be z dx translated">索引页后缀</figcaption></figure><p id="ecdf" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">这有助于假设你的桶<a class="ae li" href="http://www.example.com." rel="noopener ugc nofollow" target="_blank">www.example.com中没有名为<em class="mo"> apple </em>的文件。在这种情况下，如果用户请求URL</a><a class="ae li" href="http://www.example.com/apple," rel="noopener ugc nofollow" target="_blank">http://www.example.com/apple,</a>云存储试图提供文件<a class="ae li" href="http://www.example.com/directory/index.html" rel="noopener ugc nofollow" target="_blank">www.example.com/apple/index.html</a>。如果该文件也不存在，云存储将返回一个带有404响应的错误页面。</p><p id="920b" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">你可以在这里了解更多关于设置的信息<a class="ae li" href="https://cloud.google.com/storage/docs/hosting-static-website" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="4304" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">第四步:测试网站</h2><p id="d3ca" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">最后一步是测试我们的静态网站。通过在浏览器中请求域名，验证内容是从bucket提供的。</p><h2 id="924f" class="lx jk hi bd jl ly lz ma jp mb mc md jt kk me mf jv ko mg mh jx ks mi mj jz mk bi translated">在GCS上提供HTTPs内容</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/9fb76f218890b6b34153d3022cf5d295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4w7AMTciQHaiPBPzDCgZw.png"/></div></div><figcaption class="mv mw et er es mx my bd b be z dx translated">通过负载平衡器在GCS上提供HTTPs内容</figcaption></figure><p id="147b" class="pw-post-body-paragraph kb kc hi kd b ke kz ij kg kh la im kj kk lo km kn ko lp kq kr ks lq ku kv kw hb bi translated">需要注意的一点是，GCS只支持HTTP。为了服务于HTTPS，并获得所有的安全优势，我们需要使用CNAME重定向的直接URIs，或者迁移到使用负载平衡器作为前端，如图所示。</p><h1 id="40a1" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">结论</h1><p id="5c6f" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在本文中，我们学习了如何从小处着手，在Google云平台上部署一个静态web应用程序。我们使用<a class="ae li" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank"> Google云存储</a>来托管静态内容，并将域名指向存储桶。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es na"><img src="../Images/963eea7618b2d06eeb4fbd8d69736e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bY6M04ZQ1Sm603EASa1Z_g.png"/></div></div><figcaption class="mv mw et er es mx my bd b be z dx translated">在谷歌云平台上托管静态网站</figcaption></figure><h1 id="e088" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">后续步骤</h1><ul class=""><li id="bc95" class="kx ky hi kd b ke kf kh ki kk lr ko ls ks lt kw lu lf lg lh bi translated">在<a class="ae li" href="https://medium.com/google-cloud" rel="noopener">谷歌云平台媒体</a>上关注这个博客系列。</li><li id="5123" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">关注<a class="ae li" href="https://www.youtube.com/watch?v=pxp7uYUjH_M&amp;list=PLIivdWyY5sqIOyeovvRapCjXCZykZMLAe&amp;index=1" rel="noopener ugc nofollow" target="_blank">获取云端烹饪</a>视频系列，订阅谷歌云平台YouTube频道</li><li id="50b4" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">想要更多的故事？查看我的<a class="ae li" rel="noopener" href="/@pvergadia/">媒体</a>，<a class="ae li" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">在twitter上关注我</a>。</li><li id="3c0f" class="kx ky hi kd b ke lj kh lk kk ll ko lm ks ln kw lu lf lg lh bi translated">与我们一起享受这个系列的旅程，并了解更多关于Google Cloud的信息:)</li></ul></div></div>    
</body>
</html>