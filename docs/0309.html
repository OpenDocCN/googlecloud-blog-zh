<html>
<head>
<title>@From Zero to Hero — Run parse-server on google cloud platform part 3— Automatically obtain lets encrypt certificate for google container engine deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">@从零到英雄—在google云平台上运行parse-server第3部分—自动获取用于google容器引擎部署的加密证书</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/from-zero-to-hero-run-parse-server-on-google-cloud-platform-part-3-automatically-obtain-lets-d7db8994000a?source=collection_archive---------2-----------------------#2017-06-11">https://medium.com/google-cloud/from-zero-to-hero-run-parse-server-on-google-cloud-platform-part-3-automatically-obtain-lets-d7db8994000a?source=collection_archive---------2-----------------------#2017-06-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7855" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博客是关于如何在GCP容器引擎上运行解析服务器的<strong class="ih hj">系列博客</strong>的第3部分</p><p id="b65a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jd" rel="noopener" href="/google-cloud/from-zero-to-hero-run-parse-server-on-google-cloud-platform-part-2-deploy-and-run-parse-server-86e5d93296a3">第2部分</a>中，您学习了如何在Google容器引擎上部署和运行您的解析服务器Node.js后端和MongoDB。</p><p id="6faa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一部分中，您将学习如何通过lets encrypt api自动获取解析服务器实例的安全证书，并将自定义域(或子域)连接到解析服务器api端点。</p><h1 id="2f39" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">额外津贴</h1><ul class=""><li id="60a2" class="kc kd hi ih b ii ke im kf iq kg iu kh iy ki jc kj kk kl km bi translated">您已经阅读、理解并实现了本系列的第2部分。</li><li id="d109" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">您拥有有效的自定义域名(例如<a class="ae jd" href="http://www.myCustomDomain.com" rel="noopener ugc nofollow" target="_blank">www.myCustomDomain.com</a>等)。)</li></ul><h1 id="9dad" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">安全</strong></h1><p id="a755" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在生产中运行您的服务之前，您需要确保的最重要的事情是它是安全的。我不会在本系列中涵盖所有的安全方面，但重要的是要知道parse-server为您提供了一个非常好且稳定的安全机制，比如:身份验证(通过oAuth)、ACL(访问控制列表)、API和主密钥、用户会话等等。您自己需要注意的一件事是在HTTP层之上添加SSL/TLS层。换句话说，你只需要在<strong class="ih hj"> https模式</strong> <strong class="ih hj">下运行你的API！</strong></p><p id="e48b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第2部分中，您将解析服务器实例部署到google容器引擎，然后在它前面执行一些测试请求。如果您注意到您在那里使用的URL是:<strong class="ih hj">http://&lt;host _ IP _ address&gt;:&lt;port&gt;/parse/&lt;Class _ Name&gt;</strong>这对于开发/测试目的来说已经足够好了，但是在生产中绝对不推荐使用。这一部分的目的是向您展示如何运行相同的请求，但是这次使用https代替http，使用域名代替host_ip_address。因此，代替<strong class="ih hj">http://&lt;host _ IP _ address&gt;:&lt;port&gt;/parse/&lt;Class _ Name&gt;</strong>，您将使用<strong class="ih hj">https://myCustomDomain/parse/&lt;Class _ Name&gt;</strong>作为您的API端点。</p><h1 id="2b79" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">让我们加密和SSL/TLS证书(理论上)</h1><p id="67cd" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj"> SSL/TLS </strong></p><p id="c300" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SSL代表安全套接字层，TLS代表传输层安全性。该协议的目的是在您的服务器和应用程序之间提供加密链接。SSL/TLS是行业标准，被大多数网站/应用程序用来保护他们的客户。如果你想了解更多关于SSL/TLS的知识，我建议你去谷歌一下，或者看看youtube上解释它的视频，但你需要知道的最重要的事情是，当你在生产中运行任何服务时，请确保它是与SSL一起运行的。</p><p id="32cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">让我们加密</strong></p><p id="70d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://letsencrypt.org/about/" rel="noopener ugc nofollow" target="_blank">让加密</a>是一个伟大的服务，为你的网站或应用程序提供免费的SSL/TLS证书。lets encrypt最漂亮、最强大的特性是能够通过lets encrypt API为您的服务自动获取SSL证书。这个自动化过程如此重要的原因是由于证书的生命周期。通过lets encrypt获得的每个证书的有效期为3个月，因此，与其在到期日前几天运行手动续订流程，您可以自动化它并编写一些调度程序来为您的服务获得新的证书，这就是<a class="ae jd" href="https://github.com/jetstack/kube-lego" rel="noopener ugc nofollow" target="_blank"> kube-lego </a>的用武之地。</p><p id="127d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，let's encrypt还能为您节省金钱(如果您已经从某个提供商那里购买了一个，每年大约150-250美元)和时间(因为您可以自动完成这个过程)。这项服务是免费的，这真是令人惊讶。</p><h1 id="810a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> kube-lego和定制域名(</strong>理论上)</h1><p id="9138" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj"> kube-lego </strong></p><p id="0c81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">kube-lego是一个开源项目，它允许你为你的Kubernetes资源自动获得SSL/TLS证书。</p><p id="3781" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它是如何工作的(拍摄于kube-lego github页面):</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/3957fc035fb1e0272f496ab628b0bc18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dkv4Uzc34mIW9hf6TAhzKQ.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">kube-lego github页面</figcaption></figure><p id="9218" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">听起来很复杂，对吧？不要惊慌…把它想象成每隔X段时间运行一次的服务，并且<strong class="ih hj">自动</strong>为你获得证书。您甚至不需要更改默认配置。</p><p id="7704" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自定义域</strong></p><p id="7bda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自定义域是强制性的，以便使用kube-lego和加密。原因是当您生成SSL证书时，您必须提供要为其生成证书的域(例如api.myDomain.com)。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h1 id="9c68" class="je jf hi bd jg jh ls jj jk jl lt jn jo jp lu jr js jt lv jv jw jx lw jz ka kb bi translated">kube-乐高(实用)</h1><p id="f218" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj">将kube-lego部署到容器引擎</strong></p><p id="a3c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您需要做的第一件事是为您的kube-lego资源创建一个名称空间。创建新的命名空间非常简单，可以通过执行以下命令来完成:</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="0a4b" class="mc jf hi ly b fi md me l mf mg">kubectl create namespace kube-lego</span></pre><p id="c8b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查您的名称空间是否已创建，请通过打开浏览器导航到您的Kubernetes实例，并导航到<a class="ae jd" href="http://localhost:8001/ui" rel="noopener ugc nofollow" target="_blank"> http://localhost:8001/ui </a>，在左侧菜单中单击名称空间，并检查kube-lego名称空间是否列在那里。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mh"><img src="../Images/9c19ad11e6baaedc8f632b8f3f84ae92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXEQZdLnK3lv8k-rGBtFJw.png"/></div></div></figure><p id="48bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，转到visual studio代码，双击<strong class="ih hj"> parse-server-service.yml </strong>文件，将<strong class="ih hj"> type </strong>值从<strong class="ih hj"> LoadBalancer </strong>更改为<strong class="ih hj"> NodePort </strong>或简单地<strong class="ih hj">用这个文件复制并替换</strong>该文件的内容:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="a1b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这种变化的原因是因为负载平衡器将由<a class="ae jd" href="https://kubernetes.io/docs/concepts/services-networking/ingress/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">Kubernetes Ingress</strong></a><strong class="ih hj"/>资源处理，该资源是允许入站连接到达您的容器引擎集群服务的规则集合。在您的情况下，您的入口yml文件将定义2个规则:一个用于SSL，另一个用于负载平衡器。</p><p id="299f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，转到visual studio代码，右键单击container-engine文件夹并创建一个<strong class="ih hj">kube-Lego-config map . yml</strong>文件。这个配置文件将在运行时被kube-lego服务解析。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mk"><img src="../Images/4f941e0d405b61d73e62e01a7f4851ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*xOaUqBi9mmZ3S5e-mqM4uA.png"/></div></figure><p id="dfb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将以下要点的内容复制并粘贴到该文件中:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="924b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将<strong class="ih hj"> &lt;您的电子邮件地址&gt; </strong>更改为您有权访问的有效电子邮件地址。<strong class="ih hj"> lego.url </strong>键指向let加密staging api。如果您在生产环境中运行服务，您需要修改此URL并使用加密生产API。生产API的URL是:<a class="ae jd" href="https://acme-v01.api.letsencrypt.org/directory" rel="noopener ugc nofollow" target="_blank">https://acme-v01.api.letsencrypt.org/directory</a></p><p id="46c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在lego.email中添加您的电子邮件地址后，您就可以将该文件部署到Kubernetes了。为了部署此文件，请在您的终端中执行以下命令:</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="b79e" class="mc jf hi ly b fi md me l mf mg">kubectl apply -f container-engine/kube-lego-configmap.yml</span></pre><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es ml"><img src="../Images/24ac42effafea08ae183d993d1ff6ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*f1ZwyR7QG4e0Pli2Bk2zHA.png"/></div></figure><p id="0596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，转到visual studio代码，右键单击container-engine文件夹并创建一个<strong class="ih hj">kube-Lego-deployment . yml</strong>文件。将以下内容复制并粘贴到该文件中:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="c6ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个文件将在您的Kubernetes集群中创建kube-lego守护进程服务。kube-lego守护程序是负责为您自动化所有过程的服务。一旦kube-lego守护进程开始运行，它将:</p><ul class=""><li id="ad52" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">创建一个用户帐户(通过您的电子邮件地址)与加密</li><li id="82cc" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">在Kubernetes中自动创建一个服务资源(服务名是:kube-lego-gce)</li><li id="6e3b" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">查找具有以下注释的Kubernetes <strong class="ih hj"> Ingress </strong>资源:</li></ul><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="7d91" class="mc jf hi ly b fi md me l mf mg">metadata:<br/>  annotations:<br/>    kubernetes.io/tls-acme: "true"</span></pre><p id="07c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">kube-lego守护进程将监控和处理具有此注释的每个入口资源。</p><p id="4bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将解析服务器入口部署到容器引擎</strong></p><p id="fbd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转到visual studio代码，右键单击container-engine文件夹并创建一个<strong class="ih hj"> parse-server-ingress.yml </strong>文件。将以下代码复制并粘贴到该文件中:</p><figure class="kw kx ky kz fd la"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="786d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该文件将在集群中创建入口资源。它将创建负载平衡器，secret将托管您的let加密证书的密钥和其他相关资源，这将允许您使用SSL运行您的解析服务器。kube-lego守护进程唯一关注的部分是spec.tls列表，在那里您需要定义您的API端点URL并使用您的自定义域。</p><p id="3555" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将<strong class="ih hj">&lt;YOUR _ CUSTOM _ DOMAIN&gt;</strong>改为自己的自定义域名。我建议你创建一个子域(如api.myCustomDomain.com ),因为在kube-lego中，你可以用同一个守护进程为不同的服务生成多个证书，你唯一需要做的就是把它添加到你的入口主机，然后指向相关的服务。</p><p id="1908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">位于<strong class="ih hj">注释</strong>部分下面的行<strong class="ih hj">kubernetes.io/ingress.class:“gce”</strong>表示我们的入口将使用GCE负载平衡器来负载平衡集群中服务的流量。只有在google container engine上运行集群时，这一行才有意义。不使用GCE负载平衡器，您可以将这一行改为<strong class="ih hj"> nginx </strong>，将一个inginx服务部署到您的集群中，并使用它来实现集群中服务之间的负载平衡。因为我们在这个系列中使用GCP，所以我决定使用GCE负载平衡器，而不是自己处理和维护。如果你出于各种原因坚持维护自己的nginx控制器(例如，你不想为GCE负载平衡器资源付费)，你可以在<a class="ae jd" href="https://github.com/jetstack/kube-lego" rel="noopener ugc nofollow" target="_blank"> kube-lego github页面</a>中阅读如何做到这一点。</p><p id="f5d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在终端中执行以下命令，以便将入口资源部署到集群中:</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="14dc" class="mc jf hi ly b fi md me l mf mg">kubectl create -f container-engine/parse-server-ingress.yml</span></pre><p id="5531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您需要做的是将您的负载平衡器IP地址与您的自定义域连接起来。部署入口资源后，您的负载平衡器IP地址将在大约1–2分钟内可用。为了知道为您分配了哪个IP地址，请执行以下操作:</p><ul class=""><li id="3a19" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">打开浏览器，转到集群管理UI:<a class="ae jd" href="http://localhost:8001/ui" rel="noopener ugc nofollow" target="_blank">http://localhost:8001/UI</a></li><li id="970b" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">在左侧菜单中点击<strong class="ih hj">入口</strong></li><li id="d89b" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">IP地址应该位于<strong class="ih hj">端点</strong>列下</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mp"><img src="../Images/bd2eb324c6b13c0f2c5e340e5540c403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRMfIhK0LR4jdXuCHJBIKQ.png"/></div></div></figure><p id="c6ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">故障排除</strong>:如果由于某种原因，1-5分钟后你看不到IP地址，进入你的GCP控制台→网络→负载均衡，检查是否已经创建了负载均衡器。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mq"><img src="../Images/887763efe4cba2282645a5ae5be9597c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PXqNDYxuGYTpvohOrfaVpw.png"/></div></div></figure><p id="39fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您已经有了IP地址，是时候将它连接到您自己的自定义域了。就像我前面提到的，kube-lego需要一个域来获取证书，所以接下来你要做的就是将你自己的自定义域连接到你的入口负载平衡器URL。</p><h1 id="3612" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">自定义域(实用)</h1><p id="b384" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj">连接您的自定义域</strong></p><p id="5846" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成以下步骤，以便将您的自定义域连接到您的负载平衡器IP地址:</p><ul class=""><li id="9090" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">登录到您的域名提供商(在我的情况下是godaddy.com)</li><li id="f7a4" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">转到您的域管理器</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mr"><img src="../Images/e6a147fa2c12ac013a819ac0a0fa385a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*3pKcfodOM8fkaeiN3eshSw.png"/></div></figure><ul class=""><li id="bf44" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">从列表中选择您的域</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ms"><img src="../Images/7ce814b40c4712d0fd57ebcb7bc4d0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t5sPHjnS1SVI6H5xdRqLkQ.png"/></div></div></figure><ul class=""><li id="9b2c" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">转到DNS管理器</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mt"><img src="../Images/052e7e8799b47de08540f92183c7bf49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGnCTnyVm-hKhwBzkEH_3w.png"/></div></div></figure><ul class=""><li id="5760" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">创建一个新的子域，并通过创建一个新的<strong class="ih hj"> A记录</strong>将其连接到您的负载平衡器IP地址。主机名应该是api <strong class="ih hj"> </strong>(这是您的子域名)，它应该指向您的负载平衡器IP地址</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mu"><img src="../Images/3796d38b8757e0e3783c00619bb655ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MW26-Cva4bQB_uJ8bLe3ug.png"/></div></div></figure><ul class=""><li id="c63f" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">点击<strong class="ih hj">保存</strong>，确保您的新子域名已列出</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es mv"><img src="../Images/b7151a403c08118c4bdc868e675b5377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7g7kJLsOvcXMdL90kKUNCw.png"/></div></div></figure><p id="ac1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你唯一能做的就是等待(大约5-10分钟),让奇迹发生。在此期间，kube-lego守护进程将运行，创建一个新的加密帐户，如果需要，访问加密api的，并获得一个新的证书，最后通过Kubernetes的秘密资源将此证书附加到您的解析服务器服务。</p><h1 id="6978" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">测试你的API(实用)</strong></h1><p id="00b1" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">完成以下步骤，以检查您的API是否能与SSL/TLS一起工作</p><ul class=""><li id="bbd3" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">打开您的浏览器</li><li id="7512" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">导航到https://api。<your_custom_domain>/解析</your_custom_domain></li><li id="9a84" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">通过浏览器<strong class="ih hj">安全标志</strong>确保您的证书有效且您的API安全</li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mw"><img src="../Images/84b323512379b0637ec9c431bcc851e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*dznOl4Li-q6l1fmkl7FlzQ.png"/></div></figure><ul class=""><li id="46ab" class="kc kd hi ih b ii ij im in iq mm iu mn iy mo jc kj kk kl km bi translated">最后，打开POSTMAN并执行一个<strong class="ih hj"> GET </strong>请求，以获取在本系列第2部分中创建的所有任务，但是这次使用https和您的自定义域端点，并确保您获得相同的结果<strong class="ih hj"/></li></ul><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es mx"><img src="../Images/dd31c8ad0d35b8abb4c1efd6596d7a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*OaOj17R4nD706H1L_1SKDg.png"/></div></figure><h1 id="4dae" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">第3部分—总结</strong></h1><p id="5730" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">既然您的API是受SSL保护的，那么是时候了解如何在“真正的”应用程序中使用它了。在下一部分(第4部分)，我将向您展示如何创建一个使用解析服务器API的iOS应用程序。此外，我将解释如何利用parse-server高级安全机制(身份验证、授权等)为您的客户端创建一个安全的应用程序。</p></div></div>    
</body>
</html>