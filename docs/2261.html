<html>
<head>
<title>Using Cloud CDF to transform XML to JSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用云CDF将XML转换成JSON</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/using-cloud-cdf-to-transform-xml-to-json-6033c785b844?source=collection_archive---------0-----------------------#2022-07-14">https://medium.com/google-cloud/using-cloud-cdf-to-transform-xml-to-json-6033c785b844?source=collection_archive---------0-----------------------#2022-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c035" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，Dataplex只允许您存储和组织来自云存储buckets &amp; BigQuery的数据。Dataplex支持诸如Parquet、Avro、ORC、JSON &amp; CSV等格式。</p><p id="4658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是像XML这样的格式呢？或者，如果一个人将所有文件都存储在SFTP服务器上，而不是BigQuery或云存储中，会怎么样？Dataplex将如何支持(记住Dataplex只支持BQ或云存储)。</p><p id="8724" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这些情况下，方法之一是使用谷歌云数据融合(CDF)。Google CDF是一个可视化的点击式解决方案，用于构建ELT/ETL数据管道。CDF是由CDAP提供支持的托管解决方案。这些集成或管道可以手动触发，也可以预定/自动触发。您可以在下面给出的文档链接中了解更多信息。</p><p id="3e5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我和一个客户一起工作，他一直在探索Dataplex，但是他们的很多数据都以XML格式存储在Sftp服务器上。我们想设计一个管道，从这个SFTP服务器读取数据，将其转换为JSON &amp;然后写入Google云存储或BigQuery。本文将向您展示使用云数据流来构建这样一个管道是多么容易。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8e226a592ecf3b77d83b521c73e7c84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jEaK-0GtL5KkSJ7F"/></div></div></figure><p id="f5f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">先决条件</strong></p><ol class=""><li id="deb4" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">云数据融合</li><li id="2785" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">具有凭据的SFTP服务器</li><li id="97b2" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">带有示例XML文件的临时GCS存储桶</li><li id="1631" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">Google云存储中的目标GCS存储桶</li></ol><p id="25bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">从集线器部署FTP连接器</strong></p><ol class=""><li id="bd57" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">在云数据融合主页上，单击HUB</li><li id="0358" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">搜索FTP &amp;点击FTP插件v 3.0.0。这将部署FTP连接器，您可以稍后使用它来构建您的ETL过程。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/77eee506bab33be2181f9bfd8fc8cfe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*byipwPOzyi6KYGpk"/></div></div></figure><p id="3020" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">构建ETL流程</strong></p><ol class=""><li id="0f5e" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">从谷歌云数据融合选择争论。可以把Wrangler看作一个带有预定义解析器的转换工具。</li><li id="0aef" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">从GCS中选择Cloud Storage Default，并选择保存示例XML文件的临时存储桶&amp;从存储桶中选择一个示例XML文件。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl kd"><img src="../Images/e369bfd3dbfb5c6ab08972a1d34bc000.png" data-original-src="https://miro.medium.com/v2/0*QMX1ukXluRcAj6bV"/></div></figure><p id="c74c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.将数据类型更改为字符串。默认情况下，当您选择示例文件时，默认格式是byte。解析器接受String作为数据类型，这就是我们将类型改为String的原因</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/6d3820d8d04fa402b7c2bf3f552f940a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/0*OFOo0tiJ_Af3PVxc"/></div></figure><p id="91b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.在同一个选项卡上，也选择解析-&gt; XML到JSON &amp;选择“深度”为1。云数据融合有许多内置的解析器。您不仅可以将XML转换为JSON，还可以解析CSV，将数据转换为大写/小写，处理日期等。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/4ea7fc9504629ad04c1f9c6726cd5b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mn-98_jBA0MUcT0l"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/a41daa7da9f1368938af3d5519bd6bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8efUD1kDts6L2a10"/></div></div></figure><p id="a61b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.点击创建管道-&gt;批处理管道。还要注意，在这个阶段，您应该能够看到您选择的样本XML的相应JSON。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b86186fcead8f175d1df54e32f9d7031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5jcakt-qLTKRbX1v"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/c549c26ec1a46c680439306de4dbbf4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jKgxdMtrwMT43Dtu"/></div></div></figure><p id="d866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.从接收器中选择“GCS ”,从源中选择“FTP”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/cf0a6977d29a8f65278c5d57466e6fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U0dEVYXlC04rk75q"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/402a52d8c4994e00bb0ec54a24ebc2bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bIT7rfxBI6hUFDLw"/></div></div></figure><p id="28ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.删除现有的源，即GCS文件，并将FTP设置为源。完成布线。在这个阶段，你的画布应该是这样的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/61392f0453a17626dff2984069ccd5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kSaqrJs655eoLbyi"/></div></div></figure><p id="b0fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.点击源FTP并在属性中提供您的SFTP详细信息。为了简单起见，我给出了我希望转换的xml文件的完整路径(例如:sftp://username:password @ hostname:22/path/to/xmlfile . XML ),然后单击Validate</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1886f9327291741e06ab63f1fe6abd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sdGto2PClAeiNLLZ"/></div></div></figure><p id="3841" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9.回到画布，点击牧马人属性。您应该看到该指令被自动设置为将类型设置为String &amp;将XML解析为Json。还要注意，输出模式应该是XML要转换到的JSON模式。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0591324b024950b64dfd67161dae9664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yMC1DE5yl-uje-Wq"/></div></div></figure><p id="ddbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10.回到画布上，单击Sink上的云存储。提供诸如需要上传JSON的存储桶路径、格式为JSON和内容类型为application/json的信息</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2647d0f7c56628f09e8d2b00fbcf5608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wj7oNQvVnXKfOT77"/></div></div></figure><p id="d7a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">11.在画布上单击Preview-&gt;Run，现在您应该能够将XML转换成JSON，它的源是SFTP</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/24e9aa1be08fb0dbb0af6c8daf9891ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A8FtYHgLIevBY7Xq"/></div></div></figure><h2 id="bdc8" class="kh ki hi bd kj kk kl km kn ko kp kq kr iq ks kt ku iu kv kw kx iy ky kz la lb bi translated">摘要</h2><p id="a358" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">您可以看到，在用户界面中点击几下，构建这样的管道是多么容易。云数据融合提供了150多个连接器，可用于实现各种ELT/ETL用例。首先，你可以使用谷歌云数据融合或者在你的笔记本电脑上安装CDAP框架。我推荐使用本地安装进行开发，因为它更加灵活，并且允许您调试复杂的流程。开发完成后，您可以随时导出和导入项目。</p><p id="dfb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是提供更多信息的一些链接</p><ol class=""><li id="de3c" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><a class="ae lh" href="https://cdap.io/get-started/" rel="noopener ugc nofollow" target="_blank"> CDAP开源框架</a> —</li><li id="371f" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae lh" href="https://cloud.google.com/data-fusion/" rel="noopener ugc nofollow" target="_blank">谷歌云数据融合文档</a> —</li><li id="ede9" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated"><a class="ae lh" href="https://cloud.google.com/dataplex" rel="noopener ugc nofollow" target="_blank"> Google Dataplex文档</a> —</li></ol></div></div>    
</body>
</html>