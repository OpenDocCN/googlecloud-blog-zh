<html>
<head>
<title>GCP — BigQuery — Data Security at rest (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP — BigQuery —静态数据安全性(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcp-bigquery-data-security-at-rest-part-1-2a6fe1394c41?source=collection_archive---------3-----------------------#2022-11-15">https://medium.com/google-cloud/gcp-bigquery-data-security-at-rest-part-1-2a6fe1394c41?source=collection_archive---------3-----------------------#2022-11-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="89b8" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">经常可以看到，由于安全控制的放松，组织由于数据丢失或数据被盗或数据泄露而受到很大的惩罚。这种泄漏不仅会影响组织的财务，还会使客户的数据面临被滥用的风险。</p><p id="ebef" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这篇博客是“Bigquery —静态数据安全”5部分系列文章的一部分。这篇博客是这个系列的第一部分。<br/>点击此处查看<a class="ae jh" rel="noopener" href="/google-cloud/gcp-bigquery-data-security-at-rest-series-menu-1e59e1793deb">系列菜单</a></p></blockquote><p id="0aa0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">随着云技术的出现，数据安全性是决定采用云技术的首要驱动因素。</p><p id="1b29" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">虽然安全性是一个非常广泛的话题，包括硬件安全、网络安全、软件补丁、访问控制、静态数据和传输中的数据，但本博客将重点关注可用于保护大查询中<strong class="il hj">静态数据的安全实现。</strong></p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="3bda" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">概观</h2><p id="4d30" class="pw-post-body-paragraph ii ij hi il b im kn io ip iq ko is it ji kp iw ix jj kq ja jb jk kr je jf jg hb bi translated">下图显示了一组选项，这些选项可以根据需要单独使用，也可以一起使用。根据每种安全控制提供的安全性的性质，我将这些安全控制分为静态和动态。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ks"><img src="../Images/34cfaa93c06bdc8958cdbb3eff79f503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHbXZ4n0NLf9EF_cGpYppA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">高级安全控制</figcaption></figure><blockquote class="if ig ih"><p id="7d9e" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">客户端加密将不作为本系列的一部分，因为它本身是一个广泛的主题。</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="9901" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">访问控制(IAM)</h2><p id="5d7d" class="pw-post-body-paragraph ii ij hi il b im kn io ip iq ko is it ji kp iw ix jj kq ja jb jk kr je jf jg hb bi translated">IAM 可以被认为是提供受控资源访问的第一个入口点。<br/>了解可以与Bigquery交互的不同角色非常重要。<br/>下面是<a class="ae jh" href="https://cloud.google.com/iam/docs/understanding-roles" rel="noopener ugc nofollow" target="_blank">角色列表</a>(不详尽)，这些角色拥有与大查询交互的权限。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es li"><img src="../Images/1ce295b757c40ff5c5269a37009070b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SHzK7fETzqB_qnc6DSeMg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">具有Bigquery权限的角色</figcaption></figure><p id="0d2f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">有一些角色具有类似于<strong class="il hj">数据目录</strong>、<strong class="il hj"> DLP </strong>和<strong class="il hj">数据复用</strong>的服务，这些服务可以提供对大查询数据的<strong class="il hj">直接访问</strong>。<br/>除了这些角色之外，还有<strong class="il hj">安全管理员和审核者、</strong>T23】推荐者和<strong class="il hj">大查询迁移角色</strong>，这些角色拥有大查询权限的足迹。</p><blockquote class="if ig ih"><p id="d5f1" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">大的查询角色可以在不同的粒度上被授权，例如:项目、数据集、表级别。请按照最低特权原则彻底检查。</p><p id="c1ea" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">评估为服务客户适当提供任何管理员角色的需求。</p><p id="771b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">了解每个角色中授予的权限，并遵循最小特权原则提供访问权限</p><p id="6928" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">不要向主体授予单独的权限，如果需要，创建一个自定义角色并分配给组。</p><p id="ba63" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">重要说明</strong> — <strong class="il hj">服务代理角色</strong>确实提供了对大型查询的访问，但不应授予委托人，它们是用于服务用途的。他们拥有强大的权限，可以随时更改。</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="b00e" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">信息有限的表/视图</h2><p id="4dbb" class="pw-post-body-paragraph ii ij hi il b im kn io ip iq ko is it ji kp iw ix jj kq ja jb jk kr je jf jg hb bi translated">确保有限暴露的最简单的方法之一是创建具有有限信息的第二层表格。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lj"><img src="../Images/2c8ed90ed729a1008bb34ab5d32e158f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlJhFJRIrFHRwxYgVQ9t8g.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">外观层-包含有限信息的表</figcaption></figure><p id="3e56" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">在这种类型的设置中，来自原始层的敏感列不会暴露给用户。<br/>用户只能访问所需的<strong class="il hj">派生表</strong>，其中包含用例所需的有限信息。</p><p id="1f06" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">假设有一个原始表——customers _ raw，包含以下信息</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lk"><img src="../Images/cb848f23256ea2697f7df976ed3e92bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNsL-esOVkYP-Ez03q3gpA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">客户原始表的架构</figcaption></figure><p id="46f6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">让我们创建另一个只显示有限信息的表，如下所示</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ll"><img src="../Images/98b1bbbaac80f09358aa173b94ee34cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Porvw2E1bP1R4lemNZGLjg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">客户信息有限的表格</figcaption></figure><p id="7d98" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">上表中有使用<strong class="il hj"> SHA1 </strong>函数散列的<strong class="il hj">名字</strong>列。<br/>栏目<strong class="il hj"> SSN </strong>和<strong class="il hj">已婚</strong>未曝光消费。</p><blockquote class="if ig ih"><p id="9cd3" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">优点<br/> 1。</strong>这种模式有其优势，因为父表信息或与谱系的任何关系都不会显示出来，因为这是一个完全不同的物化表，有自己的存储。<br/> 2。当数据消费的用例非常清楚时，这种模式就可以工作<br/> 3。对于重复的查询模式，命中派生表的查询可以被缓存和提供，此外，它可以有自己的分区和聚类方案</p><p id="6fcf" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">注意事项</strong> <br/> 1。如果事先不知道这些模式，那么这可能很容易导致大量零碎信息的产生。<br/> 2。这需要设置存储过程或预定查询来定期刷新<br/> 3。创建的派生表需要自己的存储</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="5205" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">授权数据集/视图</h2><blockquote class="if ig ih"><p id="dd6b" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">为什么授权视图？对于普通视图，权限也需要在基表中提供，因为视图反过来查询基表。</p></blockquote><p id="70e7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">授权视图可以认为是<strong class="il hj">视图</strong>具有<strong class="il hj">显式授权</strong>访问基表数据。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lm"><img src="../Images/dabefb7c73a729e8ea5f1a4004e2b680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EF7gttSTOIlrkV4giVV7ow.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">授权视图</figcaption></figure><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ln"><img src="../Images/ac57e9c9b918970de67221818e74be0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CJCMNCbEgLs2D3OMmng_hQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">父数据集-共享选项</figcaption></figure><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lo"><img src="../Images/8873601437921403e0d78577a1bc695c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4mhJ-Q6f0svVFCVwDY_2g.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">父数据集授权子视图</figcaption></figure><p id="ff52" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated"><strong class="il hj">授权数据集</strong>是一个场景，其中一组视图聚集在一个数据集中，整个数据集由父数据集授权。</p><figure class="kt ku kv kw fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lp"><img src="../Images/ec2682026173edac176baf335f0f3a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W1zIQ2vNqR7CsnwFMltwbg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">授权数据集</figcaption></figure><p id="bc26" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">授权数据集被授权用于将来创建的新视图。</p><blockquote class="if ig ih"><p id="868a" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">优点<br/> 1。</strong>不需要在基表<br/> 2上提供显式访问。因为视图本质上是逻辑的，所以不需要提供任何额外的存储。</p><p id="603e" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">注意事项<br/> 1。</strong>授权视图是对每个查询执行的视图，并且依赖于基表进行任何分区或集群设置<br/> 2。该视图当前在数据集级别授权，而不是在单个表或视图级别授权。</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="2e80" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">数据加密</h2><p id="d169" class="pw-post-body-paragraph ii ij hi il b im kn io ip iq ko is it ji kp iw ix jj kq ja jb jk kr je jf jg hb bi translated">默认情况下，Bigquery中的所有数据都使用<a class="ae jh" href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" rel="noopener ugc nofollow" target="_blank"> AES加密</a>(高级加密标准)进行静态加密。</p><p id="a952" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">作为附加的安全机制，Bigquery支持整个数据集的CMEK(客户管理的加密密钥)。加密密钥由云KMS管理。</p><blockquote class="if ig ih"><p id="3209" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">对于由CMEK加密的数据集/表，bigquery服务帐户需要云KMS密钥的附加角色-加密器/解密器</p><p id="16b1" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">优点</strong> <br/> 1。通过加密提供额外的安全层<br/> 2。适合安全合规性要求</p><p id="45f3" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">注意事项</strong>T12】1。从更新密钥到它们的最新版本，需要手动处理密钥轮换。<br/> 2。如果不使用不同的加密选项<br/> 3重新创建表格，则无法在默认和CMEK之间切换。批处理查询需要提及destination_kms_key选项，查询才能正常工作。<br/> 4。提到的带有默认客户密钥加密的数据集不能有没有客户密钥加密的表。</p></blockquote></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="9556" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">我们将在系列的第2部分<a class="ae jh" rel="noopener" href="/google-cloud/gcp-bigquery-data-security-at-rest-part-2-f4e3c741c162">中介绍动态安全控制。</a></p><p id="52c6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">如有任何疑问，请通过https://www.linkedin.com/in/murli-krishnan-a1319842/<a class="ae jh" href="https://www.linkedin.com/in/murli-krishnan-a1319842/" rel="noopener ugc nofollow" target="_blank">与我联系。</a></p><p id="af79" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it ji iv iw ix jj iz ja jb jk jd je jf jg hb bi translated">快乐学习。</p></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><h2 id="cbb5" class="js jt hi bd ju jv jw jx jy jz ka kb kc ji kd ke kf jj kg kh ki jk kj kk kl km bi translated">参考</h2><p id="6fd5" class="pw-post-body-paragraph ii ij hi il b im kn io ip iq ko is it ji kp iw ix jj kq ja jb jk kr je jf jg hb bi translated"><a class="ae jh" href="https://services.google.com/fh/files/misc/designing_and_deploying_data_security_strategy.pdf" rel="noopener ugc nofollow" target="_blank">设计和部署数据安全策略</a> <br/> <a class="ae jh" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/aead-encryption-concepts" rel="noopener ugc nofollow" target="_blank"> AEAD —关联数据的认证加密</a><br/><a class="ae jh" href="https://developers.google.com/tink/bind-ciphertext" rel="noopener ugc nofollow" target="_blank">AEAD的使用案例</a> <br/> <a class="ae jh" href="https://cloud.google.com/iam/docs/understanding-roles" rel="noopener ugc nofollow" target="_blank"> IAM角色和权限</a></p></div></div>    
</body>
</html>