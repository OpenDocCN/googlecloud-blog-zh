# GCS 存储桶的安全建议

> 原文：<https://medium.com/google-cloud/security-advice-for-gcs-buckets-6a6e9825d49f?source=collection_archive---------1----------------------->

几乎每个非平凡的网站都会有存储需求。作为谷歌开发者的拥护者，我一直在使用谷歌云存储，并与客户谈论他们在 GCS 方面的问题和困难。在这些讨论中，安全问题出现过几次。虽然我不能告诉你如何使你的桶和对象 100%安全，但是我可以给你一些基本的建议，这些建议是非常普遍适用的。这些信息的绝大部分来自于我在 12 月初对一个典型用例中的 GCS 存储桶的安全性进行的为期一周的研究。

# 把你的证件留给你自己

我知道不应该共享密码、[服务账户](https://cloud.google.com/iam/docs/understanding-service-accounts)、 [API 密匙](https://cloud.google.com/docs/authentication/api-keys)或其他秘密，这似乎是显而易见的。然而，泄露凭据是安全问题的常见来源。公认的最佳实践是每个人和每个应用程序都应该有自己的凭证。这使得删除一个人的权限变得容易，而不会影响存储桶的任何其他用户。它还可以让您了解谁在使用您的审计日志做什么。但是仅仅给每个人分配一个帐户是不够的。因为一名工程师的证书被泄露，所以发生了一些引人注目的泄密事件。确保凭据的存储足够安全，适合您的使用情形。键盘托盘下的一张纸并不安全，但它比将凭证(或点文件)签入公共源代码库要安全得多。如果您使用密码管理器或将凭据签入源代码，则凭据仅作为密码管理器或源代码库是安全的。

# 存储桶名称是可发现的

当我开始在云中存储数据时，我并不清楚存储桶名称经常会被任何人发现。复杂的是，在 GCS 和其他云存储提供商中，存储桶名称必须是全球唯一的。在这些约束下，将您的项目、公司、应用程序甚至个人证书放入 bucket name 中是一个不错的主意。我过去常常这样做，因为很容易想到一个以“aja-”为前缀的惟一的 bucket 名称。一旦我意识到一个足够积极的人可以探查我的桶，我就从桶名中取出所有个人信息。根据您访问存储桶的内容，对象名称也可能出现在 URL 中，因此也可能出现在浏览器或防火墙日志中。同样，这也是不将秘密放入对象名的另一个好理由。在官方存储最佳实践文档中，Google Cloud 建议如果您需要很多存储桶，使用 [guids](https://cloud.google.com/storage/docs/best-practices) 作为存储桶名称。

# 仔细检查权限

我的最后一个技巧是定期审计权限和 ACL。当我仔细检查项目的权限时，我发现了配置错误的存储桶。也许您正在设置概念验证，并在整理应用程序的其余部分时使您的 bucket 全局可读。我们中的大多数人偶尔会做这样的事情，但是如果这个 bucket 以相同的权限存在于产品中，就会成为一个问题。使用 GCS，大多数项目使用 IAM 权限，但是如果您需要对同一个 bucket 中的对象拥有不同的权限，您可能需要使用 [ACLs](https://cloud.google.com/storage/docs/access-control/if) 列表。当我深入研究 GCS 权限时，我发现我对不同作用域的含义做出了不正确的假设。例如，我假设“AllAuthenticatedUsers”的范围意味着我的云项目的所有用户。当我阅读文档时，我意识到它指的是拥有谷歌账户的任何人。如果我想将访问权限仅限于我项目的合作者，我可以用其他范围来实现。当然，许多项目都有充分的理由让 bucket 具有全局可读性。也许您正在使用存储桶来存储 web 应用程序的资产，或者也许您正在使用存储桶来存储与他人共享的科学数据集。只要确保权限适合您的用例，并设置一个提醒来经常审核它们，以确保您的用例没有改变。
这篇博文只涉及了几个要点。在你把你的应用投入生产之前，我建议你在[谷歌云网站](https://cloud.google.com/storage/docs/best-practices)上阅读更多关于谷歌云存储最佳实践的信息。与博客帖子不同，该文档会不断更新。

01/17/18

*原载于 2018 年 1 月 17 日*[*www.thagomizer.com*](http://www.thagomizer.com/blog/2018/01/17/securing-gcs-buckets.html)*。*