<html>
<head>
<title>Google Cloud Storage Tutorial Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google云存储教程第1部分</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-storage-tutorial-part-1-aee81f9d3247?source=collection_archive---------0-----------------------#2015-02-21">https://medium.com/google-cloud/google-cloud-storage-tutorial-part-1-aee81f9d3247?source=collection_archive---------0-----------------------#2015-02-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/4db4ae9df03a8d61537b7803ab4363ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*lcRm2muyWDct3FW2drmptA.png"/></div></figure><p id="4af9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在过去的几天里，我一直在钻研谷歌云存储(GCS)。你可能会认为这是谷歌云平台的一个无聊的方面，因为云存储已经存在了一段时间，但我在探索中发现了一些惊喜。让我们从一个简单的概述开始:</p><ul class=""><li id="6012" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><a class="ae jt" href="http://cloud.google.com/storage" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">谷歌云存储</strong> </a>不是<a class="ae jt" href="https://www.google.com/drive/" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj">谷歌驱动</strong> </a>。Google Drive是一种面向消费者的文件存储和同步服务，允许用户存储文档、共享文件以及与合作者编辑文档，并且它具有允许开发人员扩展它的API。谷歌云存储是面向开发者和系统管理员的文件存储解决方案，具有允许应用程序存储和检索对象的API。它具有全局边缘缓存、版本控制、OAuth和粒度访问控制、可配置的安全性等特性..</li><li id="3d36" class="jk jl hi io b ip ju it jv ix jw jb jx jf jy jj jp jq jr js bi translated">谷歌云存储建立在谷歌庞大的全球基础设施之上。想想谷歌提供的所有文件，包括YouTube视频等。规模之大，尺度之大，超出了大多数人的理解。我最近参观了许多谷歌数据中心中的一个(这是非常难得的待遇，即使对谷歌人来说也是如此！)，这让我对谷歌的巨大规模有了一点了解，它彻底改变了我对“可扩展”和“快速”的定义。</li><li id="310b" class="jk jl hi io b ip ju it jv ix jw jb jx jf jy jj jp jq jr js bi translated">谷歌云存储有一个基本功能的web界面，但我更喜欢使用命令行工具<a class="ae jt" href="https://cloud.google.com/storage/docs/gsutil" rel="noopener ugc nofollow" target="_blank"> gsutil </a>。此外，命令行工具公开了更多的功能。还有<a class="ae jt" href="https://cloud.google.com/storage/docs/concepts-techniques" rel="noopener ugc nofollow" target="_blank">API(XML和JSON) </a>，我们将在后面的文章中介绍。</li></ul><h2 id="9014" class="jz ka hi bd kb kc kd ke kf kg kh ki kj ix kk kl km jb kn ko kp jf kq kr ks kt bi translated">初始设置:</h2><ul class=""><li id="973d" class="jk jl hi io b ip ku it kv ix kw jb kx jf ky jj jp jq jr js bi translated">如果你还没有谷歌云平台账户，你可以在<a class="ae jt" href="http://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">http://cloud.google.com</a>创建一个。如果你以前从未注册过，你可以获得60天300美元的免费试用(截至本文撰写之时)。</li><li id="cf61" class="jk jl hi io b ip ju it jv ix jw jb jx jf jy jj jp jq jr js bi translated">安装http://cloud.google.com/sdk<a class="ae jt" href="http://cloud.google.com/sdk" rel="noopener ugc nofollow" target="_blank">的谷歌云平台SDK。</a></li><li id="cb49" class="jk jl hi io b ip ju it jv ix jw jb jx jf jy jj jp jq jr js bi translated"><a class="ae jt" href="https://cloud.google.com/storage/docs/signup" rel="noopener ugc nofollow" target="_blank">创建一个项目，并为该项目激活Google云存储</a>(项目是Google云资源的逻辑分组——存储、服务、用户、实例等。).创建一个项目需要一个web浏览器，但是一旦你创建了它，你就可以使用命令行工具做几乎所有的事情。记下您的项目ID。在本文的剩余部分，我将使用“<strong class="io hj"> gwprojectid </strong>”。</li><li id="886b" class="jk jl hi io b ip ju it jv ix jw jb jx jf jy jj jp jq jr js bi translated">我们需要将我们的新项目设置为Google Cloud命令行工具的默认项目，否则我们将不得不对每个命令使用“<strong class="io hj"> -p gwprojectid </strong>”。要设置默认项目，请键入:<strong class="io hj">g cloud config set project GW projectid</strong></li></ul><h2 id="17e8" class="jz ka hi bd kb kc kd ke kf kg kh ki kj ix kk kl km jb kn ko kp jf kq kr ks kt bi translated">使用gsutil工具</h2><p id="59c1" class="pw-post-body-paragraph im in hi io b ip ku ir is it kv iv iw ix kz iz ja jb la jd je jf lb jh ji jj hb bi translated">下面是一个简单的存储和检索文件的例子。首先，我们需要创建一个bucket——用于存储文件的基本容器。因为所有的存储桶名称共享全局名称空间，所以它需要在整个Google Cloud中是唯一的。当我们开始通过http公开共享文件时，你会在后面的文章中看到为什么会这样。对于这个例子，我将使用一个名为“gwbucket”的桶。引用存储桶时，您需要指定URL，例如<strong class="io hj">GS://【bucket name】</strong>。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="6483" class="jz ka hi lh b fi ll lm l ln lo">#Create a bucket:<br/><strong class="lh hj">gsutil mb gs://gwbucket</strong></span><span id="0933" class="jz ka hi lh b fi lp lm l ln lo">#Copy some files to the bucket:<br/><strong class="lh hj">gsutil cp *.jpg gs://gwbucket</strong></span><span id="ec11" class="jz ka hi lh b fi lp lm l ln lo">#List the files in the bucket:<br/><strong class="lh hj">gsutil ls -l gs://gwbucket</strong></span><span id="3b4e" class="jz ka hi lh b fi lp lm l ln lo">#Copy a file from our bucket back to the local /tmp directory<br/><strong class="lh hj">gsutil cp gs://gwbucket/sunset.jpg /tmp</strong></span><span id="c366" class="jz ka hi lh b fi lp lm l ln lo">#Delete the files:<br/><strong class="lh hj">gsutil rm gs://gwbucket/*</strong></span><span id="45a2" class="jz ka hi lh b fi lp lm l ln lo">#Remove the bucket:<br/><strong class="lh hj">gsutil rb gs://gwbucket</strong></span></pre><p id="1afb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">还没有什么太令人兴奋的，但是您很快就会发现这些命令很熟悉。您可以将“-r”添加到大多数命令中，使其递归，如预期的那样。在<a class="ae jt" href="https://cloud.google.com/storage/docs/gsutil" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/storage/docs/gsutil</a>或从命令行使用<strong class="io hj"> gsutil help cp </strong>可获得所有命令的详细帮助</p><p id="eb73" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是另一个使用<a class="ae jt" href="https://cloud.google.com/storage/docs/gsutil/commands/rsync" rel="noopener ugc nofollow" target="_blank"> rsync </a>和<a class="ae jt" href="https://medium.com/p/aee81f9d3247/edit" rel="noopener">版本控制</a>的例子:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="5581" class="jz ka hi lh b fi ll lm l ln lo">#Create a new bucket:<br/><strong class="lh hj">gsutil mb gs://gwnewbucket</strong></span><span id="6ae3" class="jz ka hi lh b fi lp lm l ln lo">#Turn on versioning for the bucket<br/><strong class="lh hj">gsutil versioning set on gs://gwnewbucket</strong></span><span id="280c" class="jz ka hi lh b fi lp lm l ln lo">#rsync the current directory to our new bucket<br/>#Adding -m to run multiple parallel processes (speed boost)<br/><strong class="lh hj">gsutil -m rsync -r -d . gs://gwnewbucket</strong></span><span id="9a90" class="jz ka hi lh b fi lp lm l ln lo">#List all of the files in the bucket:<br/><strong class="lh hj">gsutil ls -lr gs://gwnewbucket</strong></span></pre><p id="fc7c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jt" href="https://cloud.google.com/storage/docs/object-versioning" rel="noopener ugc nofollow" target="_blank">了解更多关于对象版本控制的信息</a> <br/> <a class="ae jt" href="https://cloud.google.com/storage/docs/gsutil/addlhelp/TopLevelCommandLineOptions" rel="noopener ugc nofollow" target="_blank">了解更多关于-m选项的信息</a></p><p id="a1f8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注:以上示例使用默认时段分类“标准”和默认时段位置“美国”。要了解其他选项，请参见<a class="ae jt" href="https://cloud.google.com/storage/docs/gsutil/commands/mb#bucket-storage-classes" rel="noopener ugc nofollow" target="_blank">这些文档</a>。</p><p id="a7e9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用了上面的最后一个例子(版本控制行除外)将我的120，000+图像库备份到Google云存储中。每当我添加/修改/删除图像时，我简单地重复<strong class="io hj"> gsutil rsync。</strong></p><p id="4f1b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="lq">(在rsync上使用-d选项时要非常小心，因为它会从目标中删除任何已经从源中删除的文件。如果你有任何疑问，我建议使用&lt; strong &gt; -n &lt; /strong &gt;选项。-n选项使rsync以“模拟运行”模式运行，即只输出将要复制或删除的内容，而不进行任何复制/删除。)</em></p><p id="cb6b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我的下一篇文章中，我将展示如何设置bucket对象生命周期管理，以便在对象达到一定年龄时配置自动删除，或者简单地保留特定对象的最后n个版本。当进行定期备份时，例如每晚归档日志文件等，这成为一个关键特性。然后，我将向您展示如何通过HTTP公开共享对象，以及如何利用Google的全球边缘缓存来提供非常快速的文件下载。</p></div></div>    
</body>
</html>