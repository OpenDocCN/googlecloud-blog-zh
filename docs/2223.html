<html>
<head>
<title>Google Cloud — Billing Budgets and Alerts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云——计费预算和警报</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-billing-budgets-and-alerts-fc707ac1c2e4?source=collection_archive---------2-----------------------#2022-06-16">https://medium.com/google-cloud/google-cloud-billing-budgets-and-alerts-fc707ac1c2e4?source=collection_archive---------2-----------------------#2022-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e94b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我听到的关于云的最大担忧之一是意外成本。例如，我听说过许多人尝试云，意外地积累了大量账单，因为大型虚拟机运行时间太长，低效的数据库查询处理了太多数据，旧项目没有得到妥善清理。使问题更加复杂的是，人们直到几天后账单到达时才知道这些意想不到的费用。意想不到的成本让人们不敢进一步探索云，并可能在短期内损害云计划。在Google Cloud中解决这一问题的一种方法是使用<a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets" rel="noopener ugc nofollow" target="_blank">计费预算和警报</a>。顾名思义，预算和提醒允许您设置一个预算，并在您超出预算时提醒您。预算和警报在谷歌云中监控成本，易于设置，是控制意外成本的有效工具。</p><p id="767b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要设置<a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets" rel="noopener ugc nofollow" target="_blank">计费预算和警报</a>，请在谷歌云控制台中转至“<em class="je">计费→预算和警报”</em>。选择<em class="je">创建预算</em>。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/55c7c61aa13367581c803a95ce601edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AImI_Btc06ytlGq7hndLLw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">计费和提醒起始页</figcaption></figure><p id="e605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第1步</strong>:输入预算名称。默认情况下，指定整个计费帐户的每月预算，但您可以更改时间范围，并使用项目、服务和标签过滤器选择特定的资源。此外，默认情况下会选择折扣和积分，因此您会收到净支出通知，但如果您希望收到总支出通知，您可以取消选中它们。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jv"><img src="../Images/420d42c7b96ad53950e01c20bd036b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blOSUpy_KsGurUPqW_CITA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">创建预算</figcaption></figure><p id="abcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步</strong>。指定你的每月预算。在这个例子中，我设定每月预算为1000美元。还有一个选项，通过从<em class="je">“预算类型”</em>下拉菜单中选择<em class="je">“上个月的支出”</em>，使用上个月的支出作为目标金额，这将自动将预算填充为您上个月的支出金额。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/f7c5ce0c2ad8adf4ea776234a6396dcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OLMnXRrb2Is4IRoicsKqzg.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">设定预算</figcaption></figure><p id="2ebf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步</strong>:设置预警阈值规则。默认情况下，当实际支出超过预算的50%、90%和100%时，将触发警报。还有一个选项可以触发预测支出的警报。所有值都是可配置的。您甚至可以添加或删除阈值。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/aa6b3a08b4ac154d1bb0102763ebc270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VQrGzyld7TCot-bSI3IGA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">设置警报阈值</figcaption></figure><p id="c8bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第四步</strong>:管理通知。有三种通知选项:</p><ol class=""><li id="dc8d" class="jx jy hi ih b ii ij im in iq jz iu ka iy kb jc kc kd ke kf bi translated">向计费管理员和用户发送电子邮件提醒。</li><li id="e245" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated">将监控电子邮件通知渠道链接到此预算。</li><li id="2f5f" class="jx jy hi ih b ii kg im kh iq ki iu kj iy kk jc kc kd ke kf bi translated">将发布/订阅主题连接到此预算。</li></ol><figure class="jg jh ji jj fd jk er es paragraph-image"><a href="https://cloud.google.com/billing/docs/how-to/budgets"><div class="er es kl"><img src="../Images/996f9488ec05ed9485d20f3d7a00ed10.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*IIldoOi6HfLcojlp5sG56Q.png"/></div></a><figcaption class="jr js et er es jt ju bd b be z dx translated">谷歌云预算警报选项</figcaption></figure><p id="7273" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选项1:向计费管理员和用户发送电子邮件提醒:</strong>默认提醒行为将向计费管理员和计费用户发送电子邮件。该复选框已被选中。</p><p id="f180" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选项2: </strong> <a class="ae jd" href="https://cloud.google.com/monitoring/support/notification-options" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">将监控邮件通知渠道链接到该预算</strong> </a> <strong class="ih hj"> : </strong>如果您想向其他邮件地址发送预警，您可以选择“<em class="je">将监控邮件通知渠道链接到该预算</em>”。首先，你需要设置一个<a class="ae jd" href="https://cloud.google.com/monitoring/support/notification-options" rel="noopener ugc nofollow" target="_blank">云监控邮件通知通道</a>。</p><p id="942f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要设置电子邮件通知通道，请转至“<em class="je">监控→警报”</em>。然后选择<em class="je">“编辑通知频道”</em>。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/7a00690ddda4627716d3a29ba0efdd50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rfUnd55JlsYv89mTfbo-A.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">监控和警报</figcaption></figure><p id="628f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有几个通知渠道可用，但<a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets-notification-recipients#how-to-setup" rel="noopener ugc nofollow" target="_blank">只有电子邮件渠道支持</a>云计费预算和警报。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/c97d764a7f3797dfd1762f51309cfe5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krjYRiXoBIH7o5CNOTWXQA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">编辑通知渠道</figcaption></figure><p id="270e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加新的或编辑现有的电子邮件渠道。在本例中，电子邮件提醒将发送到群组电子邮件“alerting-noreply@google.com”。可以将多个电子邮件地址添加到通知通道，但请注意，最多只能向5个电子邮件地址发送计费警报。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es km"><img src="../Images/9d35e9dff31ca9876ed14b3744777570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qnhe6N0jxc6DnLlqzwCOfA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">配置发送警报的电子邮件</figcaption></figure><p id="814f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">返回“预算和预警配置”页面，选择您配置的电子邮件通知。通知通道中最多可以选择五个电子邮件收件人。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es kn"><img src="../Images/3c53290181bb7672e0fa3fa09feb750c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phQiLEDl6ksGKRsFRQJUbw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">发送到电子邮件通知通道的警报</figcaption></figure><p id="55c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选项三:</strong> <a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets-programmatic-notifications" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">自动化成本控制</strong> </a> <strong class="ih hj"> : </strong>有一个程序化的通知选项，用于自动化成本控制。一般的想法是，警报被发送到一个发布/订阅主题，一个程序订阅该主题，然后程序在收到警报时采取行动。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ko"><img src="../Images/a827f10cc040c8e7e23e824647bbae20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDvW-y0J1LRnqrs8d1YfVw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">使用发布/订阅实现自动化成本控制</figcaption></figure><p id="8e6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Google Cloud提供了<a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/notify" rel="noopener ugc nofollow" target="_blank">示例参考架构</a>，它结合了云发布/订阅和云功能，将警报重定向到Slack，并自动禁用计费以防止成本失控。您可以编写自己的云函数来发出警报。</p><pre class="jg jh ji jj fd kp kq kr ks aw kt bi"><span id="f4ec" class="ku kv hi kq b fi kw kx l ky kz">Warning: Disabling billing on a project will cause <em class="je">all</em> Google Cloud services in the project to terminate, including <a class="ae jd" href="https://cloud.google.com/free/docs/gcp-free-tier" rel="noopener ugc nofollow" target="_blank">free-tier services</a>. Therefore, programatically disabling billing would only be appropriate in development or sandbox environments.</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es la"><img src="../Images/c25252159ce52be1e1490c465689f9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/0*s2A9iT5mVlCLp9zB.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">发布/订阅通知的参考架构示例</figcaption></figure><p id="7a39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤5: </strong>预算配置完成后，预算将出现在主仪表板上。您可以根据需要创建任意多的预算来监控和控制成本。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jw"><img src="../Images/0351225ad58cd9943526ede1d7ca71d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLM_gTRa_IV6gPPrSdgzCg.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">预算和预警列表</figcaption></figure><h2 id="f5bd" class="ku kv hi bd lb lc ld le lf lg lh li lj iq lk ll lm iu ln lo lp iy lq lr ls lt bi translated">摘要</h2><p id="d7f0" class="pw-post-body-paragraph if ig hi ih b ii lu ik il im lv io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">预算和警报在谷歌云中监控和控制成本。您设置一个预算，当超过特定阈值时就会触发警报。警报可以发送到电子邮件通知或发布/订阅主题进行编程控制。通过使用预算和预警，您可以防止意外成本。</p><h2 id="50b9" class="ku kv hi bd lb lc ld le lf lg lh li lj iq lk ll lm iu ln lo lp iy lq lr ls lt bi translated">进一步观察</h2><figure class="jg jh ji jj fd jk"><div class="bz dy l di"><div class="lz ma l"/></div></figure><pre class="jg jh ji jj fd kp kq kr ks aw kt bi"><span id="72bf" class="ku kv hi kq b fi kw kx l ky kz"><strong class="kq hj">Further Reading:</strong></span><span id="8987" class="ku kv hi kq b fi mb kx l ky kz"><a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets" rel="noopener ugc nofollow" target="_blank">Google Cloud: Create, edit, or delete budgets and budget alerts</a><br/><a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets-notification-recipients" rel="noopener ugc nofollow" target="_blank">Google Cloud: Customize budget alert email recipients</a><br/><a class="ae jd" href="https://cloud.google.com/monitoring/support/notification-options" rel="noopener ugc nofollow" target="_blank">Google Cloud: Manage notification channels</a><br/><a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/notify" rel="noopener ugc nofollow" target="_blank">Google Cloud: Examples of automated cost control responses</a><br/><a class="ae jd" href="https://cloud.google.com/billing/docs/how-to/budgets-programmatic-notifications" rel="noopener ugc nofollow" target="_blank">Google Cloud: Manage programmatic budget alert notifications</a><br/><a class="ae jd" rel="noopener" href="/google-cloud/google-cloud-export-billing-data-to-bigquery-ce004fb87ce3">Medium: Google Cloud - Export Billing Data to BigQuery</a></span></pre></div></div>    
</body>
</html>