<html>
<head>
<title>Handling Sensitive Data on the Google Cloud Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在谷歌云平台上处理敏感数据</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/handling-sensitive-data-on-the-google-cloud-platform-12dac6a6b044?source=collection_archive---------1-----------------------#2018-12-14">https://medium.com/google-cloud/handling-sensitive-data-on-the-google-cloud-platform-12dac6a6b044?source=collection_archive---------1-----------------------#2018-12-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0ae2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作者维克多·桑克和斯蒂安·德库伯，军情六处工程师@军情六处</p><p id="5818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数字世界中的隐私在公众意识中越来越重要。我们与无数不同的公司和政府共享大量数据。他们可能会利用这些数据做好事，他们甚至可能在大多数时候负责任地使用这些数据，但隐私不仅仅是表现良好。它是关于试图以这样一种方式建立系统，即使在未来，当法律、规范和道德发生变化时，也没有人能够使用这些数据来反对原始所有者。这不是关于你可能必须隐藏什么，<strong class="ih hj">而是关于不允许任何人替你决定。T3】</strong></p><p id="2c99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是GDPR出现的原因。它并没有禁止公司使用你的数据，它只是<strong class="ih hj">要求你有选择权</strong>。但即使一家公司被允许使用这些个人数据，在数据保护和安全方面也有严格的规定要遵循。除了在生产环境中，不允许使用个人数据之类的规则，以及严格的加密要求，促使公司认真审视他们是如何处理数据的。</p><p id="884f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在ML6，<strong class="ih hj">我们经常从事需要我们处理敏感数据的机器学习项目</strong>。近年来，深度学习的突破和TensorFlow等软件的发布为令人兴奋的新软件应用扫清了道路，这些应用通常涉及图像、音频或文本文件等非结构化数据。<strong class="ih hj">然而，识别和屏蔽非结构化数据中的敏感部分并不总是简单明了的，</strong>有时甚至无法使用基于规则的方法。在本文中，我们将<strong class="ih hj">说明如何使用谷歌云机器学习服务来识别和屏蔽非结构化数据集中的敏感数据</strong>。我们将从一些Google云视觉示例开始，然后强调如何通过结合云视觉和云自然语言来解决更复杂的问题。正如我们将展示的，这些服务功能强大，利用最先进的模型获得高度准确的结果，并且可以轻松集成到现有服务中或作为上游处理管道。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="d809" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了跟进，你需要创建一个谷歌云平台(GCP)项目。如果你还没有账户:试用期持续1年，你可以花300美元。在这里创建你的第一个项目<a class="ae jl" href="https://console.cloud.google.com/cloud-resource-manager" rel="noopener ugc nofollow" target="_blank">，并确保</a><a class="ae jl" href="https://cloud.google.com/billing/docs/how-to/modify-project" rel="noopener ugc nofollow" target="_blank">启用</a>。谷歌云控制台是一个通用的地方，在这里你可以管理你想在GCP做的任何事情。在我们的例子中，我们需要<strong class="ih hj">云视觉API </strong>和<strong class="ih hj">云自然语言API </strong>。</p><p id="b7ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了认证，你需要创建一个<a class="ae jl" href="https://console.cloud.google.com/apis/credentials/serviceaccountkey" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">服务账户</strong> </a>，它基本上允许你编写的任何软件独立访问GCP项目。从下拉菜单中选择<strong class="ih hj">新服务账户</strong>并输入名称。出于我们的测试目的，让我们只给该帐户<strong class="ih hj">所有者角色</strong>，这样它就可以访问所有内容。最后一步，下载<strong class="ih hj"> JSON keyfile </strong>，并将环境变量<strong class="ih hj">GOOGLE _ APPLICATION _ CREDENTIALS</strong>设置为它的路径。您的程序将使用这个密钥文件作为一种身份验证形式。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">设置GOOGLE_APPLICATION_CREDENTIALS环境变量来设置身份验证</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="1690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用谷歌云视觉<br/> </strong>屏蔽车牌在全球范围内，仅在2017年我们就集体拍摄了约<strong class="ih hj"> 1.2万亿张照片。所有这些数据都被用于机器学习应用，从物体检测到无人驾驶汽车。但在很多场景中，图像的部分对机器学习模型来说既不重要，又高度敏感。自动驾驶汽车其实不在乎车牌，只在乎有障碍。谷歌街景也有同样的问题:行人的脸对于一个好的街景来说是不必要的，但他们仍然是可见的，我们想保护这些人的隐私。</strong></p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/e7ff4fdabcd963d4ada7ea05a189e2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VRiab5RtJXZJtMih71rPwQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">谷歌的云视觉API能够在图像中进行强大的对象和文本检测。你可以在https://cloud.google.com/vision/亲自尝试一下</figcaption></figure><p id="66b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是有趣的部分:<strong class="ih hj">代码</strong>！</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="aa01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从进口开始。谷歌云包中的视觉模块能够与GCP的视觉API对话。我们将向它发送汽车图片，并希望检测它们的牌照。我们使用PIL打开图像，绘制隐藏车牌的黑盒并保存图像。我们使用io来打开映像和操作系统，以确保路径跨平台工作。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="b1cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在代码的注释中看到对每个组件的解释，但基本上我们创建了一个函数，它将图像的路径作为输入，并保存图像的审查版本。注意，也可以通过REST API调用大多数Google云服务，包括这里讨论的那些。下面是一个脚本工作的例子。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ke"><img src="../Images/0cf44f16176055c8a529fbb83b66949a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCA8DwN4oWSq2E-NlWaTzg.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">正常图像</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ke"><img src="../Images/20960a9647c4efcac7cf09c3ca1ab926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KjjBcuUdQO5rqg18WH_bPA.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">车牌被遮住了！</figcaption></figure><p id="1ef9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">掩蔽人脸<br/> </strong>现在我们有了基本代码，知道该做什么，我们可以将这种方法应用到云视觉识别的其他各种类别:人脸、地标、徽标……下面是扩展我们之前的示例的代码，使其具有检测人脸的能力。您可以尝试一下，并插入上述每个类别，作为匿名化您的数据的附加方法。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kf"><img src="../Images/a8c3e3175c16ad141ff0dd2200fb0619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14QUyfpbMJdeNVGNrfhezA.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">正常人玩得开心</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kf"><img src="../Images/509ca751edac56cf99fb2d7d1c85dbd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AhUU9dFuRJwwKQZfuKnOiA.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">正常人私下找乐子</figcaption></figure><p id="d48b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这段代码看起来和上面的几乎一样！多酷啊。这非常容易做到，你可以创建尽可能多的这些功能(甚至组合它们)，并通过它们运行你的照片进行完整的匿名扫描。</p><p id="0e21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">匿名商店收据:云视觉和云自然语言</strong></p><p id="fadb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在车牌示例中，我们使用云视觉通过检测和屏蔽图像中的所有文本来模糊车牌。如果我们只想屏蔽某些类型的文本呢？输入云自然语言。自然语言API提供开箱即用的实体识别、情感分析甚至语法分析，目前支持10种主要语言。</p><p id="93c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有商店收据扫描数据集，出于隐私原因，我们希望屏蔽掉客户或员工的姓名。简单地检测和屏蔽所有文本会导致我们丢弃所有信息。另一种方法是首先使用Vision API从扫描中提取所有文本，然后使用实体识别来检测哪些文本实际上是名称。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kg"><img src="../Images/0118b7312ede23f8f2391d4c0e9326e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VtTyEClMOIaCPlnip3Zm-A.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">云自然语言提供现成的语义文本分析和实体识别。对于我们的商店收据，API可以帮助我们识别文档中的名字。结合云视觉，很容易建立一个管道，屏蔽图像中的名称。<a class="ae jl" href="https://cloud.google.com/natural-language/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/natural-language/</a></figcaption></figure><p id="4d3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们确定了名称，就可以直接使用上面的代码将其屏蔽掉:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kh"><img src="../Images/642c07292a5fe6954d3d70d48435eb49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSXzgmoQ_o_vMWFQNAY5kQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">左图:我们扫描的商店收据。右图:通过云视觉和云自然语言，我们只需几行代码就可以匿名化收据，而不会丢失任何其他信息。</figcaption></figure><p id="f882" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就实现而言，与前面示例的主要区别是对云自然语言的额外调用。实际上，这意味着只需要两行额外的代码:</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="d4ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">云语音和云视频<br/> </strong>除了视觉和自然语言服务，GCP还提供用于语音到文本以及视频分析和注释的API。虽然我们不会在这里讨论这些服务，但是它们显然也可以用于识别和屏蔽敏感数据。一个例子是从语音样本中自动提取和屏蔽姓名(例如，客户服务电话)，首先通过云语音转换为文本，然后调用云自然语言进行实体识别。</p><p id="3021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">云数据丢失防护<br/> </strong>一个额外的选择是利用GCP的数据丢失防护API。它主要针对文本数据，并允许检测和编辑敏感数据，如信用卡号码，电话号码和姓名。此外，它还可以处理文本流，这样，在数据写入磁盘之前，就可以对其进行编辑。因此，它非常适合实时应用。</p><p id="2246" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">但是，我的数据发送到Google Cloud时安全吗？<br/> </strong>是的。通过HTTPS向GCP服务发送数据，通过TLS连接确保安全性，这意味着您可以确保将数据发送到正确的接收方，并且您的数据在传输过程中是加密的。更普遍的情况是，谷歌云平台在将数据写入磁盘之前，默认会对所有数据进行加密。此外，每个数据块的加密密钥本身都是用一组主密钥加密的，GCP提供了多种管理这些密钥的方法，从自动管理到由客户管理主密钥并保存在内部。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="eeee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在ML6，我们在将机器学习集成到软件产品方面拥有丰富的经验，无论是通过使用谷歌云API还是通过构建定制解决方案来解决更复杂的问题。对于任何项目，隐私保护都是我们优先考虑的事情，我们相信我们在解决未来复杂的ML问题上处于领先地位。</p><p id="19d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要了解更多关于GCP机器学习API的信息，请参考<a class="ae jl" href="https://blog.ml6.eu/digitizing-and-cataloging-the-boekentoren-book-tower-ffc0070793ac" rel="noopener ugc nofollow" target="_blank">本博客</a> t，其中我们讨论了如何使用云视觉为根特大学数字化超过一百万张目录卡。</p></div></div>    
</body>
</html>