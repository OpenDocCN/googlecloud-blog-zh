<html>
<head>
<title>Using the Google Cloud SDK with Powershell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Google Cloud SDK与Powershell结合使用</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/using-the-google-cloud-sdk-with-powershell-dacbd3581208?source=collection_archive---------0-----------------------#2018-04-16">https://medium.com/google-cloud/using-the-google-cloud-sdk-with-powershell-dacbd3581208?source=collection_archive---------0-----------------------#2018-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bbd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="http://cloud.google.com/sdk" rel="noopener ugc nofollow" target="_blank"> Google Cloud SDK </a>包括一个名为<code class="du je jf jg jh b">gcloud</code>的命令行工具，方便管理<a class="ae jd" href="http://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Cloud </a>资源。例如，我可以用它来观察和修改一个<a class="ae jd" href="https://cloud.google.com/appengine/docs/flexible/" rel="noopener ugc nofollow" target="_blank"> App Engine </a>应用。在这里，我列出了一个App Engine应用程序的所有版本:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><p id="a7c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">观察我的应用程序的当前状态很好，但是如果我真的想用这些信息做些什么呢？上面的输出看起来像Powershell表，但实际上，它只是文本。如何用Powershell解析输出？</p><h1 id="38a5" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><code class="du je jf jg jh b">gcloud</code> + <code class="du je jf jg jh b">ConvertFrom-Json</code></h1><p id="dca4" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><code class="du je jf jg jh b">gcloud</code>和<a class="ae jd" href="https://docs.microsoft.com/en-us/powershell/scripting/powershell-scripting?view=powershell-6" rel="noopener ugc nofollow" target="_blank"> Powershell </a>的<code class="du je jf jg jh b"><a class="ae jd" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-json?view=powershell-6" rel="noopener ugc nofollow" target="_blank">ConvertFrom-Json</a></code> cmdlet是为对方制作的。<code class="du je jf jg jh b">gcloud</code>可以将其所有输出格式化为json，<code class="du je jf jg jh b">ConvertFrom-Json</code>将json转换为原生Powershell对象。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><p id="3a6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的例子中，我让这两个特性为我服务。</p><h1 id="6979" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">删除旧的应用引擎版本</h1><p id="ffed" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我有一个<a class="ae jd" href="https://cloud.google.com/appengine/docs/flexible/" rel="noopener ugc nofollow" target="_blank">应用引擎</a>应用程序，它的旧版本已经不再运行，如下面<code class="du je jf jg jh b">SERVING_STATUS</code>栏中的<code class="du je jf jg jh b">STOPPED</code>所示。我想删除这些旧版本。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><p id="618c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我添加了<code class="du je jf jg jh b">--format json</code>标志来将<code class="du je jf jg jh b">gcloud</code>的输出格式化为json。然后，我将结果传输到<code class="du je jf jg jh b">ConvertFrom-Json</code>以将输出转换为Powershell对象:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><p id="a823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我添加了一个过滤器来查找被停止的版本:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><p id="27e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我用所有停止的版本id调用<code class="du je jf jg jh b">gcloud app versions delete</code>来删除它们:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure><h1 id="07b7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="e82e" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><code class="du je jf jg jh b">gcloud</code>的json输出和Powershell的<code class="du je jf jg jh b">ConvertFrom-Json</code> cmdlet让操作谷歌云资源的重复性任务自动化变得很容易。现在<a class="ae jd" href="https://docs.microsoft.com/en-us/powershell/scripting/setup/installing-powershell-core-on-macos-and-linux?view=powershell-6" rel="noopener ugc nofollow" target="_blank"> Powershell运行在Linux和Mac </a>上，你也可以在那些平台上使用这些相同的技术！</p><p id="a01a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个组合语句，它一步就完成了所有工作:</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="jn jo l"/></div></figure></div></div>    
</body>
</html>