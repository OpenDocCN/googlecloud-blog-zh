<html>
<head>
<title>Seamless deployments for servers in an autoscaler group of instances.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在自动扩展的实例组中无缝部署服务器。</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/seamless-deployments-for-servers-in-an-autoscaler-group-of-instances-8b5cedc0aa5b?source=collection_archive---------0-----------------------#2016-02-01">https://medium.com/google-cloud/seamless-deployments-for-servers-in-an-autoscaler-group-of-instances-8b5cedc0aa5b?source=collection_archive---------0-----------------------#2016-02-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6d76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由Powerupcloud的高级云架构师Roger撰写。原载于2016年2月1日<a class="ae je" href="http://blog.powerupcloud.com/2016/02/01/google-compute-engine-jenkins-deployments-for-autoscaler-servers/" rel="noopener ugc nofollow" target="_blank"><em class="jd">【blog.powerupcloud.com】</em></a><em class="jd">。</em></p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><p id="835d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何无缝地部署到负载均衡器后面的一堆web服务器和自动缩放器的一部分？部署过程应该提取<a class="ae je" href="https://cloud.google.com/compute/docs/instance-groups/" rel="noopener ugc nofollow" target="_blank">实例组</a>中的服务器列表，以确保由于扩展而出现的新实例也运行相同版本的代码。以下是解释设置小型Jenkins服务器和配置部署的步骤。本教程假设部署到tomcat。</p><h2 id="1eab" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">启动Jenkins服务器</h2><p id="08e1" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">登录控制台，为Jenkins启动一个小实例。确保使用compute-ReadOnly启用API访问。这使得在该实例上运行的应用程序可以与API交互，并获取有关实例组、列表IP等的信息。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es km"><img src="../Images/04cbb7756078c7826949f5eb85602d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/0*ygl__nGtXT84ymxa.png"/></div></figure><h2 id="de88" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">安装詹金斯</h2><pre class="kn ko kp kq fd ku kv kw kx aw ky bi"><span id="0459" class="jm jn hi kv b fi kz la l lb lc">apt-get update </span><span id="db40" class="jm jn hi kv b fi ld la l lb lc">wget -q -O - <a class="ae je" href="http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key" rel="noopener ugc nofollow" target="_blank">http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key</a> | apt-key add - echo deb <a class="ae je" href="http://pkg.jenkins-ci.org/debian" rel="noopener ugc nofollow" target="_blank">http://pkg.jenkins-ci.org/debian</a> binary/ &gt; /etc/apt/sources.list.d/jenkins.list </span><span id="9d2e" class="jm jn hi kv b fi ld la l lb lc">apt-get update </span><span id="8ad8" class="jm jn hi kv b fi ld la l lb lc">apt-get install jenkins</span></pre><p id="b261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有时您可能会看到类似于<em class="jd">Jenkins E:Sub-process/usr/bin/dpkg返回了一个错误代码(1) </em>的异常，这可以使用<em class="jd"> sudo apt-get -f install </em>来修复。对于其余的jenkins在Ubuntu上的设置，你可以遵循这个指南<a class="ae je" href="https://wiki.jenkins-ci.org/display/JENKINS/Installing+Jenkins+on+Ubuntu" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a812" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在詹金斯创建第一个工作，去自由式项目，并给出一个参考名称，然后单击确定。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/f9d9d9dc33804bf2d1d3632309bf3e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vly3zcEOIK99uGVK.png"/></div></div></figure><p id="f496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从“添加构建”步骤中选择执行外壳选项。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lj"><img src="../Images/c09e3dbcd6b336bfd77479d59f364a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z5j0ZLXtUjH-VYCx.png"/></div></div></figure><p id="6b18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">传递下面的脚本并点击保存选项。下面的脚本使用了google cloud命令行实用程序gcloud。详情请查看评论。</p><figure class="kn ko kp kq fd kr"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/2b8b994e12e30d2aa959ee6ecfa0459c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YjpVMZtMXF11XHyQ.png"/></div></div></figure><p id="1fb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击Save，build就可以部署了！</p><h2 id="1231" class="jm jn hi bd jo jp jq jr js jt ju jv jw iq jx jy jz iu ka kb kc iy kd ke kf kg bi translated">先决条件</h2><p id="8386" class="pw-post-body-paragraph if ig hi ih b ii kh ik il im ki io ip iq kj is it iu kk iw ix iy kl ja jb jc hb bi translated">为Jenkins添加ssh密钥以登录到应用服务器实例，这可以使用计算引擎部分下的元数据从google cloud控制台完成。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/929430f9e6595209bc8ec1affa2723e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sqVMk_6ah2W-GLS4.png"/></div></div></figure><p id="fe8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Jenkins服务器应该启用api访问，如本文开头所述。</p><p id="693a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">部署时，服务器的FTP位置应该包含所有WAR文件和现有的WAR，这样就不会与正在运行的文件冲突。</p><p id="d285" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这有用。部署愉快！:)</p></div></div>    
</body>
</html>