<html>
<head>
<title>Access Control in BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery中的访问控制</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/access-control-in-bigquery-d5d800654f47?source=collection_archive---------0-----------------------#2022-04-27">https://medium.com/google-cloud/access-control-in-bigquery-d5d800654f47?source=collection_archive---------0-----------------------#2022-04-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/fcb9fddd6163708101d953ffd1757247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5xYx2KgLQaTN8l3yFidiiA.png"/></div></figure><p id="e5e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">简介</strong></p><p id="347d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本文解释了如何在大查询中控制访问。在组织中从事GCP项目时，安全性起着至关重要的作用。作为最佳实践，我们应该遵循为用户分配最小特权的方法。一旦用户拥有大型查询服务的项目级IAM角色，默认情况下，用户将能够访问所有数据集/表/视图。我们将看到如何在数据集级别、表级别以及列和行级别限制访问。</p><p id="55f3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在数据集级别限制访问</strong></p><ol class=""><li id="0ff7" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">转到云控制台，导航到Bigquery控制台。</li><li id="51fc" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">展开项目以查看可用的数据集。</li></ol><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/376bdc2769c3fdcc3736af4d70a20766.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*y1TfUHAix7Tn0rPmdBcLcw.png"/></div></figure><p id="4fad" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.打开数据集，例如本演示中的演示</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/7dac1c21ead7012a48bfd96530a2929c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*F_jiMWQDdDNHWP_6hin6qQ.png"/></div></figure><p id="dd70" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4.点击共享</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ke"><img src="../Images/03a28478fd3a555a65bd22f435b8df59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZiBNXZXUyrsNhCQJSHYJw.png"/></div></div></figure><p id="b4aa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">5.点击添加委托人</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/79dc87cfd06da07d311d387d2e522ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*XwDXlz3Z-ALpISVI3AoQ4Q.png"/></div></figure><p id="4fb3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">6.输入用户电子邮件id并分配所需的角色。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/35c72c7a4fed015770b4d041b1ed1440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*tjDnMDpTrD3-H9_YTWTWXA.png"/></div></figure><p id="9a16" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">7.现在，验证用户和只能看到演示数据集的用户的访问权限。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kl"><img src="../Images/5978fe54a7dde76f0bbbf38fe2c302d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eEUjqr18SFbHINTCuSiH8A.png"/></div></div></figure><p id="fbfc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这样，我们可以在数据集级别限制访问。</p><p id="908c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">限制表级访问</strong></p><p id="5e4f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在假设我们有一个需求，我们希望用户只看到表1中的数据，而不是表2中的数据，那么我们需要在表级别限制访问。</p><ol class=""><li id="f7c0" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">转到表1，单击共享</li></ol><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es km"><img src="../Images/9a5f02ef9208a2cd4a95b347ae6c40a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtJxjeItA6y5F663M6rMyA.png"/></div></div></figure><p id="d20e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.点击添加委托人</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/2fb6f0d850bcf128ee241b9a06c4966f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*sHrlyGL3pcRsoL-H73ahog.png"/></div></figure><p id="c25e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.输入用户电子邮件并分配所需的角色。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/b09b838fb4874b9b22be57ca4b7e0cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*mHns9wg3FVGerpRCLxW2Lw.png"/></div></figure><p id="5443" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4.请注意，在此步骤之后，您可能无法在数据资源管理器中看到该表，但是您可以访问该表。尝试在表上运行查询。</p><p id="6328" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意—如果运行查询时出现错误，请从IAM添加角色<strong class="io hj"> BigQuery作业用户</strong>。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kp"><img src="../Images/0717066948488f50f6d6a37c43dcc8a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cxR6aaq-ipgAr9ZsntYmhQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx translated">能够访问表1</figcaption></figure><p id="5aa8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因为我们只提供了对table-1的访问，所以在table-2上运行查询将会抛出一个错误。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ku"><img src="../Images/8917eb9d2c917a8ea8f2c80a4213acc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AaeIhN5Ymuw7MyntKLTFkw.png"/></div></div></figure><p id="39e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">在列级别限制访问</strong></p><p id="ddd5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在我们可以看到table-1有三列，最后一列anonymous_string包含敏感数据，我们希望将该列限制为特定用户。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/fd12573fdf502a2a5de3614c548123ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*iRqZloREwEC8WF6BV0y_Qg.png"/></div></figure><p id="279e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这种情况下，我们需要创建一个包含所需列的视图。</p><ol class=""><li id="85b4" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">创建新的数据集测试</li><li id="06d9" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">运行查询后，点击查询结果窗口上方的<strong class="io hj">保存视图</strong>按钮，将查询保存为视图。</li></ol><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kw"><img src="../Images/2fa9723906bb1bf7a4df4fb187bcc08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unGDKmbmbQsqbohRRt-sGg.png"/></div></div></figure><p id="3fcd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">给出我们创建的数据集名称，即<strong class="io hj">测试</strong>和期望的视图名称，即<strong class="io hj"> v_table-1 </strong></p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kx"><img src="../Images/9406422511bb2670e5e72e5ce4f1b335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHKF_140wBQp8Dj6TYul2Q.png"/></div></div></figure><p id="b88e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建视图后，添加用户对视图的访问权限。</p><p id="a34f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">用户可以看到表1中的数据，但基于视图的敏感列除外。</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ky"><img src="../Images/7378b1582c0b2ecce6951d68aa228f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbFuiiczcY5A4UJHnFl6PA.png"/></div></div></figure><p id="ae2d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">请找到下面的视频演示。</p><figure class="jz ka kb kc fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure></div></div>    
</body>
</html>