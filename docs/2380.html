<html>
<head>
<title>Deploy Gatekeeper policies as OCI image, the GitOps way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»¥OCIæ˜ åƒã€GitOpsæ–¹å¼éƒ¨ç½²ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/google-cloud/deploying-gatekeeper-policies-as-oci-artifacts-the-gitops-way-e1233429ae2?source=collection_archive---------4-----------------------#2022-09-23">https://medium.com/google-cloud/deploying-gatekeeper-policies-as-oci-artifacts-the-gitops-way-e1233429ae2?source=collection_archive---------4-----------------------#2022-09-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="13b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">2023å¹´2æœˆ10æ—¥æ›´æ–°â€” </em> <a class="ae je" href="https://oras.land/blog/gatekeeper-policies-as-oci-image/" rel="noopener ugc nofollow" target="_blank"> <em class="jd">æœ¬å¸–ç°ç²¾é€‰äºORASå®˜æ–¹åšå®¢</em> </a> <em class="jd">ï¼</em>ğŸ‰</p><p id="9922" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">2023å¹´1æœˆ16æ—¥æ›´æ–°ï¼Œåœ¨è°·æ­Œäº‘æ§åˆ¶å°ä¸­ä½¿ç”¨æ–°çš„é…ç½®åŒæ­¥ç”¨æˆ·ç•Œé¢ï¼Œåˆ—å‡ºåŒæ­¥çš„èµ„æºåŠå…¶çŠ¶æ€ã€‚</em></p><p id="c5fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">2023å¹´1æœˆ10æ—¥æ›´æ–°ï¼Œæœ‰ä¸€äº›</em> <code class="du jf jg jh ji b"><em class="jd">gator test</em></code> <em class="jd">çš„ä¾‹å­ã€‚è‡ªä»</em> <a class="ae je" href="https://github.com/open-policy-agent/gatekeeper/releases/tag/v3.11.0" rel="noopener ugc nofollow" target="_blank"> <em class="jd">ç‰ˆæœ¬3.11.0 </em> </a> <em class="jd">ä»¥æ¥ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç›´æ¥ä½œä¸ºOCIæ˜ åƒæµ‹è¯•ç½‘å®ˆç­–ç•¥ï¼Œå¤ªæ£’äº†ï¼</em></p><p id="387e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»<a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/release-notes#September_15_2022" rel="noopener ugc nofollow" target="_blank"> Anthosé…ç½®ç®¡ç†1.13.0 </a>å¼€å§‹ï¼Œé™¤äº†åŒæ­¥å­˜å‚¨åœ¨Gitä»“åº“ä¸­çš„æ–‡ä»¶ï¼Œç°åœ¨<a class="ae je" href="https://cloud.google.com/blog/products/containers-kubernetes/gitops-with-oci-artifacts-and-config-sync" rel="noopener ugc nofollow" target="_blank">å¯ä»¥ç”¨GitOpsçš„æ–¹å¼åŒæ­¥OCIå›¾åƒå’Œèˆµå›¾ï¼Œé…ç½®åŒæ­¥</a>ã€‚</p><p id="f74a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å°†<a class="ae je" href="https://open-policy-agent.github.io/gatekeeper/website/docs/" rel="noopener ugc nofollow" target="_blank">å¼€æ”¾ç­–ç•¥ä»£ç†(OPA)ç½‘å…³å®ˆæŠ¤</a>ç­–ç•¥éƒ¨ç½²ä¸ºOCIæ˜ åƒï¼Œè¿™è¦å½’åŠŸäº<code class="du jf jg jh ji b"><a class="ae je" href="https://oras.land/" rel="noopener ugc nofollow" target="_blank">oras</a></code>ã€Googleå·¥ä»¶æ³¨å†Œå’Œé…ç½®åŒæ­¥ã€‚</p><p id="4e3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»¥ä¸‹æ˜¯ä½ å°†é€šè¿‡è¿™ç¯‡åšå®¢å®ç°çš„ç›®æ ‡:</p><ul class=""><li id="45c9" class="jj jk hi ih b ii ij im in iq jl iu jm iy jn jc jo jp jq jr bi translated">åˆ›å»ºç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥</li><li id="92e1" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">ç”¨æœ¬åœ°æ–‡ä»¶æµ‹è¯•æ­¤ç­–ç•¥</li><li id="4f5d" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">åˆ›å»ºå·¥ä»¶æ³¨å†Œåº“</li><li id="8041" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">å°†æŠŠå…³è€…ç­–ç•¥(<code class="du jf jg jh ji b">K8sAllowedRepos</code>)ä½œä¸ºOCIæ˜ åƒæ¨é€åˆ°å·¥ä»¶æ³¨å†Œåº“</li><li id="2afe" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">ä½¿ç”¨æ­¤è¿œç¨‹OCIæ˜ åƒæµ‹è¯•æ­¤ç­–ç•¥</li><li id="9bce" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">ä½¿ç”¨é…ç½®åŒæ­¥å’Œç­–ç•¥æ§åˆ¶å™¨è®¾ç½®GKEé›†ç¾¤</li><li id="129f" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">ä½¿ç”¨é…ç½®åŒæ­¥å°†ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥éƒ¨ç½²ä¸ºOCIæ˜ åƒ</li><li id="fcfc" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">åœ¨é›†ç¾¤ä¸­æµ‹è¯•è¯¥ç­–ç•¥</li><li id="2751" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated">åœ¨ç»“æŸæœ¬åšå®¢æ—¶ï¼Œå¯»æ‰¾æœºä¼šåˆ›å»ºç¬¬äºŒä¸ªæŠŠå…³è€…ç­–ç•¥(<code class="du jf jg jh ji b">RSyncAllowedRepos</code>)ï¼›)</li></ul><p id="e482" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">ä¸ºäº†åœ¨è¿™ç¯‡åšå®¢ä¸­è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨</em> <a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/concepts/policy-controller" rel="noopener ugc nofollow" target="_blank"> <em class="jd">ç­–ç•¥æ§åˆ¶å™¨</em> </a> <em class="jd">ï¼Œä½†æ˜¯å¦‚æœæ‚¨è‡ªå·±</em> <a class="ae je" href="https://open-policy-agent.github.io/gatekeeper/website/docs/install" rel="noopener ugc nofollow" target="_blank"> <em class="jd">å®‰è£…OSSç½‘å…³å®ˆæŠ¤è®¾å¤‡</em> </a> <em class="jd">ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•ã€‚</em></p><figure class="jy jz ka kb fd kc er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es jx"><img src="../Images/93d5948a8ef9774ecb99a2c172c6688d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhAOEn_SUWfJ1Or9TxzDJQ.png"/></div></div></figure></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="1670" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">è®¾ç½®ç¯å¢ƒ</h1><p id="aa17" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">ä»¥ä¸‹æ˜¯ä½ åœ¨è¿™ç¯‡åšå®¢ä¸­éœ€è¦çš„å·¥å…·:</p><ul class=""><li id="efd9" class="jj jk hi ih b ii ij im in iq jl iu jm iy jn jc jo jp jq jr bi translated"><code class="du jf jg jh ji b"><a class="ae je" href="https://cloud.google.com/sdk/docs/install" rel="noopener ugc nofollow" target="_blank">gcloud</a></code></li><li id="12b3" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><code class="du jf jg jh ji b"><a class="ae je" href="https://oras.land/cli/" rel="noopener ugc nofollow" target="_blank">oras</a></code></li><li id="0c7a" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><code class="du jf jg jh ji b"><a class="ae je" href="https://kubernetes.io/docs/tasks/tools/#kubectl" rel="noopener ugc nofollow" target="_blank">kubectl</a></code></li><li id="5753" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><code class="du jf jg jh ji b"><a class="ae je" href="https://open-policy-agent.github.io/gatekeeper/website/docs/gator/" rel="noopener ugc nofollow" target="_blank">gator</a></code></li></ul><p id="a22d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åˆå§‹åŒ–æœ¬åšå®¢ä¸­ä½¿ç”¨çš„å…¬å…±å˜é‡:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="ab00" class="lx kr hi ji b be ly lz l ma mb">PROJECT_ID=FIXME-WITH-YOUR-PROJECT-ID<br/>REGION=us-east4<br/>ZONE=us-east4-a</span></pre><p id="a7e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºäº†é¿å…åœ¨æ•´ä¸ªæ•™ç¨‹ä¸­é‡å¤å‘½ä»¤ä¸­çš„<code class="du jf jg jh ji b">--project</code>ï¼Œè®©æˆ‘ä»¬è®¾ç½®å½“å‰é¡¹ç›®:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="e50e" class="lx kr hi ji b be ly lz l ma mb">gcloud config set project ${PROJECT_ID}</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="9118" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">åˆ›å»ºç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥</h1><p id="68d5" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”±ä¸€ä¸ª<code class="du jf jg jh ji b">Constraint</code>å’Œä¸€ä¸ª<code class="du jf jg jh ji b">ConstraintTemplate</code>ç»„æˆçš„ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥ã€‚æ‚¨å¯ä»¥ç”¨è‡ªå·±çš„ç­–ç•¥åˆ—è¡¨è½»æ¾å¤åˆ¶è¿™ä¸ªåœºæ™¯ã€‚</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="0393" class="lx kr hi ji b be ly lz l ma mb">mkdir policies</span></pre><p id="af28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å®šä¹‰ä¸€ä¸ª<code class="du jf jg jh ji b">ConstraintTemplate</code>ï¼Œå®ƒå¯ä»¥ç¡®ä¿å®¹å™¨å›¾åƒä»¥æŒ‡å®šåˆ—è¡¨ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²å¼€å§‹:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="a1aa" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF&gt; policies/k8sallowedrepos.yaml<br/>apiVersion: templates.gatekeeper.sh/v1<br/>kind: ConstraintTemplate<br/>metadata:<br/>  annotations:<br/>    description: Requires container images to begin with a string from the specified list.<br/>  name: k8sallowedrepos<br/>spec:<br/>  crd:<br/>    spec:<br/>      names:<br/>        kind: K8sAllowedRepos<br/>      validation:<br/>        openAPIV3Schema:<br/>          type: object<br/>          properties:<br/>            repos:<br/>              description: The list of prefixes a container image is allowed to have.<br/>              type: array<br/>              items:<br/>                type: string<br/>  targets:<br/>  - target: admission.k8s.gatekeeper.sh<br/>    rego: |<br/>      package k8sallowedrepos<br/>      violation[{"msg": msg}] {<br/>        container := input.review.object.spec.containers[_]<br/>        satisfied := [good | repo = input.parameters.repos[_] ; good = startswith(container.image, repo)]<br/>        not any(satisfied)<br/>        msg := sprintf("container &lt;%v&gt; has an invalid image repo &lt;%v&gt;, allowed repos are %v", [container.name, container.image, input.parameters.repos])<br/>      }<br/>      violation[{"msg": msg}] {<br/>        container := input.review.object.spec.initContainers[_]<br/>        satisfied := [good | repo = input.parameters.repos[_] ; good = startswith(container.image, repo)]<br/>        not any(satisfied)<br/>        msg := sprintf("initContainer &lt;%v&gt; has an invalid image repo &lt;%v&gt;, allowed repos are %v", [container.name, container.image, input.parameters.repos])<br/>      }<br/>      violation[{"msg": msg}] {<br/>        container := input.review.object.spec.ephemeralContainers[_]<br/>        satisfied := [good | repo = input.parameters.repos[_] ; good = startswith(container.image, repo)]<br/>        not any(satisfied)<br/>        msg := sprintf("ephemeralContainer &lt;%v&gt; has an invalid image repo &lt;%v&gt;, allowed repos are %v", [container.name, container.image, input.parameters.repos])<br/>      }<br/>EOF</span></pre><p id="233a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸º<code class="du jf jg jh ji b">Pods</code>å®šä¹‰ä¸€ä¸ªå…³è”çš„<code class="du jf jg jh ji b">Constraint</code>ï¼Œè¯¥<code class="du jf jg jh ji b">Pods</code>éœ€è¦å…¶å®¹å™¨æ˜ åƒæ¥è‡ªå…è®¸çš„æ³¨å†Œä¸­å¿ƒ:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="ce52" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF&gt; policies/pod-allowed-container-registries.yaml<br/>apiVersion: constraints.gatekeeper.sh/v1beta1<br/>kind: K8sAllowedRepos<br/>metadata:<br/>  name: pod-allowed-container-registries<br/>spec:<br/>  enforcementAction: deny<br/>  match:<br/>    kinds:<br/>    - apiGroups:<br/>      - ""<br/>      kinds:<br/>      - Pod<br/>  parameters:<br/>    repos:<br/>    - gcr.io/config-management-release/<br/>    - gcr.io/gkeconnect/<br/>    - gke.gcr.io/<br/>    - ${REGION}-docker.pkg.dev/${PROJECT_ID}/<br/>EOF</span></pre><p id="f4fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">æ³¨æ„:æˆ‘ä»¬å…è®¸ç³»ç»Ÿå®¹å™¨å›¾åƒå…ˆç”¨3ä¸ª</em> <code class="du jf jg jh ji b"><em class="jd">repos</em></code> <em class="jd">ã€‚å¯¹äºæœ€åä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æ‚¨åœ¨è¿™ä¸ª</em> <code class="du jf jg jh ji b"><em class="jd">${REGION}-docker.pkg.dev/${PROJECT_ID}/</em></code> <em class="jd">å·¥ä»¶æ³¨å†Œå­˜å‚¨åº“ä¸­æ‹¥æœ‰è‡ªå·±çš„å®¹å™¨æ˜ åƒã€‚</em></p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="7cd0" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ç”¨æœ¬åœ°æ–‡ä»¶æµ‹è¯•æ­¤ç­–ç•¥</h1><p id="ddff" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„<code class="du jf jg jh ji b">Pod</code>æ¥æµ‹è¯•è¿™ä¸ªç­–ç•¥:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="095b" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF&gt; nginx-pod.yaml<br/>apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: nginx<br/>spec:<br/>  containers:<br/>  - name: nginx<br/>    image: nginx:latest<br/>    ports:<br/>    - containerPort: 80<br/>EOF</span></pre><p id="55e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨<code class="du jf jg jh ji b">gator</code> CLIé’ˆå¯¹è¯¥ç­–ç•¥åœ¨æœ¬åœ°æµ‹è¯•è¿™ä¸ª<code class="du jf jg jh ji b">Pod</code>ã€‚ä¸ç”¨ä»»ä½•Kubernetesé›†ç¾¤å°±å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æµ‹è¯•ç­–ç•¥ï¼</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="a73b" class="lx kr hi ji b be ly lz l ma mb">gator test -f nginx-pod.yaml -f policies/</span></pre><p id="8eda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¾“å‡ºç±»ä¼¼äº:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="859c" class="lx kr hi ji b be ly lz l mc mb">["pod-allowed-container-registries"] Message: "container &lt;nginx&gt; has an invalid image repo &lt;nginx:latest&gt;, allowed repos are...</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="30be" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">è®¾ç½®å·¥ä»¶æ³¨å†Œåº“</h1><p id="038a" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">åˆ›å»ºå·¥ä»¶æ³¨å†Œåº“:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="b600" class="lx kr hi ji b be ly lz l ma mb">gcloud services enable artifactregistry.googleapis.com<br/>ARTIFACT_REGISTRY_REPO_NAME=oci-artifacts<br/>gcloud artifacts repositories create ${ARTIFACT_REGISTRY_REPO_NAME} \<br/>    --location ${REGION} \<br/>    --repository-format docker</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="19e3" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">å°†ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥ä½œä¸ºOCIæ˜ åƒæ¨é€åˆ°å·¥ä»¶æ³¨å†Œä¸­å¿ƒ</h1><p id="9944" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">ç™»å½•åˆ°å·¥ä»¶æ³¨å†Œè¡¨:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="e6bc" class="lx kr hi ji b be ly lz l ma mb">gcloud auth configure-docker ${REGION}-docker.pkg.dev</span></pre><p id="e23e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨<code class="du jf jg jh ji b"><a class="ae je" href="https://oras.land/" rel="noopener ugc nofollow" target="_blank">oras</a></code>åœ¨å·¥ä»¶æ³¨å†Œè¡¨ä¸­æ¨é€ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="f351" class="lx kr hi ji b be ly lz l ma mb">oras push \<br/>    ${REGION}-docker.pkg.dev/${PROJECT_ID}/${ARTIFACT_REGISTRY_REPO_NAME}/my-policies:1.0.0 \<br/>    policies/</span></pre><p id="d977" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¯·æ³¨æ„ï¼Œæ‚¨çš„OCIå›¾åƒå·²ç»ä¸Šä¼ åˆ°Googleå·¥ä»¶æ³¨å†Œåº“ä¸­:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="a2c5" class="lx kr hi ji b be ly lz l ma mb">gcloud artifacts docker images list ${REGION}-docker.pkg.dev/${PROJECT_ID}/${ARTIFACT_REGISTRY_REPO_NAME}</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="2d53" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ä½¿ç”¨æ­¤è¿œç¨‹OCIæ˜ åƒæµ‹è¯•æ­¤ç­–ç•¥</h1><p id="d632" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨<code class="du jf jg jh ji b">gator</code> CLIåœ¨æœ¬åœ°æµ‹è¯•ä¹‹å‰æ ¹æ®è¯¥ç­–ç•¥åˆ›å»ºçš„<code class="du jf jg jh ji b">Pod</code>ä½œä¸ºè¿œç¨‹OCIæ˜ åƒã€‚éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸åŒçš„åœ°æ–¹å…±äº«å’Œè¯„ä¼°æ‚¨çš„ç­–ç•¥(ä¾‹å¦‚ï¼Œåœ¨æœ¬åœ°ï¼Œåœ¨æŒç»­é›†æˆè¿‡ç¨‹ä¸­ï¼Œç­‰ç­‰)ã€‚)!</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="4ec1" class="lx kr hi ji b be ly lz l ma mb">gator test -f nginx-pod.yaml -i ${REGION}-docker.pkg.dev/${PROJECT_ID}/${ARTIFACT_REGISTRY_REPO_NAME}/my-policies:1.0.0</span></pre><p id="24e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¾“å‡ºç±»ä¼¼äº:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="5ba8" class="lx kr hi ji b be ly lz l mc mb">["pod-allowed-container-registries"] Message: "container &lt;nginx&gt; has an invalid image repo &lt;nginx:latest&gt;, allowed repos are...</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="0404" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ä½¿ç”¨é…ç½®åŒæ­¥å’Œç­–ç•¥æ§åˆ¶å™¨è®¾ç½®GKEé›†ç¾¤</h1><p id="d367" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">åˆ›å»ºåœ¨æœºç¾¤ä¸­æ³¨å†Œçš„GKEé›†ç¾¤ä»¥å¯ç”¨é…ç½®ç®¡ç†:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="dd7a" class="lx kr hi ji b be ly lz l ma mb">gcloud services enable container.googleapis.com<br/>CLUSTER_NAME=gatkeeper-oci-cluster<br/>gcloud container clusters create ${CLUSTER_NAME} \<br/>    --workload-pool=${PROJECT_ID}.svc.id.goog \<br/>    --zone ${ZONE}<br/><br/>gcloud services enable gkehub.googleapis.com<br/>gcloud container fleet memberships register ${CLUSTER_NAME} \<br/>    --gke-cluster ${ZONE}/${CLUSTER_NAME} \<br/>    --enable-workload-identity<br/><br/>gcloud beta container fleet config-management enable</span></pre><p id="e49a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æ­¤GKEç¾¤é›†ä¸­å®‰è£…é…ç½®åŒæ­¥å’Œç­–ç•¥æ§åˆ¶å™¨:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="56b2" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF &gt; acm-config.yaml<br/>applySpecVersion: 1<br/>spec:<br/>  configSync:<br/>    enabled: true<br/>  policyController:<br/>    enabled: true<br/>    templateLibraryInstalled: false<br/>EOF<br/><br/>gcloud beta container fleet config-management apply \<br/>    --membership ${CLUSTER_NAME} \<br/>    --config acm-config.yaml</span></pre><p id="a1ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">æ³¨æ„:åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰å®‰è£…</em> <a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/latest/reference/constraint-template-library" rel="noopener ugc nofollow" target="_blank"> <em class="jd">é»˜è®¤çš„çº¦æŸæ¨¡æ¿åº“</em> </a> <em class="jd">ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦éƒ¨ç½²æˆ‘ä»¬è‡ªå·±çš„</em> <code class="du jf jg jh ji b"><em class="jd">ConstraintTemplate</em></code> <em class="jd">ã€‚</em></p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="9e1a" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ä½¿ç”¨é…ç½®åŒæ­¥å°†ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥éƒ¨ç½²ä¸ºOCIæ˜ åƒ</h1><p id="c84e" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">åˆ›å»ºä¸€ä¸ªä¸“ç”¨çš„Googleäº‘æœåŠ¡å¸æˆ·ï¼Œå¯¹å·¥ä»¶æ³¨å†Œåº“è¿›è¡Œç»†ç²’åº¦çš„è®¿é—®(<code class="du jf jg jh ji b">roles/artifactregistry.reader</code>):</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="539f" class="lx kr hi ji b be ly lz l ma mb">OCI_PULLER_GSA_NAME=configsync-oci-sa<br/>OCI_PULLER_GSA_ID=${OCI_PULLER_GSA_NAME}@${PROJECT_ID}.iam.gserviceaccount.com<br/>gcloud iam service-accounts create ${OCI_PULLER_GSA_NAME} \<br/>    --display-name=${OCI_PULLER_GSA_NAME}<br/>gcloud artifacts repositories add-iam-policy-binding ${ARTIFACT_REGISTRY_REPO_NAME} \<br/>    --location $REGION \<br/>    --member "serviceAccount:${OCI_PULLER_GSA_ID}" \<br/>    --role roles/artifactregistry.reader</span></pre><p id="b5ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å…è®¸é…ç½®åŒæ­¥åŒæ­¥ç‰¹å®š<code class="du jf jg jh ji b">RootSync</code>çš„èµ„æº:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="c0d7" class="lx kr hi ji b be ly lz l ma mb">ROOT_SYNC_NAME=root-sync-policies<br/>gcloud iam service-accounts add-iam-policy-binding \<br/>   --role roles/iam.workloadIdentityUser \<br/>   --member "serviceAccount:${PROJECT_ID}.svc.id.goog[config-management-system/root-reconciler-${ROOT_SYNC_NAME}]" \<br/>   ${OCI_PULLER_GSA_ID}</span></pre><p id="3e96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®¾ç½®é…ç½®åŒæ­¥ä»¥ä»å·¥ä»¶æ³¨å†Œè¡¨éƒ¨ç½²æ­¤OCIæ˜ åƒ:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="dca8" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt; EOF | kubectl apply -f -<br/>apiVersion: configsync.gke.io/v1beta1<br/>kind: RootSync<br/>metadata:<br/>  name: ${ROOT_SYNC_NAME}<br/>  namespace: config-management-system<br/>spec:<br/>  sourceFormat: unstructured<br/>  sourceType: oci<br/>  oci:<br/>    image: ${REGION}-docker.pkg.dev/${PROJECT_ID}/${ARTIFACT_REGISTRY_REPO_NAME}/my-policies:1.0.0<br/>    dir: .<br/>    auth: gcpserviceaccount<br/>    gcpServiceAccountEmail: ${OCI_PULLER_GSA_ID}<br/>EOF</span></pre><p id="cd26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é€šè¿‡è¿è¡Œå‘½ä»¤<code class="du jf jg jh ji b">gcloud alpha anthos config sync resources list</code>æˆ–ä»äº‘æ§åˆ¶å°å¯¼èˆªåˆ°<strong class="ih hj"> <em class="jd"> Kuberneteså¼•æ“&gt;é…ç½®&amp;ç­–ç•¥&gt;é…ç½®</em> </strong>ï¼Œåˆ—å‡ºé…ç½®åŒæ­¥æ‰€åŒæ­¥çš„èµ„æºåŠå…¶çŠ¶æ€:</p><figure class="jy jz ka kb fd kc er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es md"><img src="../Images/f86dcf159d03800c950c4e963bc08c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLc5UPtHR8jGdLx-Sf1EUg.png"/></div></div></figure><p id="d4f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç§å•Šã€‚è¿™å°±æ˜¯ä»¥GitOpsæ–¹å¼é€šè¿‡é…ç½®åŒæ­¥å°†ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥éƒ¨ç½²ä¸ºOCIæ˜ åƒçš„ç®€å•ä¹‹å¤„ã€‚</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="a4eb" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">åœ¨é›†ç¾¤ä¸­æµ‹è¯•è¯¥ç­–ç•¥</h1><p id="fc7f" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬å°è¯•åœ¨Kubernetesé›†ç¾¤ä¸­éƒ¨ç½²ä¹‹å‰åˆ›å»ºçš„<code class="du jf jg jh ji b">Pod</code>:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="90c2" class="lx kr hi ji b be ly lz l ma mb">kubectl apply -f nginx-pod.yaml</span></pre><p id="cb2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¾“å‡ºç±»ä¼¼äº:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="d4ec" class="lx kr hi ji b be ly lz l mc mb">Error from server (Forbidden): error when creating "nginx-pod.yaml": admission webhook "validation.gatekeeper.sh" denied the request: [pod-allowed-container-registries] container &lt;nginx&gt; has an invalid image repo &lt;nginx:latest&gt;, allowed repos are...</span></pre></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="f221" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ç»“è®º</h1><p id="3686" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œå¤šäºäº†<code class="du jf jg jh ji b"><a class="ae je" href="https://oras.land/" rel="noopener ugc nofollow" target="_blank">oras</a></code>ï¼Œæ‚¨èƒ½å¤Ÿå°†ä¸€ä¸ªç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥(<code class="du jf jg jh ji b">Constraint</code>å’Œ<code class="du jf jg jh ji b">ConstraintTemplate</code>)æ‰“åŒ…æˆä¸€ä¸ªOCIæ˜ åƒï¼Œå¹¶å°†å…¶æ¨é€åˆ°Googleå·¥ä»¶æ³¨å†Œè¡¨ã€‚æœ€åï¼Œæ‚¨çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨Workload Identityè®¿é—®Google Artifact Registryï¼Œå°†è¿™ä¸ªç§æœ‰OCIæ˜ åƒä¸Config Syncçš„<code class="du jf jg jh ji b">RootSync</code>è®¾ç½®ä¸­çš„<code class="du jf jg jh ji b">spec.oci.auth: gcpserviceaccount</code>è®¾ç½®åŒæ­¥ã€‚</p><p id="80bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GitOpsçš„æŒç»­åè°ƒå°†åœ¨ç°åœ¨å­˜å‚¨åœ¨OCIæ³¨å†Œè¡¨ä¸­çš„æœŸæœ›çŠ¶æ€å’Œè¿è¡Œåœ¨Kubernetesä¸­çš„å®é™…çŠ¶æ€ä¹‹é—´è¿›è¡Œåè°ƒã€‚ä½œä¸ºOCIæ˜ åƒçš„ç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥ç°åœ¨å°±åƒä»OCIæ³¨å†Œä¸­å¿ƒè·å–çš„Kubernetesé›†ç¾¤çš„ä»»ä½•å®¹å™¨æ˜ åƒä¸€æ ·ã€‚è¿™ç§æ¥è‡ªOCIæ³¨å†Œä¸­å¿ƒçš„æŒç»­åè°ƒ(ä¸ä¸Gitäº¤äº’)åœ¨å¯ä¼¸ç¼©æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§æ–¹é¢æœ‰å¾ˆå¤šå¥½å¤„ï¼Œå› ä¸ºæ‚¨å°†èƒ½å¤Ÿè·¨æ‚¨çš„é›†ç¾¤é…ç½®å¯¹OCIæ˜ åƒçš„ç»†ç²’åº¦è®¿é—®ã€‚</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="a50b" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">å‡†å¤‡å¥½æ¥å—å¦ä¸€é¡¹æŠŠå…³æ”¿ç­–äº†å—ï¼Ÿ</h1><p id="a341" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">å®é™…ä¸Šï¼Œè®©æˆ‘ä»¬å†ä¸€æ¬¡æ ¹æ®æˆ‘ä»¬åˆšåˆšå¾—å‡ºçš„ç»“è®ºåˆ›å»ºå¦ä¸€ä¸ªç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥:</p><blockquote class="me mf mg"><p id="ee5d" class="if ig jd ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated">OCIå›¾åƒç°åœ¨å°±åƒæ‚¨çš„Kubernetesé›†ç¾¤çš„ä»»ä½•å®¹å™¨å›¾åƒä¸€æ ·ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä»OCIæ³¨å†Œè¡¨ä¸­æå–çš„ã€‚</p></blockquote><p id="bf28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬ä¹Ÿä¸ºæ­¤åˆ›å»ºä¸€ä¸ªç½‘å…³å®ˆæŠ¤è®¾å¤‡ç­–ç•¥ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿ç”±é…ç½®åŒæ­¥æ‹‰å–çš„ä»»ä½•OCIæ˜ åƒä»…ä»…æ¥è‡ªæˆ‘ä»¬è‡ªå·±çš„ç§æœ‰å·¥ä»¶æ³¨å†Œåº“ã€‚</p><p id="cb85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å®šä¹‰ä¸€ä¸ª<code class="du jf jg jh ji b">ConstraintTemplate</code>ï¼Œå®ƒå¯ä»¥ç¡®ä¿OCIå›¾åƒä»¥æŒ‡å®šåˆ—è¡¨ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²å¼€å§‹:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="16d6" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF&gt; policies/rsyncallowedrepos.yaml<br/>apiVersion: templates.gatekeeper.sh/v1<br/>kind: ConstraintTemplate<br/>metadata:<br/>  annotations:<br/>    description: Requires OCI images to begin with a string from the specified list.<br/>  name: rsyncallowedrepos<br/>spec:<br/>  crd:<br/>    spec:<br/>      names:<br/>        kind: RSyncAllowedRepos<br/>      validation:<br/>        openAPIV3Schema:<br/>          type: object<br/>          properties:<br/>            repos:<br/>              description: The list of prefixes an OCI image is allowed to have.<br/>              type: array<br/>              items:<br/>                type: string<br/>  targets:<br/>  - target: admission.k8s.gatekeeper.sh<br/>    rego: |<br/>      package rsyncallowedrepos<br/>      violation[{"msg": msg}] {<br/>        image := input.review.object.spec.oci.image<br/>        satisfied := [good | repo = input.parameters.repos[_] ; good = startswith(image, repo)]<br/>        not any(satisfied)<br/>        msg := sprintf("&lt;%v&gt; named &lt;%v&gt; has an invalid image repo &lt;%v&gt;, allowed repos are %v", [input.review.kind.kind, input.review.object.metadata.name, image, input.parameters.repos])<br/>      }<br/>EOF</span></pre><p id="1ec0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸º<code class="du jf jg jh ji b"><a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/reference/rootsync-reposync-fields" rel="noopener ugc nofollow" target="_blank">RootSyncs</a></code> <a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/reference/rootsync-reposync-fields" rel="noopener ugc nofollow" target="_blank">å’Œ</a> <code class="du jf jg jh ji b"><a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/reference/rootsync-reposync-fields" rel="noopener ugc nofollow" target="_blank">RepoSyncs</a></code>å®šä¹‰ä¸€ä¸ªå…³è”çš„<code class="du jf jg jh ji b">Constraint</code>ï¼Œå®ƒä»¬éœ€è¦ä»å…è®¸çš„æ³¨å†Œä¸­å¿ƒè·å¾—å®ƒä»¬çš„OCIæ˜ åƒ:</p><pre class="jy jz ka kb fd lt ji lu bn lv lw bi"><span id="660b" class="lx kr hi ji b be ly lz l ma mb">cat &lt;&lt;EOF&gt; policies/rsync-allowed-artifact-registries.yaml<br/>apiVersion: constraints.gatekeeper.sh/v1beta1<br/>kind: RSyncAllowedRepos<br/>metadata:<br/>  name: rsync-allowed-artifact-registries<br/>spec:<br/>  enforcementAction: deny<br/>  match:<br/>    kinds:<br/>    - apiGroups:<br/>      - configsync.gke.io<br/>      kinds:<br/>      - RootSync<br/>      - RepoSync<br/>  parameters:<br/>    repos:<br/>    - ${REGION}-docker.pkg.dev/${PROJECT_ID}/${ARTIFACT_REGISTRY_REPO_NAME}<br/>EOF</span></pre><p id="e496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬ä¸ä¼šéƒ¨ç½²ä¹Ÿä¸ä¼šæµ‹è¯•è¿™äº›èµ„æºï¼Œä½†æ˜¯æ‚¨å·²ç»æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åªæ˜¯å¢åŠ äº†æ›´å¤šçš„æ²»ç†å’Œå®‰å…¨æ€§ã€‚æˆ‘ä»¬ç°åœ¨èƒ½å¤Ÿæ§åˆ¶é›†è£…ç®±å›¾åƒå’Œä½œä¸ºOCIå›¾åƒçš„Kubernetesæ¸…å•çš„æ¥æºã€‚å¾ˆé…·ï¼Œä¸æ˜¯å—ï¼Ÿï¼</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="9209" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆ</h1><ul class=""><li id="1853" class="jj jk hi ih b ii lo im lp iq mk iu ml iy mm jc jo jp jq jr bi translated"><a class="ae je" href="https://cloud.google.com/blog/products/containers-kubernetes/gitops-with-oci-artifacts-and-config-sync" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨é…ç½®åŒæ­¥</a>ä»¥GitOpsæ–¹å¼éƒ¨ç½²OCIå·¥ä»¶å’Œèˆµå›¾</li><li id="2198" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/how-to/sync-helm-charts-from-artifact-registry" rel="noopener ugc nofollow" target="_blank">ä»ç¥å™¨æ³¨å†Œè¡¨åŒæ­¥èˆµå›¾</a></li><li id="8fdd" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><a class="ae je" href="https://cloud.google.com/anthos-config-management/docs/how-to/sync-oci-artifacts-from-artifact-registry" rel="noopener ugc nofollow" target="_blank">ä»å·¥ä»¶æ³¨å†Œè¡¨åŒæ­¥OCIå·¥ä»¶</a></li><li id="7055" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><a class="ae je" rel="noopener" href="/google-cloud/836913e74e79">å¸¦æœ‰Helmçš„CI/gitopã€GitHubæ“ä½œã€GitHubå®¹å™¨æ³¨å†Œå’Œé…ç½®åŒæ­¥</a></li><li id="a0cb" class="jj jk hi ih b ii js im jt iq ju iu jv iy jw jc jo jp jq jr bi translated"><a class="ae je" rel="noopener" href="/google-cloud/b48604191fda">å¸¦æœ‰Helmçš„CI/gitopã€GitHubæ“ä½œã€Googleå·¥ä»¶æ³¨å†Œè¡¨å’Œé…ç½®åŒæ­¥</a></li></ul></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><p id="cd22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">åŸå¸–</em><a class="ae je" href="https://mathieu-benoit.github.io/" rel="noopener ugc nofollow" target="_blank"><em class="jd">Mathieu-Benoit . github . io</em></a><em class="jd">ã€‚</em></p></div></div>    
</body>
</html>