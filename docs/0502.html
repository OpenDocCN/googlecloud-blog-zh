<html>
<head>
<title>Unit testing + Google App Engine in Python 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 2中的单元测试+ Google App引擎</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/unit-testing-google-app-engine-in-python-2-198195b695e8?source=collection_archive---------0-----------------------#2018-01-24">https://medium.com/google-cloud/unit-testing-google-app-engine-in-python-2-198195b695e8?source=collection_archive---------0-----------------------#2018-01-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fe8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的上一篇文章中，我解释了如何让GAE在本地使用你自己的pip包，我只需要再写一篇简短的文章，谈谈如果你依赖谷歌应用引擎，例如，如果你有NDB模型的deps，你如何对你的pip包进行单元测试。</p><p id="2bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前我最喜欢的IDE是PyCharm，所以我的例子发生在一个环境中，我有以下设置:</p><ul class=""><li id="0c13" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">皮查姆</li><li id="94a0" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">谷歌应用引擎SDK</li><li id="c29e" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">我自己的pip包(带有setup.py的Python包)带有到GAE的deps</li><li id="7bbd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Python 2.7.10</li><li id="ab3a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">MacOS 10.13.2(高塞拉)</li></ul><p id="c6ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">老实说，我不确定其他python开发者是否一直在使用<em class="jr"> virtualenv </em>,但是我已经知道GAE·德夫用这个工具工作得更好。然而，当您使用PyCharm时，默认设置是使用系统中的默认Python解释器，在我的例子中:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9166" class="kb kc hi jx b fi kd ke l kf kg">Python 2.7.10 located at <em class="jr">/usr/bin/python</em></span></pre><p id="f481" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这让事情变得很有趣，因为即使您参照GAE SDK设置您的PyCharm项目，测试运行程序也不会理解或导入您的常见GAE包，例如:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2b22" class="kb kc hi jx b fi kd ke l kf kg">google.appengine.ext<br/>google.appengine.api</span></pre><p id="d79c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我立刻找到了这个资源:</p><ul class=""><li id="02cc" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><a class="ae kh" href="https://cloud.google.com/appengine/docs/standard/python/tools/localunittesting" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/app engine/docs/standard/python/tools/localunittesting</a></li></ul><p id="288c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是做:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="fa98" class="kb kc hi jx b fi kd ke l kf kg"><strong class="jx hj">import</strong> sys<br/>sys.path.insert(1, <em class="jr">'google-cloud-sdk/platform/google_appengine'</em>)<br/>sys.path.insert(1, <em class="jr">'google-cloud-sdk/platform/google_appengine/lib/yaml/lib'</em>)<br/>sys.path.insert(1, <em class="jr">'myapp/lib'</em>)</span></pre><p id="6a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对我没用——所以在谷歌搜索了一下后，我在Jetbrains社区论坛上找到了一个<a class="ae kh" href="https://intellij-support.jetbrains.com/hc/en-us/community/posts/206630245-Unable-to-run-unit-tests-inside-a-Google-app-engine-project" rel="noopener ugc nofollow" target="_blank">的帖子，说我应该把这个放在我的<em class="jr">‘my _ test . py’</em>的顶部</a></p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="abf7" class="kb kc hi jx b fi kd ke l kf kg"><strong class="jx hj">import </strong>dev_appserver<br/>dev_appserver.fix_sys_path()</span></pre><p id="0c2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我这样做了，它成功了。</p><p id="11ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还做了一个'<em class="jr"> pip安装。-升级'</em>并在本地重新安装我的包。</p><p id="0b34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PS！当然，所有这些都意味着您已经安装了<a class="ae kh" href="https://cloud.google.com/appengine/downloads" rel="noopener ugc nofollow" target="_blank"> Google App Engine SDK </a>。</p><p id="0149" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于样品，我想推荐位于以下位置的样品:</p><ul class=""><li id="b67f" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><a class="ae kh" href="https://github.com/GoogleCloudPlatform/python-docs-samples/tree/master/appengine/standard/localtesting" rel="noopener ugc nofollow" target="_blank">https://github . com/Google cloud platform/python-docs-samples/tree/master/app engine/standard/local testing</a></li></ul></div></div>    
</body>
</html>