<html>
<head>
<title>Deploying Apps to Google Kubernetes Engine using Cloud Marketplace, Kubectl CLI &amp; Helm Charts.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用云市场、Kubectl CLI和Helm图表将应用部署到Google Kubernetes引擎。</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/kubernetes-on-gke-series-intro-8ec514c4c369?source=collection_archive---------0-----------------------#2020-03-03">https://medium.com/google-cloud/kubernetes-on-gke-series-intro-8ec514c4c369?source=collection_archive---------0-----------------------#2020-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/22f8c30adf472f625c8168affed945fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jT0r5xd2Ps2bZ6IqY-KR1w.png"/></div></div></figure><blockquote class="iq"><p id="1cb4" class="ir is hi bd it iu iv iw ix iy iz ja dx translated">在本文中，您将学习如何使用<a class="ae jb" href="https://cloud.google.com/marketplace" rel="noopener ugc nofollow" target="_blank"> Google Cloud Marketplace </a>、<a class="ae jb" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank"> Kubectl CLI </a>、<a class="ae jb" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> Helm3 Charts </a>来设置和部署应用程序到<a class="ae jb" href="https://cloud.google.com/kubernetes-engine" rel="noopener ugc nofollow" target="_blank">Google Kubernetes Engine(GKE</a>)集群。</p></blockquote><p id="d21b" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ja hb bi translated"><em class="jz">虽然这篇文章是基于容器的，但我不会谈论容器，请随意阅读Robert John关于什么是Docker容器</em>  <em class="jz">的文章。<br/>这只是为了让你尽快熟悉GKE。<br/>本系列的其他文章将指导您以多种方式将应用程序部署和管理到您即将创建的GKE集群。</em></p><blockquote class="ka kb kc"><p id="dd40" class="jc jd jz je b jf kd jh ji jj ke jl jm kf kg jp jq kh ki jt ju kj kk jx jy ja hb bi translated">Kubernetes(通常称为k8s)是一个开源的容器编排系统，用于自动化应用程序部署、扩展和管理。它旨在提供一个“跨主机集群自动部署、扩展和操作应用程序容器的平台”。<br/>它可以和一系列容器工具一起工作，包括Docker。——<a class="ae jb" href="https://en.wikipedia.org/wiki/Kubernetes" rel="noopener ugc nofollow" target="_blank"><em class="hi">维基</em> </a></p><p id="584a" class="jc jd jz je b jf kd jh ji jj ke jl jm kf kg jp jq kh ki jt ju kj kk jx jy ja hb bi translated">有关Kubernetes概念的概述，请参见<a class="ae jb" href="https://kubernetes.io/docs/concepts/" rel="noopener ugc nofollow" target="_blank"> Kubernetes文档</a>。</p><p id="68e3" class="jc jd jz je b jf kd jh ji jj ke jl jm kf kg jp jq kh ki jt ju kj kk jx jy ja hb bi translated">Google Kubernetes引擎 (GKE)提供了一个托管环境，用于部署、管理和扩展使用Google基础设施的容器化应用程序。Kubernetes引擎环境由多台机器(具体来说是<a class="ae jb" href="https://cloud.google.com/compute" rel="noopener ugc nofollow" target="_blank"> Google计算引擎</a>实例)组成，这些机器组合在一起形成一个<a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture" rel="noopener ugc nofollow" target="_blank">容器集群</a>。</p></blockquote><h2 id="1160" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">先决条件</h2><ul class=""><li id="a239" class="lg lh hi je b jf li jj lj jn lk jr ll jv lm ja ln lo lp lq bi translated">创建一个<a class="ae jb" href="https://console.cloud.google.com/project" rel="noopener ugc nofollow" target="_blank">谷歌云平台(GCP)项目</a>，或者使用一个现有的项目。</li><li id="2cd3" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated">启用<a class="ae jb" href="https://console.developers.google.com/apis/api/container.googleapis.com/overview" rel="noopener ugc nofollow" target="_blank"> Kubernetes引擎API </a>。</li><li id="d756" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/sdk/install" rel="noopener ugc nofollow" target="_blank">安装GCloud SDK </a></li></ul><h2 id="67db" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">本文的主要部分</h2><ul class=""><li id="6d7f" class="lg lh hi je b jf li jj lj jn lk jr ll jv lm ja ln lo lp lq bi translated"><a class="ae jb" href="#9808" rel="noopener ugc nofollow"> <em class="jz">使用云市场将就绪应用部署到GKE</em></a></li><li id="68b0" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="#6b83" rel="noopener ugc nofollow"> <em class="jz">使用Kubectl </em> </a>将容器映像部署到GKE</li><li id="79c1" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="#8f0c" rel="noopener ugc nofollow"> <em class="jz">使用舵图管理GKE上的应用</em> </a></li></ul><h1 id="97a7" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">使用Kubernetes引擎进行集群编排</h1><p id="c38c" class="pw-post-body-paragraph jc jd hi je b jf li jh ji jj lj jl jm jn mn jp jq jr mo jt ju jv mp jx jy ja hb bi translated">Kubernetes引擎集群由开源集群管理系统提供支持。Kubernetes提供了与容器集群交互的机制。您可以使用Kubernetes命令和资源来部署和管理您的应用程序，执行管理任务和设置策略，以及监控您部署的工作负载的健康状况。</p><p id="b98d" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">当您在GKE上运行Kubernetes引擎集群时，您还会受益于Google云平台提供的高级集群管理功能。其中包括:</p><ul class=""><li id="f032" class="lg lh hi je b jf kd jj ke jn mq jr mr jv ms ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/compute/docs/load-balancing-and-autoscaling" rel="noopener ugc nofollow" target="_blank">计算引擎实例的负载平衡</a>。</li><li id="65ec" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/node-pools" rel="noopener ugc nofollow" target="_blank">节点池</a>指定集群中的节点子集，以提供额外的灵活性。</li><li id="4db8" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/cluster-autoscaler" rel="noopener ugc nofollow" target="_blank">自动扩展集群的节点实例数</a>。</li><li id="3362" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/node-auto-upgrade" rel="noopener ugc nofollow" target="_blank">为集群的节点软件自动升级</a>。</li><li id="21e2" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://google.qwiklabs.com/focuses/Node%20auto-repair%5D(https://cloud.google.com/kubernetes-engine/docs/node-auto-repair" rel="noopener ugc nofollow" target="_blank">节点自动修复</a>维护节点健康和可用性。</li><li id="38f7" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/how-to/logging" rel="noopener ugc nofollow" target="_blank">使用Stackdriver对集群进行日志记录和监控</a>。</li></ul><h1 id="911f" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">创建Kubernetes引擎集群</h1><figure class="mu mv mw mx fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/e874e01ccdcac3b51fdf78c0303534e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*AlqaL4IofdoHXJ4q"/></div><figcaption class="my mz et er es na nb bd b be z dx translated">Kubernetes聚类图(来自维基)</figcaption></figure><p id="a3f9" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">一个GKE <a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture" rel="noopener ugc nofollow" target="_blank">集群</a>由至少一个<em class="jz">集群主</em>机和多个被称为<em class="jz">节点</em>的工作机组成。节点是<a class="ae jb" href="https://cloud.google.com/compute/docs/instances/" rel="noopener ugc nofollow" target="_blank">计算引擎虚拟机(VM)实例</a>，它们运行必要的Kubernetes进程，使它们成为集群的一部分。</p><p id="388b" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要设置GKE集群，</em> <a class="ae jb" href="https://console.cloud.google.com/kubernetes/add" rel="noopener ugc nofollow" target="_blank"> <em class="jz">单击此处</em> </a> <em class="jz">或在GCP控制台上导航如下:<br/> </em> <strong class="je hj"> <em class="jz"> Kubernetes引擎&gt;集群&gt;创建集群<br/> </em> </strong> <em class="jz">(名称:</em> <strong class="je hj"> <em class="jz">我的集群</em> </strong> <em class="jz">，其他字段保持不变)</em></p><figure class="mu mv mw mx fd ij er es paragraph-image"><div class="er es nc"><img src="../Images/eb6bc0f7dc625197993952e6cb07aec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/0*FAs4G5cVyHmK3Jre"/></div><figcaption class="my mz et er es na nb bd b be z dx translated">集群创建屏幕</figcaption></figure><p id="7c64" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">如果您更习惯使用gcloud工具，上面的等效命令如下。</em> <em class="jz">确保你已经默认</em> <strong class="je hj"> <em class="jz">项目</em></strong><em class="jz">&amp;</em><strong class="je hj"><em class="jz">区域</em> </strong> <em class="jz">配置好了。</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="ad19" class="kl km hi ne b fi ni nj l nk nl">gcloud container clusters create my-cluster</span></pre><p id="5473" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">您的集群应该在几分钟内准备好。</p><h1 id="9808" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">使用云市场将就绪应用部署到GKE</h1><figure class="mu mv mw mx fd ij er es paragraph-image"><div class="er es nm"><img src="../Images/1cadb0f5812a1d6721fd759c67ae188b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*G0cci36zOj0jB8_M5_ZHMw.jpeg"/></div><figcaption class="my mz et er es na nb bd b be z dx translated">GKE</figcaption></figure><p id="2ca1" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><a class="ae jb" href="https://cloud.google.com/marketplace" rel="noopener ugc nofollow" target="_blank"> Google Cloud Marketplace </a>包括容器映像和配置文件，比如一个<code class="du nn no np ne b">kubectl</code>配置，我们将使用它将一个<a class="ae jb" href="https://wordpress.org/" rel="noopener ugc nofollow" target="_blank"> Wordpress </a>应用程序部署到Google Kubernetes引擎集群。</p><p id="be27" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">当您从Google Cloud Marketplace部署应用程序时，Kubernetes资源会在您的集群中创建，您可以作为一个组来管理这些资源。</p><p id="a5b0" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要查看您可以在GKE集群上部署的Kubenetes应用程序，</em> <a class="ae jb" href="https://console.cloud.google.com/kubernetes/add" rel="noopener ugc nofollow" target="_blank"> <em class="jz">单击此处</em> </a> <em class="jz">或在GCP控制台上导航如下:<br/></em><strong class="je hj"><em class="jz">market place</em></strong><em class="jz">&gt;Filter by</em><strong class="je hj"><em class="jz">Kubenetes应用程序</em> </strong></p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/3d1c8c0f1df5572a92df0b9502aae3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDSCYA0BeRRDCdIsKDwq6Q.png"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">可部署在GKE集群上的谷歌云市场应用</figcaption></figure><p id="5a56" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">搜索或选择一个应用程序，以查看其信息，包括其价格。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nr"><img src="../Images/6b2c28b9c5203fc8cb13c2eb06c16d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8AYckrQ1wuEcvgfA"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">搜索Wordpress</figcaption></figure><p id="3f34" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">点击你选择的app&gt;</em><strong class="je hj"><em class="jz">进行配置。<br/> </em> </strong> <em class="jz">为您的应用程序输入一个名称，然后点击</em> <strong class="je hj"> <em class="jz">【部署】</em> </strong> <em class="jz">。</em></p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/a5b3af639a583a73ab4493a04f1f20ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/0*E8MCUzqGCsGAu_yN"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">在GKE集群上部署应用</figcaption></figure><p id="5eb4" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">您可以</em> <strong class="je hj"> <em class="jz">启用公共IP访问</em> </strong> <em class="jz">进行来自外部世界的可访问性，</em> <strong class="je hj"> <em class="jz">启用stack driver Metrics Exporter</em></strong><em class="jz">进行监控，并且还要做检查</em> <strong class="je hj"> <em class="jz">服务条款。</em> </strong></p><p id="72af" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">将部署您的应用程序，并为您创建所有资源。<br/>要管理、编辑或删除您的应用程序部署，请从GKE集群的<strong class="je hj">应用程序</strong>页面进行操作。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nt"><img src="../Images/003192eeffa9a2b4af97b90492c925f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sfmWZ5IwTK7x9rvm"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">管理部署的应用程序</figcaption></figure><p id="f743" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">你可以从它的<a class="ae jb" href="https://cloud.google.com/marketplace/docs" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多关于谷歌云市场的信息。</p><h1 id="6b83" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">使用Kubectl将容器映像部署到GKE</h1><figure class="mu mv mw mx fd ij er es paragraph-image"><div class="er es nu"><img src="../Images/533caa7a53316994c5155f8f98149df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*3g1v0fYm_GzootYk9hV0LQ.jpeg"/></div><figcaption class="my mz et er es na nb bd b be z dx translated">库伯内特斯</figcaption></figure><p id="d148" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">Kubectl是一个用于控制Kubernetes集群的命令行工具，它允许您对Kubernetes集群运行命令来部署应用程序、检查和管理集群资源，或者查看日志。<br/>我们将使用kubectl工具将一个容器映像部署到Google Kubernetes引擎集群。</p><p id="5b39" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">GKE使用Kubernetes对象来创建和管理集群的资源。Kubernetes提供了<a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/concepts/deployment" rel="noopener ugc nofollow" target="_blank">部署</a>对象，用于部署无状态应用程序，如web服务器。<a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs/concepts/service" rel="noopener ugc nofollow" target="_blank">服务</a>对象定义了从互联网访问应用程序的规则和负载平衡。</p><p id="256f" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">要安装Kubectl，请遵循此处描述的<a class="ae jb" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank">步骤。</a></p><h2 id="fda9" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">配置kubectl</h2><p id="d9a2" class="pw-post-body-paragraph jc jd hi je b jf li jh ji jj lj jl jm jn mn jp jq jr mo jt ju jv mp jx jy ja hb bi translated">创建集群后，您需要获得身份验证凭证来与集群交互，您可以使用安装了<em class="jz"> kubectl </em>和<a class="ae jb" href="https://cloud.google.com/sdk" rel="noopener ugc nofollow" target="_blank">g cloud</a>的命令行来完成。</p><ul class=""><li id="e818" class="lg lh hi je b jf kd jj ke jn mq jr mr jv ms ja ln lo lp lq bi translated">使用以下方式登录Gcloud:</li></ul><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="4762" class="kl km hi ne b fi ni nj l nk nl">gcloud auth login</span></pre><p id="5a35" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">这将打开一个浏览器窗口供您登录。如果您还没有设置默认项目，也可以设置一个默认项目。</p><ul class=""><li id="ebb4" class="lg lh hi je b jf kd jj ke jn mq jr mr jv ms ja ln lo lp lq bi translated">要配置kubectl来管理您的GKE集群，请执行:</li></ul><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="ab70" class="kl km hi ne b fi ni nj l nk nl">gcloud container clusters get-credentials my-cluster</span></pre><p id="efa0" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">其中</em><strong class="je hj"><em class="jz">my-cluster</em></strong><em class="jz">是您之前创建的集群的名称。</em></p><h2 id="65a0" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">创建部署</h2><p id="d8f3" class="pw-post-body-paragraph jc jd hi je b jf li jh ji jj lj jl jm jn mn jp jq jr mo jt ju jv mp jx jy ja hb bi translated">在这一步中，您将通过编写YAML配置，使用<em class="jz"> kubectl </em>命令和<strong class="je hj">而不是</strong>命令来创建部署。</p><p id="87c4" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要在您的GKE集群上创建一个新的部署，运行以下命令:</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="7842" class="kl km hi ne b fi ni nj l nk nl">kubectl create deployment hello-server — image=gcr.io/google-samples/hello-app:1.0</span></pre><p id="e760" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">该命令在您配置的集群上创建一个名为</em><strong class="je hj"><em class="jz">hello-server</em></strong><em class="jz">的部署。部署的Pod运行</em><strong class="je hj"><em class="jz">hello-app</em></strong><em class="jz">容器映像。<br/> </em>通过跑步检查跑步吊舱:</p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="68da" class="kl km hi ne b fi ni nj l nk nl">kubectl get pods</span></pre><h2 id="fc9a" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">公开部署</h2><p id="2730" class="pw-post-body-paragraph jc jd hi je b jf li jh ji jj lj jl jm jn mn jp jq jr mo jt ju jv mp jx jy ja hb bi translated">您需要将它公开到互联网上，以便用户可以访问它。您可以通过创建一个服务来公开您的应用程序，这个服务是一个Kubernetes资源，它将您的应用程序公开给外部流量。</p><p id="1703" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要在您的GKE集群上创建新服务，请运行以下命令:</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="ff37" class="kl km hi ne b fi ni nj l nk nl">kubectl expose deployment hello-server — type=LoadBalancer — port 8080</span></pre><p id="bc8d" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">通过运行以下命令检查<code class="du nn no np ne b">hello-server</code>服务:</p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="44d0" class="kl km hi ne b fi ni nj l nk nl">kubectl get service hello-server</span></pre><p id="334f" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">生成外部IP地址可能需要几分钟时间。如果外部IP列处于“挂起”状态，请再次运行上述命令。</em></p><p id="d65e" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">要了解更多关于Kubectl的信息，请查看kubectl的概述。</p><h1 id="8f0c" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">使用舵图管理GKE上的应用程序</h1><figure class="mu mv mw mx fd ij er es paragraph-image"><div class="er es nv"><img src="../Images/715db22faca598dba84ebc08c67476b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*gjed202klfXzQ8ruM03auQ.jpeg"/></div><figcaption class="my mz et er es na nb bd b be z dx translated">舵</figcaption></figure><p id="86fe" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">Helm被描述为“Kubernetes的包管理器”，它是一个管理在Kubernetes集群管理器中运行的应用程序的工具。Helm提供了一组对管理应用程序有用的操作，例如:检查、安装、升级和删除。我们将使用Helm将应用程序部署到Google Kubernetes引擎集群。</p><p id="7d5a" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">Helm提供了与您可能已经熟悉的许多包管理器相同的基本特性集，例如Debian的apt或Python的pip。舵能:安装软件。自动安装软件依赖项。升级软件。配置软件部署。从存储库中获取软件包</p><h2 id="614e" class="kl km hi bd kn ko kp kq kr ks kt ku kv jn kw kx ky jr kz la lb jv lc ld le lf bi translated">舵图</h2><p id="665c" class="pw-post-body-paragraph jc jd hi je b jf li jh ji jj lj jl jm jn mn jp jq jr mo jt ju jv mp jx jy ja hb bi translated">Helm charts是预先配置的Kubernetes资源包，可以随时部署。它包括描述应用程序的元数据，以及按照标准Kubernetes原语操作应用程序所需的基础设施。每个图表引用一个或多个(通常是Docker兼容的)容器映像，这些映像包含要运行的应用程序代码。</p><p id="47ca" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">安装舵v3。x，运行以下命令，或者检查出</em> <a class="ae jb" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> <em class="jz">文档</em> </a> <em class="jz"> : </em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="b189" class="kl km hi ne b fi ni nj l nk nl">curl https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get-helm-3 &gt; get_helm.sh<br/>chmod 700 get_helm.sh<br/>./get_helm.sh</span></pre><p id="2696" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><a class="ae jb" href="https://hub.helm.sh" rel="noopener ugc nofollow" target="_blank"> Helm Hub </a>存储库包含Helm托管的分布式公共存储库搜索的文档和一些配置。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nw"><img src="../Images/b0562ce56062f3e7bfed98f36561a6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMzAv7wAnJM6_5bO9sbxsA.png"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">舵毂</figcaption></figure><p id="06e2" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">你可以使用Helm Chart安装一个<a class="ae jb" href="https://wordpress.org" rel="noopener ugc nofollow" target="_blank"> Wordpress </a>应用程序。你可以搜索Wordpress掌舵图，选择<em class="jz"> bitnami/wordpress </em>。</p><p id="6649" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要添加</em> <a class="ae jb" href="https://kubeapps.com/charts/search?q=bitnami" rel="noopener ugc nofollow" target="_blank"> <em class="jz"> Bitnami Helm图表库</em> </a> <em class="jz">以便使用install Wordpress，您需要运行以下命令:</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="70e7" class="kl km hi ne b fi ni nj l nk nl">helm repo add bitnami <a class="ae jb" href="https://charts.bitnami.com/bitnami" rel="noopener ugc nofollow" target="_blank">https://charts.bitnami.com/bitnami</a></span></pre><p id="ea1b" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要验证存储库是否已添加，请运行命令:</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="d1a5" class="kl km hi ne b fi ni nj l nk nl">helm repo list</span></pre><p id="ac30" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">要安装Wordpress图表到Helm，运行命令:</em></p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="750f" class="kl km hi ne b fi ni nj l nk nl">helm install myblog bitnami/wordpress --version 8.1.4 <!-- -->--set wordpressUsername=admin,wordpressPassword=password</span></pre><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nx"><img src="../Images/ec74c8873e92276dc50f331f65065f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tgy3crdfi-kCBiVjk6cArw.png"/></div></div><figcaption class="my mz et er es na nb bd b be z dx translated">输出</figcaption></figure><p id="98bc" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">这个图表使用<a class="ae jb" href="https://helm.sh/" rel="noopener ugc nofollow" target="_blank"> Helm </a>包管理器在您的<a class="ae jb" href="http://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>集群上启动一个<a class="ae jb" href="https://github.com/bitnami/bitnami-docker-wordpress" rel="noopener ugc nofollow" target="_blank"> WordPress </a>部署。</p><p id="c0cc" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">它还打包了Bitnami MariaDB图表，这是为WordPress应用程序的数据库需求引导MariaDB部署所必需的。</p><p id="5246" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">上面的命令还将WordPress管理员帐户的用户名和密码分别设置为<code class="du nn no np ne b">admin</code>和<code class="du nn no np ne b">password</code>。你可以在这里了解更多关于Bitnami Wordpress图表及其配置参数<a class="ae jb" href="https://hub.helm.sh/charts/bitnami/wordpress" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="20be" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">要获取部署的应用程序的IP地址，您可以运行以下命令:</p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="1a80" class="kl km hi ne b fi ni nj l nk nl">kubectl get service myblog-wordpress</span></pre><p id="92aa" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">注意这是*&lt;application _ name&gt;-WordPress *的形式。您也可以访问外部IP或使用之前使用的用户名和密码登录* &lt; IP &gt; /admin*。</em></p><p id="b8f5" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">您还可以导航到<strong class="je hj"> Kubernetes引擎&gt;服务&amp;入口</strong>并查看您的应用程序运行情况。如下图所示。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ny"><img src="../Images/2e813e0abe97114805432bce588451f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BVwKgeq_8OLBE5sAWHmNLA.png"/></div></div></figure><p id="7f34" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">要卸载应用程序，您需要运行以下命令:</p><pre class="mu mv mw mx fd nd ne nf ng aw nh bi"><span id="2df7" class="kl km hi ne b fi ni nj l nk nl"><em class="jz">helm delete</em> command</span></pre><p id="ec9d" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated"><em class="jz">请注意，与该版本相关的所有Kubernetes资源都将被删除。</em></p><p id="145b" class="pw-post-body-paragraph jc jd hi je b jf kd jh ji jj ke jl jm jn kg jp jq jr ki jt ju jv kk jx jy ja hb bi translated">要了解更多关于Helm的信息，请访问它的<a class="ae jb" href="https://helm.sh/docs/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="7a33" class="lw km hi bd kn lx ly lz kr ma mb mc kv md me mf ky mg mh mi lb mj mk ml le mm bi translated">有用的链接</h1><ul class=""><li id="1ac9" class="lg lh hi je b jf li jj lj jn lk jr ll jv lm ja ln lo lp lq bi translated"><a class="ae jb" href="https://github.com/ramitsurana/awesome-kubernetes" rel="noopener ugc nofollow" target="_blank">牛逼的Kubernetes </a></li><li id="d9ce" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://kubernetes.io/docs/" rel="noopener ugc nofollow" target="_blank"> Kubernetes文档</a></li><li id="96af" class="lg lh hi je b jf lr jj ls jn lt jr lu jv lv ja ln lo lp lq bi translated"><a class="ae jb" href="https://cloud.google.com/kubernetes-engine/docs" rel="noopener ugc nofollow" target="_blank">谷歌Kubernetes引擎文档</a></li></ul></div></div>    
</body>
</html>