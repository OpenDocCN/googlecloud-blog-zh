<html>
<head>
<title>Local pip package and Google App Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">本地pip包和谷歌应用引擎</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/local-pip-package-and-google-app-engine-c39b1e6412b0?source=collection_archive---------1-----------------------#2018-01-22">https://medium.com/google-cloud/local-pip-package-and-google-app-engine-c39b1e6412b0?source=collection_archive---------1-----------------------#2018-01-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0f6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌的应用引擎沙箱是一个神奇的解决方案，可以快速创建应用程序。您已经获得了所需的一切，以及大量资源、样本和快速入门。</p><p id="d055" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，在用Python开发多个服务时，您可能会发现应该为您的域、实用程序等创建至少一个公共库。</p><p id="94e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自于。在网络世界中，私有的NuGet feeds对于组织来说是一件很平常的事情，我猜想<em class="jd"> pip </em>也有同样的情况——尤其是因为<em class="jd"> pip </em>已经存在了很长时间。</p><p id="7ff5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我错了。</p><p id="abdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我开始在谷歌上搜索，基本上只有简单的解决方案，比如:</p><blockquote class="je jf jg"><p id="4fc5" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">"使用SimpleHTTPServer在本地计算机上手动创建您的包并托管它"</p><p id="804f" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">"使用桶"</p><p id="56bd" class="if ig jd ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">" $ pip安装。"</p></blockquote><p id="7d43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我明白了，这就是开源精神——事情应该是开放的，所以如果我真的想让事情不对公众开放，也许我应该使用Git中的子模块特性来做到这一点。然而，问题是，我还不想公开这个应用的领域和特性。此外，我这样做是因为我真的想更多地了解pip。</p><p id="ad94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我开始将一些模块转移到我创建的新包中，并阅读了<a class="ae jk" href="https://python-packaging.readthedocs.io/en/latest/minimal.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="jd">这本简单的指南</em> </strong> </a>，我想将它推荐给需要了解pip的每个人。</p><p id="2149" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这个指南，我学会了</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="b301" class="ju jv hi jq b fi jw jx l jy jz">1. Create a setup.py with a simple module.<br/>2. Install the package locally using '$ pip install .'<br/>3. Install the package locally as a symlink '$ pip install -e .'<br/>4. Create an actual package using '$ python setup.py sdist'</span></pre><p id="a26a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">理论上我已经控制了一切，我制作了我的模块，设法将它们打包在同一个名为'<em class="jd"> myapp-shared </em>的包中，我很高兴——运行<em class="jd"> sdist </em>命令后的dist-package看起来不错。</p><p id="75b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，我很难让这个包与<em class="jd"> virtualenv </em>和GAE运行时一起工作。</p><p id="4e0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建了一个源代码发行版，并尝试使用指向<em class="jd"> dist </em>文件夹位置的pip的<em class="jd"> find-links </em>选项<em class="jd"> </em>来安装该包，在shell中一切似乎都正常，但是当我更新共享包并再次运行<em class="jd"> sdist </em>时，这似乎无法正常工作——当我查看<em class="jd"> lib </em>文件夹<em class="jd"> </em>时，我发现了旧的那个，就好像它刚刚从本地缓存安装的一样(？？？).</p><p id="9f7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，经过多次反复之后，我发现最简单的方法是忽略sdist-命令，只需从GAE项目的根目录运行这个命令:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="7553" class="ju jv hi jq b fi jw jx l jy jz">pip install ../../../myapp-shared -t lib --upgrade</span></pre><p id="c654" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我将这一行添加到现有的install.sh脚本中:</p><pre class="jl jm jn jo fd jp jq jr js aw jt bi"><span id="8650" class="ju jv hi jq b fi jw jx l jy jz"><em class="jd">#!/bin/sh<br/></em>virtualenv env<br/>source env/bin/activate<br/>pip install -r requirements.txt -t lib<br/>pip install ../../../myapp-shared -t lib --upgrade</span></pre><p id="c00f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以最后，最简单的解决方案是最好的。</p><p id="ef70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯。</p></div></div>    
</body>
</html>