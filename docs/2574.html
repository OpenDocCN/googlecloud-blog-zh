<html>
<head>
<title>Pulumi Convertors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">普鲁米转换器</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/pulumi-convertors-ca8c712878?source=collection_archive---------4-----------------------#2022-11-30">https://medium.com/google-cloud/pulumi-convertors-ca8c712878?source=collection_archive---------4-----------------------#2022-11-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pulumi是一个很有前途的IaC工具，面向那些一直使用Go、Java、C#等编程语言的核心开发人员。NET Stack)、Python、NodeJS、TypeScript，甚至像YAML等标记语言，用于构建服务器端或客户端(TypeScript/JavaScript)应用程序/系统。</p><p id="2ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是Pulumi与市场上其他工具(如Terraform)的主要区别，Terraform有自己的规则，特别是在特定领域语言(terra form的HCL)方面。因此，在您变得高效之前，您需要花一些时间了解这些工具是如何工作的，以便开始实施过程。</p><p id="c248" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Pulumi，您可以用您熟悉的语言对基础设施进行编程。这意味着您可以开始编写云部署代码，而无需花费任何时间学习一门新语言。</p><p id="bddc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pulumi使用期望的状态模型来管理基础设施。一个Pulumi程序由一个<em class="jd">语言主机</em>执行，为一个栈的基础设施计算一个期望的状态。<em class="jd">部署引擎</em>将该期望状态与堆栈的当前状态进行比较，并确定需要创建、更新或删除哪些资源。引擎使用一组<em class="jd">资源提供者</em>(如<a class="ae je" href="https://www.pulumi.com/docs/get-started/aws/" rel="noopener ugc nofollow" target="_blank"> AWS </a>、<a class="ae je" href="https://www.pulumi.com/docs/get-started/azure/" rel="noopener ugc nofollow" target="_blank"> Azure </a>、<a class="ae je" href="https://www.pulumi.com/docs/get-started/gcp/" rel="noopener ugc nofollow" target="_blank"> Google Cloud Platform </a>、<a class="ae je" href="https://www.pulumi.com/docs/get-started/kubernetes/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>等)来管理个体资源。在运行过程中，引擎会使用有关已供应的所有资源以及任何未决操作的信息来更新基础架构的<em class="jd">状态</em>。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/3a36c9a5464d6cb8a238b00f6c7644e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tU9RbzZD2sxgZ5ME3JlgIg.png"/></div></div></figure><p id="5249" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发人员/DevOps/SRE可能会考虑从现有的IaC工具(如Terraform、ARM templates、AWS Cloud Formation、Kubernetes CRDs、Kubernetes YAMLs)迁移到Pulumi。正是出于这个目的，Pulumi提供了转换器，可以利用这些转换器从其他IaC工具转移到Pulumi，以利用其IaC的代码中心性。</p><p id="592c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我将介绍Pulumi必须提供的以下转换器:</p><ul class=""><li id="ac9a" class="jr js hi ih b ii ij im in iq jt iu ju iy jv jc jw jx jy jz bi translated"><a class="ae je" href="https://www.pulumi.com/arm2pulumi/" rel="noopener ugc nofollow" target="_blank">手臂到Pulumi </a></li><li id="cd73" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><a class="ae je" href="https://www.pulumi.com/cf2pulumi/" rel="noopener ugc nofollow" target="_blank">云形成到普鲁米</a></li><li id="c9ab" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><a class="ae je" href="https://www.pulumi.com/blog/introducing-crd2pulumi/" rel="noopener ugc nofollow" target="_blank"> Kubernetes海关资源给普鲁米</a></li><li id="488a" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><a class="ae je" href="https://www.pulumi.com/kube2pulumi/" rel="noopener ugc nofollow" target="_blank">YAML到普鲁米</a></li><li id="6eab" class="jr js hi ih b ii ka im kb iq kc iu kd iy ke jc jw jx jy jz bi translated"><a class="ae je" href="https://www.pulumi.com/tf2pulumi/" rel="noopener ugc nofollow" target="_blank">地形到普鲁米</a></li></ul><h1 id="66b7" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">将模板武装到Pulumi</h1><p id="7585" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">如果你想把你现有的ARM模板转换成任何一种Pulumi支持的编程语言，Pulumi提供了https://github.com/pulumi/arm2pulumi<a class="ae je" href="https://github.com/pulumi/arm2pulumi" rel="noopener ugc nofollow" target="_blank">工具。</a></p><p id="bd14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该工具目前托管在https://www.pulumi.com/arm2pulumi/<a class="ae je" href="https://www.pulumi.com/arm2pulumi/" rel="noopener ugc nofollow" target="_blank">并且将很快开源。</a></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es li"><img src="../Images/16be66e7bf9fe93e7d98c88f604fb6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDYZMj8i3oCa8gD2vXWxWQ.png"/></div></div></figure><h1 id="ccce" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">自动气象站云形成到普鲁米</h1><p id="4dcf" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">如果你想把现有的AWS云形成模板转换成Pulumi支持的编程语言，Pulumi提供了https://github.com/pulumi/pulumi-aws-native工具。</p><p id="5712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pulumi AWS本机提供程序使您能够构建、部署和管理AWS Cloud Control API支持的任何AWS资源。通过AWS Native，您可以在同一天访问所有新的AWS资源和云控制API支持的现有资源上的所有新属性。您可以从用任何Pulumi语言编写的Pulumi程序中使用AWS Native:c#、Go、JavaScript/TypeScript和Python。如果您还没有安装和配置Pulumi CLI，那么您需要安装和配置Pulumi CLI。</p><blockquote class="lj lk ll"><p id="fd45" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated"><strong class="ih hj">注</strong></p><p id="e2a6" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">AWS原生是在公共预览。在AWS本机提供程序中，目前并非所有的AWS资源都可用。它涵盖了AWS Cloud Control API和AWS CloudFormation Registry当前支持的所有资源。<a class="ae je" href="https://github.com/pulumi/pulumi-aws-native/blob/master/provider/cmd/pulumi-gen-aws-native/supported-types.txt" rel="noopener ugc nofollow" target="_blank">支持资源列表</a>。</p><p id="254a" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">对于新项目，我们建议同时使用AWS Native和<a class="ae je" href="https://github.com/pulumi/pulumi-aws" rel="noopener ugc nofollow" target="_blank"> AWS Classic </a>，这样您可以尽可能获得AWS Native的速度和正确性优势。对于现有项目，AWS Classic仍然完全受支持；此时，我们建议等待将现有项目迁移到AWS Native。</p></blockquote><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lp"><img src="../Images/eb0d09d2845d2389e86fe07b21bf84a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y3BLkovS-Za4FbtSc6hkDw.png"/></div></div></figure><h1 id="977e" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">CRD到普卢米</h1><p id="c144" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">如果你想从Kubernetes CRD迁移到Pulumi，Pulumi提供了一个工具<a class="ae je" href="https://github.com/pulumi/crd2pulumi" rel="noopener ugc nofollow" target="_blank">https://github.com/pulumi/crd2pulumi</a>可以用来将CRDs转换成你选择的Pulumi支持的编程语言。</p><p id="865e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">crd2pulumi</code>是一个CLI工具，基于Kubernetes CustomResourceDefinition(CRDs)生成类型化的CustomResources。CRD允许您通过为定制对象定义自己的模式来扩展Kubernetes API。虽然Pulumi允许您创建<a class="ae je" href="https://www.pulumi.com/docs/reference/pkg/kubernetes/apiextensions/customresource/" rel="noopener ugc nofollow" target="_blank"> CustomResources </a>，但是以前这些对象没有强类型，因为每个模式都是自定义的。这对于像<a class="ae je" href="https://github.com/jetstack/cert-manager/tree/master/deploy/crds" rel="noopener ugc nofollow" target="_blank"> cert-manager </a>或<a class="ae je" href="https://github.com/istio/istio/tree/0321da58ca86fc786fb03a68afd29d082477e4f2/manifests/charts/base/crds" rel="noopener ugc nofollow" target="_blank"> istio </a>这样包含数千行复杂YAML模式的流行CRD来说是一个巨大的难题。通过生成CustomResources的类型化版本，<code class="du lq lr ls lt b">crd2pulumi</code>允许您利用现有的IDE类型检查和自动完成特性，从而使填写它们的参数更加方便。</p><p id="14ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">crd2pulumi</code>可以从Pulumi家酿水龙头安装在Mac上。</p><pre class="jg jh ji jj fd lu lt lv bn lw lx bi"><span id="3ff9" class="ly kg hi lt b be lz ma l mb mc">brew install pulumi/tap/crd2pulumi</span></pre><p id="0b60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">crd2pulumi</code>使用Go模块管理依赖关系。如果你想开发<code class="du lq lr ls lt b">crd2pulumi</code>本身，你需要安装Go来构建。一旦安装了这个先决条件，运行下面的代码来构建<code class="du lq lr ls lt b">crd2pulumi</code>二进制文件并将其安装到<code class="du lq lr ls lt b">$GOPATH/bin</code>中:</p><pre class="jg jh ji jj fd lu lt lv bn lw lx bi"><span id="9b96" class="ly kg hi lt b be lz ma l mb mc">go build -ldflags="-X github.com/pulumi/crd2pulumi/gen.Version=dev" -o $GOPATH/bin/crd2pulumi main.go</span></pre><h1 id="1b55" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">YAML到普卢米</h1><p id="99f0" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">要将YAMLs转换成您选择的、Pulumi支持的编程语言，您可以利用<a class="ae je" href="https://github.com/pulumi/kube2pulumi" rel="noopener ugc nofollow" target="_blank">https://github.com/pulumi/kube2pulumi</a>工具。</p><p id="39c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Go，TypeScript，Python，C#和Java中将Kubernetes YAML转换为Pulumi程序。通过利用强类型、编译错误、对自动完成等特性的完全IDE支持来改善您的Kubernetes开发体验。在管理Kubernetes资源的同一个程序中声明和管理任何云中的基础设施。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es md"><img src="../Images/9385319bde4df61d152418d6bb3f90f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYrjPLToBCEr6P06EoPtYA.png"/></div></div></figure><blockquote class="lj lk ll"><p id="67b7" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">注意:</p><p id="f78d" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">kube2pulumi</code>当前不处理CustomResourceDefinitions或CustomResources的转换。然而，我们的新工具<code class="du lq lr ls lt b">crd2pulumi</code>，基于您的CRD为资源创建强类型参数！</p></blockquote><h1 id="7492" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">Terraform到Pulumi</h1><p id="0253" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">如果你想把terraform HCL(Hashicorp配置语言)转换成typescript语言，你可以利用一个叫做<a class="ae je" href="https://github.com/pulumi/tf2pulumi" rel="noopener ugc nofollow" target="_blank">https://github.com/pulumi/tf2pulumi</a>的工具。<code class="du lq lr ls lt b">tf2pulumi</code>的目标是帮助用户有效地将Terraform管理的基础设施转换成Pulumi堆栈。它将HCL配置翻译成Pulumi类型脚本程序。在时机成熟时，它还会将Terraform状态文件转换为Pulumi检查点文件。</p><p id="863a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">tf2pulumi</code>可以从Pulumi家酿tap安装在Mac上。</p><pre class="jg jh ji jj fd lu lt lv bn lw lx bi"><span id="e094" class="ly kg hi lt b be lz ma l mb mc">brew install pulumi/tap/tf2pulumi</span></pre><p id="07ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">tf2pulumi使用<a class="ae je" href="https://github.com/golang/go/wiki/Modules" rel="noopener ugc nofollow" target="_blank"> Go模块</a>来管理依赖关系。如果你想开发<code class="du lq lr ls lt b">tf2pulumi2</code>本身，你需要安装<a class="ae je" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> Go </a>来进行构建。一旦安装了这个先决条件，运行下面的代码来构建<code class="du lq lr ls lt b">tf2pulumi</code>二进制文件并将其安装到<code class="du lq lr ls lt b">$GOPATH/bin</code>中:</p><pre class="jg jh ji jj fd lu lt lv bn lw lx bi"><span id="2f1e" class="ly kg hi lt b be lz ma l mb mc">go build -o $GOPATH/bin/tf2pulumi main.go</span></pre><p id="2e8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Go应该会自动为您提取依赖项。</p><p id="1b0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<code class="du lq lr ls lt b">$GOPATH/bin</code>不在您的路径上，您可能希望将<code class="du lq lr ls lt b">tf2pulumi</code>二进制文件从<code class="du lq lr ls lt b">$GOPATH/bin</code>移到您的路径上的一个目录中。</p><blockquote class="lj lk ll"><p id="de28" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">注意:</p><p id="7fd3" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">虽然已经支持了大多数Terraform构造，但是还存在一些差距。最值得注意的是<code class="du lq lr ls lt b">tf2pulumi</code>目前不能转换置备程序块。除此之外，以下构造尚未实现:</p><p id="b01d" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">各种内置插值函数。对未实现函数的调用将在运行时抛出(#12)。</p><p id="db40" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">多个提供程序实例和命名的提供程序。如果一个资源或数据源命名了一个提供者，那么这个引用当前被忽略(#11)。</p><p id="0b6d" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">粮食供给商。置备程序块目前被忽略(#10)。</p><p id="ce82" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated">数据源中的显式依赖(#1)。</p><p id="2394" class="if ig jd ih b ii ij ik il im in io ip lm ir is it ln iv iw ix lo iz ja jb jc hb bi translated"><code class="du lq lr ls lt b">self</code>和<code class="du lq lr ls lt b">terraform</code>变量引用(#2)。</p></blockquote><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es me"><img src="../Images/e0339b5c9bc45b26349a3416d03ebb3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Y23Or_PsNkpqs1m8jgPTA.png"/></div></div></figure><p id="5598" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，Pulumi转换器允许您将ARM、CloudFormation、Kubernetes CustomResources、Kubernetes YAML和Terraform转换为Pulumi。希望这篇博客有助于理解Pulumi提供的从其他IaC工具移植而来的不同转换器工具。</p></div></div>    
</body>
</html>