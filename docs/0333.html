<html>
<head>
<title>The 12 Components of Google BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌大查询的12个组成部分</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/the-12-components-of-google-bigquery-c2b49829a7c7?source=collection_archive---------0-----------------------#2017-07-11">https://medium.com/google-cloud/the-12-components-of-google-bigquery-c2b49829a7c7?source=collection_archive---------0-----------------------#2017-07-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7118" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人们这些天一直在讨论BigQuery，这太棒了。但是BigQuery有很多东西——它是一个复杂、成熟的服务，有许多移动的部分，很容易迷失！</p><p id="42a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了帮助理解什么是BigQuery服务，下面是我认为面向用户的主要组件的简要介绍:</p><ul class=""><li id="cf80" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">无服务器服务模型</li><li id="1f54" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">固执己见的存储引擎</li><li id="3fd3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Dremel执行引擎和标准SQL</li><li id="c566" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">通过Jupiter网络实现存储和计算的分离</li><li id="f77a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">企业级数据共享</li><li id="8424" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">公共数据集、商业数据集、营销数据集和免费定价层</li><li id="5225" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">流式摄取</li><li id="c23d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">批量摄取</li><li id="dee0" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">联邦查询引擎</li><li id="15cd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">UX，CLI，SDK，ODBC/JDBC，API</li><li id="ea72" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">按查询付费和统一费率定价</li><li id="e40c" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">IAM、认证和审计日志</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/ccf564c427c0bac805150e4c1ef149bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHmYWdJNM9D-2Fb3hs1nXw.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">从业者视角下的BigQuery</figcaption></figure><p id="2ce4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，BigQuery远不止于此，我们在这里采用了以客户为中心的观点。我忽略了一些更平凡的部分。也就是说，我们之前写过<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/01/bigquery-under-the-hood" rel="noopener ugc nofollow" target="_blank">big query在幕后的样子</a>，以及<a class="ae kh" rel="noopener" href="/google-cloud/15-awesome-things-you-probably-didnt-know-about-google-bigquery-6654841fa2dc">关于BigQuery </a>你可能不知道的15件事。</p><h1 id="5885" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated"><strong class="ak">无服务器服务模式</strong></h1><p id="816e" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery最重要的方面可能是它的无服务器模型(请原谅这个时髦词)。我可以直截了当地说——big query拥有业内最高级别的抽象、<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/08/google-bigquery-continues-to-define-what-it-means-to-be-fully-managed" rel="noopener ugc nofollow" target="_blank">可管理性</a>和自动化，将您从虚拟机和CPU/RAM规模的束缚中解放出来。BigQuery的计算具有令人难以置信的弹性，<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/01/anatomy-of-a-bigquery-query" rel="noopener ugc nofollow" target="_blank">能够在几秒钟内将</a>扩展到数万个内核，同时让您只为自己消耗的资源付费；BigQuery是一个高度可用、持久且安全的开箱即用的工具。在那里，选中“无服务器”的所有复选框，您会看到…</p><h1 id="e86a" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">固执己见的托管存储引擎</h1><p id="611c" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery拥有一个令人惊叹的存储引擎，可以代表您不断发展和优化您的存储——免费且无中断。</p><p id="e119" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">巨像是谷歌对GFS的继承。Colossus非常棒——它经久耐用，性能卓越，可扩展性超强。BigQuery将其数据以固执己见的<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/04/inside-capacitor-bigquerys-next-generation-columnar-storage-format" rel="noopener ugc nofollow" target="_blank">电容器</a>格式存储在Colossus中。BigQuery的电容器在幕后做了大量的优化，在这个过程中消耗了大量的CPU/RAM(不影响查询性能..或者你的账单！).</p><p id="2d50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery使用存储的一个很好的例子是，当您的表由太多小文件驱动时，会自动重新物化您的数据。“许多小文件”的问题是整整一代DBA生存的祸根。</p><h1 id="e8e2" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">Dremel执行引擎和标准SQL</h1><p id="3c8a" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">每个人都知道BigQuery运行在<a class="ae kh" href="https://research.google.com/pubs/pub36632.html" rel="noopener ugc nofollow" target="_blank"> Dremel </a>之上。也就是说，Dremel本身已经进化了，现在它与论文中描述的有点不同:</p><ul class=""><li id="9e35" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">截至2015年夏天，100%的BigQuery用户运行在Dremel的新版本上。</li><li id="8ffa" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">BigQuery <a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/08/in-memory-query-execution-in-google-bigquery" rel="noopener ugc nofollow" target="_blank">在一个单独的子服务中执行</a>它的内存洗牌</li><li id="7834" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">Dremel做类似流水线执行和智能调度的事情</li></ul><p id="df3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dremel本身就是一个庞大的多租户计算集群。您的查询只是Dremel中的短期租户，Dremel调度程序执行类似太阳马戏团的体操来保持所有查询以最佳状态运行。Dremel的性质也使你对任何单个节点的故障免疫——耶！</p><p id="7573" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dremel目前支持其遗留的SQL-ish方言，以及2011 ANSI标准SQL方言。</p><h1 id="4842" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">Jupiter网络与存储和计算的分离</h1><p id="0e0b" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我们已经<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/01/bigquery-under-the-hood" rel="noopener ugc nofollow" target="_blank">骑着</a>这匹业余小马走到了它的最后一程。<a class="ae kh" href="https://cloudplatform.googleblog.com/2015/06/A-Look-Inside-Googles-Data-Center-Networks.html" rel="noopener ugc nofollow" target="_blank"> Jupiter </a>是谷歌的内部数据中心网络，能够处理数Pb的二分流量，并允许BigQuery将数据从存储设备传输到计算设备，不会出现任何问题。是胶水。</p><h1 id="3880" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">企业级数据共享</h1><p id="2603" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery将存储和计算完全分离，再加上Colossus的强大功能，使得人们可以相互共享EB级数据集，就像今天共享Google文档和工作表一样。</p><p id="45c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些体系结构中，将数据复制到不同的集群中以共享数据，从而创建数据孤岛，这并不是一种反模式。我认为数据孤岛是最糟糕的—你在用数据玩电话游戏，你在增加操作的复杂性，你的基础设施非常低效，最终你的账单会高得离谱！</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es ll"><img src="../Images/cbe2a1dafda9f9d4059e58439d09733e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*45pSqcaKcAGUJuGyOQ_IgA.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">对数据孤岛说不</figcaption></figure><p id="c7cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery不利用虚拟机作为其存储层(甚至不作为加速器)，因此您将不会受到任何与数据存储相关的欺骗，如竞争条件、锁定、热点，并且您可以抛弃您对CLONE和SWAP命令的了解。我说过巨像很棒吗？</p><p id="ef67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，BigQuery的无服务器特性允许您与其他组织共享数据，而不必强迫他们创建自己的集群。您为存储付费，他们为每次查询付费，这一切都是完全透明的。谁喜欢为闲置的集群付费？没错，谁都不是！</p><h1 id="56ce" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">公共数据集、商业数据集、营销数据集和免费层！！</h1><p id="4c7b" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">一些好人正在利用BigQuery强大的数据共享特性来做一些非常酷的事情。</p><p id="dc5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://cloud.google.com/bigquery/public-data/" rel="noopener ugc nofollow" target="_blank">公共数据集项目</a>有下坡失控货运列车的势头。数据集几乎每周都在增加，NOAA数据是最新加入的。</p><p id="4ba7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以通过BigQuery的<a class="ae kh" href="https://cloud.google.com/commercial-datasets/" rel="noopener ugc nofollow" target="_blank">商业数据集</a>货币化或获得商业级数据集。同样，如果你使用Google Analytics、AdWords、Doubleclick或Youtube，你的数据可以通过<a class="ae kh" href="https://cloud.google.com/blog/big-data/2017/05/introducing-ads-data-hub-next-generation-insights-and-reporting" rel="noopener ugc nofollow" target="_blank">营销数据集</a>(正如Mercedez-Benz、Hearst和《纽约时报》的人发现的)一键进入BigQuery。</p><p id="6800" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，BigQuery有一个永久的<a class="ae kh" href="https://cloud.google.com/free/" rel="noopener ugc nofollow" target="_blank">空闲层</a>，允许您每月存储10GB和查询1TB。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es lm"><img src="../Images/c95e6d67a3bfb755a7b51ba9253fed8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zSsvBjb81CcpYEvE-g8g5g.png"/></div></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">智齿鱼的故事</figcaption></figure><h1 id="9d91" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">流式传输和批量摄取</h1><p id="e7b5" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery的<a class="ae kh" href="https://cloud.google.com/bigquery/streaming-data-into-bigquery" rel="noopener ugc nofollow" target="_blank">流API </a>是一个相当独特的特性。您可以将数据以每秒数百万行的速度流入BigQuery，并且数据几乎可以立即用于分析。对于分析数据库来说，这实际上是一个很难解决的技术问题，所以这里的团队值得称赞。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es ln"><img src="../Images/5fd28a76b28729e04b2ed2c4115ac9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*dmk4UUFpokIrgVDWlx3k3g.png"/></div><figcaption class="kd ke et er es kf kg bd b be z dx translated">流式摄取—不仅仅是看上去那样简单</figcaption></figure><p id="3e25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery的批量接收并不轻松，它上面有一个完整的独立的<a class="ae kh" rel="noopener" href="/google-cloud/paying-it-forward-how-bigquerys-data-ingest-breaks-tech-norms-8bfe2341f5eb">博客</a>(TL；dr:它不会消耗您的查询能力，也不会花费任何东西！)</p><h1 id="079a" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">联邦查询引擎</h1><p id="afdb" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">如果您的数据驻留在Bigtable、GCS或Google Drive中，您可以直接从BigQuery查询这些数据，而无需移动任何数据。这就是我们所说的“<a class="ae kh" href="https://cloud.google.com/bigquery/external-data-sources" rel="noopener ugc nofollow" target="_blank">联邦查询</a>”。</p><h1 id="5f5d" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">UX，CLI，SDK，ODBC/JDBC，API</h1><p id="37ee" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">典型的访问模式，都包装在REST API中。值得一提的一点是，它与BQ的语义配合得非常好:</p><ul class=""><li id="170b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">提交存储(查询、加载、复制)的作业要么全部提交，要么全部不提交。不需要清理失败或未完成一半的作业。</li><li id="654f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">查询会及时查看快照中的存储。因此，它们不受竞争条件、表/行/单元锁、中途状态等的影响。</li></ul><h1 id="6a2d" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">按查询付费和统一费率定价</h1><p id="3a29" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery有两种定价模式——超高效的云原生按查询付费模式，以及可预测的企业级统一费率模式。</p><p id="dda8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人们谴责按查询付费的模式过于昂贵。我很同情那些很难找到这个模型并预测它的人，但它并不昂贵。您只需为您消费的东西付费，不会多花一分钱，而且在分析工作负载(往往不稳定)中，<a class="ae kh" href="https://cloud.google.com/blog/big-data/2016/02/visualizing-the-mechanics-of-on-demand-pricing-in-big-data-technologies" rel="noopener ugc nofollow" target="_blank">要花很多钱</a>。</p><p id="e14f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您有一个相当大的用例，并且珍惜价格的可预测性而不是效率，BigQuery确实提供了统一费率定价模型。你只需支付一笔固定费用，所有的查询都是免费的！</p><p id="6e53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最重要的是，你可以清楚地看到任何一种型号。您可以选择从一个型号跳到下一个型号，因为它符合您的预算需求。</p><h1 id="f908" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">IAM、认证和审计日志</h1><p id="3552" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">BigQuery符合Google Cloud的<a class="ae kh" href="https://cloud.google.com/iam/" rel="noopener ugc nofollow" target="_blank"> IAM </a>策略，允许组织为其用户划分高粒度的角色和控制。</p><p id="6598" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">BigQuery支持两种通用的身份验证模式:</p><ul class=""><li id="166a" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">OAuth(三脚用户参与的认证方法)</li><li id="2be8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">服务帐户(通过机密文件无头)</li></ul><p id="a8b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两者都有有效的用例。如果你已经集成了谷歌的认证，OAuth是很棒的，如果你在你这边联合访问控制，服务账户也可以工作。</p><p id="c966" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，BigQuery的审计日志是BigQuery中发生的所有事情的书面记录。大量用户将审计日志导出回BigQuery，<a class="ae kh" rel="noopener" href="/google-cloud/visualize-gcp-billing-using-bigquery-and-data-studio-d3e695f90c08">在Data Studio </a>中实时可视化BigQuery使用情况！</p><p id="821b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你有它。你已经成为我长篇大论的结尾了。希望我已经很好地详细描述了自2012年以来谷歌的分析主力BigQuery背后的广度和力量。请留下评论或问题！</p><h1 id="4f0c" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">更多资源</h1><div class="lo lp ez fb lq lr"><a href="https://www.reddit.com/r/bigquery/" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hj fi z dy lw ea eb lx ed ef hh bi translated">r/bigquery</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">r/bigquery:关于Google BigQuery的一切</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">www.reddit.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf kb lr"/></div></div></a></div><ul class=""><li id="bcab" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">【https://www.reddit.com/r/bigquery/ T2】号</li></ul></div></div>    
</body>
</html>