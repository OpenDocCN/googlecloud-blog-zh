<html>
<head>
<title>Using Fog Google</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌雾</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/using-fog-google-1250f5e3dcf1?source=collection_archive---------0-----------------------#2016-10-28">https://medium.com/google-cloud/using-fog-google-1250f5e3dcf1?source=collection_archive---------0-----------------------#2016-10-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a7a6bd2b167a6d84e0ef22ed71d6dce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cje6dBjwwHxxlW8mskVhMg.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">树林里的雾。</figcaption></figure><div class=""/><p id="eded" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">两周前，我开始试验<a class="ae js" href="https://github.com/fog/fog" rel="noopener ugc nofollow" target="_blank">雾</a>，特别是<a class="ae js" href="https://github.com/fog/fog-google" rel="noopener ugc nofollow" target="_blank">雾-谷歌</a>。我在之前的一份工作中使用了fog和AWS，想看看对谷歌云平台的支持是否具有可比性。</p><p id="a695" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我不得不说这个实验很艰难。Fog的任务并不令人羡慕，它试图为大量具有不同功能和理念的云提供商提供一个逻辑统一的接口。此外，因为这是Ruby，所以它应该在保持最小惊奇原则的同时做到这一点。这可能是一项不可能完成的任务。也就是说，我能够使用计算引擎创建一个虚拟机，并使用fog将一个文件上传到云存储，所以我知道基本的工作。</p><h1 id="c96d" class="jt ju hx bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">证明</h1><p id="fc80" class="pw-post-body-paragraph iu iv hx iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">有许多方法可以使用fog设置身份验证。我选择使用一个和其他点文件一起保存的YAML文件。</p><figure class="la lb lc ld fd hk"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">一个例子。雾文件</figcaption></figure><p id="1c48" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">唯一棘手的是弄清楚<code class="du kw kx ky kz b">google_client_email</code>键是什么。这是自动生成的服务帐户id，看起来像电子邮件地址。您可以从云控制台中的服务帐户页面获得此信息。我使用了默认配置，但是如果你需要的话,<code class="du kw kx ky kz b">.fog</code>文件允许你有多种配置。例如，我可以想象拥有阶段、生产和开发配置会很方便。</p><h1 id="7dd5" class="jt ju hx bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">云存储</h1><p id="b4d6" class="pw-post-body-paragraph iu iv hx iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">将文件上传到云存储的代码很简单。</p><figure class="la lb lc ld fd hk"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">使用fog上传文件的基本脚本</figcaption></figure><p id="a51e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您需要做的就是连接到存储，创建一个桶，然后将您想要上传的对象放入桶中。您可以使用其他方法，但是API可能不完全直观。我建议查看<a class="ae js" href="http://fog.io/storage/" rel="noopener ugc nofollow" target="_blank">储雾文档</a>以了解最佳实践。</p><p id="afd0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用fog在计算引擎上创建虚拟机是一个两步过程。首先，创建一个磁盘，然后创建一个使用该磁盘的服务器。</p><p id="91d3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面是创建磁盘的代码。</p><figure class="la lb lc ld fd hk"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">在Google计算引擎上初始化和创建磁盘</figcaption></figure><p id="f0d3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">第1行到第6行连接到Google计算引擎，并设置稍后使用的常量。创建磁盘的方法采用选项哈希。我指定了桌子名称、大小、区域(使用常量)和操作系统映像。调用此方法开始创建磁盘，但磁盘不一定准备好立即挂载。所以我使用<code class="du kw kx ky kz b">disk.wait_for</code>来暂停我的脚本，直到磁盘准备好。</p><p id="5cc2" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">创建磁盘后，我可以在创建新虚拟机时使用它。</p><figure class="la lb lc ld fd hk"><div class="bz dy l di"><div class="le lf l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">用fog-google创建一个Google计算引擎虚拟机。(以上脚本的后半部分。)</figcaption></figure><p id="78a7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就像磁盘创建服务器创建需要一个选项散列。我指定了比创建磁盘更多的选项。我像对待磁盘一样传递名称和计算区域。我还传递了一个包含我刚刚创建的磁盘的磁盘数组。我必须指定机器的类型，并且我可以传入ssh密钥，这样一旦它准备好了，我就可以ssh到服务器。在调用<code class="du kw kx ky kz b">servers.create</code>之后，我等待服务器准备好，然后退出我的脚本。</p><h1 id="34ed" class="jt ju hx bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="a989" class="pw-post-body-paragraph iu iv hx iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">这是一篇关于雾和雾的超级基础介绍——谷歌。雾已经存在很长时间了，有许多教程涵盖了更具体的场景。雾-谷歌有一些粗糙的地方，但我知道几个人正在积极地工作，我希望也能贡献一些。</p><p id="af3c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi">10/28/16</p></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><p id="49d2" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="ln">原载于2016年10月28日【www.thagomizer.com】<a class="ae js" href="http://www.thagomizer.com/blog/2016/10/28/using-fog-google.html" rel="noopener ugc nofollow" target="_blank"><em class="ln"/></a><em class="ln">。</em></em></p></div></div>    
</body>
</html>