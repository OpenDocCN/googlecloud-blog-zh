<html>
<head>
<title>Building an API for your Medium posts with Google Cloud Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用谷歌云功能为你的中型文章建立一个API</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/building-an-api-for-your-medium-posts-with-google-cloud-functions-cafdd32359df?source=collection_archive---------0-----------------------#2018-03-30">https://medium.com/google-cloud/building-an-api-for-your-medium-posts-with-google-cloud-functions-cafdd32359df?source=collection_archive---------0-----------------------#2018-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="63b7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我需要一种方法来轻松地在客户端查询我的个人博客<a class="ae ix" href="https://tristansokol.com/" rel="noopener ugc nofollow" target="_blank"/>&amp;中的帖子，我想尝试编写我的第一个<a class="ae ix" href="https://cloud.google.com/shell/docs/tutorials" rel="noopener ugc nofollow" target="_blank"> Google Cloud Shell教程</a>。通过这篇文章，我们将创建一个可公开访问的端点来获取您的中型文章的json提要。</h2></div><p id="d5eb" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">这篇文章是最好的谷歌云外壳教程:</p><figure class="jv jw jx jy fd jz er es paragraph-image"><a href="https://console.cloud.google.com/cloudshell/open?git_repo=https://github.com/tristansokol/medium-get-latest-api-function-tutorial&amp;page=editor&amp;tutorial=tutorial.md"><div class="er es ju"><img src="../Images/692f7973f9ce164fe67caa59455dd61d.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*qP_7UZ7btKvJha1ilfbQVw.png"/></div></a></figure><p id="afc2" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="ja hj">开始之前</strong> : <br/> *确保你有一个中型账户，你想从<br/>发帖*有一个谷歌云平台账户<br/> *熟悉谷歌云平台命令行工具会有帮助。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kc"><img src="../Images/11dba7251c021806f43639e3fc9dea3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OV7_FmZJ4Lhj3ESm06PPKw.png"/></div></div></figure><h2 id="5275" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku jl kv kw kx jp ky kz la lb bi translated">Medium不是已经有API了吗？</h2><p id="dfb2" class="pw-post-body-paragraph iy iz hi ja b jb lc ij jd je ld im jg jh le jj jk jl lf jn jo jp lg jr js jt hb bi translated">是啊！Medium有一个API ,似乎主要是为了让你发布帖子而设计的。这对我获取内容没有太大帮助。真正有用的是未记录的<code class="du lh li lj lk b">json</code>格式，你可以在任何一个媒体页面上申请。您所需要做的就是将<code class="du lh li lj lk b">?format=json</code>追加到您的请求中。对我来说，我的最新帖子列在了<code class="du lh li lj lk b"><a class="ae ix" href="https://medium.com/@tristansokol/latest" rel="noopener">https://medium.com/@tristansokol/latest</a></code>上，而<code class="du lh li lj lk b"><a class="ae ix" href="https://medium.com/@tristansokol/latest?format=json" rel="noopener">https://medium.com/@tristansokol/latest?format=json</a></code>以一种有点方便的<code class="du lh li lj lk b">json</code>格式保存了所有这些信息。我没有把它放入我的页面的唯一原因是Medium在json ( <code class="du lh li lj lk b">). Oh well, nobo</code> dy可以停止determination &amp; javascript)前添加了明确的预防措施！</p><h2 id="2836" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku jl kv kw kx jp ky kz la lb bi translated">设置Google云</h2><p id="8420" class="pw-post-body-paragraph iy iz hi ja b jb lc ij jd je ld im jg jh le jj jk jl lf jn jo jp lg jr js jt hb bi translated">首先，您需要设定当前的云项目。</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="2811" class="kh ki hi lk b fi lp lq l lr ls">gcloud config set project YOUR_PROJECT_NAME</span></pre><p id="0e7c" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">接下来，使用如下命令查看您的项目是否启用了云功能:</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="95ce" class="kh ki hi lk b fi lp lq l lr ls">gcloud functions list</span></pre><p id="20b5" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">如果不是，您应该会得到这样的回应</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="1ea2" class="kh ki hi lk b fi lp lq l lr ls">API [cloudfunctions.googleapis.com] not enabled on project<br/>[single-cirrus-142722]. Would you like to enable and retry? (y/N)?</span></pre><p id="11b3" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">一个简单的<code class="du lh li lj lk b">y</code>将启用适当的API。</p><h2 id="8568" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku jl kv kw kx jp ky kz la lb bi translated">代码</h2><p id="0f10" class="pw-post-body-paragraph iy iz hi ja b jb lc ij jd je ld im jg jh le jj jk jl lf jn jo jp lg jr js jt hb bi translated">看一看<code class="du lh li lj lk b">index.js</code>。</p><p id="3510" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">你可以使用云壳的内置文本编辑器编辑存储在云壳中的文件，这不是很棒吗？代码非常简单，基本上是一个包装单个请求的包装器，去掉了跨站点防护。</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="9f0e" class="kh ki hi lk b fi lp lq l lr ls">exports.getLatest = (req, res) =&gt; {<br/> let username = ‘yourusername’;<br/> request(‘<a class="ae ix" rel="noopener" href="/@'">https://medium.com/@'</a> + username + ‘/latest?format=json’, function(error, response, body) {<br/> res.send(JSON.parse(body.substring(16)));<br/> });<br/>};</span></pre><p id="90c0" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">将用户名编辑为您的中型用户名！</p><h2 id="077f" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku jl kv kw kx jp ky kz la lb bi translated">部署功能</h2><p id="dda6" class="pw-post-body-paragraph iy iz hi ja b jb lc ij jd je ld im jg jh le jj jk jl lf jn jo jp lg jr js jt hb bi translated">将用户名保存到<code class="du lh li lj lk b">index.js</code>后，使用以下命令部署您的功能:</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="acb5" class="kh ki hi lk b fi lp lq l lr ls">gcloud functions deploy getLatest — trigger-http</span></pre><p id="3def" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">大G通过读取<code class="du lh li lj lk b">package.json</code>来处理你所有的依赖项，所以你不必担心上传任何其他东西。</p><h2 id="4b0b" class="kh ki hi bd kj kk kl km kn ko kp kq kr jh ks kt ku jl kv kw kx jp ky kz la lb bi translated">调用您的新API！</h2><p id="1070" class="pw-post-body-paragraph iy iz hi ja b jb lc ij jd je ld im jg jh le jj jk jl lf jn jo jp lg jr js jt hb bi translated">部署完成后，您应该会看到类似如下的输出</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="c4ad" class="kh ki hi lk b fi lp lq l lr ls">httpsTrigger:<br/> url: <a class="ae ix" href="https://us-central1-super-burrito-212121.cloudfunctions.net/getLatest" rel="noopener ugc nofollow" target="_blank">https://us-central1-super-burrito-212121.cloudfunctions.net/getLatest</a></span></pre><p id="db51" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">然后您可以尝试您的新API:</p><pre class="jv jw jx jy fd ll lk lm ln aw lo bi"><span id="4d53" class="kh ki hi lk b fi lp lq l lr ls">curl <a class="ae ix" href="https://us-central1-super-burrito-212121.cloudfunctions.net/getLatest" rel="noopener ugc nofollow" target="_blank">https://us-central1-super-burrito-212121.cloudfunctions.net/getLatest</a></span></pre><p id="8884" class="pw-post-body-paragraph iy iz hi ja b jb jc ij jd je jf im jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">你应该会得到一堆关于你在Medium上的最新帖子的json。</p></div></div>    
</body>
</html>