<html>
<head>
<title>Organization policies that must be enabled to strengthen your google cloud security.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">必须启用的组织政策，以加强您的google云安全。</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/organization-policies-that-needs-to-be-enforced-to-tighten-your-gcp-security-f3bfb724e9dd?source=collection_archive---------0-----------------------#2022-10-22">https://medium.com/google-cloud/organization-policies-that-needs-to-be-enforced-to-tighten-your-gcp-security-f3bfb724e9dd?source=collection_archive---------0-----------------------#2022-10-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0c7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">向所有人问好。今天，我们将探讨gcloud组织政策如何帮助建立跨项目的标准，并了解如果不采取行动会产生什么影响。</p><p id="2dd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是组织政策，为什么我需要改变它们？<br/> 组织策略由约束组成，这些约束定义了跨项目使用资源的一组规则和限制。有几个策略可能会对项目产生影响，默认情况下会启用它们。我们将看到一些有助于加强GCP环境安全的方法。</p><p id="707a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong> :-对大多数组织策略的更改不会影响现有的资源/权限，它们将仅在新的更改时实施。但是，很少有策略会撤销现有权限，请确保在执行任何策略之前确认相同的权限。<br/>通过以下链接访问组织政策<br/><a class="ae jd" href="https://console.cloud.google.com/iam-admin/orgpolicies/list?organizationId=" rel="noopener ugc nofollow" target="_blank">https://console . cloud . Google . com/iam-admin/org policies/list？organization id =</a>your _ GCP _ org _ id _ here</p><p id="9227" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是一些有助于确保GCP安全的政策。</p><p id="f0e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">禁用默认网络创建<br/> </strong>启用此选项将在新项目中创建一个默认VPC网络，并低于默认防火墙规则，将网络中所有实例上的RDP和ssh端口以及ICMP暴露给整个互联网，如果实例与公共IP连接，这可能会导致攻击暴露。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c168dcf0c40371c816e0b3aacffea3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkd0m7kgbRaE_TyhK9-pRg.png"/></div></div></figure><p id="53c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确保强制执行此组织策略，以避免创建默认网络。如果它已经在当前环境中使用，请确保在所有现有项目中删除上面列出的防火墙规则。<br/>运行下面的命令来审计项目中的所有防火墙规则，并查找与上面匹配的任何规则名称。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="fbe2" class="jv jw hi jr b fi jx jy l jz ka">gcloud asset search-all-resources --asset-types=compute.googleapis.com/firewall --scope=organizations/your_org_id_here --format="table(displayName,project)"</span></pre><p id="b258" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">禁用默认服务帐户的自动IAM授权<br/> </strong>在您的组织策略中默认启用此选项将为计算和云服务创建一个默认服务帐户，该帐户默认具有编辑者角色</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kb"><img src="../Images/c448c1382d3216096451af4201239fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*CtOch41H-hMQTO88QSBHNg.png"/></div></div></figure><p id="8c63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，我希望你不要让任何用户以编辑的身份访问与VM实例绑定的服务帐户和任何可以用来对GCP项目进行各种控制的组件。请确保实施此策略，并重新检查您的GCP项目的所有默认服务帐户权限。</p><p id="16a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是由gcloud <br/> <code class="du kc kd ke jr b">project-id@appspot.gserviceaccount.com<br/>project-number-compute@developer.gserviceaccount.com</code> <br/> <code class="du kc kd ke jr b">project-number@cloudservices.gserviceaccount.com<br/></code>创建的默认服务帐户了解更多关于默认服务的信息<a class="ae jd" href="https://cloud.google.com/iam/docs/service-accounts#default" rel="noopener ugc nofollow" target="_blank">这里</a></p><p id="411b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实施公共访问防护<br/> </strong>如果您想要限制某人意外公开暴露存储桶，此策略将有助于减少此类事件。这将防止存储桶公开暴露它们。此外，实施此策略将撤销在IAM级别或ACL级别上拥有公共权限allusers/allauthenticatedusers的所有现有存储桶。</p><p id="7881" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果存在公开公开对象的用例，并且您不能强制执行此策略，请考虑对bucket使用细粒度访问，这将允许将对象级别的权限设置为公开，而不是将整个bucket公开。将整个桶公开将会泄漏桶中所有对象的密钥标识符。使用细粒度访问，您可以通过编程将单个对象强制发布给公众。请参考文档<a class="ae jd" href="https://cloud.google.com/storage/docs/access-control/making-data-public#objects" rel="noopener ugc nofollow" target="_blank">中的</a>。</p><p id="d02f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">域受限共享<br/> </strong>默认情况下，所有域实体都允许添加到gcloud中的IAM策略中，像gmail.com或者其他任何域。通过强制实施属于允许或拒绝客户id工作区域的主体来启用此策略将避免添加不需要的域ID。通过在强制中添加您的工作区ID，您可以通过选择允许策略类型来限制属于您的工作区域的域。</p><p id="533b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获取您自己工作区的客户id，请参考此处的<a class="ae jd" href="https://support.google.com/a/answer/10070793?hl=en" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="1930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的GCP组织中运行审计，以查找是否有任何第三方域ID被添加到IAM策略中，并执行清理。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="41c6" class="jv jw hi jr b fi jx jy l jz ka">gcloud beta asset search-all-iam-policies --scope=organizations/your_gcp_org_id_here</span></pre><p id="fead" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">禁用虚拟机串口访问<br/> </strong>访问虚拟机串口访问没有IP限制。任何拥有实例ssh用户和密钥线索的人都可以访问任何人，即使没有IAM访问权限。保持这一点将有助于确保没有虚拟机启用虚拟机串行端口访问。</p><p id="6932" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">禁用服务帐户密钥创建<br/> </strong>默认情况下，服务帐户密钥的创建会将密钥设置为“Jan 10000”，这将导致拥有永久认证SA的密钥，并且永不过期。应该强制执行此策略，以防止密钥滥用，并在组织中建立标准的密钥轮换策略来限制密钥创建。<br/>我们之前已经讨论过服务账户密钥的最佳安全实践<a class="ae jd" rel="noopener" href="/@madhusm/best-security-practice-for-service-account-on-gcloud-3146e977dad3">这里</a></p><p id="1742" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">限制云SQL实例上的公共IP访问<br/> </strong>通过控制台选择创建云SQL实例的默认配置会导致附加公共IP。尽管授权网络是专门添加的，但将SQL放在内部网络上是最佳实践，而不是通过公共IP访问它们。实施这一点将有助于减少云SQL在公共网络上的暴露。</p><p id="fe71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这将有助于在您的GCP环境中审计和执行一些安全标准。很快再见</p></div></div>    
</body>
</html>