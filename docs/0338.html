<html>
<head>
<title>Ionic 3 + Google Cloud Vision + Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ionic 3 +谷歌云视觉+ Firebase</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/ionic-3-google-cloud-vision-firebase-78ea68cfbea8?source=collection_archive---------0-----------------------#2017-07-18">https://medium.com/google-cloud/ionic-3-google-cloud-vision-firebase-78ea68cfbea8?source=collection_archive---------0-----------------------#2017-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d026f08f71607420cf76011b5a39785e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cjj86mHPgHcFYD7OrcHZAA.png"/></div></div></figure><p id="892d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我一直在关注谷歌云视觉，并希望有一种快速的方法在现实世界中测试它，所以我拼凑了一个快速的Ionic 3应用程序。在我意识到它有多简单后，我决定一步一步地分享如何构建自己的。如果你只是想看代码，你可以在这里找到它<a class="ae jo" href="https://github.com/cbetz/my-stuff" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="128f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将构建一个Ionic 3移动应用程序，允许用户拍摄一些东西的照片，使用谷歌云视觉对其进行标记，并将图像和标签保存到Firebase实时数据库。这是完成的应用程序的简短演示:</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="2fdb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们开始吧！首先，我们将安装Ionic CLI，获得我们的Google Cloud项目设置，并启用我们需要的功能:</p><ol class=""><li id="bb00" class="jv jw hi is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated">按照这里<a class="ae jo" href="http://ionicframework.com/docs/intro/installation/" rel="noopener ugc nofollow" target="_blank">的说明</a>安装Ionic CLI。当您到达启动您的应用程序部分时停止，我们将在几分钟后到达该部分！</li><li id="f52d" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">创建一个新的谷歌云项目，并按照这里<a class="ae jo" href="https://cloud.google.com/vision/docs/before-you-begin" rel="noopener ugc nofollow" target="_blank">的说明</a>启用Vision API。</li><li id="5051" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated"><a class="ae jo" href="https://support.google.com/cloud/answer/6158862?hl=en" rel="noopener ugc nofollow" target="_blank">创建一个API密钥</a>。请务必在此查看API关键最佳实践<a class="ae jo" href="https://support.google.com/cloud/answer/6310037" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="219d" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">创建一个Firebase项目，方法是转到<a class="ae jo" href="https://firebase.google.com" rel="noopener ugc nofollow" target="_blank"> Firebase </a>，点击Get Started，然后点击Import Google Project按钮。选择您在步骤1中创建的项目。</li><li id="a5d0" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">通过单击数据库，然后单击规则选项卡来设置数据库规则。使用下面的配置。<strong class="is hj">重要提示:</strong>这会打开你的数据库，这样<strong class="is hj">任何人</strong>都可以读写数据。在真实的应用程序中，您会想要限制这种访问。</li></ol><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="4a04" class="ko kp hi kk b fi kq kr l ks kt">{<br/>  "rules": {<br/>    ".read": true,<br/>    ".write": true<br/>  }<br/>}</span></pre><p id="ac68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在开始有趣的部分！让我们使用“空白”模板创建一个新的Ionic 3应用程序:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="808d" class="ko kp hi kk b fi kq kr l ks kt">$ ionic start my-stuff blank</span></pre><p id="1e06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，跳转到您新创建的文件夹，安装一些我们将需要这个项目的依赖项:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="9dd0" class="ko kp hi kk b fi kq kr l ks kt">$ cd ./my-stuff</span><span id="09a8" class="ko kp hi kk b fi ku kr l ks kt">$ npm install angularfire2 firebase --save</span><span id="29aa" class="ko kp hi kk b fi ku kr l ks kt">$ ionic cordova plugin add cordova-plugin-camera</span><span id="31d0" class="ko kp hi kk b fi ku kr l ks kt">$ npm install --save <a class="ae jo" href="http://twitter.com/ionic" rel="noopener ugc nofollow" target="_blank">@ionic</a>-native/camera</span></pre><p id="7321" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面将添加firebase和angularfire2(两者都是与我们的实时Firebase数据库通信所需要的)以及添加Cordova相机插件和Ionic本地库。</p><p id="15d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动您最喜欢的代码编辑器并编辑src/app/app.module.ts。导入摄像机并将其添加到提供程序阵列中:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="feca" class="ko kp hi kk b fi kq kr l ks kt">import { Camera } from '@ionic-native/camera';</span><span id="d80e" class="ko kp hi kk b fi ku kr l ks kt">...</span><span id="7e6c" class="ko kp hi kk b fi ku kr l ks kt">providers: [</span><span id="438e" class="ko kp hi kk b fi ku kr l ks kt">  StatusBar,</span><span id="e15f" class="ko kp hi kk b fi ku kr l ks kt">  SplashScreen,</span><span id="e233" class="ko kp hi kk b fi ku kr l ks kt">  Camera,</span><span id="5cc5" class="ko kp hi kk b fi ku kr l ks kt">  {provide: ErrorHandler, useClass: IonicErrorHandler},</span><span id="f28c" class="ko kp hi kk b fi ku kr l ks kt">]<br/>...</span></pre><p id="a295" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，让我们创建一个文件来存储我们所有的Firebase配置设置:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="36ae" class="ko kp hi kk b fi kq kr l ks kt">$ touch ./src/environment.ts</span></pre><p id="a724" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步，您将需要Firebase配置设置。最快的方法是转到您的Firebase项目，并单击概述中的<strong class="is hj">将Firebase添加到您的web应用程序</strong>按钮。使用这些字符串来完成新创建的environment.ts文件:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="86ac" class="ko kp hi kk b fi kq kr l ks kt">export const environment = {</span><span id="9832" class="ko kp hi kk b fi ku kr l ks kt">  firebaseConfig: {</span><span id="fb6a" class="ko kp hi kk b fi ku kr l ks kt">    apiKey: "",</span><span id="34a3" class="ko kp hi kk b fi ku kr l ks kt">    authDomain: "",</span><span id="527a" class="ko kp hi kk b fi ku kr l ks kt">    databaseURL: "",</span><span id="9d8e" class="ko kp hi kk b fi ku kr l ks kt">    projectId: "",</span><span id="47b1" class="ko kp hi kk b fi ku kr l ks kt">    storageBucket: "",</span><span id="d495" class="ko kp hi kk b fi ku kr l ks kt">    messagingSenderId: ""</span><span id="4cae" class="ko kp hi kk b fi ku kr l ks kt">  }</span><span id="0fb2" class="ko kp hi kk b fi ku kr l ks kt">};</span></pre><p id="4539" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，回到src/app/app.module.ts，添加以下导入并添加Http和Firebase模块:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="09b2" class="ko kp hi kk b fi kq kr l ks kt">import { HttpModule } from '@angular/http';<br/>import { AngularFireModule } from 'angularfire2';<br/>import { AngularFireDatabaseModule } from 'angularfire2/database';<br/>import { AngularFireAuthModule } from 'angularfire2/auth';<br/>import { environment } from '../environment';</span><span id="f2cd" class="ko kp hi kk b fi ku kr l ks kt">...</span><span id="8d25" class="ko kp hi kk b fi ku kr l ks kt">imports: [</span><span id="dc87" class="ko kp hi kk b fi ku kr l ks kt">  BrowserModule,</span><span id="06b0" class="ko kp hi kk b fi ku kr l ks kt">  HttpModule,</span><span id="b562" class="ko kp hi kk b fi ku kr l ks kt">  IonicModule.forRoot(MyApp),</span><span id="eeb7" class="ko kp hi kk b fi ku kr l ks kt">  AngularFireModule.initializeApp(environment.firebaseConfig),</span><span id="8c9b" class="ko kp hi kk b fi ku kr l ks kt">  AngularFireDatabaseModule,</span><span id="aae0" class="ko kp hi kk b fi ku kr l ks kt">  AngularFireAuthModule</span><span id="a34e" class="ko kp hi kk b fi ku kr l ks kt">],</span><span id="0f1e" class="ko kp hi kk b fi ku kr l ks kt">...</span></pre><p id="60f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">既然我们已经将应用程序连接到Firebase，我们就可以继续使用Google Cloud Vision了。创建一个服务，使用Ionic CLI包装我们对Vision API的调用:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="11fc" class="ko kp hi kk b fi kq kr l ks kt">$ ionic g provider GoogleCloudVisionService</span></pre><p id="2ee9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开新创建的文件(/src/providers/Google-cloud-vision-service/Google-cloud-vision-service . ts)并添加以下内容:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="8ee2" class="ko kp hi kk b fi kq kr l ks kt">import { Injectable } from '@angular/core';<br/>import { Http } from '@angular/http';<br/>import 'rxjs/add/operator/map';<br/>import { environment } from '../../environment';</span><span id="f86b" class="ko kp hi kk b fi ku kr l ks kt">@Injectable()</span><span id="9d46" class="ko kp hi kk b fi ku kr l ks kt">export class GoogleCloudVisionServiceProvider {<br/>  constructor(public http: Http) { }</span><span id="b7a8" class="ko kp hi kk b fi ku kr l ks kt">  getLabels(base64Image) {</span><span id="944c" class="ko kp hi kk b fi ku kr l ks kt">    const body = {</span><span id="3159" class="ko kp hi kk b fi ku kr l ks kt">      "requests": [</span><span id="ac28" class="ko kp hi kk b fi ku kr l ks kt">        {</span><span id="6631" class="ko kp hi kk b fi ku kr l ks kt">          "image": {</span><span id="3732" class="ko kp hi kk b fi ku kr l ks kt">            "content": base64Image</span><span id="ddc4" class="ko kp hi kk b fi ku kr l ks kt">          },</span><span id="b1be" class="ko kp hi kk b fi ku kr l ks kt">          "features": [</span><span id="2497" class="ko kp hi kk b fi ku kr l ks kt">            {</span><span id="b0ed" class="ko kp hi kk b fi ku kr l ks kt">              "type": "LABEL_DETECTION"</span><span id="8fb4" class="ko kp hi kk b fi ku kr l ks kt">            }</span><span id="a21a" class="ko kp hi kk b fi ku kr l ks kt">          ]</span><span id="4963" class="ko kp hi kk b fi ku kr l ks kt">        }</span><span id="2d78" class="ko kp hi kk b fi ku kr l ks kt">      ]</span><span id="66a2" class="ko kp hi kk b fi ku kr l ks kt">    }</span><span id="906c" class="ko kp hi kk b fi ku kr l ks kt">    return this.http.post('https://vision.googleapis.com/v1/images:annotate?key=' + environment.googleCloudVisionAPIKey, body);<br/>    }<br/>}</span></pre><p id="8cce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这个应用程序，我们将只使用标签检测功能，但还有许多其他可用的功能。请务必查看所有可用的<a class="ae jo" href="https://cloud.google.com/vision/docs/reference/rest/v1/images/annotate#Feature" rel="noopener ugc nofollow" target="_blank">功能</a>。</p><p id="11d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您的代码编辑器可能会抱怨我们的googleCloudVisionAPIKey引用。让我们将它添加到我们的environment.ts文件中，填入您在步骤2中生成的API键:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="2d47" class="ko kp hi kk b fi kq kr l ks kt">googleCloudVisionAPIKey: ""</span></pre><p id="d2eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">信不信由你，我们现在有一个完全配置的应用程序，准备好了功能！我们需要一种方法来拍摄一张新照片，分析它，并显示结果。打开/src/pages/home.ts并添加我们的导入:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="a5f4" class="ko kp hi kk b fi kq kr l ks kt">import { Component } from '@angular/core';</span><span id="fba9" class="ko kp hi kk b fi ku kr l ks kt">import { AlertController } from 'ionic-angular';</span><span id="41a1" class="ko kp hi kk b fi ku kr l ks kt">import { Camera, CameraOptions } from '@ionic-native/camera';</span><span id="cd59" class="ko kp hi kk b fi ku kr l ks kt">import { GoogleCloudVisionServiceProvider } from '../../providers/google-cloud-vision-service/google-cloud-vision-service';</span><span id="99de" class="ko kp hi kk b fi ku kr l ks kt">import { AngularFireDatabase, FirebaseListObservable } from 'angularfire2/database';</span></pre><p id="94c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，为我们的项目创建一个FirebaseListObservable，并将其连接到我们的构造函数中:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="1b30" class="ko kp hi kk b fi kq kr l ks kt">items: FirebaseListObservable&lt;any[]&gt;;</span><span id="4714" class="ko kp hi kk b fi ku kr l ks kt">constructor(</span><span id="fa63" class="ko kp hi kk b fi ku kr l ks kt">  private camera: Camera,</span><span id="a845" class="ko kp hi kk b fi ku kr l ks kt">  private vision: GoogleCloudVisionServiceProvider,</span><span id="8cc8" class="ko kp hi kk b fi ku kr l ks kt">  private db: AngularFireDatabase,</span><span id="419e" class="ko kp hi kk b fi ku kr l ks kt">  private alert: AlertController) {</span><span id="3516" class="ko kp hi kk b fi ku kr l ks kt">    this.items = db.list('items');</span><span id="37d2" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="9d6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">FirebaseListObservable将实时数据库中的数据同步为我们的应用程序可以使用的列表。您将看到我们拍摄的新项目几乎立即添加到列表中，无需刷新！</p><p id="c506" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">说到这里，我们需要一种向实时数据库添加项目的方法:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="5f6e" class="ko kp hi kk b fi kq kr l ks kt">saveResults(imageData, results) {</span><span id="2b90" class="ko kp hi kk b fi ku kr l ks kt">  this.items.push({ imageData: imageData, results: results})</span><span id="c641" class="ko kp hi kk b fi ku kr l ks kt">    .then(_ =&gt; { })</span><span id="1a74" class="ko kp hi kk b fi ku kr l ks kt">    .catch(err =&gt; { this.showAlert(err) });</span><span id="2236" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="d6b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">saveResults获取base64图像数据和结果，并将它们推送到我们的FirebaseListObservable，后者处理数据同步。</p><p id="3035" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有一个效用函数来显示任何可能出现的错误:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="eccd" class="ko kp hi kk b fi kq kr l ks kt">showAlert(message) {</span><span id="08fd" class="ko kp hi kk b fi ku kr l ks kt">  let alert = this.alert.create({</span><span id="5a6f" class="ko kp hi kk b fi ku kr l ks kt">    title: 'Error',</span><span id="30b3" class="ko kp hi kk b fi ku kr l ks kt">    subTitle: message,</span><span id="537c" class="ko kp hi kk b fi ku kr l ks kt">    buttons: ['OK']</span><span id="057e" class="ko kp hi kk b fi ku kr l ks kt">  });</span><span id="a849" class="ko kp hi kk b fi ku kr l ks kt">  alert.present();</span><span id="98ab" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="7a9b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当然，我们需要一个函数来拍摄照片并调用我们的服务包装器:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="be81" class="ko kp hi kk b fi kq kr l ks kt">takePhoto() {</span><span id="e2b1" class="ko kp hi kk b fi ku kr l ks kt">  const options: CameraOptions = {</span><span id="7796" class="ko kp hi kk b fi ku kr l ks kt">    quality: 100,</span><span id="85a4" class="ko kp hi kk b fi ku kr l ks kt">    targetHeight: 500,</span><span id="fa64" class="ko kp hi kk b fi ku kr l ks kt">    targetWidth: 500,</span><span id="59fb" class="ko kp hi kk b fi ku kr l ks kt">    destinationType: this.camera.DestinationType.DATA_URL,</span><span id="395c" class="ko kp hi kk b fi ku kr l ks kt">    encodingType: this.camera.EncodingType.PNG,</span><span id="f3c0" class="ko kp hi kk b fi ku kr l ks kt">    mediaType: this.camera.MediaType.PICTURE</span><span id="aaac" class="ko kp hi kk b fi ku kr l ks kt">  }</span><span id="1342" class="ko kp hi kk b fi ku kr l ks kt">  this.camera.getPicture(options).then((imageData) =&gt; {</span><span id="a43d" class="ko kp hi kk b fi ku kr l ks kt">    this.vision.getLabels(imageData).subscribe((result) =&gt; {</span><span id="4f58" class="ko kp hi kk b fi ku kr l ks kt">      this.saveResults(imageData, result.json().responses);</span><span id="e9e4" class="ko kp hi kk b fi ku kr l ks kt">    }, err =&gt; {</span><span id="828d" class="ko kp hi kk b fi ku kr l ks kt">      this.showAlert(err);</span><span id="9b1e" class="ko kp hi kk b fi ku kr l ks kt">    });</span><span id="0543" class="ko kp hi kk b fi ku kr l ks kt">  }, err =&gt; {</span><span id="a586" class="ko kp hi kk b fi ku kr l ks kt">    this.showAlert(err);</span><span id="132b" class="ko kp hi kk b fi ku kr l ks kt">  });</span><span id="6122" class="ko kp hi kk b fi ku kr l ks kt">}</span></pre><p id="d8b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里发生了很多事情:</p><ol class=""><li id="3966" class="jv jw hi is b it iu ix iy jb jx jf jy jj jz jn ka kb kc kd bi translated">相机选项:重要的是，我们想要一张照片(不是视频)，我们希望通过DATA_URL获得图像数据，这将为我们提供base64图像数据。包括质量、大小和格式在内的其他选项由您决定，但是Vision API确实有限制，这里列出了<a class="ae jo" href="https://cloud.google.com/vision/docs/limits" rel="noopener ugc nofollow" target="_blank"/>。在测试时，我没有缩减文件大小，很快就达到了内容限制。</li><li id="bf42" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">当调用camera API的getPicture方法时，我们使用我们的Camera选项，该方法为我们提供base64图像数据。</li><li id="880d" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">我们获取base64图像数据，并将其传递给Google Cloud Vision服务包装器的getLabels方法。</li><li id="8da6" class="jv jw hi is b it ke ix kf jb kg jf kh jj ki jn ka kb kc kd bi translated">最后，我们将base64图像数据和API调用的原始结果保存到实时数据库中。</li></ol><p id="fcc6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们需要切换到/src/pages/home.html中的HTML:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="c747" class="ko kp hi kk b fi kq kr l ks kt">&lt;ion-header&gt;</span><span id="f840" class="ko kp hi kk b fi ku kr l ks kt">  &lt;ion-navbar&gt;</span><span id="8ec7" class="ko kp hi kk b fi ku kr l ks kt">    &lt;ion-title&gt;My Stuff&lt;/ion-title&gt;</span><span id="cc12" class="ko kp hi kk b fi ku kr l ks kt">  &lt;/ion-navbar&gt;</span><span id="ff58" class="ko kp hi kk b fi ku kr l ks kt">&lt;/ion-header&gt;<br/></span><span id="7443" class="ko kp hi kk b fi ku kr l ks kt">&lt;ion-content padding&gt;</span><span id="e785" class="ko kp hi kk b fi ku kr l ks kt">  &lt;ion-card *ngFor="let item of items | async"&gt;</span><span id="583a" class="ko kp hi kk b fi ku kr l ks kt">    &lt;img [src]="'data:image/png;base64,' + item.imageData"/&gt;</span><span id="0261" class="ko kp hi kk b fi ku kr l ks kt">    &lt;ion-card-content&gt;</span><span id="6039" class="ko kp hi kk b fi ku kr l ks kt">      &lt;ion-list no-lines&gt;</span><span id="2f2f" class="ko kp hi kk b fi ku kr l ks kt">        &lt;ion-list-header&gt;Labels&lt;/ion-list-header&gt;</span><span id="b65e" class="ko kp hi kk b fi ku kr l ks kt">        &lt;ion-item *ngFor="let label of item.results[0].labelAnnotations"&gt;{{label.description}}&lt;/ion-item&gt;</span><span id="e90a" class="ko kp hi kk b fi ku kr l ks kt">      &lt;/ion-list&gt;</span><span id="ce7a" class="ko kp hi kk b fi ku kr l ks kt">    &lt;/ion-card-content&gt;</span><span id="b0f5" class="ko kp hi kk b fi ku kr l ks kt">  &lt;/ion-card&gt;</span><span id="864b" class="ko kp hi kk b fi ku kr l ks kt">  &lt;ion-fab bottom right&gt;</span><span id="7b50" class="ko kp hi kk b fi ku kr l ks kt">    &lt;button ion-fab (click)="takePhoto()"&gt;<br/>      &lt;ion-icon name="camera"&gt;&lt;/ion-icon&gt;<br/>    &lt;/button&gt;</span><span id="4886" class="ko kp hi kk b fi ku kr l ks kt">  &lt;/ion-fab&gt;</span><span id="4086" class="ko kp hi kk b fi ku kr l ks kt">&lt;/ion-content&gt;</span></pre><p id="95c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将为我们的数据库中的每个项目创建一个卡片，其中包含从Google Cloud Vision返回的图像和标签列表。它还增加了一个FAB，点击后就会启动相机。</p><p id="c74f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">是时候测试一下了！您需要连接一个真实的设备并运行</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="8152" class="ko kp hi kk b fi kq kr l ks kt">$ ionic cordova run android --device</span></pre><p id="1d84" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="b987" class="ko kp hi kk b fi kq kr l ks kt">$ ionic cordova run ios --device</span></pre><p id="b353" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您遇到这样的错误:</p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="776b" class="ko kp hi kk b fi kq kr l ks kt">Error: ./node_modules/firebase/app/shared_promise.js<br/>Module not found: Error: Can't resolve 'promise-polyfill' in ...</span></pre><p id="4410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">试着运行下面的代码，从<a class="ae jo" href="https://github.com/ionic-team/ionic-app-scripts/issues/1001" rel="noopener ugc nofollow" target="_blank">到这里</a></p><pre class="jp jq jr js fd kj kk kl km aw kn bi"><span id="99ce" class="ko kp hi kk b fi kq kr l ks kt">$ npm install promise-polyfill --save-exact</span></pre><p id="0ac9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们只是触及了<a class="ae jo" href="https://cloud.google.com/vision/" rel="noopener ugc nofollow" target="_blank">谷歌云视觉</a>的皮毛。记住代码可在<a class="ae jo" href="https://github.com/cbetz/my-stuff" rel="noopener ugc nofollow" target="_blank">这里</a>获得。问题和公关是受欢迎的！</p><p id="ff23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>