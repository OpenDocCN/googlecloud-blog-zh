<html>
<head>
<title>The Google NLP API Meets Ruby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google NLP API遇上Ruby</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/the-google-nlp-api-meets-ruby-5453ba0ee0d3?source=collection_archive---------1-----------------------#2017-04-14">https://medium.com/google-cloud/the-google-nlp-api-meets-ruby-5453ba0ee0d3?source=collection_archive---------1-----------------------#2017-04-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7bd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在RailsConf，我将做一个关于自然语言处理的报告。作为我准备这次演讲的一部分，我一直在阅读自然语言处理的历史，并且一直在尝试谷歌的自然语言API。这个API的<a class="ae jd" href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/tree/master/google-cloud-language" rel="noopener ugc nofollow" target="_blank"> Ruby Gem </a>是alpha，但是它足够好来做基本的实验。</p><h2 id="22e6" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">语法分析</h2><p id="5706" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">关于NLP，最让我感兴趣的事情之一是语法分析。对英语做静态分析是很棘手的。甚至确定词性也很难。例如，在句子“我要离开工作”中，工作是一个名词。我要离开一个实体的地方。但是在这个句子中，“我致力于我的谈话”是一个动词。像“very”这样的词既可以是副词，也可以是形容词，这取决于它们在句子中的位置。</p><p id="c7d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管有这些挑战，知道词性还是很有用的。在上周的西雅图Ruby Brigade会议上，我们开发了一个文本生成器，最终将用于聊天机器人。我们为我们的机器人使用简单的<a class="ae jd" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank">马尔可夫链</a>，但有时会导致语法错误的句子。如果我们能够确保每个句子都有一个动词和一个主语，那么生成的文本可能会更好。</p><p id="188b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自然语言API将输入文本分解成标记(单词和标点符号)，然后提供关于每个标记的信息。下面是一些基本代码，它们使用自然语言API来识别输入中每个单词的词性。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="3dbd" class="je jf hi kj b fi kn ko l kp kq">require "google/cloud/language"<br/><br/>language = Google::Cloud::Language.new<br/><br/>content = ARGV[0]<br/><br/>document = language.document content<br/>syntax = document.syntax<br/><br/>syntax.tokens.each do |token|<br/>  puts "Token: #{token.text_span.text} #{token.part_of_speech.tag}"<br/>end</span></pre><p id="38be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将这段代码与句子“猫在玩耍”进行了对比得到了这个输出。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="ae5d" class="je jf hi kj b fi kn ko l kp kq">Token: The DET<br/>Token: cat NOUN<br/>Token: plays VERB<br/>Token: . PUNCT</span></pre><p id="41ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们更熟悉的将标签映射到标记的枚举是这里的<a class="ae jd" href="https://cloud.google.com/natural-language/docs/reference/rpc/google.cloud.language.v1#tag" rel="noopener ugc nofollow" target="_blank"/>。对照一个稍长的句子，“猫在玩玩具。”给了我这个。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="9238" class="je jf hi kj b fi kn ko l kp kq">Token: The DET<br/>Token: cat NOUN<br/>Token: plays VERB<br/>Token: with ADP<br/>Token: the DET<br/>Token: toy NOUN<br/>Token: . PUNCT</span></pre><p id="007d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这两个例子中，API将cat标识为名词，将play标识为动词。被标识为限定词；你可能知道这是一篇文章。在较长的句子中，“with”被识别为“Adposition(介词和后置)”。</p><p id="978b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NLP API还可以通过使用标记的“标签”属性来识别特定单词在句子中扮演的角色。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="1b20" class="je jf hi kj b fi kn ko l kp kq">require "google/cloud/language"<br/><br/>language = Google::Cloud::Language.new<br/><br/>content = ARGV[0]<br/><br/>document = language.document content<br/>syntax = document.syntax<br/><br/>syntax.tokens.each do |token|<br/>  puts "Token: #{token.text_span.text} #{token.label}"<br/>end</span></pre><p id="cc0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是通过API运行上面的长句子的结果。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="2d26" class="je jf hi kj b fi kn ko l kp kq">Word: The DET<br/>Token: cat NSUBJ<br/>Token: plays ROOT<br/>Token: with PREP<br/>Token: the DET<br/>Token: toy POBJ<br/>Token: . P</span></pre><figure class="ke kf kg kh fd ks er es paragraph-image"><div class="er es kr"><img src="../Images/9ee97e137d347eaafabf96a4d6149d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*Fbiopwc2ahy5fIa6ni6Y6w.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">猫在玩玩具。</figcaption></figure><p id="c53b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Cat被确定为主语，plays作为句子的词根，“with the toy”作为介词短语(介词、限定词、介词宾语)。</p><p id="b3a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我一直喜欢摆弄API，只是为了学习它，看看优势在哪里。下面是我使用graph gem和语法分析调用返回的信息制作的图表。</p><p id="0a6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的Rails Conf talk中，我将展示其他句子图解方法，并更详细地说明所有这些语法术语对那些忘记中学语法的人意味着什么。</p><h2 id="a110" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">情感分析</h2><p id="0827" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">在圣安东尼奥的Ruby Conf上，我做了一个题为<a class="ae jd" href="https://www.youtube.com/watch?v=_O1MGHcsQCI" rel="noopener ugc nofollow" target="_blank">许多计算机的愚蠢想法</a>的演讲。在那次演讲中，我通过给各种表情符号赋值，从推文中提取表情符号，然后把所有东西加起来，对推文进行了非常粗糙的情感分析。这是一个极其愚蠢的想法，但这正是我们演讲的目的。</p><p id="f1b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将在Rails Conf上重复这段代码，但这次我将使用适当的情感分析。代码类似于上面的语法分析代码。</p><pre class="ke kf kg kh fd ki kj kk kl aw km bi"><span id="4394" class="je jf hi kj b fi kn ko l kp kq">require "google/cloud/language"<br/><br/>language = Google::Cloud::Language.new<br/><br/>content = ARGV[0]<br/><br/>document = language.document content<br/>sentiment = document.sentiment<br/><br/>puts sentiment.score<br/>puts sentiment.magnitude</span></pre><p id="5b72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分数是介于-1(消极情绪)和1(积极情绪)之间的数字。量级是衡量信息“有多少”是负面或正面的。我通过情绪分析器发了一些微博。</p><figure class="ke kf kg kh fd ks"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="d837" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我精心挑选了这一张，因为我相信这种情绪会是积极的。我的情绪得分是0.7，震级是1.5。所以用粗话来说就是“非常肯定”。我还尝试了西雅图Ruby Brigade发出的提醒我们开会的推文。</p><figure class="ke kf kg kh fd ks"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="04f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对此的情绪是0.1，所以几乎是中性的。震级为1.3级。总的来说，这大约是“非常强烈的中立”。</p><h2 id="7407" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">结论</h2><p id="01a0" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">如果您喜欢这些例子，我鼓励您尝试一下云自然语言API库，并尝试它支持的所有不同类型的分析。如果你参加了Rails Conf，你可以在我的演讲中看到更多的例子，或者在Google Cloud展台前停下来，在代码实验室里尝试一下。</p><p id="4434" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lb">原载于</em><a class="ae jd" href="http://thagomizer.com/blog/2017/04/13/the-google-nlp-api-meets-ruby.html" rel="noopener ugc nofollow" target="_blank"><em class="lb">——命运之刺</em> </a></p></div></div>    
</body>
</html>