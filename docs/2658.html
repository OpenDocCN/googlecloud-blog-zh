<html>
<head>
<title>Use case-1: Data Migration from Panzura to Google Cloud Storage using Data Transfer Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用例1:使用数据传输服务将数据从Panzura迁移到Google云存储</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/use-case-data-migration-from-panzura-to-google-cloud-storage-using-data-transfer-service-d1b7f4e5a876?source=collection_archive---------5-----------------------#2022-12-21">https://medium.com/google-cloud/use-case-data-migration-from-panzura-to-google-cloud-storage-using-data-transfer-service-d1b7f4e5a876?source=collection_archive---------5-----------------------#2022-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="104c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">问题陈述— </strong></p><p id="ac48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们要求将大约240 TB的数据从Panzura迁移到Google云存储，并在迁移后停止使用Panzura。Panzura设备安装在内部数据中心，接收来自内部应用程序的文件，将其压缩并以其专有格式保存在AWS S3存储桶中。我们无法使用Google Cloud Transfer appliance服务，因为Panzura appliance将需要在迁移后解压缩文件。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="e7a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">术语- </strong></p><p id="5960" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Panzura </strong>是一个基于云的文件存储和协作平台，允许用户随时随地访问、共享和协作文件。</p><p id="8811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">谷歌云数据传输服务</strong>允许用户通过安全的高带宽网络连接将数据从内部系统传输到谷歌云存储。这对于快速高效地传输大量数据特别有用。</p><p id="9349" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">谷歌云存储</strong>是一种基于云的对象存储服务，允许用户从谷歌的基础设施中存储和检索数据。</p><p id="4bf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将了解如何使用数据传输服务将数据从Panzura传输到Google云存储，以便通过高可用性虚拟专用网络(HA VPN)连接将数据从本地传输到Google云存储。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="9986" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案架构— </strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/b46e642a2239db9dac70a13e990786aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NB7qnM08UhfSBfT5wy71Fw.png"/></div></div></figure><p id="6f31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图1 —将数据从Panzura内部迁移到Google云存储的高级架构</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="3bf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">先决条件</strong></p><ul class=""><li id="f376" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">潘祖拉账户</li><li id="db54" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">谷歌云账户</li><li id="1add" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">将Panzura设备文件路径作为共享驱动器装载到本地虚拟机</li><li id="78fa" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">将数据传输代理作为数据源安装到本地虚拟机。</li><li id="7748" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">在您的内部系统和Google Cloud之间建立高可用性VPN连接</li></ul></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="802e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:设置谷歌云存储桶</strong></p><p id="0a01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是创建一个Google云存储桶，用于存储从Panzura传输的数据。为此，请按照下列步骤操作:</p><p id="3acf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.登录<a class="ae kk" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>。</p><p id="23a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.单击顶部栏中的项目下拉列表，并选择要用于存储桶的项目。</p><p id="5fc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.点击汉堡菜单，选择“存储”</p><p id="c0b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.单击“创建存储桶”按钮。</p><p id="5d79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.在“创建存储桶”表单中，输入存储桶的唯一名称，选择存储类别和位置，然后单击“创建”。</p><p id="0eae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤2:设置数据传输服务</strong></p><p id="9a91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据传输服务允许您通过高可用性VPN连接将数据从本地系统传输到Google云存储。要设置它，请按照下列步骤操作:</p><ol class=""><li id="1319" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kl kc kd ke bi translated">在谷歌云控制台中，进入<a class="ae kk" href="https://console.cloud.google.com/transfer" rel="noopener ugc nofollow" target="_blank">数据传输服务页面</a>。</li><li id="64e3" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">单击“创建传输作业”按钮。</li><li id="521f" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">在“创建传输作业”表单中，输入传输作业的名称，并选择“内部”作为源，选择“Google云存储”作为目标。</li><li id="a86d" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">点击“继续”按钮。</li><li id="0f5e" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">在“指定传输细节”页面上，选择您在步骤1中创建的Google云存储桶作为传输数据的目的地。</li><li id="379b" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">输入本地系统上要传输的数据的路径。</li><li id="9835" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">选择传输作业的时间表。您可以选择一次性传输数据或重复传输数据。</li><li id="3174" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kl kc kd ke bi translated">单击“创建”按钮创建传输作业。</li></ol><p id="ac06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:监控传输</strong></p><p id="7e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置传输作业后，数据传输服务将开始通过HA VPN连接将数据从您的内部系统传输到Google云存储。您可以在Google Cloud控制台的数据传输服务页面中监控传输进度。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="ea90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">挑战</strong></p><ol class=""><li id="918f" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kl kc kd ke bi translated"><strong class="ih hj">网络带宽问题</strong> —最初数据传输速率非常低(<strong class="ih hj"> ~100 Kbps </strong>)，因为Panzura设备和本地虚拟机使用不同的物理网络，因此它们必须通过多个防火墙和安全规则。</li></ol><p id="e44a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案</strong> —将本地虚拟机迁移到安装了Panzura设备的同一网络后，<strong class="ih hj">网络带宽</strong>增加了<strong class="ih hj"> 200倍</strong>达到<strong class="ih hj"> ~200 Mbps </strong>。仍然没有得到预期的1.5 Gbps-2 Gbps的带宽。</p><p id="18b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进一步分析这个问题，我们发现Panzura装置启用了网络带宽限制，一旦我们禁用它，我们看到数据传输速率急剧<strong class="ih hj"> 1000倍</strong>增加到<strong class="ih hj"> 1 Gbps </strong>。</p><p id="0be8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">由于文件大小导致的传输速率限制— </strong>尽管现在我们能够实现1000倍的网络吞吐量，但仍有优化的空间，因为总可用带宽为2 Gbps</p><p id="c76b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案— </strong>经过几天的努力，我们解决了这个问题，为小于500 KB的文件创建了不同的数据集，并在多个虚拟机上使用多个数据传输代理进行并行传输，从而将传输速率优化到1.8 Gbps (~ 2 Gbps)。大于500 KB的文件在单个虚拟机上处理，因为它以大约1.5 Gbps到1.9 Gbps的速度运行</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="20ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总结</strong></p><p id="337b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们研究了如何使用数据传输服务将数据从Panzura传输到Google云存储。通过遵循本文中概述的步骤，我们能够将大约240 TB的数据从Panzura迁移到Google云存储，并利用Google基于云的对象存储服务的可伸缩性、可靠性和安全性。</p><p id="881f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们开始数据迁移时，预计的完成时间是18个月到24个月，但我只用了3个月就完成了。</p><p id="2af8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这在经济上帮助了客户很多美元，因为他们可以停止支付使用Panzura服务的许可费用。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="27ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关于我</strong> —我是多云认证云架构师；目前的工作任务集中在谷歌云平台上。过去18个月我写了17+云认证(9+ GCP)，最近通过了GCP-专业网络工程师认证。</p><p id="9331" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有任何问题，可以通过<a class="ae kk" href="https://www.linkedin.com/in/jitu028/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> LinkedIn </strong> </a> <strong class="ih hj"> </strong>和Twitter<a class="ae kk" href="https://twitter.com/jitu028" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">@ jitu 028</strong></a>和DM联系我，我很乐意帮忙！！</p></div></div>    
</body>
</html>