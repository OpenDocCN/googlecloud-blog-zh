<html>
<head>
<title>BigQuery Omni is everywhere</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery Omni无处不在</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/bigquery-omni-is-everywhere-afa2b5f64688?source=collection_archive---------0-----------------------#2022-03-10">https://medium.com/google-cloud/bigquery-omni-is-everywhere-afa2b5f64688?source=collection_archive---------0-----------------------#2022-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/9eacea88c885cd7f460f6d74e3c752cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*K6UyKy8jVoMOJDO7TUHOIg.png"/></div></figure><p id="8d0c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">每次你喜欢使用一个工具时，你最终会需要尚未可用的特性…</p><p id="a2c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这一次圣诞老人比预期的早到了！</p><p id="be59" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我的公司在企业数据仓库中大量使用BigQuery，但是像其他老公司一样，我们的遗留应用程序远离当前平台。</p><p id="d430" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">相信我，这就像试图在没有翻译的情况下讨论西班牙人和中国人一样，几乎是不可能的。</p><p id="e772" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这里，我们有Omni(一年前在Google Next大会上宣布)来帮助我们完成这项任务。承诺是:</p><ul class=""><li id="f4a7" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">您的数据可以被<strong class="io hj">优先</strong></li><li id="3502" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">你的数据可以在另一个<strong class="io hj">云服务提供商</strong>上</li><li id="b036" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">您的数据将可用于<strong class="io hj"> BigQuery </strong></li></ul><p id="a6da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">听起来不错，因为我在世界各地的Microsoft Azure上托管了大量数据，有时BigQuery还不可用。</p><p id="33ea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">试试Omni能不能解决这个！</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es jy"><img src="../Images/9ea3617c7c1008c7d7c70b1a46594d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*paaeHYf7Gs5OUCDgUN_VFA.jpeg"/></div></div></figure><p id="061d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面的例子是关于AWS的，但是我的例子是关于Azure的。</p><p id="132b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我必须上传或使用Azure区域上已经存储的数据，格式为JSON、Parquet、Avro、ORC或CSV。</p><p id="ea68" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">BigQuery控制台的第一步是在两个世界之间建立连接(安全的外部连接)</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kh"><img src="../Images/e92eb681bd67e548a24a8783fc82212a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6n3bjCYGsXGzC41-ztxQA.png"/></div></div></figure><p id="3e7e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在魔法可以运作了</p><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es ki"><img src="../Images/bf72f166aa239947716ad19f8adbc47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfAxOlhd3LOul7aTPafovA.jpeg"/></div></div></figure><p id="4c24" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">现在是基准时间！</strong></p><p id="c556" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">SQL是一个标准，不仅仅是在我的公司。我想看看我能做些什么，只要记住一个重要的事实:</p><ul class=""><li id="788c" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">在您选择托管BigQuery的CSP上有一个Anthos集群(由Google管理)</li><li id="0dda" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">处理在CSP上完成，结果返回到控制台</li><li id="8411" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">Omni的目标是帮助公司在BigQuery上提供数据，而不是在GCP之外提供100%相同的BigQuery性能。因为它的运行位置可能会有所不同，并且您发送回控制台的数据量可能会受到网络等不同因素的影响。</li></ul><p id="fda8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一次基准测试(公共数据)</strong></p><p id="a324" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我使用芝加哥出租车公共数据源来了解我的查询运行了多长时间:</p><ul class=""><li id="06a1" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">77 GB表</li><li id="d835" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">19，5856，374行</li><li id="5d32" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">没有分区</li><li id="211d" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">全扫描</li><li id="a4f3" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">使用运算符的最后测试意味着使用AVG、提取日期、格式、组和顺序</li></ul><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kj"><img src="../Images/c0724c5bf4378c6f8b6caf654ce0e9ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwGPGPRJN6RK7qEPb6OMOg.png"/></div></div></figure><p id="f4d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我将限制从1000更改为5000，只是为了在控制台中返回更大量的数据(不要太大，否则我会得到太大的错误输出，当前返回到控制台的数据限制为2MB)</p><p id="c8c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我也尝试过不在控制台而是直接将结果返回给源(Azure)，太费时间了，忘了那个想法吧…</p><p id="61c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二基准(公司数据)</strong></p><ul class=""><li id="4407" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">1 TB表作为数据源+ 200MB表</li><li id="e014" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">9172577750行</li><li id="0970" class="jk jl hi io b ip jt it ju ix jv jb jw jf jx jj jp jq jr js bi translated">与Limit 10000一起使用的内部联接函数(因为当前Omni对返回到控制台的数据的大小有限制)</li></ul><figure class="jz ka kb kc fd ij er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kk"><img src="../Images/0fb4e2097dd1f9c0c04279f012872e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfHsc6Z83qV3YKd5WLZy2Q.png"/></div></div></figure><p id="821d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">结论:</strong></p><p id="c7da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">性能没有那么差，那真的能解决问题！</p><p id="cb66" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在等待更多的选项和功能可用。</p></div></div>    
</body>
</html>