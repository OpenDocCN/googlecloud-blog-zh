<html>
<head>
<title>Introduction to GKE On-Prem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GKE本地简介</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/introduction-to-gke-on-prem-78a42d630eb9?source=collection_archive---------1-----------------------#2022-09-29">https://medium.com/google-cloud/introduction-to-gke-on-prem-78a42d630eb9?source=collection_archive---------1-----------------------#2022-09-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/a5005345e659d04e8f424ad3a294875a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*2sz94jhWbUKBwmp64uzYpw.png"/></div></figure><div class=""/><p id="df51" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">嘿大家，我希望你们都做得很好。在这篇文章中，我想向您概述一下VMware上的GKE本地Anthos。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><blockquote class="jr"><p id="5774" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">订阅我的频道，<a class="ae kb" href="https://www.youtube.com/c/TheCloudPilot" rel="noopener ugc nofollow" target="_blank">云领航</a></p></blockquote></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="cdef" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq"> Anthos clusters on VMware，也称为GKE on-prem，</strong>是一款将谷歌Kubernetes引擎(GKE)引入本地数据中心的软件。借助VMware上的Anthos集群，<strong class="io hq"> <em class="kc">，您可以在自己的内部环境中创建、管理和升级Kubernetes集群</em> </strong>。</p><p id="6b2d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它还将为用户提供:</p><ol class=""><li id="a91b" class="kd ke hp io b ip iq it iu ix kf jb kg jf kh jj ki kj kk kl bi translated">能够管理和维护运行在Google Cloud或他们自己的数据中心的Kubernetes集群。</li><li id="e95c" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj ki kj kk kl bi translated">使用云操作监控其集群的能力。</li><li id="4c98" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj ki kj kk kl bi translated">能够在本地运行的Kubernetes集群上部署市场应用程序。</li></ol><p id="f464" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">【了解Kubernetes？阅读</strong> <a class="ae kb" href="http://bit.ly/KubernetesRetail" rel="noopener ugc nofollow" target="_blank"> <strong class="io hq">为什么零售商选择在Kubernetes </strong> </a> <strong class="io hq">上</strong> <a class="ae kb" href="http://bit.ly/GoogleCloudBlogHome" rel="noopener ugc nofollow" target="_blank"> <strong class="io hq">谷歌云博客</strong> </a> <strong class="io hq">。] </strong></p><h1 id="a28d" class="kr ks hp bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">GKE本地建筑</h1><figure class="lq lr ls lt fd hk er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lp"><img src="../Images/797c929bc8ca4084cbc5ef8a74891bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eCVgulUfF9r8a1kH"/></div></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">来源:<a class="ae kb" href="https://cloud.google.com/static/anthos/clusters/docs/on-prem/1.11/images/architecture_ha_09302019.png" rel="noopener ugc nofollow" target="_blank"> GKE本地架构</a></figcaption></figure><p id="1448" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">GKE本地部署在您的数据中心正常运行需要三样东西。</p><ul class=""><li id="8f96" class="kd ke hp io b ip iq it iu ix kf jb kg jf kh jj mc kj kk kl bi translated"><strong class="io hq">运行vSphere 6.5的VMware vSphere集群</strong>(这是GKE本地版本1.0唯一支持的版本)</li><li id="9c7a" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj mc kj kk kl bi translated"><strong class="io hq"> F5 BIG-IP LTM </strong>为K8s集群中定义的应用服务提供负载平衡器类型支持。</li><li id="4c00" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj mc kj kk kl bi translated"><strong class="io hq">管理工作站</strong>:管理工作站是部署GKE本地集群所需的所有不同实用程序的捆绑包，这些集群可以部署在运行VirtualBox或不同管理集群的笔记本电脑上。</li></ul><blockquote class="md me mf"><p id="1445" class="im in kc io b ip iq ir is it iu iv iw mg iy iz ja mh jc jd je mi jg jh ji jj hb bi translated">VMware vSphere提供了两个主要组件来为用户提供更好的本地体验。</p></blockquote><p id="38c3" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Kubernetes的<strong class="io hq"> vSphere Cluster API </strong>和<strong class="io hq"> vSphere Cloud Provider </strong>插件使用户能够无缝部署虚拟机，使其成为管理和用户Kubernetes集群的一部分，并能够分别为运行在Kubernetes集群之上的应用程序单元或容器提供持久存储。</p><p id="b45d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">vSphere Cluster API添加了以下构造，以简化底层虚拟机的部署:</p><h2 id="0c3d" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">机器</h2><blockquote class="md me mf"><p id="0344" class="im in kc io b ip iq ir is it iu iv iw mg iy iz ja mh jc jd je mi jg jh ji jj hb bi translated">机器是在vSphere基础架构上运行的虚拟机。</p></blockquote><p id="c8c0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它们相当于Kubernetes豆荚。所有虚拟机级别的详细信息，如CPU、内存、存储和基本操作系统要求，都可以使用机器定义来定义。</p><h2 id="5c94" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">机组</h2><p id="27c3" class="pw-post-body-paragraph im in hp io b ip mx ir is it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj hb bi translated"><strong class="io hq">与副本集</strong>类似，您可以定义支持K8s集群所需的机器数量，机器集控制器将运行一个协调循环，以确保所需状态与当前状态相匹配。</p><h2 id="0358" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">机器部署</h2><p id="9776" class="pw-post-body-paragraph im in hp io b ip mx ir is it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj hb bi translated"><strong class="io hq">与部署</strong>类似，您可以使用机器部署的概念对您的机器(VM)的底层基础操作系统执行滚动更新。</p><h2 id="3368" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">机器类别</h2><p id="c2e2" class="pw-post-body-paragraph im in hp io b ip mx ir is it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj hb bi translated"><strong class="io hq">类似于存储类定义</strong>，这使您能够在一个地方指定所有特定于环境的配置参数，而不是必须在每个机器定义中定义它。</p><p id="d3d1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用vSphere Cluster API，您可以部署、管理和扩展您的虚拟基础架构，就像Kubernetes部署、管理和扩展您的容器化应用程序一样。</p><h2 id="5550" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">vSphere云提供商</h2><p id="792d" class="pw-post-body-paragraph im in hp io b ip mx ir is it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj hb bi translated"><strong class="io hq"><em class="kc">VSP here Cloud Provider</em></strong><strong class="io hq"><em class="kc">插件</em> </strong>内置于上游K8s中，因此您将不必担心部署任何额外的CSI插件来为容器提供持久存储。<strong class="io hq"><em class="kc">VSP here Cloud Provider plugin</em></strong>支持用户使用装载在<strong class="io hq"> <em class="kc"> vSphere (NFS、VMFS或vSAN) </em> </strong>上的任何数据存储中的存储。当您使用<strong class="io hq"> <em class="kc"> vSAN数据存储</em> </strong>时，您可以将所有<strong class="io hq"> <em class="kc">基于存储策略的管理(SPBM) </em> </strong>功能扩展到Kubernetes内的存储类定义。K8s定义的<strong class="io hq"> <em class="kc">持久卷</em> </strong>在<strong class="io hq"><em class="kc">vsanDatastore</em></strong>中创建为VMDK文件，然后挂载到运行您的pod的虚拟机上。</p><h2 id="8074" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">在本地部署GKE</h2><p id="bf76" class="pw-post-body-paragraph im in hp io b ip mx ir is it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj hb bi translated">当您使用管理工作站部署初始GKE本地集群时，您将部署一个管理集群和一个单用户集群。</p><ol class=""><li id="6009" class="kd ke hp io b ip iq it iu ix kf jb kg jf kh jj ki kj kk kl bi translated"><strong class="io hq">管理集群</strong>负责运行GKE本地的所有控制平面组件。</li><li id="654e" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj ki kj kk kl bi translated">当您想要部署额外的用户集群时，您可以使用<em class="kc"> gkectl </em>与管理集群对话，然后管理集群将与<strong class="io hq"><em class="kc">vCenter API</em></strong>对话，为新的用户集群部署额外的虚拟机。</li><li id="91be" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj ki kj kk kl bi translated"><strong class="io hq">用户集群</strong>是你部署应用的地方。</li><li id="be1b" class="kd ke hp io b ip km it kn ix ko jb kp jf kq jj ki kj kk kl bi translated">用户集群的主节点也参与管理集群。</li></ol><blockquote class="md me mf"><p id="4ca5" class="im in kc io b ip iq ir is it iu iv iw mg iy iz ja mh jc jd je mi jg jh ji jj hb bi translated">购买Anthos许可证时，您只需为用户群集中虚拟机使用的vCPUs付费。<strong class="io hq">这种架构被称为Kubeception。</strong></p></blockquote><h2 id="3780" class="mj ks hp bd kt mk ml mm kx mn mo mp lb ix mq mr lf jb ms mt lj jf mu mv ln mw bi translated">从Google云控制台管理您所有的本地集群</h2><blockquote class="jr"><p id="df59" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">Google Cloud提供了一项名为Connect的服务，可以帮助您将本地集群连接回Google Cloud。</p></blockquote><blockquote class="md me mf"><p id="27c2" class="im in kc io b ip nc ir is it nd iv iw mg ne iz ja mh nf jd je mi ng jh ji jj hb bi translated">它允许您<strong class="io hq">管理您的集群、部署应用程序、工作负载</strong>以及<strong class="io hq">将自动扩展策略应用于本地运行的pod</strong>。</p></blockquote><p id="f877" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">连接代理</strong> <strong class="io hq"> <em class="kc">需要一个服务帐户密钥</em> </strong>来拥有连接到Google Cloud的正确权限，并且它在您的集群中作为K8s部署运行。一旦连接，它将与运行在Google Cloud中的控制平面共享有关集群、工作负载和任何元数据的信息。</p></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><blockquote class="jr"><p id="5a7b" class="js jt hp bd ju jv jw jx jy jz ka jj dx translated">除非您想要访问任何其他GCP服务，否则您不需要额外的VPN或云互连连接用于GKE本地。</p></blockquote></div><div class="ab cl jk jl gp jm" role="separator"><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp jq"/><span class="jn bw bk jo jp"/></div><div class="hb hc hd he hf"><p id="ff39" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">这是对GKE本地部署(基于VMware的Anthos)的高级概述</strong>。希望这对你有帮助。感谢您的阅读。回头见！</p></div></div>    
</body>
</html>