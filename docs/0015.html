<html>
<head>
<title>My Slow Internet vs Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的慢速互联网vs Docker</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/my-slow-internet-vs-docker-7678ae1cae72?source=collection_archive---------1-----------------------#2015-07-20">https://medium.com/google-cloud/my-slow-internet-vs-docker-7678ae1cae72?source=collection_archive---------1-----------------------#2015-07-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在纽约工作，住在一个微型工作室里。公寓提供Wi-Fi，但不幸的是，它的带宽非常低，而且经常不可靠。我也经常旅行，我花很多时间在火车上、飞机上和酒店里，这些地方的互联网接入速度慢且不可靠。</p><p id="36e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我经常构建Docker映像——为了工作，为了<a class="ae jd" href="https://github.com/saturnism/spring-boot-docker" rel="noopener ugc nofollow" target="_blank">演示</a>，为了<a class="ae jd" href="https://twitter.com/googlecloudspin" rel="noopener ugc nofollow" target="_blank">云旋转</a>！</p><p id="9e49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我了解到通过低带宽连接下载Docker图像和推送图像是令人不快的。</p><h1 id="e162" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">码头机器来救援了</h1><p id="0d30" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在过去的几个月里，我一直在使用<a class="ae jd" href="https://cloud.google.com/compute/" rel="noopener ugc nofollow" target="_blank">谷歌计算引擎</a>上的<a class="ae jd" href="https://docs.docker.com/machine/" rel="noopener ugc nofollow" target="_blank"> Docker机器</a>，而不是使用<a class="ae jd" href="http://boot2docker.io/" rel="noopener ugc nofollow" target="_blank"> boot2docker </a>在本地构建和推送Docker图像。这在很多情况下都非常有效——在我的公寓里，在酒店里，在火车上，甚至在飞机上。</p><p id="adeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Docker Machine有几个好处:</p><ul class=""><li id="e316" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">快速网络—快速容器映像下载和快速推送至容器存储库，如Docker Hub</li><li id="0c86" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">当你在谷歌计算引擎上托管Docker机器时，访问私有的<a class="ae jd" href="https://cloud.google.com/tools/container-registry/" rel="noopener ugc nofollow" target="_blank">谷歌容器注册表</a>(甚至更快的图像下载和推送)</li><li id="62d8" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">容器映像存储在Docker机器实例上，而不是您的本地台式机/笔记本电脑上</li><li id="9f13" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">我可以释放我的笔记本电脑资源(包括磁盘、CPU，甚至带宽)</li></ul><h1 id="b629" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">怎么会？</h1><p id="9748" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在谷歌计算引擎上设置Docker机器很简单！</p><ol class=""><li id="130b" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc kv kn ko kp bi translated"><a class="ae jd" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">注册</a>使用谷歌云平台并创建一个新项目(记住项目ID)</li><li id="e856" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">安装<a class="ae jd" href="https://docs.docker.com/installation/" rel="noopener ugc nofollow" target="_blank"> Docker </a>命令行工具</li><li id="9d7a" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc kv kn ko kp bi translated">安装<a class="ae jd" href="https://docs.docker.com/machine/" rel="noopener ugc nofollow" target="_blank">对接机</a></li></ol><p id="de35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个动画GIF(时间压缩)中可以看到在Google Compute Engine上提供Docker Machine实例的过程:</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/456e664bf91a11854cae9977eda9d5a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/1*1hxxkUuu-uybq9DXy-A_bQ.gif"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">见<a class="ae jd" href="https://twitter.com/saturnism/status/620715664609804289" rel="noopener ugc nofollow" target="_blank">原推文</a>。</figcaption></figure><p id="ac0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，这里有详细的说明(2017年8月30日更新，感谢古斯塔夫·马斯科维茨):</p><ul class=""><li id="e1e2" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">如果你在Mac上，安装Docker Machine最简单的方法就是使用Brew。</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="07b3" class="lr jf hi ln b fi ls lt l lu lv">$ brew install docker docker-machine</span></pre><ul class=""><li id="1dd0" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">要使用Docker机器搭配Google云平台，<a class="ae jd" href="https://cloud.google.com/sdk/downloads" rel="noopener ugc nofollow" target="_blank">安装Google Cloud SDK </a>。是Google云平台的CLI工具。</li><li id="b7da" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">使用Google Cloud SDK验证您的帐户。您可能需要对常规登录和应用程序登录进行身份验证</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="1a19" class="lr jf hi ln b fi ls lt l lu lv">$ gcloud auth login<br/>$ gcloud auth application-default login</span></pre><ul class=""><li id="9e47" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">创建一个docker机器实例(在本例中，该实例名为“Docker”)。你可以为你的用例确定一个合适的<a class="ae jd" href="https://cloud.google.com/compute/pricing#machinetypes" rel="noopener ugc nofollow" target="_blank">机器类型</a>，但是我推荐一个至少有两个CPU的。</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="3619" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine create docker -d google --google-project=PROJECT_ID --google-machine-type n1-highcpu-4 --google-open-port 22</span></pre><ul class=""><li id="5403" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">该命令将提示您授权Docker Machine访问您的Google云平台项目。</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lw"><img src="../Images/f2764f6390d96864d42732aa8bb86ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*LkZKv69UZ4cGaDk7nwaPxw.png"/></div></figure><ul class=""><li id="9839" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">授权后，将临时授权码复制并粘贴回命令行提示符:</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="03b3" class="lr jf hi ln b fi ls lt l lu lv">Enter code: [PASTE YOUR TEMPORARY CODE HERE]</span></pre><ul class=""><li id="7575" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">Docker Machine将在Google Compute Engine中创建一个虚拟机实例，并设置所有必要的组件和密钥来安全地访问Docker Machine实例。</li><li id="67ce" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">最后，您需要设置环境变量来告诉Docker使用新创建的Docker机器实例:</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="ce9e" class="lr jf hi ln b fi ls lt l lu lv">$ eval $(docker-machine env docker)</span></pre><ul class=""><li id="9608" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">考虑将这一行添加到~/。bash_profile或您选择的shell初始化脚本，使Docker机器成为默认选择。</li></ul><p id="71f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以做几件事来验证Docker机器实例是否正在运行:</p><p id="986b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该能够列出它:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="11a0" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine ls<br/>NAME             ACTIVE   DRIVER   STATE     URL                         SWARM<br/>docker   *        google   Running   tcp://...</span></pre><p id="d703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该能够通过SSH进入机器:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="e543" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine ssh docker<br/>Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.16.0-30-generic x86_64)<br/>...<br/>docker-user@docker:~$</span></pre><p id="2289" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，Docker应该能够连接到Docker机器实例:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="b1f8" class="lr jf hi ln b fi ls lt l lu lv">$ docker ps<br/>CONTAINER ID        IMAGE                    COMMAND             CREATED             STATUS              PORTS                    NAMES</span></pre><p id="7c99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，最终测试是在Docker机器实例中运行一个容器:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="2d93" class="lr jf hi ln b fi ls lt l lu lv">$ docker run busybox echo hello world<br/>Unable to find image 'busybox:latest' locally<br/>latest: Pulling from busybox<br/>cf2616975b4a: Pull complete <br/>6ce2e90b0bc7: Pull complete <br/>8c2e06607696: Already exists <br/>busybox:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.<br/>Digest: sha256:38a203e1986cf79639cfb9b2e1d6e773de84002feea2d4eb006b52004ee8502d<br/>Status: Downloaded newer image for busybox:latest<br/>hello world</span></pre><h1 id="3cc4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">提示和技巧</h1><p id="501a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我学到了一些东西，而使用Docker机器的低带宽互联网连接，可能会节省你一些麻烦！</p><h2 id="5ed4" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">从Dockerfile文件下载所有内容</h2><p id="33ab" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">添加/复制指令会通过网络将文件从本地机器复制到Docker机器实例。不要使用ADD/COPY指令将大文件复制到Docker映像中，而是尽可能从互联网上下载，包括:</p><ul class=""><li id="140f" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">代码(例如，使用“git clone ”)</li><li id="92e1" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">二进制文件(使用wget/curl下载大型二进制文件)</li></ul><p id="d39e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将直接的源代码复制到Docker机器中，以便用新代码快速测试容器。但是我试图从互联网上下载尽可能多的依赖项(源代码和二进制文件)。</p><p id="3e24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你需要的东西在网上找不到，试着把它储存在<a class="ae jd" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank">谷歌云存储</a>，然后从那里下载。</p><h2 id="3a07" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">使用ONBUILD</h2><p id="b82c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">使用<a class="ae jd" href="https://docs.docker.com/reference/builder/#onbuild" rel="noopener ugc nofollow" target="_blank"> ONBUILD </a>指令下载任何构建依赖项，并编译您的源代码。例如，如果您使用Maven构建Java应用程序，请查看<a class="ae jd" href="https://registry.hub.docker.com/_/maven/" rel="noopener ugc nofollow" target="_blank"> maven:onbuild </a>基础映像。这将下载所有Maven依赖项来构建您的项目。当与Docker Machine一起使用时，所有依赖项都将从Docker Machine下载，因为Docker Machine可能具有更快的互联网连接。</p><p id="c079" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mk">6月16日更新:ONBUILD可能会产生非常大的图像，既有源代码又有编译后的二进制文件。使用多阶段构建，见下文！</em></p><h2 id="c163" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">使用多阶段构建</h2><p id="a45a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">从Docker 17.05开始，可以使用<a class="ae jd" href="https://docs.docker.com/engine/userguide/eng-image/multistage-build/" rel="noopener ugc nofollow" target="_blank">多级构建</a>。这允许您有一个获取源代码并编译代码的构建阶段。然后，将工件复制到最终的运行时容器中。Java构建的一个示例:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="5d35" class="lr jf hi ln b fi ls lt l lu lv">FROM maven:3.5-jdk-8 as BUILD</span><span id="8d1b" class="lr jf hi ln b fi ml lt l lu lv">COPY . /src<br/>RUN mvn -f /src/pom.xml package</span><span id="213d" class="lr jf hi ln b fi ml lt l lu lv">FROM openjdk:8</span><span id="d6fb" class="lr jf hi ln b fi ml lt l lu lv">COPY --from=BUILD /src/target/lib /app/lib<br/>COPY --from=BUILD /src/target/artifact.jar /app/artifact.jar</span><span id="5296" class="lr jf hi ln b fi ml lt l lu lv">EXPOSE 8080<br/>ENTRYPOINT ["java", "-jar", "/app/artifact.jar"]</span></pre><h2 id="8b80" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">使用压缩</h2><p id="4652" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当Docker上下文被发送到远程Docker守护进程时，您可以对其进行压缩:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="3d31" class="lr jf hi ln b fi ls lt l lu lv">$ docker build --compress ...</span></pre><h2 id="adf2" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">该卷安装在哪里？</h2><p id="729c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当使用Docker Machine并将卷装载到容器中时，卷是根据虚拟机本身的目录装载的，而不是您的本地台式机/笔记本电脑。</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="6a49" class="lr jf hi ln b fi ls lt l lu lv">$ docker run -ti -v /myfiles:/data busybox</span></pre><p id="21c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将把虚拟机的/myfiles目录绑定到容器的/data目录中。</p><p id="4ed2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也意味着您需要将希望与容器共享的任何文件复制到Docker机器实例中:</p><ul class=""><li id="e816" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">首先，SSH进入Docker机器实例以创建目录结构</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="5cd2" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine ssh docker<br/>...<br/>Last login: Thu Jul 16 03:18:20 2015 from ...</span><span id="89f9" class="lr jf hi ln b fi ml lt l lu lv">docker-user@docker:~$ sudo mkdir -p /myfiles</span></pre><ul class=""><li id="2f2e" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">然后使用“docker-machine scp”命令:</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="6e18" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine scp somefile docker:/myfiles</span></pre><h2 id="a6d0" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">从容器下载输出</h2><p id="aea3" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">有时候，你的容器可能会产生输出，比如二进制构建，或者从<a class="ae jd" href="https://github.com/saturnism/deepdream-docker" rel="noopener ugc nofollow" target="_blank">深度梦境容器</a>生成的图像。您可以通过几种方式获取数据:</p><p id="93f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用“docker cp ”(这适用于正在运行的容器和已退出的容器):</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="1b40" class="lr jf hi ln b fi ls lt l lu lv">$ docker ps<br/>CONTAINER ID        IMAGE                    COMMAND             CREATED             STATUS              PORTS                    NAMES<br/>0dc6f3c9c399        deepdream:latest   "/bin/bash"         2 days ago          Up 2 days           8888/tcp                 nostalgic_almeida</span><span id="3c8e" class="lr jf hi ln b fi ml lt l lu lv">$ docker cp 0dc6f3c9c399:/deepdream/deepdream/frames/0001.jpg .</span></pre><p id="1da1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您安装了一个卷来存储输出，请使用“docker-machine scp ”:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="6303" class="lr jf hi ln b fi ls lt l lu lv">$ docker run -ti -v /output:/output mycontainer<br/>$ docker-machine scp docker:/output/myfile .</span></pre><p id="7407" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最喜欢的一种技术是将输出直接通过管道传输到STDOUT。为此，请查看我用Go编写的<a class="ae jd" href="https://github.com/saturnism/oauth2util" rel="noopener ugc nofollow" target="_blank"> oauth2util </a>。它可以使用一个容器为多个平台构建二进制文件。</p><p id="7d1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://github.com/saturnism/oauth2util/blob/master/script/build" rel="noopener ugc nofollow" target="_blank">构建脚本</a>做两件事:</p><ul class=""><li id="e8b4" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">在容器中，对所有构建工件进行处理，并通过管道将其传输到STDOUT</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="0c20" class="lr jf hi ln b fi ls lt l lu lv">tar -czf — oauth2util-*”</span></pre><ul class=""><li id="5136" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">在容器外部，展开输出:</li></ul><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="3050" class="lr jf hi ln b fi ls lt l lu lv">tar -xzf -</span></pre><p id="e80f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将它们放在一起:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="900c" class="lr jf hi ln b fi ls lt l lu lv">docker run -e GOOS=$GOOS -e GOARCH=$GOARCH oauth2util /bin/bash -c “go build -o oauth2util-$GOOS-$GOARCH$SUFFIX 1&gt;&amp;2 &amp;&amp; tar -czf — oauth2util-*” | tar -xzf -</span></pre><p id="cbd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，您还可以将输入通过管道传输到Docker容器进程的STDIN中，而不是将输入复制到文件系统中:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="16b0" class="lr jf hi ln b fi ls lt l lu lv">$ cat myimage.jpg | docker -i mycontainer &gt; output.jpg</span></pre><h2 id="4950" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">暴露端口</h2><p id="7e5d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">如果您需要将容器端口绑定到主机上，它将绑定到Docker机器实例，而不是您的本地机器。因此，您需要配置防火墙规则以允许访问该端口。例如，如果您将一个端口绑定到主机端口8888:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="8711" class="lr jf hi ln b fi ls lt l lu lv">$ docker run -p 8888:80 nginx</span></pre><p id="3913" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">…然后你需要配置防火墙。首先登录<a class="ae jd" href="http://console.developers.google.com" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>，然后:</p><ul class=""><li id="935c" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">导航到<strong class="ih hj">计算引擎&gt;网络</strong></li><li id="7cee" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">点击<strong class="ih hj">默认</strong>网络</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mm"><img src="../Images/36ab91dccb4c8e17f7c13eb8345536cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3Cuz2hhhL8fmiuL897iWA.png"/></div></div></figure><ul class=""><li id="2dde" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">点击<strong class="ih hj">添加防火墙规则</strong></li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es mn"><img src="../Images/28384eeabcb4af8423898230c29b7e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*B4QM1MkdRe0Ld_L8IBTqww.png"/></div></figure><ul class=""><li id="a842" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">允许来自任何来源，并允许协议和端口(例如，tcp:8888)</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mo"><img src="../Images/eaada3bc43c541e4dbfe22095db1b479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tr-zyfJrHwpHY95ZD4gtvg.png"/></div></div></figure><ul class=""><li id="40d7" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">点击<strong class="ih hj">创建</strong></li></ul><p id="c81e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，找出Docker机器实例的IP地址:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="7d04" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine ls<br/>NAME             ACTIVE   DRIVER   STATE     URL                         SWARM<br/>docker   *        google   Running   tcp://xxx.xxx.xxx.xxx:2376</span></pre><p id="6f19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并导航到<a class="ae jd" href="http://xxx.xxx.xxx.xxx:8888/" rel="noopener ugc nofollow" target="_blank">http://xxx.xxx.xxx.xxx:8888/</a>以访问端口。</p><h2 id="ab07" class="lr jf hi bd jg lx ly lz jk ma mb mc jo iq md me js iu mf mg jw iy mh mi ka mj bi translated">停止/启动码头机器</h2><p id="f3bc" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当您使用完Docker机器时，您可以将其关闭以降低成本:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="a226" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine stop docker</span></pre><p id="dbef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，当您需要再次使用它时开始:</p><pre class="kx ky kz la fd lm ln lo lp aw lq bi"><span id="9354" class="lr jf hi ln b fi ls lt l lu lv">$ docker-machine start docker</span></pre></div></div>    
</body>
</html>