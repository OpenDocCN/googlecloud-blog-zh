<html>
<head>
<title>Different Microservices &amp; Cloud Native Architecture flavors &amp; how Google Cloud supports those flavors?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不同的微服务和云原生架构风格&amp;谷歌云如何支持这些风格？</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/different-microservices-cloud-native-architecture-flavors-how-google-cloud-supports-those-de2828fc7e4a?source=collection_archive---------0-----------------------#2020-07-27">https://medium.com/google-cloud/different-microservices-cloud-native-architecture-flavors-how-google-cloud-supports-those-de2828fc7e4a?source=collection_archive---------0-----------------------#2020-07-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多架构师和开发人员认为构建微服务架构(MSA)或云原生架构(CNA)只会考虑一种架构模式，尽管这是不正确的:)。恰恰相反；CNA/MSA架构融合了多种架构模式，不仅仅是应用CNA/MSA模式那么简单。让我们从探索这些架构模式开始:</p><ul class=""><li id="b545" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">事件驱动架构(EDA) </strong>是一种模式，支持服务通过事件为通信提供服务，并将数据更改作为事件进行处理。它高度支持松散耦合和自主设计原则。</li><li id="b320" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">无服务器</strong>，是一种无需运行和维护任何服务器或任何基础设施即可运行服务的模式。此外，它支持缩减到零个实例，从而支持高效的按需付费，因为付费是针对服务代码的精确执行、运行、调用和计算使用。</li><li id="6dfd" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">容器化</strong>，这种模式使得服务代码可以在一个容器内运行，支持运行时的一致性、服务的可移植性、简单高效的服务实例可伸缩性。</li><li id="17f6" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> Function as a Service (FaaS) </strong>，是在无服务器模式下运行代码片段作为功能的模式。它支持使用事件或直接API调用来触发函数。</li><li id="f3c8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">平台即服务(PaaS) </strong>，是使用通用平台支持多租户、支持自动扩展和自我修复的模式。通常，PaaS以两种运行时模式提供，第一种模式是PaaS检测和维护服务代码运行时，而第二种模式是通过清单使用用户定义的运行时来运行服务代码，然后对其进行维护和编排。</li><li id="0806" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">服务目录&amp; Service Broker </strong>是支持提供后台服务的模式，在运行时将它们绑定到工作负载，无需停机或更改代码。此外，它还支持管理服务消费和定价。</li><li id="5b70" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> API管理&amp; API网关</strong>，是使用安全可控的平台公开服务的模式。它支持API货币化、API集成模式(如企业集成模式(EIP))、API策略实施以及API安全和屏蔽。</li><li id="bd42" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">DevOps是设计和实现自动化软件开发生命周期的E2E开发和操作过程的模式。它支持定义软件交付管道和阶段，考虑连续交付和连续集成。通常，它实现最高级别的自动化，即测试自动化、自我修复、资源消耗优化、自动供应和自动扩展。</li><li id="7e29" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">人工智能(AI) </strong>，是使用机器学习和数据科学来实施智能分析(包括预测和检测分析)的模式。它支持数字化商业智能。</li><li id="5c1c" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">业务</strong> <strong class="ih hj">流程</strong> <strong class="ih hj">自动化</strong>，是利用业务流程管理(bpmn)和业务规则(br)实现业务流程自动化的模式。它支持数字化商业智能。</li><li id="59bc" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj">网格化</strong>是一种模式，支持分布式跟踪、配置和服务质量(QoS)的外部化、指标和遥测收集、日志聚合、动态服务发现、流量管理、智能&amp;灵活集成，包括断路器设计模式支持、自我修复、故障注入和策略执行。我始终认为，在实施MSA/CNA时，网格化是一个重要的模式，因为它淡化了MSA/CNA在集成和治理方面的复杂性和挑战，这就是为什么它是我最喜欢的主题之一:)。</li><li id="58df" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> MSA </strong>，是基于业务领域服务设计微服务的模式，实现了MSA的设计原则，如状态管理、松耦合、去中心化、自治和弹性。</li><li id="09b9" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> CNA </strong>，是原生消费底层云基础设施并与之通信的模式，实现了云原生应用的设计原则，如无状态、可观察性和业务敏捷性。</li></ul><p id="4fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经讨论了MSA/CNA解决方案中最需要的主要模式，让我们来探讨一下多云和混合云的主题以及它们在构建MSA/CNA中的用途。</p><p id="93c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">首先，什么是多云，它与混合云有何不同？</strong></p><p id="671a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多云是跨多个云分布应用程序的模式，它可以是一组私有云和/或公共云，而混合云是跨私有云和公共云分布应用程序的模式。</p><p id="99cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，但是仍然有什么不同呢？</p><p id="3681" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主要区别在于，混合云模式旨在从公共云和私有云/基础架构中构建一个同构的集成基础架构，消除公用设施、公共服务和服务质量(QoS)中的冗余，实施高度治理和控制，例如，使用一个单一身份管理(IdM)来控制整个基础架构中的身份认证和授权，因此它更具针对性，并实施基础架构和云无关性。 虽然多云是一个更广泛的概念，因为它不实施中央治理流程和消除冗余，所以它可能只涉及公共云，其中每个云都有自己的IdM。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/8c0275a63c2087573ed6d59f568c4058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*oygte_rqBMGfel3roDH1QA.png"/></div><figcaption class="jz ka et er es kb kc bd b be z dx translated"><strong class="bd kd">多云和混合云</strong></figcaption></figure><p id="1455" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">是的，但是多云和混合云如何帮助CNA/MSA解决方案呢？</strong></p><p id="64fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CNA &amp; MSA背后的想法是建立一个从业务和IT方面智能的应用程序。它适应业务和It中的任何变化，即使这种变化是意外的；这是一个更加反应式的架构，而不仅仅是一个响应式的架构。CNA/MSA更关注业务，目标是基础架构和平台无关性。因此，对于不同基础设施和服务提供商(传统和现代)的扩展和采用来说，多云和混合云是重要的模式。在应用程序现代化和业务数字化的过程中，随着应用程序的各个部分被现代化并从一个平台或基础架构迁移到另一个平台或基础架构，增加了对多云和混合云的支持。</p><p id="337b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经讨论了在构建CNA/MSA解决方案中使用的不同架构和设计模式，让我们尝试为CNA/MSA解决方案建立一个样本参考架构，将所有这些架构模式结合在一起，并解释其工作原理。</p><p id="8604" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在典型的MSA/CNA解决方案中，使用的是混合云(公共云和私有云的组合，或者我们习惯称之为地面)，因此为了简单起见，在展示的示例参考体系结构中，我们将使用一个公共云和一个私有云(当然可以添加更多的云:)。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ke"><img src="../Images/d960eca295ce04fb7594756c5c978595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bO8YgrMFXSMHhdJMmmGIdw.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated"><strong class="bd kd">CNA/MSA参考架构示例</strong></figcaption></figure><p id="ee62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的蓝图描绘了高级参考体系结构，让我们通过列出主要的体系结构原则来尝试和解释它:</p><ul class=""><li id="9c67" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">公共云和私有云都托管两种风格(完全托管运行时和用户定义运行时)的PaaS产品</li><li id="3cff" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">公共云和私有云都支持用户定义的运行时PaaS产品中的容器化工作负载(无状态和有状态MSA)。</li><li id="ac9b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">公共云和私有云都使用完全托管的运行时PaaS产品在无服务器模式下提供FaaS。</li><li id="b921" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">DevOps套件(工具和管道)以混合解决方案模式分布在公共云和私有云之间。</li><li id="db80" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">服务代理和服务目录用于在公共云和私有云(包括人工智能服务/工作负载)中实现各种支持服务的动态配置。</li><li id="cbed" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">私有云托管一个消息代理，用于不同MSAes和CNAes之间的异步通信，从而支持EDA的实施。</li><li id="f3af" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">公共云仅在用户定义的运行时PaaS产品中启用服务网格(这只是一个示例，说明可以在同一云中的一个PaaS上启用服务网格，而在另一个PaaS上禁用服务网格，这完全取决于需求:)。</li><li id="ff3f" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">私有云支持两种PaaS产品上的服务啮合。</li><li id="6b55" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">一些部署的CNAes和MSAes以无服务器模式托管。</li><li id="b70a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">私有云托管业务规则和业务流程管理运行时，用于编排由实施的CNAes和MSAes提供的业务功能/步骤。</li><li id="f665" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">业务流程运行时使用API网关与MSAes和CNAes通信。</li><li id="3dc7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">所有外部设备(手机、智能手表、平板电脑、笔记本电脑……)正在使用API网关与业务流程运行时和任何MSA或CNA进行通信。</li></ul><p id="e605" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们使用Google Cloud来尝试和探索这个参考架构，看看Google Cloud如何帮助在公共云和私有云实现这些模式。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kj"><img src="../Images/847c3039e03e391a1f4e81dfba7f2ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwEYKWidcacW-de5Up3Lig.png"/></div></div><figcaption class="jz ka et er es kb kc bd b be z dx translated"><strong class="bd kd">CNA/MSA参考架构示例—谷歌云</strong></figcaption></figure><p id="594e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的蓝图中，我们可以看到Google Cloud为实现任何目标架构模式提供了一套备选方案，让我们深入探讨一下:)。</p><p id="ea5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Anthos平台</strong>是面向CNA/MSA和数字化转型解决方案的谷歌云产品的核心，Anthos实现了混合和多云故事，它提供了运行、协调&amp;管理跨不同基础设施分布的工作负载<strong class="ih hj">T5】的能力，提供了基础设施不可知原则 </strong>。Anthos还支持跨此类基础设施的治理，因此QoS不会受到任何影响，它使用其<strong class="ih hj"> Anthos配置管理</strong> (ACM)和<strong class="ih hj"> Anthos服务网格</strong> (ASM)来实现这一点。</p><p id="552e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过Google Anthos，可以供应、监控和控制Kubernetes集群。</p><p id="4fbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的蓝图中，我选择了<strong class="ih hj">Google Kubernetes Engine</strong>(GKE)作为私有云与Google云都使用的K8s发行版；但它是灵活的，你可以选择任何其他发行版。</p><p id="8b0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至于托管CNA和MSA的平台即服务，除了GKE，谷歌云还提供:</p><ul class=""><li id="9367" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj"> Google App Engine </strong>是一个完全托管的无服务器PaaS它高度支持和启用所有CNA设计原则和最佳实践，如12个因素。</li><li id="86a7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> Google Cloud Run </strong>基于Knative，是一款PaaS产品，用于运行无服务器工作负载。它支持EDA模式和FaaS实现。</li><li id="9f8b" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated"><strong class="ih hj"> Google Cloud Function </strong>，这是一款完全托管的无服务器FaaS产品，Google Cloud Functions和Google Cloud Run的主要区别在于，前者在代码行数、工件大小和功能执行时间长度方面受限于FaaS的设计原则，而后者在这方面则非常灵活。</li></ul><p id="f92a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至于后台服务，Google提供了大部分的Google云服务，可以使用<strong class="ih hj"> K8s配置连接器</strong>进行动态配置，这有助于在Google Cloud中配置和管理服务，还可以在运行时将其绑定到工作负载。</p><p id="b411" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过config connector你可以动态配置数据库，比如Google <strong class="ih hj">云SQL </strong>，Google <strong class="ih hj">云扳手</strong>和AI服务，比如云中的Google <strong class="ih hj"> BigQuery </strong>。</p><p id="44b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至于API网关和API管理，Google Cloud提供了<strong class="ih hj"> APIGee </strong>，这是一个SaaS产品，用于管理和控制对分布在多云和混合云中的msae/cnae的访问。</p><p id="7020" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在DevOps的世界里，Google Cloud提供了一套服务，比如<strong class="ih hj">云源码库</strong>、<strong class="ih hj">云构建</strong>、<strong class="ih hj"> Stackdriver监控</strong>等等。它还通过能够与大范围的DevOps工具和管道集成来支持混合故事。</p><p id="ed58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，Anthos与APIGee和Google Cloud完全集成，并支持在地面运行GKE和云，以提供最佳的混合解决方案，这同样与运行解决方案的基础架构和平台无关。</p><p id="d622" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总结一下</strong>，CNA/MSA解决方案架构融合了不同的架构和设计模式。CNA/MSA &amp;数字化转型的主要目标是独立于基础设施和平台，换句话说:它不再是关于基础设施和运行时；它更多的是关于质量、敏捷性、灵活性、适应性和智能。这就是为什么MSA/CNA和数字化转型总是青睐混合云和多云的原因</p></div></div>    
</body>
</html>