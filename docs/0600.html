<html>
<head>
<title>More Functions on Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云上的更多功能</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/more-functions-on-google-cloud-69c44a514661?source=collection_archive---------2-----------------------#2018-05-09">https://medium.com/google-cloud/more-functions-on-google-cloud-69c44a514661?source=collection_archive---------2-----------------------#2018-05-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/83f72c59536235b4c2d015a51b8ce503.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*7ODsiX7lD0wUflyy6v8bhg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">谷歌云</figcaption></figure><p id="0099" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你还没有读过我的上一篇文章<a class="ae jo" rel="noopener" href="/google-cloud/deploying-a-functions-serverless-app-on-google-cloud-e8f0e3011b2b">在Google Cloud </a>上部署一个功能(无服务器)应用，你应该看看这篇文章的背景。</p><h1 id="cabe" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们将假设:</h1><ul class=""><li id="041d" class="kn ko hi is b it kp ix kq jb kr jf ks jj kt jn ku kv kw kx bi translated">您已经安装了<code class="du ky kz la lb b">gcloud</code>工具</li><li id="e103" class="kn ko hi is b it lc ix ld jb le jf lf jj lg jn ku kv kw kx bi translated">你在GCP有一个项目</li></ul><blockquote class="lh li lj"><p id="26c1" class="iq ir lk is b it iu iv iw ix iy iz ja ll jc jd je lm jg jh ji ln jk jl jm jn hb bi translated">注意:您必须安装<code class="du ky kz la lb b"><em class="hi">gcloud</em></code>测试版</p></blockquote><p id="cdb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要安装<code class="du ky kz la lb b">gcloud</code>测试版使用:</p><pre class="lo lp lq lr fd ls lb lt lu aw lv bi"><span id="52c7" class="lw jq hi lb b fi lx ly l lz ma">gcloud components update &amp;&amp; gcloud components install beta</span></pre><h1 id="6571" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">概述</h1><p id="5ad9" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">上次，我们做了一个功能应用程序，看起来像这样:</p><pre class="lo lp lq lr fd ls lb lt lu aw lv bi"><span id="363c" class="lw jq hi lb b fi lx ly l lz ma">exports.helloFunctions = (req, res) =&gt; {<br/>  res.send('Hello Functions!');<br/>};</span></pre><p id="9689" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你到达终点时，它简单地发送回<code class="du ky kz la lb b">Hello Functions!</code>。现在让我们继续下去，展开这一点。我们要做一个基于文本的冒险游戏(想想<a class="ae jo" href="https://en.wikipedia.org/wiki/Zork" rel="noopener ugc nofollow" target="_blank"> Zork </a>)。</p><h1 id="eee0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">我们想要什么？</h1><p id="9e59" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">我们可以把冒险中的每个<em class="lk">步骤</em>想象成一个函数。所以，当你开始游戏时，<em class="lk">那是一个函数</em>，当你选择走一条路<em class="lk">，那是一个函数</em>，或者当你选择走另一条路，<em class="lk">那是一个函数</em>。</p><h2 id="db41" class="lw jq hi bd jr me mf mg jv mh mi mj jz jb mk ml kd jf mm mn kh jj mo mp kl mq bi translated">那么，我们如何才能做到这一点呢？</h2><p id="c139" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">让我们从一个HTML模板开始，它将显示一条消息和两个链接:</p><pre class="lo lp lq lr fd ls lb lt lu aw lv bi"><span id="9e53" class="lw jq hi lb b fi lx ly l lz ma">let template = ({ message, opt1, opt2, opt1Label, opt2Label }) =&gt; {<br/>  return `<br/>    &lt;!DOCTYPE html&gt;<br/>    &lt;html&gt;<br/>      &lt;head&gt;<br/>      &lt;/head&gt;<br/>      &lt;body&gt;<br/>        &lt;p&gt;${message}&lt;/p&gt;<br/>        &lt;div&gt;&lt;a href='${opt1}'&gt;${opt1Label}&lt;/a&gt;&lt;/div&gt;<br/>        &lt;div&gt;&lt;a href='${opt2}'&gt;${opt2Label}&lt;/a&gt;&lt;/div&gt;<br/>      &lt;/body&gt;<br/>    &lt;/html&gt;<br/>  `</span></pre><p id="9410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在这里看到的，模板接受了一条消息、几个链接以及这些链接的几个标签。</p><h2 id="2821" class="lw jq hi bd jr me mf mg jv mh mi mj jz jb mk ml kd jf mm mn kh jj mo mp kl mq bi translated">现在，让我们开始我们的冒险吧！</h2><p id="bf41" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">我们将创建一个名为<code class="du ky kz la lb b">startAdventure</code>的新功能，它将欢迎我们的玩家加入游戏，并给他们两个选项:</p><pre class="lo lp lq lr fd ls lb lt lu aw lv bi"><span id="9941" class="lw jq hi lb b fi lx ly l lz ma">exports.startAdventure = (req, res) =&gt; {<br/>  res.status(200).send(template({<br/>  message: `Greetings adventurer... Let us begin.<br/>  Are you a knight or an elf?<br/>  `,<br/>  opt1: req.url + "Knight",<br/>  opt2: req.url + "Elf",<br/>  opt1Label: "I am a knight, strong and skilled with a sword.",<br/>  opt2Label: "An elf, am I, known for my ranged ability."<br/>  }));<br/>};</span></pre><p id="fe07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们开始部署我们的冒险:</p><p id="eb3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ky kz la lb b">gcloud beta functions deploy startAdventure --trigger-http</code></p><p id="fb0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们冒险的开始。它应该输出URL，但是如果您错过了，格式是:</p><p id="228f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ky kz la lb b">https://[GCP-REGION]-[PROJECT_ID].cloudfunctions.net/startAdventure</code></p><p id="e7bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以打开那个网页，看到这样的内容:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="er es mr"><img src="../Images/5336d14e9445c92dcf9efa0673bae0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5o3nme1-EAq4kYd-nHziMQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated"><code class="du ky kz la lb b"><a class="ae jo" rel="noopener ugc nofollow" target="_blank" href="/[GCP-REGION]-[PROJECT_ID].cloudfunctions.net/startAdventure">https://[GCP-REGION]-[PROJECT_ID].cloudfunctions.net/startAdventure</a></code></figcaption></figure><p id="45f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，这些链接还不行。让我们为骑士写一首:</p><pre class="lo lp lq lr fd ls lb lt lu aw lv bi"><span id="115c" class="lw jq hi lb b fi lx ly l lz ma">exports.Knight = (req, res) =&gt; {<br/>  res.status(200).send(template({<br/>    message: `So you are a Knight..<br/>    Where do you want to go?<br/>    `,<br/>    opt1: req.url + "Castle",<br/>    opt2: req.url + "Mountain",<br/>    opt1Label: "To the castle! I might talk to the princess.",<br/>    opt2Label: "I see a dragon in the distance, to the mountain!"<br/>  }));<br/>};</span></pre><p id="15f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们来部署它:</p><p id="9f62" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ky kz la lb b">gcloud beta functions deploy Knight --trigger-http</code></p><p id="0225" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以现在当你点击第一个链接时，你应该在这里结束:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/a08d16afa1c20320362450046ea56f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*qJq31m1Hz21I6YuwgzMgzw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated"><a class="ae jo" rel="noopener ugc nofollow" target="_blank" href="/[GCP-REGION]-[PROJECT_ID].cloudfunctions.net/Knight"> https://[GCP地区]-[项目ID]. cloud functions . net/Knight</a></figcaption></figure><h1 id="32b5" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">那么这是如何工作的呢？</h1><p id="0612" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">好吧，当我们制作我们的<code class="du ky kz la lb b">startAdventure</code>函数时，我们告诉它提供一个带有<code class="du ky kz la lb b">req.url + Knight</code>和<code class="du ky kz la lb b">req.url + Elf</code>链接的HTML页面(如上图)。你会注意到，当你点击骑士链接时，网址改变了，现在以<code class="du ky kz la lb b">Knight</code>而不是<code class="du ky kz la lb b">startAdventure</code>结尾。我们可以看到我们的<code class="du ky kz la lb b">Knight</code>页面链接到<code class="du ky kz la lb b">Castle</code>和<code class="du ky kz la lb b">Mountain</code>。</p><h1 id="a3d0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">下一步是什么？</h1><p id="b0c3" class="pw-post-body-paragraph iq ir hi is b it kp iv iw ix kq iz ja jb mb jd je jf mc jh ji jj md jl jm jn hb bi translated">往前走，继续走！可能性是无限的</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="802e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我鼓励你继续发展你的冒险！如果你想用更多的选项甚至一个图像来定制它，你可以改变模板。</p><p id="032f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最棒的是。</p><blockquote class="mz"><p id="cf91" class="na nb hi bd nc nd ne nf ng nh ni jn dx translated">功能有💲🆓。⁹⁹(免费)！</p></blockquote><p id="904f" class="pw-post-body-paragraph iq ir hi is b it nj iv iw ix nk iz ja jb nl jd je jf nm jh ji jj nn jl jm jn hb bi translated">这里是<a class="ae jo" href="https://cloud.google.com/functions/pricing" rel="noopener ugc nofollow" target="_blank">定价</a>如果你不相信我。</p><h1 id="293f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">感谢阅读！如有疑问，在下方评论！👋</h1></div></div>    
</body>
</html>