<html>
<head>
<title>Let’s talk Deployments with Google Home, CircleCI and Google Container Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们讨论一下Google Home、CircleCI和Google Container Engine的部署</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/lets-talk-deployments-with-google-home-circleci-and-google-container-engine-f4121703ef26?source=collection_archive---------2-----------------------#2017-10-16">https://medium.com/google-cloud/lets-talk-deployments-with-google-home-circleci-and-google-container-engine-f4121703ef26?source=collection_archive---------2-----------------------#2017-10-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex if ig ih ii"><div class="bz dy l di"><div class="ij ik l"/></div></figure><p id="47df" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">我们如何使用Google Home来推动我们与CircleCI的一些DevOps工作。请参见本页末尾的概念验证视频。</p><blockquote class="jj jk jl"><p id="6ffe" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated"><strong class="in hj">背景</strong>:在<a class="ae jq" rel="noopener" href="/@nithinmallya4">过去的文章</a>中，我描述了我们进入谷歌云平台的旅程，以及我们如何利用我们的发现提出想法来简化我们的构建/测试/部署过程，并与社区分享它们。</p><p id="5efb" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">我们处理了涉及后端服务、发布/订阅用户、存储桶、CloudSQL数据库、众多GCP项目、证书、cdn、多种环境(QA、试运行(预生产)、冒烟测试和生产)的部署。这引发了蓝/绿部署和其他创新方法，在保持稳定的部署速度的同时，不会破坏生产中的应用程序。CircleCI是满足我们需求的优秀工具，他们的API非常好。为此我们使用了CircleCI 1.0和2.0。</p></blockquote><p id="270d" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">现在，我们已经可以在不到5分钟的时间内以完全自动化的方式将我们的应用程序部署到生产环境中，我想看看我们还能做些什么来简化我们的日常工作。</p><p id="73ca" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">所以，我决定开始说。也就是和Google Home对话。</p><blockquote class="jj jk jl"><p id="4b91" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">Google Home是一个语音激活的扬声器，类似于亚马逊的Alexa。你可以使用谷歌助手与它交流，这是一个虚拟的个人助理。经典的例子包括询问天气，让它播放你的Spotify播放列表中的歌曲等。当你想用它做更多的事情时，你可以通过创建一个动作来扩展它的功能。</p><p id="ee84" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">在我的例子中，我有一个允许我构建和部署Google云平台的操作，所以我会通过说“O <strong class="in hj"> k，Google”这样的话与助手进行交互。与开发运营助手"</strong>交流。</p><p id="d47f" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">它是由<a class="ae jq" href="https://dialogflow.com/" rel="noopener ugc nofollow" target="_blank"> DialogFlow </a>(以前的API。AI)，这是一个基于你的输入进行学习的对话平台，允许你将你的需求转化为行动。</p></blockquote><p id="9214" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">本文的其余部分将讨论我们如何使用Google Home和DialogFlow工具(以前的API)。AI)使用自然语言理解来为我们做一些繁重的工作。</p><p id="0b63" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">下图来自Google，展示了从用户到设备到DialogFlow (API)的流程。AI)调用node.js编写的云函数。</p><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es jr"><img src="../Images/ee06a40d64976af3692cdc9e6d926bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*g8RhAgmXjiwwm-QSFT4vpQ.jpeg"/></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">来源:<a class="ae jq" href="https://www.slideshare.net/bretmc/google-home-and-google-assistant-workshop-build-your-own-serverless-action-on-google-app" rel="noopener ugc nofollow" target="_blank">https://www . slide share . net/bretmc/Google-home-and-Google-assistant-workshop-build-your-own-server less-action-on-Google-app</a></figcaption></figure><p id="d831" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">下图显示了用户如何通过语音命令与Dev Ops助手(在我们的例子中是Google Assistant)进行交流。这些命令反过来执行Google Cloud函数(node.js)。Cloud函数调用CircleCI中的RESTful APIs，这些API触发我们在GitHub中的存储库的各个分支中的构建。</p><p id="58b4" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">图中还显示了第二个交互，其中一个应用程序托管在GCP，并公开了一个端点，该端点调用Kubernetes APIs(类似于<strong class="in hj"> kubectl </strong>所做的)来管理GKE集群。</p><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kc"><img src="../Images/0b657f9fa4e2483d78a870179301a42a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iknndR55EwwmVEaK76clQQ.jpeg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx translated">使用Google Assistant和CircleCI将应用程序部署到GCP</figcaption></figure><p id="1d86" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">虽然有许多家庭应用程序，但我们可以通过以下方式利用谷歌助手满足工作中的一些需求:</p><ol class=""><li id="7a98" class="kh ki hi in b io ip is it iw kj ja kk je kl ji km kn ko kp bi translated"><strong class="in hj">指导助理构建和部署</strong>我们的各种环境。当然，我们也使用CircleCI-Github webhooks，但这更有趣，本文后面的演示视频就是这么做的。</li><li id="b39d" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated"><strong class="in hj">使用K8s APIs查询您的GCP Kubernetes集群</strong>(我们广泛使用谷歌容器引擎)以获取更多信息并修改我们的部署、副本、服务等。用语音命令。您可以轻松地启动/关闭您的工人(Rails世界中的ActiveJobs)，扩展您的部署，并做Kube API允许您做的几乎任何事情。</li><li id="62d7" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated"><strong class="in hj">查看系统运行状况的仪表盘，生产错误</strong>，应有尽有。如果它可以通过RESTful端点交付，那么最有可能通过询问Google Home来获得。</li></ol><p id="a7e3" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">在很高的层次上，您需要了解以下内容:</p><ol class=""><li id="bda7" class="kh ki hi in b io ip is it iw kj ja kk je kl ji km kn ko kp bi translated">您已经在<a class="ae jq" href="https://console.actions.google.com/u/0/?pli=1" rel="noopener ugc nofollow" target="_blank">动作控制台</a>中创建了一个项目</li><li id="aa31" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated">您理解以下概念:</li></ol><blockquote class="jj jk jl"><p id="f68a" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">a<strong class="in hj">Actions</strong>:Actions帮助你联系用户，把事情做好。例如，在演示中，我使用了一个动作，允许我开始构建和部署到我选择的环境中。</p><p id="3f3d" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">E <strong class="in hj">实体</strong>:实体是用户提供给助手的值。例如:在流行的谷歌主页视频中，你可以看到用户指定他们想要的比萨饼配料。在我的例子中，我使用"<strong class="in hj"> environment </strong>"实体来告诉助手我想要在什么环境中进行构建/部署。</p></blockquote><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kv"><img src="../Images/d4305d18a8d0d8a8aadf34a3fd387a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPDXz46EunAOG6e0tDvonA.png"/></div></div></figure><blockquote class="jj jk jl"><p id="9750" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated"><strong class="in hj">意图</strong>:意图是用户告诉助手的。简单来说，用户说类似于“<strong class="in hj">我想做一个QA版本</strong>”可能是一种意图。您可以训练助手微调用户请求，并将它们映射到正确的意图。我有几个意图，包括一个“<strong class="in hj">env-intent”</strong>，它处理我将应用程序部署到不同环境的请求。</p></blockquote><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kw"><img src="../Images/9121243de4354e2fc2fa2f6230ea813d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAgA8ZKSrTka4WkQwdW3pQ.png"/></div></div></figure><blockquote class="jj jk jl"><p id="6b8f" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated">完成:最终，你的意图需要做“一些事情”。这可能是用静态响应来响应您的请求，也可能是来自后端服务的更动态的响应。Fulfillments通过允许您指向对应于HTTPS RESTful API的WebHook来帮助实现这一点，该API可以是应用程序中的端点，也可以是提供所需输出的Google Cloud函数。在我的例子中，node.js中的云函数调用一个RESTful CircleCI API，该API触发我的Github存储库中的主构建和开发分支。</p></blockquote><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kx"><img src="../Images/3e5d0ffc5d79716fcae5e93eb0c504b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zxo3al_yq60uIxWv3LHwyw.png"/></div></div></figure><p id="9fb3" class="pw-post-body-paragraph il im hi in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji hb bi translated">在下面的视频中，我使用Google Home在两种不同的环境中开始构建:QA和Staging。这只是我们能做的一些事情的一个例子，还有很多可能性。</p><blockquote class="jj jk jl"><p id="843f" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated"><strong class="in hj"> <em class="hi">结论</em> </strong> <em class="hi">:总体来说，这是一个非常顺利的过程。从建立行动项目到创建一个简单的应用程序，它有潜力做更多的事情。与Google Home设备本身的集成是无缝的。</em></p></blockquote><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="ky ik l"/></div></figure><blockquote class="jj jk jl"><p id="bdc1" class="il im jm in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji hb bi translated"><strong class="in hj">请注意</strong>，谷歌上有一些关于如何开始使用自定义助手的优秀资源，您可以在下面的链接中找到它们。我将很快分享我的Github repo和更多的实现细节。</p></blockquote><h2 id="1fa8" class="kz la hi bd lb lc ld le lf lg lh li lj iw lk ll lm ja ln lo lp je lq lr ls lt bi translated">资源:</h2><ol class=""><li id="f4be" class="kh ki hi in b io lu is lv iw lw ja lx je ly ji km kn ko kp bi translated">谷歌助手:<a class="ae jq" href="https://home-assistant.io/addons/google_assistant/" rel="noopener ugc nofollow" target="_blank">https://home-assistant.io/addons/google_assistant/</a></li><li id="21a0" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated">云功能:<a class="ae jq" href="https://cloud.google.com/functions/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/functions/</a></li><li id="447e" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated">对谷歌的行动:<a class="ae jq" href="https://developers.google.com/actions/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/actions/</a></li><li id="f563" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated">构建自己的无服务器操作:<a class="ae jq" href="https://www.slideshare.net/bretmc/google-home-and-google-assistant-workshop-build-your-own-serverless-action-on-google-app" rel="noopener ugc nofollow" target="_blank">https://www . slide share . net/bretmc/Google-home-and-Google-assistant-workshop-build-your-own-server less-action-on-Google-app</a></li><li id="aaa6" class="kh ki hi in b io kq is kr iw ks ja kt je ku ji km kn ko kp bi translated">我以前关于这些主题的文章:<a class="ae jq" rel="noopener" href="/@nithinmallya4">https://medium.com/@nithinmallya4</a></li></ol></div></div>    
</body>
</html>