<html>
<head>
<title>An app modernization story — Part 2 (Lift &amp; Shift)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应用程序现代化故事—第2部分(提升和转变)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/an-app-modernization-story-part-2-lift-shift-7a3740f22860?source=collection_archive---------2-----------------------#2020-02-06">https://medium.com/google-cloud/an-app-modernization-story-part-2-lift-shift-7a3740f22860?source=collection_archive---------2-----------------------#2020-02-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2875" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在应用程序现代化系列的第1部分中，我介绍了一个简单的新闻聚合器，以及其初始架构中的一些挑战。在第2部分中，我将谈论云计算之旅，以及在此过程中一些意想不到的好处和收获。</p><h2 id="4f0b" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">为什么是云？</h2><p id="5a31" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">最初的后端有许多我在<a class="ae jd" rel="noopener" href="/google-cloud/an-app-modernization-story-part-1-prototype-6a11398f6e7e">第一部分</a>中概述的问题。大约一年后，在2016年末，我们决定将它搬到一个更稳定的家。我们的主要目标是<strong class="ih hj">提高应用</strong>的弹性，因为IIS主机一直在崩溃，但是<strong class="ih hj">我们不想以一种主要的方式重写或重新架构</strong>应用。大约在同一时间，我开始在谷歌工作，学习所有关于谷歌云的知识。我们决定试一试，看看如何将应用程序迁移到那里。</p><h2 id="396c" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">提升和移位</h2><p id="cc97" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">我们的应用程序是基于Windows的，因此，当时在谷歌云上的唯一选择是将其部署到计算引擎上的Windows服务器虚拟机。(现在Windows应用程序有更多选项，但我们将在下一篇文章中讨论。)</p><p id="1b70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌云有一个<a class="ae jd" href="https://cloud.google.com/marketplace" rel="noopener ugc nofollow" target="_blank">市场</a>，提供随时可以部署的解决方案。我们使用<a class="ae jd" href="https://console.cloud.google.com/marketplace/details/click-to-deploy-images/aspnet" rel="noopener ugc nofollow" target="_blank">ASP.NET框架</a> <strong class="ih hj"> </strong>解决方案来获得已经安装了IIS、SQL Express和ASP.NET的Windows虚拟机。简直就是轻轻一点。</p><p id="0e37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们有了Windows VM，从Visual Studio发布到计算引擎就非常简单了。这部分是因为我们的架构非常简单，没有持久性。我们<em class="ke">把&amp;我们的应用程序转移到</em>云端，但当时并不知道这个术语。</p><h2 id="f315" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">初始云架构</h2><p id="785d" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">这是建筑在最初的提升和转变后的样子:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kf"><img src="../Images/85d193dc3b19a55427a657fb23535f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tS_hFmVxfgm18wBpavkYQ.png"/></div></div></figure><p id="883f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将运行我们应用的2个负载平衡计算引擎虚拟机的实例组保持在最低水平。这样，我们实现了冗余和基本负载平衡的主要目标。</p><h2 id="fad3" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">意外的好处</h2><p id="cab4" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">然后，我们开始研究计算引擎提供了什么。</p><p id="9b38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发现了<a class="ae jd" href="https://cloud.google.com/compute/docs/instance-templates" rel="noopener ugc nofollow" target="_blank">实例模板</a>，它允许我们从现有虚拟机转到一个模板，并从该模板创建<a class="ae jd" href="https://cloud.google.com/compute/docs/instance-groups/" rel="noopener ugc nofollow" target="_blank">实例组</a>，这是一个完全相同且负载平衡的虚拟机群。实例组有很好的附加功能，如重新创建崩溃的虚拟机，尽可能自动修复虚拟机，跨多个区域分布虚拟机，负载平衡和<a class="ae jd" href="https://cloud.google.com/compute/docs/autoscaler" rel="noopener ugc nofollow" target="_blank">自动扩展</a>。</p><p id="ba7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们发现永久磁盘可以连接到虚拟机，以后您可以非常轻松地拍摄这些磁盘的快照进行备份。</p><p id="dd9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Google Cloud上的DevEx比我们之前的主机好多了。只需点击一下鼠标即可从浏览器RDP到虚拟机，能够在Stackdriver中查看和搜索应用程序日志，能够停止/暂停虚拟机以节省成本等等。</p><p id="74cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在计算引擎基础设施中有许多这样的小宝贝。诚然，我们还不需要这些特性中的大部分，但我们确实感觉马上升级到了企业级环境。</p><h2 id="ba57" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">经验教训</h2><p id="58c7" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">这些是我们应用程序提升和转变阶段的主要经验:</p><ol class=""><li id="5eb7" class="kr ks hi ih b ii ij im in iq kt iu ku iy kv jc kw kx ky kz bi translated"><strong class="ih hj">提升&amp;转变不一定很难</strong>:我们惊喜地发现，将现有应用程序迁移到云是多么容易。当然，我们有一个简单的架构，我们必须做一些研究来弄清楚事情如何在云中工作，但最终，我们不必做太多改变。</li><li id="c0c3" class="kr ks hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><strong class="ih hj">云不仅仅是托管</strong>:我们只是希望我们的应用程序有一个稳定的环境，我们在云上得到了很多，同样没有真正改变我们的应用程序。</li><li id="b220" class="kr ks hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><strong class="ih hj">没有免费的午餐</strong>:我们从一台机器发展到几台在虚拟机上运行的负载平衡的机器。毫不奇怪，这比我们以前拥有的原始IIS主机更贵。我们觉得我们的钱花得值，免费层也有所帮助，但是我们每月的账单超出了我们对这个小应用程序的期望。这是我们想以后解决的问题。</li></ol><h2 id="498f" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">然后</h2><p id="c808" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">我们的第一个云架构为我们提供了大约两年的良好服务。与此同时，随着多平台的出现，技术领域正在快速变化。NET Core，带有Docker的容器等等。在下一篇文章中，我将谈论这些技术如何将我们的Windows专用虚拟机应用程序转变为可以在任何地方运行的容器化应用程序。</p></div></div>    
</body>
</html>