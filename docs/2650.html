<html>
<head>
<title>Best practices for architecting cost-effective and scalable Apigee X PayG Organisation in GCP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GCP构建经济高效且可扩展的Apigee X PayG组织的最佳实践</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/best-practices-for-architecting-cost-effective-and-scalable-apigee-x-payg-organisation-in-gcp-f575cc504e74?source=collection_archive---------1-----------------------#2022-12-20">https://medium.com/google-cloud/best-practices-for-architecting-cost-effective-and-scalable-apigee-x-payg-organisation-in-gcp-f575cc504e74?source=collection_archive---------1-----------------------#2022-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="aab3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Apigee X是一个基于SaaS的API网关，运行在谷歌云平台上。除了作为一个反向代理，Apigee X还提供API发布、分析和货币化功能。Apigee X作为应用程序的API管理平台，由于快速部署、可伸缩性和广泛的API代理操作，被证明是非常有用的。</p><p id="f328" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">开始并构建一个有弹性且灵活的Apigee X组织可能是一项艰巨的任务，因为作为一个客户，您可能有独特的需求，并且没有一种通用的方法来构建解决方案。Apigee X组织需要与相应的GCP组织保持一致，以提供强大的API管理能力。可扩展性和成本效益密切相关，因为Apigee X是GCP最昂贵的资源之一。Apigee X组织设计应该与API消耗率保持足够的一致性和灵活性，以实现最大价值。</p><p id="63f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">一个计划良好的Apigee X设置允许轻松的可伸缩性、面向未来且经济高效的API操作。下面是在提供Apigee X组织之前需要计划的关键决策领域的清单。</p><blockquote class="jl jm jn"><p id="71f1" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">选择Apigee X计费类型</p><p id="c20e" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">与GCP资源层次结构保持一致</p><p id="110d" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">网络设计要求</p><p id="fb06" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">为Apigee X设置角色和权限</p><p id="8f66" class="im in jo io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">Apigee X组织层次结构</p></blockquote></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="b8e2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们深入研究每一步。</p><ol class=""><li id="7325" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj jx jy jz ka bi translated"><strong class="io hj"> <em class="jo">选择顶点X计费计划</em> </strong></li></ol><p id="e8c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Apigee X为Apigee X提供了三种计费方案:评估(Eval)、现收现付(PayG)和订阅(基于许可证)。</p><p id="d369" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">评估类型的Apigee X组织仅供应60天。除了持续时间短之外，评估计划还有一个基础架构限制，即只有一个实例(单个区域)，无法为业务连续性规划(BCP) /灾难恢复(DR)提供多区域设置。因此，它不是商业组织推荐的类型。</p><p id="9f2a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">PayG和Subscription类型是组织的推荐选择。</p><p id="69b3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">PayG是Google Cloud中最近推出的Apigee X的计费类型(PayG计费模式不适用于Apigee Hybrid)。客户现在可以只为支持当前API消费所需的Apigee X基础设施付费。该基础设施处理预定的最小API调用，并且可以手动和自动扩展以支持不断增加的API流量。</p><p id="1494" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/pay-as-you-go" rel="noopener ugc nofollow" target="_blank"> PayG </a>在以下场景下是不错的选择，这里可以适用多个。</p><ul class=""><li id="ab02" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">客户正处于应用现代化/向云迁移的早期阶段。正在开发新的服务，并不断添加新的服务来支持应用程序的核心功能</li><li id="215d" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">后端应用程序或微服务在其DevOps周期中处于持续集成/持续开发阶段</li><li id="c89f" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">建立(测量)生产API请求速率/数量(TPS)仍然是一个遥远的目标，应用程序处于非生产或类似的环境中</li><li id="c23f" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">业务连续性规划(BCP) /灾难恢复(DR)处于次要位置，因为主要需求是开发后端服务。</li><li id="e6eb" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">不需要高级API特性，如API货币化、应用程序集成和高级API操作</li><li id="d195" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">PayG也适合尝试基于云的API管理平台并希望控制相关成本的数字原生用户。</li></ul><p id="1a42" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">与订阅计费类型形成对比，在订阅计费类型中，在以Apigee作为API网关开始之前购买计费计划。基于订阅的计费计划基于年度API请求或呼叫量的数量、分析数据保留和其他网络相关定价。订阅类型有<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/subscription-entitlements" rel="noopener ugc nofollow" target="_blank"> 3种标准服务</a>，即标准、企业和企业升级版。由于既定的年度API费率和GCP网络成本(出口/入口/高级/标准层)与基于订阅的整体计划中的其他相关Apigee服务结合在一起，因此订阅证明具有成本效益。</p><p id="95bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在以下情况下优先选择订阅计划，此处可适用多个计划。</p><ul class=""><li id="9566" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">客户已经估计了他们的年度API调用量或API速率(TPS)</li><li id="d7b2" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">业务连续性规划(BCP) /灾难恢复(DR)是一项要求，因为后端应用程序和相关的云基础架构对于基于生产的环境来说是稳定和成熟的。</li><li id="bc26" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">持续集成/持续部署是最能描述应用程序生命周期的CI/CD阶段</li><li id="cd01" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">客户需要API货币化、应用程序集成和高级API操作等附加功能</li></ul><p id="f1c9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">本文的其余部分将重点介绍PayG作为一种计费方案，因为它被广泛使用，并在开始应用程序现代化/迁移时提供可伸缩性和低成本供应的好处。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="70d8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2.<strong class="io hj"> <em class="jo">与GCP资源层级</em>的兼容性</strong></p><p id="b1e5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">根据经验，一个GCP项目只能映射到一个Apigee X组织。GCP资源层次结构可以主要根据不同的软件开发生命周期(SDLC)来安排。建议为SDLC的生产和非生产环境分别保留至少两个不同的Apigee组织，而不是在整个SDLC中共享一个Apigee组织。这种方法有很多优点</p><ul class=""><li id="30e9" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">独立的Apigee组织只为所需的SDLC环境提供高可用性(HA) /灾难恢复(DR)规划的灵活性，从而节省总体成本。</li><li id="54c4" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">避免了开发人员和测试团队对生产资源的意外部署/变更。Apigee组织的分离确保只有相关团队可以访问。</li><li id="79ab" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">某些地区法规和公司规范要求将生产和非生产环境数据分开保存。每个环境有不同的Apigee组织可确保使用GCP IAM政策分别授予相关人员访问权限。</li><li id="e1f4" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">特定于生产的Apigee组织可以有一个预先的计费计划，如订阅计划，附带API货币化、集成和高级API操作的额外费用</li><li id="6a00" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">开发者门户、API密钥等。可以在生产和非生产环境中分开存放。这与两种环境中API密钥分开的某些法规安全要求是一致的。</li><li id="4308" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">使用高级开发人员门户的灵活性，如用于生产的Drupal和用于非生产Apigee组织的Apigee集成开发人员门户。</li><li id="bae4" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">Apigee组织的产品限制为10个实例(每个独特区域一个)、85个环境、85个环境组等。详细的产品限制可在<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/limits" rel="noopener ugc nofollow" target="_blank">这里</a>找到。将生产和非生产作为独立的组织确保不违反产品限制。</li><li id="9993" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">生产Apigee X组织可以在应用程序最终准备好进入生产环境时进行调配。</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/874b0176a13573d75d734b87fee67674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*slGigFBkGCSh_y4J"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">Apigee X -GCP资源层次结构参考</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="2137" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.<strong class="io hj"> <em class="jo">网络设计要求</em> </strong></p><p id="a44d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><a class="ae jk" href="https://cloud.google.com/kubernetes-engine/docs/concepts/service-networking" rel="noopener ugc nofollow" target="_blank">服务网络</a>用于在谷歌云上为基于SaaS的产品提供网络。使用服务网络供应的著名SaaS产品包括Apigee X、Cloud IDS、Cloud SQL等。服务网络在GCP使用网络对等来连接主机VPC与a pigee X(GCP的租户项目)的入口/出口。<a class="ae jk" href="https://cloud.google.com/vpc/docs/private-services-access" rel="noopener ugc nofollow" target="_blank">私有服务访问</a>用于在主机VPC内保留IP地址，以便在对等Saas项目(如Apigee X)间共享</p><p id="4735" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">VPC规划</p><p id="7eb8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">作为最佳实践，每个SDLC的每个生产和非生产阶段至少应该有两个VPC。每个VPC将用于在相应的SDLC阶段为Apigee X组织提供网络。不同的VPC有助于将生产和非生产流量分开，并满足法规要求。</p><p id="c90d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">VPC是一种全球资源。网络管理员可以为子网规划、静态IP、私有服务访问等特定用例提供和保留IP范围。始终为VPC配置自定义子网，并删除具有自动模式子网的VPC(如果有)。</p><p id="449e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Apigee X运行时实例要求每个实例至少有/22个子网范围(用于Apigee运行时)和/28个子网(用于故障排除)。故障排除范围可以手动选择，也可以从对等的顶点范围自动选择。但是，在自动分配的情况下，一些IP范围应保持未初始化，以便服务网络提供故障排除范围。</p><p id="a804" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">例如，GCP网络管理员提供10.224.0.0/16来供应Apigee X运行时。</p><p id="cd64" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">10 . 224 . 0 . 0/16 = &gt; 00001010.11100000.000000 00.0000000(二进制表示)</p><p id="d689" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该子网范围可分为</p><p id="80a8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">例子</p><p id="ca54" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">顶点X实例1:10 . 224 . 0 . 0/22 = &gt; 00001010.11100000.0000000.0000000</p><p id="cefb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">顶点X实例2:10 . 224 . 4 . 0/22 = &gt; 00001010.11100000.0000100.0000000</p><p id="c112" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi">…</p><p id="e435" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">顶点X实例10:10 . 224 . 36 . 0/22 = &gt; 00001010.11100000.00100.0000000</p><p id="1785" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可以根据需要添加实例数量。在此示例中，每个Apigee组织总共可以配置10个实例，从而提供可扩展性。如果需要更多实例，需要添加一个单独的Apigee组织。截至2022年12月撰写本文时，每个机构10个实例是<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/limits" rel="noopener ugc nofollow" target="_blank">极限</a>。</p><p id="bca5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Apigee故障排除范围/其他资源(未初始化):</p><p id="46f7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi">10.224.128.0/17 =&gt; 00001010.11100000.10000000.00000000</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kx"><img src="../Images/54712ab2bec0f0a4906d4a37f5244951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*Ntp_-mdY_fNzHZbI34dOqA.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">Apigee X网络参考</figcaption></figure><p id="9338" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为Apigee X分配IP地址的最佳实践</p><ul class=""><li id="f30e" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">使用的地址范围可以是私有IPv4范围(<a class="ae jk" href="https://www.rfc-editor.org/rfc/rfc1918" rel="noopener ugc nofollow" target="_blank"> RFC 1918 </a>)</li><li id="af75" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">如果计划的私有IPv4地址空间不足或可能提前耗尽，建议使用共享地址空间<a class="ae jk" href="https://www.rfc-editor.org/rfc/rfc6598" rel="noopener ugc nofollow" target="_blank"> RFC 6598 </a>。</li><li id="5686" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">请选择足够的地址空间来容纳前端资源子网、Apigee X运行时实例(PayG)、后端资源子网和组织所需的其他GCP资源。</li><li id="d879" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">为GCP资源选择IP地址不应与本地/其他云网络子网、通过云互连和云VPN调配的连接冲突</li></ul></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="d3ea" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4.<strong class="io hj"> <em class="jo">为顶点X </em> </strong>提供角色和权限</p><p id="9caa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于Apigee组织，可以通过在GCP组织内部为IAM组分配所需的角色来授予权限。</p><p id="8517" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">IAM组是设置角色的推荐方式</p><ul class=""><li id="01ff" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">通过将角色分配给组，而不是分配给单个用户，可以大规模管理Apigee X用户的权限。</li><li id="fe84" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">在撤销用户对特定Apigee权限的访问时，可以从相应的IAM组中删除该用户。</li><li id="1162" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">Apigee X的自定义角色在GCP IAM中也可用。自定义角色提供细粒度的访问，IAM组可以根据自定义角色进行设置。</li></ul><p id="3282" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">建议从具有以下权限的IAM组开始。可以根据定制的业务需求添加新的组，并拥有细粒度的Apigee X权限。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ky"><img src="../Images/297970f5d536e5fe157247d8cea15d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKsFNFgYglnd4UPYZNSOhg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">Apigee X推荐的角色和IAM组</figcaption></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="2057" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">5.<strong class="io hj"> <em class="jo">顶点X组织层级</em> </strong></p><p id="8505" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就资源层级而言，Apigee X组织不同于GCP组织。Apigee X组织由以下部分组成</p><ul class=""><li id="b3ab" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">实例—调配不同环境的区域资源</li><li id="008c" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">环境—将部署API代理的执行上下文</li><li id="56d5" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">网关节点-处理API流量的环境单元。随着流量的增加，环境需要更多的节点</li><li id="35b3" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">环境组—具有主机名的Apigee环境的逻辑分组和映射。每个组可以分配一个或多个主机名，将传入的API请求路由到适当的环境</li></ul><p id="3eee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">设置Apigee X层次结构时的建议</p><ul class=""><li id="6e55" class="js jt hi io b ip iq it iu ix ju jb jv jf jw jj kb jy jz ka bi translated">Apigee X实例是一种区域性资源。为了实现灾难恢复设置的99.99%的SLA，应该配置多个实例或多区域实例。</li><li id="7459" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">生产或类似SDLC阶段的环境应跨多区域实例设置，以实现容错和灾难恢复</li><li id="afbf" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">Apigee环境是使用充当Apigee运行时的节点实现的。每个实例为每个Apigee环境提供最少2个节点，为所有Apigee环境提供最多1000个节点。</li><li id="3a64" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">网关节点数量是<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/pay-as-you-go" rel="noopener ugc nofollow" target="_blank"> PayG Billing </a>的组成部分之一。默认情况下，最少有2个节点实例。最大节点数可以根据需要手动设置，也可以自动缩放。</li><li id="acd9" class="js jt hi io b ip kc it kd ix ke jb kf jf kg jj kb jy jz ka bi translated">在<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/pay-as-you-go-nodes#apigee-gateway-node-performance" rel="noopener ugc nofollow" target="_blank">理想测试</a>条件下，每个Apigee节点可以处理300 TPS(每秒事务)。节点的实时性能可能因API代理性能和网络配置而异。为了节省成本，建议使用每个节点300个TPS API卷来估计环境所需的最大节点数量(假设<a class="ae jk" href="https://cloud.google.com/apigee/docs/api-platform/reference/pay-as-you-go-nodes#apigee-gateway-node-performance" rel="noopener ugc nofollow" target="_blank">理想的实验室条件</a>)。请相应地修改TPS以进行评估)。手动设置节点的最大限制是控制成本的好方法。</li></ul><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kz"><img src="../Images/f1af77d67f74160ea71c4cf882f5ab37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Aonz1JjI3JIwfRlk"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">Apigee X组织结构参考</figcaption></figure><p id="726d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在GCP对上述输入(计费计划、GCP资源层级、网络规划、角色和权限、Apigee X资源层级)进行架构和规划后，可以通过Apigee <a class="ae jk" href="http://apigee.google.com/" rel="noopener ugc nofollow" target="_blank">控制台</a>或使用<a class="ae jk" href="https://github.com/apigee/terraform-modules/tree/main/modules" rel="noopener ugc nofollow" target="_blank"> Terraform </a> Apigee模块来提供Apigee。</p></div></div>    
</body>
</html>