<html>
<head>
<title>Analyzing sentiment of text with domain-specific vocabulary and topics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用特定领域词汇和主题分析文本情感</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/analyzing-sentiment-of-text-with-domain-specific-vocabulary-and-topics-726b8f287aef?source=collection_archive---------1-----------------------#2019-06-10">https://medium.com/google-cloud/analyzing-sentiment-of-text-with-domain-specific-vocabulary-and-topics-726b8f287aef?source=collection_archive---------1-----------------------#2019-06-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="46fe" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第1部分:用AutoML创建定制的机器学习模型</h2></div><p id="440b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不久前，我使用<a class="ae jt" href="https://cloud.google.com/natural-language/" rel="noopener ugc nofollow" target="_blank">云自然语言</a> (NL)来<a class="ae jt" href="https://cloud.google.com/blog/products/gcp/analyzing-text-in-a-google-sheet-using-cloud-natural-language-api-and-apps-script" rel="noopener ugc nofollow" target="_blank">分析数百条特定度假租赁评论的情绪</a>。事实证明，这是一种快速、一致的方式来提取和总结评论者谈论的内容以及他们对此的感受。位置是好是坏？价值呢？Cloud NL能够识别评论者在谈论什么，并为每个主题表达的情绪分配量化值。</p><p id="e71c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于这种情况，预先训练的模型工作得很好，因为它正在分析的文本数据与特定领域的语言或情况没有细微差别。度假租赁评论中讨论的主题，如“漏水的水龙头”或“良好的wifi”，是预训练模型理解的常见情况，并且它可以确定潜在的情绪。</p><p id="db69" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是模特知道什么是坐在停机坪上吗？</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ju"><img src="../Images/fa0cdf025499d64ecbeab197d56737ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jq6vUsUj8cnaVb5VMsewkQ.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">当通过<a class="ae jt" href="https://cloud.google.com/natural-language/" rel="noopener ugc nofollow" target="_blank">云自然语言预训练模型</a>运行与航空公司相关的推文时，会产生情感结果。</figcaption></figure><p id="308e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这种情况下，预先训练的模型没有意识到当一个人被困在一架有数百名陌生人的飞机上，呼吸着循环空气，经历着个人空间的急剧缩小时会产生的强烈负面情绪。当由预先训练好的模型进行解释时，<strong class="iz hj">这条推文的情绪预测被记录为完全中立的</strong>。</p><p id="477d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，今天我将向您展示如何创建一个模型，为一段文本中表达的情感和态度提供<strong class="iz hj">特定领域的情感评分</strong>，这是通过<a class="ae jt" href="https://cloud.google.com/natural-language/automl/docs/" rel="noopener ugc nofollow" target="_blank"> AutoML自然语言</a>实现的。</p><p id="67bd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">AutoML自然语言使用迁移学习来取预训练模型的知识(漏水的水龙头不好！)并注入您用自己的数据提供的关于特定领域主题的新知识。<strong class="iz hj">您不需要成为机器学习专家，也不需要知道如何通过AutoML编写代码来创建定制模型。</strong>不要找借口，开始吧！我们将遵循我的队友戴尔的视频步骤，有一些小的变化。</p><figure class="jv jw jx jy fd jz"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">接下来的书面教程的视频概述！</figcaption></figure><p id="fe5c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:如果你跟着做，计算成本大约是15美元。如果你<a class="ae jt" href="https://cloud.google.com/free/" rel="noopener ugc nofollow" target="_blank">注册一个新的谷歌云平台账户</a>，这可以被300美元的免费积分抵消。</p><h1 id="4c86" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">准备您的数据</h1><p id="8b2a" class="pw-post-body-paragraph ix iy hi iz b ja le ij jc jd lf im jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">训练一个机器学习模型需要有标签的例子；这就是模型的学习方式。对于情感分析，例子是具有相关情感分数的短语。拥有正确的数量、准确性和数据组合是创建良好模型的最大挑战之一。</p><p id="10d1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可能需要投入时间寻找数据来源，并可能手工标注数据。你没有必要在内部手工贴标。你可以使用像谷歌云的<a class="ae jt" href="https://cloud.google.com/data-labeling/docs/" rel="noopener ugc nofollow" target="_blank">数据标签服务</a>这样的服务，支付<a class="ae jt" href="https://cloud.google.com/data-labeling/pricing" rel="noopener ugc nofollow" target="_blank">的费用</a>，他们将为你计划用来训练定制模型的数据集合管理人工标签。现在，你可以使用来自Kaggle 的<a class="ae jt" href="https://www.kaggle.com/crowdflower/twitter-airline-sentiment" rel="noopener ugc nofollow" target="_blank">标签的tweet数据。这些都是与航空公司相关的推文，每条都被贴上了“正面”、“中性”或“负面”的标签。</a></p><ol class=""><li id="1363" class="lj lk hi iz b ja jb jd je jg ll jk lm jo ln js lo lp lq lr bi translated">将<a class="ae jt" href="https://www.kaggle.com/crowdflower/twitter-airline-sentiment" rel="noopener ugc nofollow" target="_blank"> Tweets.csv </a>下载到你的桌面上，并导入到一个新的谷歌表单中。</li><li id="bc76" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">删除除text和airline _ perspective之外的所有列，并将它们分别定位为列A和列B。</li><li id="d786" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">在“航空公司情绪”列中，将“负面”替换为0，“中性”替换为1，“正面”替换为2。您可以使用嵌套的IF语句，或者快速查找和替换。</li><li id="68f1" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">将当前工作表下载为CSV文件。</li></ol><p id="e330" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于第3步，你可以有三个以上的唯一标签。如果您自己的数据有更高的粒度，您可以使用多达数字10的标签。更多信息<a class="ae jt" href="https://cloud.google.com/natural-language/automl/sentiment/docs/prepare" rel="noopener ugc nofollow" target="_blank">点击此处</a>。</p><h1 id="d577" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">将数据集上传到AutoML</h1><p id="f613" class="pw-post-body-paragraph ix iy hi iz b ja le ij jc jd lf im jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">用AutoML创建一个定制模型需要一个<a class="ae jt" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台项目</a>，一旦你准备好了，就去找<a class="ae jt" href="https://console.cloud.google.com/natural-language" rel="noopener ugc nofollow" target="_blank"> AutoML自然语言</a>。</p><ol class=""><li id="ebf0" class="lj lk hi iz b ja jb jd je jg ll jk lm jo ln js lo lp lq lr bi translated">点击网页顶栏的<strong class="iz hj"> +新建数据集</strong>。</li><li id="aa09" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">给数据集起一个名字，在Objective下选择“情感分析”。</li><li id="a51d" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">选择从您的计算机上传CSV文件的选项，并选择您准备好的文件。</li><li id="82e8" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">点击<strong class="iz hj">创建数据集</strong>。上传需要几分钟时间，完成后您会收到一封电子邮件。</li><li id="0a08" class="lj lk hi iz b ja ls jd lt jg lu jk lv jo lw js lo lp lq lr bi translated">收到电子邮件后，单击链接查看已上传的项目。</li></ol><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lx"><img src="../Images/a0abb652e09f4e15878142bbc5728cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-EVuMcIu3BseJ5SlJO2iHw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">以下是上传数据集后您将看到的内容。</figcaption></figure><h1 id="633b" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">训练您的模型</h1><p id="c27a" class="pw-post-body-paragraph ix iy hi iz b ja le ij jc jd lf im jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">创建数据集后，就该开始训练自定义模型了。培训<a class="ae jt" href="https://cloud.google.com/natural-language/automl/pricing" rel="noopener ugc nofollow" target="_blank">费用为3美元/小时</a>，需要几个小时(这种模式需要3-4个小时)。</p><ol class=""><li id="9569" class="lj lk hi iz b ja jb jd je jg ll jk lm jo ln js lo lp lq lr bi translated">导航至<strong class="iz hj">列车</strong>子菜单，点击<strong class="iz hj">列车新型号</strong>。</li></ol><p id="f1ae" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！</p><p id="1967" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成后，您会收到一封电子邮件。电子邮件将提供查看评估指标的链接。</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ly"><img src="../Images/df634a91bcdcd618ec2ee85eac2740b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwlDrHxyvK4lenj9uZd69A.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">模型训练完成后，您可以检查模型的精度和召回率。</figcaption></figure><p id="2fd3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该模型的准确率和召回率都在83%左右。模型性能需求是可变的，取决于如何将预测用于您的特定用例。我推荐<a class="ae jt" href="https://cloud.google.com/natural-language/automl/sentiment/docs/evaluate" rel="noopener ugc nofollow" target="_blank">点击进入文档</a>阅读更多内容。<a class="ae jt" href="https://cloud.google.com/natural-language/automl/docs/beginners-guide" rel="noopener ugc nofollow" target="_blank">初学者指南</a>对于理解精度和召回率，以及如何评估机器学习模型也非常有用。</p><p id="4de9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了看看这个模型是否比使用预先训练的模型表现得更好，我通过云自然语言API运行了推文的子集，以分析文档级的情感。将情感得分范围分类为“正面”(0.25到1)、“中性”(-0.25到0.25)和“负面”(-1到-0.25)，总体精度得分徘徊在60%左右。因此，就我的目的而言，AutoML定制模型在精度上确实比预训练模型有显著提高。</p><h1 id="b081" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">分析对新文本的情感</h1><p id="227c" class="pw-post-body-paragraph ix iy hi iz b ja le ij jc jd lf im jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">通过直接在产品中分析情绪来尝试您的模型！</p><ol class=""><li id="fbe0" class="lj lk hi iz b ja jb jd je jg ll jk lm jo ln js lo lp lq lr bi translated">导航到<strong class="iz hj">预测</strong>子菜单，在文本框中输入新的文本样本，并点击<strong class="iz hj">预测。</strong></li></ol><p id="d804" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您创建的模型将获取文本，并以训练好的粒度预测情感得分(0 =负，1=中性，2=正)</p><figure class="jv jw jx jy fd jz er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lz"><img src="../Images/bb1889c7faf91311d17cae7ae57f89d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*knlW7QumK3CZuDL-PUPssw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">这就是我们想要的结果:对于我们的示例短语，一个明显负面的情感分数。</figcaption></figure><p id="e84e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">AutoML无法告诉我<em class="ma">为什么</em>定制模型的情感评分为0(“负”)，而预训练模型的结果为中性。也许更好理解的是提到柏油路，这是一个在训练数据中出现了90次的术语。也许这是定制模特在正式写作上对类似推特的短语的训练。也许定制模式决定了@United的每条推文都是负面的(开玩笑！至少这里不是这样)。</p><p id="41d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是请记住，模型只有在收到示例时才会学习，所以如果数据中从未提到tarmac，或者没有很好地表示(例如，只有在带有负面情绪的推文中)，模型将无法准确地考虑特定领域的细微差别。在构建训练数据和管理对新数据进行预测时对模型的预期时，请记住这一点。</p><h1 id="6ee4" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">后续步骤</h1><p id="6a46" class="pw-post-body-paragraph ix iy hi iz b ja le ij jc jd lf im jf jg lg ji jj jk lh jm jn jo li jq jr js hb bi translated">你现在有了一个定制的机器学习模型，可以随意分析航空公司的推文情绪！在产品界面中这样做很有趣，但是请继续关注。接下来，我将向您展示如何使用Google Sheet的一些代码，这样您就可以<strong class="iz hj">单击一下这个自定义模型，分析电子表格中的几行tweets。</strong></p><p id="1c35" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ma">更新:Part 2</em><a class="ae jt" rel="noopener" href="/google-cloud/analyzing-sentiment-of-text-with-domain-specific-vocabulary-and-topics-bdcca7ac8c3e"><em class="ma">此处可用</em> </a> <em class="ma">！</em></p></div></div>    
</body>
</html>