<html>
<head>
<title>Kubernetes Engine: kubectl config</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes引擎:kubectl配置</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/kubernetes-engine-kubectl-config-b6270d2b656c?source=collection_archive---------0-----------------------#2018-06-09">https://medium.com/google-cloud/kubernetes-engine-kubectl-config-b6270d2b656c?source=collection_archive---------0-----------------------#2018-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3eaf" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这已经在其他地方<a class="ae jh" href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/" rel="noopener ugc nofollow" target="_blank">记录过了</a>但是我认为有必要总结一下<code class="du if ig ih ii b">kubectl</code>和<code class="du if ig ih ii b">gcloud</code>配置的使用，它们的交互，以及当你有多个Kubernetes集群时如何在Kubernetes配置之间切换。</p><p id="99d7" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我正在使用Kubernetes引擎，它使配置管理变得更加容易，但是——如果你和我一样——这可能会导致自满，让工具完成它们的工作，而不花时间去研究发生了什么。</p><h2 id="9f0c" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">设置</h2><p id="abee" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">让我们假设您已经创建了2个Kubernetes引擎集群，并获得了它们的凭证。您将被配置为使用最近经过身份验证的群集:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="2e38" class="ji jj hi ii b fi kq kr l ks kt">gcloud container clusters create black ...<br/>gcloud container clusters create white ...</span><span id="5ff2" class="ji jj hi ii b fi ku kr l ks kt">gcloud container clusters get-credentials black ...<br/>gcloud container clusters get-credentials <strong class="ii hj">white</strong> ...</span><span id="d431" class="ji jj hi ii b fi ku kr l ks kt">kubectl get nodes</span><span id="a7c8" class="ji jj hi ii b fi ku kr l ks kt">NAME                  STATUS    ROLES     AGE       VERSION<br/><strong class="ii hj">white</strong>-2378271e-qpd6   Ready     &lt;none&gt;    1h        v1.10.2-gke.3<br/><strong class="ii hj">white</strong>-5d71e034-njph   Ready     &lt;none&gt;    1h        v1.10.2-gke.3<br/><strong class="ii hj">white</strong>-f4567e1d-4rwd   Ready     &lt;none&gt;    1h        v1.10.2-gke.3</span></pre><blockquote class="kv kw kx"><p id="bb33" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated">为了说明这一点，我在上面重新命名了<code class="du if ig ih ii b">NAME</code>。</p></blockquote><p id="ef30" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我们已经通过了<code class="du if ig ih ii b">white</code>集群的认证。</p><h2 id="553a" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">kubectl配置</h2><p id="3992" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">让我们来看看Kubernetes(发动机)的配置:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="2bd9" class="ji jj hi ii b fi kq kr l ks kt">kubectl config view</span></pre><figure class="ki kj kk kl fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="ff8f" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">底层配置文件很可能是(！)位于:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="157f" class="ji jj hi ii b fi kq kr l ks kt">~/.kube/config</span></pre><p id="4aed" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">您的配置将类似于这个文件。为了清楚起见，我修改并重新命名了一些元素。</p><p id="aad9" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这里有两个集群、两个上下文和两个用户。还有一个属性<code class="du if ig ih ii b">current-context</code>指向当前上下文。两个名字之一。在这种情况下<code class="du if ig ih ii b">white</code>。</p><p id="1cf9" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">有一点可能不太明显，因为我创建了两个集群(<code class="du if ig ih ii b">white</code>和<code class="du if ig ih ii b">black</code>)并且对它们进行了身份验证，所以我的配置中不需要有两个不同但相同的用户。它们都反映了同一个用户。我建议你<strong class="il hj">不要</strong>这个<strong class="il hj">而是</strong>为了清楚起见，这个配置与上面的相同:</p><figure class="ki kj kk kl fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><blockquote class="kv kw kx"><p id="0ec4" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj">注意</strong>我已经用我的用户<code class="du if ig ih ii b">name</code>重命名了2个<code class="du if ig ih ii b">users</code>中的一个，删除了重复的，并用我的用户<code class="du if ig ih ii b">name</code>重命名了<code class="du if ig ih ii b">contexts</code>中的引用。</p></blockquote><p id="7316" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">让我们深入研究一下这个<code class="du if ig ih ii b">auth-provider</code>。</p><h2 id="7af1" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">访问令牌</h2><p id="714b" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">从您的<code class="du if ig ih ii b">kubectl config view</code>中获取访问令牌。它的形式应该是<code class="du if ig ih ii b">ya29...</code>。姑且称之为<code class="du if ig ih ii b">${ACCESS_TOKEN}</code>。</p><blockquote class="kv kw kx"><p id="34ae" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj"> NB </strong>在结果中过期。如果您在该时间后尝试此命令，您的令牌将会过期。如果有，进行任意调用，例如<code class="du if ig ih ii b">kubectl get nodes</code>来强制刷新令牌，重新运行<code class="du if ig ih ii b">kubectl config view</code>并重试。</p></blockquote><p id="0c0a" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">然后，您可以浏览或卷曲:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="6aaa" class="ji jj hi ii b fi kq kr l ks kt">curl <a class="ae jh" href="https://www.googleapis.com/oauth2/v2/tokeninfo?access_token=ya29.Gl3VBZukOogc8_OjmqUwzttWgILzgnDzDpBadqfr9ggNaz_IpQNxUUDF1fcN7IGnENr29677JS9OnWKJx8YuqICryjdecgtMbJex-W6RISkDtacDLgpwzLuyBS1JvH4" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/oauth2/v2/tokeninfo?access_token=<strong class="ii hj">$</strong></a><strong class="ii hj">{ACCESS_TOKEN}</strong></span><span id="7280" class="ji jj hi ii b fi ku kr l ks kt">{<br/> "issued_to": "12345678901.apps.googleusercontent.com",<br/> "audience": "12345678901.apps.googleusercontent.com",<br/> "user_id": "123456789012345678901",<br/> "scope": "<a class="ae jh" href="https://www.googleapis.com/auth/userinfo.email" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/userinfo.email</a> <a class="ae jh" href="https://www.googleapis.com/auth/cloud-platform" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/cloud-platform</a> <a class="ae jh" href="https://www.googleapis.com/auth/appengine.admin" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/appengine.admin</a> <a class="ae jh" href="https://www.googleapis.com/auth/compute" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/compute</a> <a class="ae jh" href="https://www.googleapis.com/auth/plus.me" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/plus.me</a>",<br/> "expires_in": 1199,<br/> "email": "<a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]",<br/> "verified_email": true,<br/> "access_type": "offline"<br/>}</span></pre><blockquote class="kv kw kx"><p id="22c7" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj">注意</strong>邮件反映了你在<code class="du if ig ih ii b">gcloud</code>使用的账户。如果你查看你的<code class="du if ig ih ii b">gcloud</code>配置(或者<code class="du if ig ih ii b">gcloud auth list</code>或者<code class="du if ig ih ii b">gcloud config list</code>，或者更准确地说<code class="du if ig ih ii b">gcloud config get-value account</code>，这应该是你的<code class="du if ig ih ii b">ACTIVE</code> <code class="du if ig ih ii b">ACCOUNT</code>名字。</p></blockquote><h2 id="9193" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">g云配置</h2><p id="64ae" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated"><code class="du if ig ih ii b">auth-provider</code>引用了<code class="du if ig ih ii b">gcloud</code>。具体为<code class="du if ig ih ii b">cmd-path</code>、<code class="du if ig ih ii b">cmd-args</code>和<code class="du if ig ih ii b">expiry-key</code>、<code class="du if ig ih ii b">token-key</code>两个属性。<code class="du if ig ih ii b">cmd-path</code>应匹配:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="bfb3" class="ji jj hi ii b fi kq kr l ks kt">which gcloud</span><span id="9711" class="ji jj hi ii b fi ku kr l ks kt">/.../google-cloud-sdk/bin/gcloud</span></pre><p id="a01b" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><code class="du if ig ih ii b">cmd-args</code>没有被谷歌很好地记录(提交了一个bug :-)，但谷歌的一位工程师解释说(<a class="ae jh" href="https://github.com/GoogleCloudPlatform/google-auth-library-python/issues/146" rel="noopener ugc nofollow" target="_blank">链接</a>):</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="39d3" class="ji jj hi ii b fi kq kr l ks kt">gcloud config config-helper<br/>configuration:<br/>  active_configuration: default<br/>  properties:<br/>    core:<br/>      account: <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]<br/>      disable_usage_reporting: 'False'<br/>credential:<br/>  access_token: [[ACCESS_TOKEN]]<br/>  token_expiry: '2018-06-09T00:00:00Z'<br/>sentinels:<br/>  config_sentinel: /.../.config/gcloud/config_sentinel</span></pre><p id="07cc" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">或者你可以加上<code class="du if ig ih ii b">--format=json</code>和:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="2bbf" class="ji jj hi ii b fi kq kr l ks kt">{<br/>  "configuration": {<br/>    "active_configuration": "default",<br/>    "properties": {<br/>      "core": {<br/>        "account": "[[YOUR-EMAIL]]",<br/>        "disable_usage_reporting": "False"<br/>      }<br/>    }<br/>  },<br/>  "credential": {<br/>    "access_token": "[[ACCESS_TOKEN]]",<br/>    "token_expiry": "2018-06-09T00:00:00Z"<br/>  },<br/>  "sentinels": {<br/>    "config_sentinel": "/.../.config/gcloud/config_sentinel"<br/>  }<br/>}</span></pre><p id="59aa" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">当您使用<code class="du if ig ih ii b">kubectl</code>时，它使用<code class="du if ig ih ii b">auth-provider</code>配置来使用<code class="du if ig ih ii b">gcloud config config-helper</code>为您的帐户获取一个<code class="du if ig ih ii b">access_token</code>，以便它可以访问集群的资源。</p><p id="11ad" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我们先简单绕道通过<code class="du if ig ih ii b">gcloud</code> <code class="du if ig ih ii b">configurations</code>来说明这一点。</p><h2 id="dd3f" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">gcloud config配置</h2><p id="a2ac" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">你会注意到上面的<code class="du if ig ih ii b">gcloud</code>也有<code class="du if ig ih ii b">configurations</code>。我很少使用这个工具，但是为了完整起见…</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="3ede" class="ji jj hi ii b fi kq kr l ks kt">gcloud config list<br/>[core]<br/>account = <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]<br/>disable_usage_reporting = False</span><span id="19de" class="ji jj hi ii b fi ku kr l ks kt">Your active configuration is: [<strong class="ii hj">default</strong>]</span></pre><blockquote class="kv kw kx"><p id="1aa6" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj">NB</strong>T26】</p></blockquote><p id="b791" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><code class="du if ig ih ii b">gcloud</code>的配置存放在哪里？大概是:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="17c0" class="ji jj hi ii b fi kq kr l ks kt">ls -la ~/.config/gcloud<br/><br/>active_config<br/>application_default_credentials.json<br/>cache<br/>config_sentinel<br/>configurations</span></pre><blockquote class="kv kw kx"><p id="a18d" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj"> NB </strong>编辑以论证观点</p></blockquote><p id="4b9f" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">如果您:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="540d" class="ji jj hi ii b fi kq kr l ks kt">less <!-- -->~/.config/gcloud/<!-- -->active_config</span><span id="ea32" class="ji jj hi ii b fi ku kr l ks kt"><strong class="ii hj">default</strong></span></pre><p id="7907" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">哪一个是配置前缀<code class="du if ig ih ii b">config_</code>中条目的关键字:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="69db" class="ji jj hi ii b fi kq kr l ks kt">less ~/.config/gcloud/config_<strong class="ii hj">default</strong></span><span id="8e42" class="ji jj hi ii b fi ku kr l ks kt">[core]<br/>account = <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]</span><span id="4524" class="ji jj hi ii b fi ku kr l ks kt">[container]</span><span id="e704" class="ji jj hi ii b fi ku kr l ks kt">[compute]</span></pre><blockquote class="kv kw kx"><p id="c8c9" class="ij ik ky il b im in io ip iq ir is it kz iv iw ix la iz ja jb lb jd je jf jg hb bi translated"><strong class="il hj"> NB </strong>你的配置可能有更多属性。</p></blockquote><p id="180c" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这应该反映了什么结果<code class="du if ig ih ii b">gcloud config list</code>。</p><p id="0178" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">您可以(！)创建多个配置，以反映您希望使用的不同GCP配置。例如:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="f22e" class="ji jj hi ii b fi kq kr l ks kt">gcloud config configurations list<br/>NAME     IS_ACTIVE  ACCOUNT<br/>default  True       <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]</span><span id="5104" class="ji jj hi ii b fi ku kr l ks kt">gcloud config configurations create <strong class="ii hj">henry</strong><br/>Created [<strong class="ii hj">henry</strong>].<br/>Activated [<strong class="ii hj">henry</strong>].</span><span id="4f6b" class="ji jj hi ii b fi ku kr l ks kt">gcloud config configurations list<br/>NAME     IS_ACTIVE  ACCOUNT<br/>default  True       <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[YOUR-EMAIL]]<br/><strong class="ii hj">henry</strong>    True</span></pre><p id="645b" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">然后，您可以验证:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="7b96" class="ji jj hi ii b fi kq kr l ks kt">cat ~/.config/gcloud/active_config<br/><strong class="ii hj">henry</strong></span><span id="c0d1" class="ji jj hi ii b fi ku kr l ks kt">ls -l ~/.config/gcloud/configurations<br/>config_default<br/>config_<strong class="ii hj">henry</strong></span></pre><p id="b80e" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">还有，收拾一下:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="5393" class="ji jj hi ii b fi kq kr l ks kt">gcloud config configurations activate <strong class="ii hj">default</strong></span><span id="5a95" class="ji jj hi ii b fi ku kr l ks kt">gcloud config configurations delete henry<br/>The following configurations will be deleted:<br/> - henry<br/>Do you want to continue (Y/n)?  Y</span><span id="9d52" class="ji jj hi ii b fi ku kr l ks kt">Deleted [henry].</span></pre><p id="7e0a" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我发现很少使用gcloud配置，而是倾向于针对<code class="du if ig ih ii b">default</code>配置进行多次登录:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="8704" class="ji jj hi ii b fi kq kr l ks kt">gcloud auth list<br/>       Credentialed Accounts<br/>ACTIVE  ACCOUNT<br/>        <a class="ae jh" href="mailto:daz.wilkin@brabantcourt.com" rel="noopener ugc nofollow" target="_blank">[</a>[EMAIL-#1]]<br/>*       <a class="ae jh" href="mailto:daz.wilkin@gmail.com" rel="noopener ugc nofollow" target="_blank">[</a>[EMAIL-#2]]<br/>        <a class="ae jh" href="mailto:dazwilkin@cloud-sce.com" rel="noopener ugc nofollow" target="_blank">[</a>[EMAIL-#3]]</span><span id="4165" class="ji jj hi ii b fi ku kr l ks kt">To set the active account, run:<br/>    $ gcloud config set account `ACCOUNT`</span></pre><p id="3367" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">如上所示，使用例如<code class="du if ig ih ii b">gcloud config set account [[EMAIL-#3]]</code>在这些选项之间切换。</p><h2 id="75c0" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">kubectl配置使用上下文</h2><p id="4449" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">好了，我们现在明白了<code class="du if ig ih ii b">kubectl</code>如何使用<code class="du if ig ih ii b">gcloud</code>来对抗GCP。但是，我们还没有解决如何管理多个<code class="du if ig ih ii b">kubectl</code>配置的问题。</p><p id="09e5" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这是有据可查的(<a class="ae jh" href="https://kubernetes.io/docs/tasks/access-application-cluster/configure-access-multiple-clusters/" rel="noopener ugc nofollow" target="_blank">链接</a>)，但这里是我对它的看法。让我们回到我们的<code class="du if ig ih ii b">white</code>和<code class="du if ig ih ii b">black</code>集群。正如我提到的，Kubernetes引擎将为您的<code class="du if ig ih ii b">clusters</code>、<code class="du if ig ih ii b">contexts</code>和<code class="du if ig ih ii b">users</code>创建唯一的名称。我已经解释了你可以如何(你不需要这样做，而且要小心)重命名|合并你的<code class="du if ig ih ii b">users</code>。你也可以对<code class="du if ig ih ii b">clusters</code>和<code class="du if ig ih ii b">contexts</code>做同样的事情。只是要小心，在你的配置文件中，你要正确地将所有的引用重命名为<strong class="il hj">。</strong></p><p id="a24e" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">如果您破坏了某些东西，您可以重新运行<code class="du if ig ih ii b">gcloud container clusters get-credentials</code>来针对您的集群重新进行身份验证。</p><p id="222d" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">那么，我们如何在集群之间切换呢？其实很简单。假设:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="dab5" class="ji jj hi ii b fi kq kr l ks kt">kubectl config get-contexts<br/>CURRENT   NAME          CLUSTER AUTHINFO           NAMESPACE<br/><strong class="ii hj">*</strong>         <strong class="ii hj">white</strong>         white   dazwilkin<br/>          black         black   dazwilkin</span></pre><p id="5342" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">你需要使用在你的配置中定义的任何值。</p><p id="0cf4" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">您可以:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="5b50" class="ji jj hi ii b fi kq kr l ks kt">kubectl config use-context <strong class="ii hj">black</strong><br/>Switched to context "black"</span><span id="31dd" class="ji jj hi ii b fi ku kr l ks kt">kubectl config use-context white<br/>Switched to context "white"</span></pre><p id="b778" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">如果你想让自己的生活更简单:</p><pre class="ki kj kk kl fd km ii kn ko aw kp bi"><span id="ebf7" class="ji jj hi ii b fi kq kr l ks kt">alias black="kubectl config use-context black"<br/>black<br/>Switch to context "black"</span></pre><h2 id="ac75" class="ji jj hi bd jk jl jm jn jo jp jq jr js iu jt ju jv iy jw jx jy jc jz ka kb kc bi translated">结论</h2><p id="e04d" class="pw-post-body-paragraph ij ik hi il b im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc kh je jf jg hb bi translated">【Kubernetes引擎利用Google云平台的<code class="du if ig ih ii b">gcloud</code> CLI来促进针对集群的身份验证。这篇文章总结了如何在授权集群之间切换，而不需要重复使用<code class="du if ig ih ii b">gcloud</code>来获取凭证。</p><p id="8fc3" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">一路上，这篇文章提供了一些简化<code class="du if ig ih ii b">kubectl</code>配置的<strong class="il hj">小心操作</strong>说明，以及<code class="du if ig ih ii b">kubectl</code>和<code class="du if ig ih ii b">gcloud</code>如何管理配置和数据存储位置的总结。</p><p id="e965" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">随时欢迎反馈！</p><p id="5f02" class="pw-post-body-paragraph ij ik hi il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">仅此而已。</p></div></div>    
</body>
</html>