<html>
<head>
<title>Deploying Docker Images To Google Cloud Using Kubernetes Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Kubernetes引擎将Docker图像部署到Google Cloud</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/deploying-docker-images-to-google-cloud-using-kubernetes-engine-637af009e594?source=collection_archive---------0-----------------------#2018-03-28">https://medium.com/google-cloud/deploying-docker-images-to-google-cloud-using-kubernetes-engine-637af009e594?source=collection_archive---------0-----------------------#2018-03-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="26e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章假设您已经有了一个工作的docker映像，可以在本地机器上构建和运行，显然还有一个Google Cloud帐户，其中激活了所有必要的API，并且在您的机器上安装了Google Cloud SDK。如果一切正常，你就可以走了！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/69354cc82385eba7ec3274aa7af29bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVaCQTIeQlNEVjxw-VZpDQ.png"/></div></div></figure><p id="47f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我做的第一件事是确保我的代码上有一个最新的GitHub repo，我通常用以下格式保存它:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="d2a0" class="ju jv hi jq b fi jw jx l jy jz">- .<br/>- app<br/>-- &lt;APP CODE&gt;<br/>-- main.py<br/>- Dockerfile</span></pre><p id="1ade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在Github中建立了一个新的存储库，然后在执行最终的<code class="du ka kb kc jq b">git push origin master</code>之前，使用<code class="du ka kb kc jq b">git add .</code>和<code class="du ka kb kc jq b">git commit -m "Some Message"</code>确保存储库是最新的</p><p id="bdec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们开始构建Docker映像，并将其推送到Google Cloud的容器注册表中。首先发布:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="e834" class="ju jv hi jq b fi jw jx l jy jz">docker build -t myimage .</span></pre><p id="4253" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请随意在您的本地机器上测试:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="6da8" class="ju jv hi jq b fi jw jx l jy jz">docker run -d --name mycontainer -p 80:80 myimage</span></pre><p id="e3e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦使用完<code class="du ka kb kc jq b">docker ps</code>、<code class="du ka kb kc jq b">docker kill pid</code>和<code class="du ka kb kc jq b">docker rm pid</code>的组合，就可以终止/删除该进程。</p><p id="faf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在推送到Google Cloud之前，我们必须快速地用Google Cloud需要的必要信息来标记我们的图像。确保在Google Cloud仪表板中用正确的项目ID替换了<code class="du ka kb kc jq b">&lt;PROJECT NAME&gt;</code>。问题:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="7ecf" class="ju jv hi jq b fi jw jx l jy jz">docker tag myimage gcr.io/&lt;PROJECT NAME&gt;/myimage:v1</span></pre><p id="f5d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以使用Google Cloud SDK安装的<code class="du ka kb kc jq b">gcloud</code>命令将它推送到Google Cloud的容器注册表中。注册表类似于Docker Cloud，但与Google的控制台和Kubernetes引擎结合得很好。推动它:</p><pre class="je jf jg jh fd jp jq jr js aw jt bi"><span id="9466" class="ju jv hi jq b fi jw jx l jy jz">gcloud docker -- push gcr.io/&lt;PROJECT NAME&gt;/myimage:v1</span></pre><p id="8650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果你打开谷歌云控制台，转到容器注册表，你应该会看到你的新Docker图像。干得好！</p><p id="c69e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在需要让我们的形象在Kubernetes引擎服务。Kubernetes Engine是Google托管的Kubernetes版本，它使您能够创建一个“节点”集群来服务您的容器。首先，按照Kubernetes引擎仪表板中的提示创建一个集群。然后转到“工作负载”,点击“部署”按钮。</p><p id="da40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确保您单击了“选择现有的Google容器注册表映像”按钮，然后选择您的存储库和标签(最初将是v1)。点击“完成”，给它一个有用的名字，然后点击“部署”。</p><p id="dcb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在右边的面板中，您会看到使用负载平衡器将您的映像“暴露”到互联网的选项。去做这个吧。然后，您将获得一个面向互联网的端点，您可以在其上测试您的部署。恭喜您，您刚刚使用Kubernetes引擎将docker映像部署到Google Cloud！</p></div></div>    
</body>
</html>