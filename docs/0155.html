<html>
<head>
<title>Ruby &amp; GCP: Uploading Pictures To Cloud Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">鲁比&amp; GCP:上传图片到云存储</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/ruby-gcp-uploading-pictures-to-cloud-storage-4c136dd2405f?source=collection_archive---------0-----------------------#2016-09-30">https://medium.com/google-cloud/ruby-gcp-uploading-pictures-to-cloud-storage-4c136dd2405f?source=collection_archive---------0-----------------------#2016-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d5f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">向存储提供商上传内容是我在云提供商那里做的最基本的任务之一。至少应该是。这是一个用Ruby上传文件到Google云存储的快速教程。本教程的代码是<a class="ae jd" href="https://github.com/thagomizer/examples/tree/master/CloudMinute/Ruby" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><h1 id="0494" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">设置</h1><ol class=""><li id="16c2" class="kc kd hi ih b ii ke im kf iq kg iu kh iy ki jc kj kk kl km bi translated">要运行本教程，你需要一个谷歌云平台账户和一个项目。您可以在http://cloud.google.com/free-trial的<a class="ae jd" href="http://cloud.google.com/free-trial" rel="noopener ugc nofollow" target="_blank">创建账户和项目。</a></li><li id="d5b3" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">你还需要谷歌云存储宝石。gem安装谷歌-云存储</li><li id="2630" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">在<a class="ae jd" href="https://console.cloud.google.com/apis" rel="noopener ugc nofollow" target="_blank"> API管理器</a>中启用存储API。你希望启用Google云存储和Google云存储JSON API。</li><li id="f4be" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kj kk kl km bi translated">最后，您需要一个服务帐户。</li></ol><ul class=""><li id="e65c" class="kc kd hi ih b ii ij im in iq ks iu kt iy ku jc kv kk kl km bi translated">从console.cloud.google.com点击左侧菜单中的“API管理器”。</li><li id="0d98" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kv kk kl km bi translated">加载API管理器页面后，单击“凭据”。它可能只是作为一个关键图标出现。</li><li id="6165" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kv kk kl km bi translated">单击“创建凭据”并选择“服务帐户密钥”。</li><li id="7f8c" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kv kk kl km bi translated">您可以使用现有的服务帐户或创建一个新帐户。它应该具有存储对象管理员角色。您可能需要向下滚动角色下拉列表，以查看存储类别。</li><li id="9b4d" class="kc kd hi ih b ii kn im ko iq kp iu kq iy kr jc kv kk kl km bi translated">密钥应该会自动下载。把它放在安全的地方。我将它放在我的项目的根目录中，并将其重命名为service-account.json。</li></ul><h1 id="a80e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">代码</h1><p id="2460" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">上传文件的代码很简单。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="8011" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，需要库，并使用您的项目id和服务帐户密钥创建一个新的gcloud对象。您可以从云控制台获取项目id。它可能与您的项目名称不同。</p><p id="3fe4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后使用gcloud对象创建一个存储对象。</p><p id="0077" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，创建一个云存储桶。云存储空间名称在整个Google Cloud中必须是唯一的。存储桶名称也可能是全局可见的，因此它们不应该包含专有信息。更多信息参见<a class="ae jd" href="https://cloud.google.com/storage/docs/naming#requirements" rel="noopener ugc nofollow" target="_blank">存储桶命名要求</a>和<a class="ae jd" href="https://cloud.google.com/storage/docs/best-practices" rel="noopener ugc nofollow" target="_blank">存储桶命名最佳实践</a>。</p><p id="ce50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，这个桶被称为my_goat_pictures。</p><p id="e7d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦创建了bucket，就可以使用create_file方法上传文件。在示例中，我上传了一张名为goat.jpg的图片，它在云存储桶中保存为uploaded_goat.jpg。</p><p id="1451" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用web控制台中的存储浏览器来验证文件是否已正确上传。<a class="ae jd" href="https://console.cloud.google.com/storage/browse" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/storage/browser</a></p><h1 id="a884" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">高级选项</h1><p id="d180" class="pw-post-body-paragraph if ig hi ih b ii ke ik il im kf io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">创建存储桶时，您可以指定访问控制列表(ACL)、存储桶的位置以及要使用的存储类别。您还可以为整个存储桶打开对象版本控制。如果您使用bucket来服务一个静态网站(可能是用Jekyll生成的)，那么您可以在创建bucket时为站点和404页面设置索引/主页。</p><p id="cf07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，在创建文件时可以指定许多选项。可以指定缓存控制信息、内容元数据(编码、语言、处置)、自定义元数据和加密密钥。您还可以包括校验和，只有当校验和与云存储计算的值匹配时，才会创建文件。</p><p id="fa2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关云存储API的更多信息，请查看<a class="ae jd" href="http://googlecloudplatform.github.io/google-cloud-ruby/#/docs/google-cloud-storage/master/google/cloud/storage" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="0442" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">09/29/16</p></div><div class="ab cl lg lh gp li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="hb hc hd he hf"><p id="6649" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ln">原载于2016年9月30日</em><a class="ae jd" href="http://www.thagomizer.com/blog/2016/09/30/ruby-gcp-uploading-pictures-to-cloud-storage.html" rel="noopener ugc nofollow" target="_blank"><em class="ln">www.thagomizer.com</em></a><em class="ln">。</em></p></div></div>    
</body>
</html>