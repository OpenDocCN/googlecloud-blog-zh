<html>
<head>
<title>MongoDB Atlas in Google Cloud accessed by Private Service Connect</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过私有服务连接访问Google Cloud中的MongoDB Atlas</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/mongodb-atlas-in-google-cloud-accessed-by-private-service-connect-a4996bf6cfb4?source=collection_archive---------2-----------------------#2022-02-03">https://medium.com/google-cloud/mongodb-atlas-in-google-cloud-accessed-by-private-service-connect-a4996bf6cfb4?source=collection_archive---------2-----------------------#2022-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e171820d05edea9321e54170176a3d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ax5K7TMT7E6sjZbbNU5jcw.png"/></div></div></figure><h1 id="b392" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="1ecf" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">MongoDB是一个NoSQL数据库，自2009年推出以来已经聚集了大量的追随者，因为人们已经认识到需要存储所有数据，而不必理解它的每一个细微差别。community edition随处可见，由于其相对较低的管理开销和较低的设计门槛，开发人员已经将它集成到应用程序中，这通常超出了普通IT管理人员的权限。</p><p id="902b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">MongoDB在2016年推出了他们的云产品Atlas。这提供了一个带有“全局集群”的MongoDB托管服务。这使您能够使用云服务提供商(CSP)的底层基础设施，让您的数据更接近消费者，以最低的运营开销提供高可用性和灾难恢复。</p><p id="9a79" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">最初，如果您需要从Google Cloud项目外部访问数据库，MongoDB集群的IP地址是公开的，您可以将入站流量限制在特定的、允许的IP地址。然后是对网络对等的支持，这需要将您的网络对等到托管的MongoDB服务数据库所在的网络，但这意味着可能会暴露一系列IP地址。</p><p id="452d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来也是本指南的主题，是私有服务连接(PSC ),它允许您通过VPC上的RFC1918 IP地址连接到Google Cloud中的MongoDB集群。在MongoDB Atlas“producer”项目中，没有流量通过互联网传输，您也不会接触到IP地址。</p><h1 id="0c78" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">重要术语词汇表:</h1><p id="b3b5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">生产者项目—生产托管服务的项目。</p><p id="907b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">消费者项目—消费托管服务的项目。</p><p id="4b06" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">RFC1918地址—通常的私有范围(10.x.x.x，192.168.x.x，172.16.x.x)</p><p id="43b9" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">服务附件—服务生产者通过服务附件公开thor服务，该服务附件从内部负载平衡器(<a class="ae kr" href="https://cloud.google.com/vpc/docs/private-service-connect#service-attachments" rel="noopener ugc nofollow" target="_blank">链接</a>)获取流量路由</p><p id="147b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">共享VPC —在“主机项目”中创建和管理的VPC，但由不同“服务项目”中的基础架构使用。</p><h1 id="70d2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">从哪里开始？</h1><ul class=""><li id="20af" class="ks kt hi jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">我正在一台苹果电脑上工作，我将从这台电脑上访问谷歌云和Atlas网络控制台。</li><li id="740d" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">我将创建一个名为test/dev的Debian Linux实例，通过本地IP地址测试MongoDB服务的可访问性。因为我们将不得不允许从一个地址访问API，这可能比我们访问控制台的机器更短暂。由于这个原因，我将允许这个实例的外部ip地址用于API访问，因为在这个过程中我必须运行一个特权脚本。</li></ul><h2 id="78b6" class="lg ir hi bd is lh li lj iw lk ll lm ja jz ln lo je kd lp lq ji kh lr ls jm lt bi translated">在Atlas项目中配置Atlas端</h2><ul class=""><li id="be86" class="ks kt hi jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">在<a class="ae kr" href="https://cloud.mongodb.com/" rel="noopener ugc nofollow" target="_blank">https://cloud.mongodb.com/</a>的一个组织下设立一个项目。我不会对MongoDB Atlas本身做太多的描述，但我更愿意把重点放在连接上。</li><li id="0fb0" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在项目中创建一个集群——我们至少需要一个M10来支持网络对等/PSC功能(<a class="ae kr" href="https://docs.atlas.mongodb.com/cluster-tier/#free--shared--and-dedicated-cluster-comparison" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="9d72" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">现在在左边的菜单上你会发现一个“网络访问”标签。您可以在这里设置可以从哪些IP地址访问集群中的数据。我将用子网为10.0.0.0/23的谷歌云VPC对此进行测试。请注意，这是一个专用RFC1918范围，Atlas现在将向其打开防火墙。</li></ul><h2 id="10a5" class="lg ir hi bd is lh li lj iw lk ll lm ja jz ln lo je kd lp lq ji kh lr ls jm lt bi translated">在你的谷歌云项目中</h2><ul class=""><li id="defd" class="ks kt hi jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">创建一个名为atlas-test-vpc的VPC，子网为10.0.0.0/23，名为atlas-test-subnet，与MongoDB Atlas集群位于同一区域。</li><li id="bcfe" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在atlas-test-subnet上创建一个名为atlas-test-vm的测试/开发虚拟机。</li><li id="ad5f" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">允许完全访问云API</li><li id="1dde" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">给虚拟机一个网络标签dev，这样就可以通过标签将流量转发到防火墙。</li><li id="7da3" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在刚刚创建的子网上，为虚拟机分配一个临时外部ip地址和一个临时内部IP地址。</li><li id="1ef3" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在atlas-test-vpc上，添加一个防火墙规则，将所有来自您访问web接口的机器(【www.whatismyip.com】)的流量转发到标记为dev的实例(您的测试/开发实例)。</li><li id="ff92" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">您的测试/开发实例现在可以连接到。</li></ul><p id="d63f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">运行以下命令以连接到您的测试实例:</p><blockquote class="lu lv lw"><p id="f7bf" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">g cloud beta compute ssh—zone“us-central 1-a”“atlas-test-VM”—项目“medium-atlas”</p></blockquote><h2 id="cb72" class="lg ir hi bd is lh li lj iw lk ll lm ja jz ln lo je kd lp lq ji kh lr ls jm lt bi translated">在VPC上的测试/开发实例上</h2><ul class=""><li id="2d88" class="ks kt hi jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">一旦连接</li><li id="96eb" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">按照下面的步骤安装mongo CLI:<a class="ae kr" href="https://docs.mongodb.com/mongocli/stable/install/" rel="noopener ugc nofollow" target="_blank">https://docs.mongodb.com/mongocli/stable/install/</a></li><li id="cef7" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">安装Mongo Shell</li></ul><blockquote class="lu lv lw"><p id="a326" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">sudo apt-get install-y MongoDB-mongosh</p></blockquote><h2 id="e4f7" class="lg ir hi bd is lh li lj iw lk ll lm ja jz ln lo je kd lp lq ji kh lr ls jm lt bi translated">设置专用端点组</h2><ul class=""><li id="41f1" class="ks kt hi jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">在Atlas项目中，单击左侧的“网络访问”</li><li id="187d" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">“私有端点”→“添加私有端点”</li><li id="671e" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">选择您的子网所在的地区，将会创建一个服务附件。</li><li id="c3a1" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">接下来，填写您的Google Cloud项目特定信息。</li></ul><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/d39fbd15b1b124d90fde05d930996b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1-qGv8QkAaAuhxZm"/></div></div></figure><ul class=""><li id="7f4d" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">单击“下一步”，将为您生成一个脚本，其中包含您的项目规范。</li><li id="3bbc" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">将脚本复制到安装了Google Cloud SDK的测试/开发机器上名为setup_psc.sh的文件中。通过运行chmod +x setup_psc.sh使其可执行。</li><li id="aa00" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">现在运行它，它将保留必要的ip地址，即使它们不连续，并创建从您的Google Cloud VPC上的50个IP地址到Atlas producer项目中为您的端点服务保留的50个端点的转发规则。</li><li id="e758" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">运行该脚本需要几分钟时间。</li><li id="65db" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">这个脚本完全在Google Cloud上运行，因此不需要Atlas API密钥。</li></ul><p id="8eee" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在我的环境中，该脚本如下所示(atlas-test是我的自定义PSC端点前缀):</p><blockquote class="lu lv lw"><p id="8042" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#!/bin/bash</p><p id="f843" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gcloud配置集项目中等-图册</p><p id="11e4" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">对于{ 0 }中的I..49}</p><p id="6094" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">做</p><p id="c80b" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gcloud计算地址创建atlas-test-IP-$ I-region = us-central 1-subnet = atlas-test-subnet</p><p id="e111" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">完成的</p><p id="4ea9" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">对于{ 0 }中的I..49}</p><p id="9279" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">做</p><p id="4ae3" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">如果[$(g cloud compute addresses describe atlas-test-IP-$ I-region = us-central 1-format = " value(status)")！= "保留"]；然后</p><p id="1443" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">echo“atlas-test-IP-$ I不保留”；</p><p id="c977" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">出口1；</p><p id="7229" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">船方不负担装货费用</p><p id="adb1" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">完成的</p><p id="1272" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">对于{ 0 }中的I..49}</p><p id="e9be" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">做</p><p id="0664" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">g cloud compute forwarding-rules create atlas-test-$ I-region = us-central 1-network = atlas-test-VPC-address = atlas-test-IP-$ I-target-service-attachment = projects/p-fkosb 42 io 2c G3 NZ 1a 11 pzmwd/regions/us-central 1/service attachments/sa-us-central 1–61f 437 E1 b 488 FD 5 c 7d 9 b 9 EC 9-$ I</p><p id="3c3f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">完成的</p><p id="601f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">if[$(g cloud compute forwarding-rules list-regions = us-central 1-format = " CSV[no-heading](name)"-filter = " name:atlas-test " | WC-l)-gt 50]；然后</p><p id="9dae" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">echo "项目有太多与前缀atlas-test匹配的转发规则。请删除竞争资源或选择另一个终结点前缀。</p><p id="7ad6" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">出口2；</p><p id="e8bb" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">船方不负担装货费用</p><p id="e36e" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">g cloud compute forwarding-rules list—regions = us-central 1—format = " JSON(IP address，name)"—filter = " name:atlas-test " &gt; atlasEndpoints-atlas-test . JSON</p></blockquote><ul class=""><li id="564c" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">该脚本将在名为atlasEndpoints-atlas-test.json的文件中返回端点列表。</li><li id="8ae9" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">我将它上传到一个Google云存储桶，如下所示，并从那里下载到我正在逐步完成连接向导的实例，但是我将让您来决定通过web控制台上传文件的最佳方式。</li></ul><blockquote class="lu lv lw"><p id="0cc3" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated"># vim创建文件并粘贴内容</p><p id="8cc4" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">vim setup_spc.sh</p><p id="3f9f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#将脚本粘贴到文件中，并使其可执行</p><p id="2462" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">chmod +x setup_psc.sh</p><p id="d182" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#运行安装文件</p><p id="1b8f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">。/setup_psc.sh</p><p id="bf49" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#返回以下文件的ip地址到服务附件映射</p><p id="f805" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">卡特彼勒atlasEndpoints-atlas-test.json</p><p id="0104" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#为文件制作一个存储桶</p><p id="6384" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gsutil mb gs://medium-atlas</p><p id="ad0d" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#将文件复制到桶中</p><p id="a881" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gsutil CP atlas endpoints-atlas-test . JSON GS://medium-atlas</p><p id="d0cd" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#现在在您浏览Atlas控制台的计算机上</p><p id="d742" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#现在复制文件，准备上传到安装向导中</p><p id="195f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gsutil cp gs://medium-atlas/*。</p><p id="48a4" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">#现在删除桶以减少混乱</p><p id="efb6" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">gsutil rm -r gs://medium-atlas</p></blockquote><ul class=""><li id="9c5a" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">上传文件后，Atlas将遍历每个转发规则，将其映射到端点。这可能需要很长时间(30分钟创建服务附件，另外30分钟应用到集群)。</li></ul><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/fd07ce676d8d1d22e28de0299b872d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R7qvORo6EyDlhPUO"/></div></div></figure><p id="4971" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">一旦端点状态为“可用”，我们就可以开始连接了。</p><ul class=""><li id="4aca" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">在“网络服务”→“私人服务连接”下，您会发现一个转发规则列表，描述了IP地址如何被转发到生产者项目中的服务附件。</li></ul><p id="3ec8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">以下是一个示例:</p><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/1b6890596c72bdaa801a2350d0d7f93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-fedIkYcnFXcTAns"/></div></div></figure><ul class=""><li id="d85b" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">即使服务附件映射已经完成，服务器更新也需要一段时间，所以请等待顶部的蓝色横幅消失。</li></ul><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/86ecd1c2bac69320d38578f84c234aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*91SDCzr-idXJ5vli"/></div></div></figure><ul class=""><li id="5389" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">此时，您可以转到左侧的“数据库”→“连接”</li><li id="ced2" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在配置更改部署到群集中的所有服务器之前，“专用端点”将呈灰色显示。</li></ul><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/f9927d8cb5023cf1a4b3ddc9f04295d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m_-n4dBtBgWzYG2F"/></div></div></figure><ul class=""><li id="77f8" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">耐心点，很多管道工程正在为你做！</li><li id="3240" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">大约花了一个小时，我的3个服务器才可用，在我刷新页面之前，单击connect按钮并没有产生一个可点击的“私有端点”连接方法。但是在页面刷新之后:</li></ul><figure class="mc md me mf fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/af0858764500f3b718a0d7c6eb10e959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CbvhfB_1DAQPl8XD"/></div></div></figure><ul class=""><li id="ada8" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">单击“选择连接方法”</li><li id="2533" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">点击“用MongoDB Shell连接”</li><li id="4a46" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">单击“我已经安装了MongoDB Shell ”,因为我们已经在测试实例中安装了它。</li><li id="df68" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">选择您的shell版本，并复制连接字符串。</li></ul><blockquote class="lu lv lw"><p id="5345" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">mongosh " MongoDB+SRV://medium-cluster-pl-0 . oqryx . MongoDB . net/myFirstDatabase "-username { user }</p></blockquote><ul class=""><li id="7c52" class="ks kt hi jq b jr km jv kn jz mg kd mh kh mi kl kx ky kz la bi translated">将其复制到测试实例的命令行中。</li><li id="c2e1" class="ks kt hi jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在命令行中运行它，您将得到如下内容:</li></ul><blockquote class="lu lv lw"><p id="dd55" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">mongosh " MongoDB+SRV://medium-cluster-pl-0 . oqryx . MongoDB . net/myFirstDatabase "-用户名{name}</p><p id="3618" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">输入密码:*****</p><p id="d37e" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">当前Mongosh日志ID: 61f475f5ef14ae5b8d86301c</p><p id="5f4b" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">连接到:MongoDB+SRV://medium-cluster-pl-0 . oqryx . MongoDB . net/myFirstDatabase？appName=mongosh+1.1.9</p><p id="9fe4" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">使用MongoDB: 4.4.12</p><p id="994c" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">使用Mongosh: 1.1.9</p><p id="e78f" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">关于蒙哥语的信息，请看:<a class="ae kr" href="https://docs.mongodb.com/mongodb-shell/" rel="noopener ugc nofollow" target="_blank">https://docs.mongodb.com/mongodb-shell/</a></p><p id="63f4" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">为了帮助改进我们的产品，我们会定期收集匿名使用数据并发送给MongoDB(https://www . MongoDB . com/legal/privacy-policy)。</p><p id="b7d6" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">您可以通过运行disableTelemetry()命令退出。</p><p id="060e" class="jo jp lx jq b jr km jt ju jv kn jx jy ly ko kb kc lz kp kf kg ma kq kj kk kl hb bi translated">atlas atlas-2g cksc-shard-0[primary]my first database &gt;</p></blockquote><h2 id="bd28" class="lg ir hi bd is lh li lj iw lk ll lm ja jz ln lo je kd lp lq ji kh lr ls jm lt bi translated">结论:</h2><p id="6f28" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在，您已经配置了从您的Google Cloud项目和VPC到托管Atlas MongoDB服务的访问，并且它在您的VPC本地的IP地址上可用。</p><p id="3cfa" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">您可以将集群扩展到50个MongoDB节点，并且可以使用控制台中提供的一个简单的连接字符串进行连接。</p><p id="f2d3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果您将服务端点映射到的VPC是主机项目中的共享VPC，那么您将能够从任何附加的服务项目访问MongoDB。</p></div></div>    
</body>
</html>