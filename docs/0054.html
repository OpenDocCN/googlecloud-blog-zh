<html>
<head>
<title>A to Z of Google Cloud Platform a personal selection — F is for firewalls</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云平台的a到Z个人选择— F代表防火墙</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/a-to-z-of-google-cloud-platform-a-personal-selection-f-is-for-firewalls-3e45852630c9?source=collection_archive---------0-----------------------#2016-01-23">https://medium.com/google-cloud/a-to-z-of-google-cloud-platform-a-personal-selection-f-is-for-firewalls-3e45852630c9?source=collection_archive---------0-----------------------#2016-01-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我是深度防御的坚定信徒，在这篇文章中，我只想谈谈计算引擎防火墙，这是在GCP上使用计算引擎时的一个关键部分。</p><p id="efe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我假设您知道防火墙通常是如何在内部实施的，即通过实施一组规则来管理哪些流量可以在子网和互联网之间流动，哪些流量不可以在子网和互联网之间流动，这些规则根据端口、协议以及源和目标子网或IP地址来允许或禁止流量通过防火墙。</p><p id="dc18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GCP防火墙实际上在应用上非常相似，因为防火墙与网络相关联，所以GCP项目中的每个网络都有自己的防火墙来控制连接。</p><p id="7883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有GCP项目都有一个默认网络，并有一个关联的默认防火墙规则。此默认防火墙具有以下规则:</p><p id="3b89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">默认-允许-内部</em> </strong></p><p id="45f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许网络上实例之间的任何协议和端口的网络连接。</p><p id="375f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">T5】默认-允许-sshT7】</strong></p><p id="d811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许通过TCP端口22从任何源到网络上任何实例的SSH连接。</p><p id="d2f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">默认-允许-rdp </em> </strong></p><p id="6b93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许通过TCP端口3389从任何来源到网络上任何实例的RDP连接。</p><p id="a534" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">默认-允许-icmp </em> </strong></p><p id="51f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">允许ICMP流量从任何来源流向网络上的任何实例</p><p id="63b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，当您创建新网络时，没有防火墙规则允许任何类型的连接。因此，在创建一个新网络之后，您需要<a class="ae je" href="https://cloud.google.com/compute/docs/networking#addingafirewall" rel="noopener ugc nofollow" target="_blank">创建防火墙规则</a>来允许它与您的实例进行任何形式的连接。</p><p id="567b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实例必须与网络相关联，因此默认情况下，与该网络相关联的防火墙规则适用于该网络中的实例。如果您没有使用— network标志明确说明实例应该部署到的网络，实例将被部署(或关联，这取决于您希望如何学究—在讨论这个问题时，部署对我来说听起来更自然)到默认的网络和连接中，并遵守与此相关的防火墙规则。</p><p id="e647" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">注意:您可以向默认网络添加额外的防火墙规则</em></p><p id="5747" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，一个GCP项目最多有5个网络(您可以通过提出配额请求来增加)，每个网络可以有多个相关联的防火墙规则。</p><p id="1d6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GCP也有<a class="ae je" href="https://cloud.google.com/compute/docs/subnetworks#subnet_network" rel="noopener ugc nofollow" target="_blank">子网络</a>的概念。这允许您将您的网络划分为具有非重叠<a class="ae je" href="https://tools.ietf.org/html/rfc1918" rel="noopener ugc nofollow" target="_blank"> RFC1918 </a>范围的块(子网)，即您可以在单个网络中定义和管理的私有IPv4地址范围。一个项目最多可以有100个子网，这些子网可以按照您认为合适的方式进行排列，即全部在一个网络中，或者分布在多个网络中(总共最多5个网络)</p><p id="91f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我不想转移话题谈论子网(我知道得太晚了！)希望文档中的下图能让您了解如何在区域边界内和跨区域边界配置子网。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/fa05885752dafd379953c119d4a25ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-sFTy0UJod5x_FnUrUeTUA.png"/></div></div></figure><p id="8dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还建议在计划如何使用计算引擎配置任何应用程序之前，花点时间通读子网上的<a class="ae je" href="https://cloud.google.com/compute/docs/subnetworks#subnetworks" rel="noopener ugc nofollow" target="_blank">文档，以防你想利用这个特性。</a></p><p id="d5a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">子网不会改变我已经描述的防火墙规则的工作方式，但是您可能会问，如果这些规则适用于网络，您如何应用特定于子网的防火墙规则。标签就是答案！使用标记意味着您可以通过有选择地只允许某些实例进行通信，在子网之间创建额外的隔离。如果您安排子网中的所有实例共享同一个标记，您可以在防火墙规则中指定该标记，以模拟每个子网的防火墙。例如，如果您有一个名为subnet-a的子网，您可以用标记my-subnet-a标记subnet-a中的所有实例，并在防火墙规则目标标记中使用该标记或将其用作源范围。这些文档通过一个<a class="ae je" href="https://cloud.google.com/compute/docs/subnetworks#subnetworks_and_firewall_rules" rel="noopener ugc nofollow" target="_blank">很好的例子</a>展示了使用带有防火墙规则的标签和子网</p></div></div>    
</body>
</html>