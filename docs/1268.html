<html>
<head>
<title>GCP: Google Kubernetes Engine- A Starter Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP:谷歌Kubernetes引擎-入门指南</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-platform-gke-and-kubernetes-deploying-that-app-1c5494a7d711?source=collection_archive---------3-----------------------#2020-01-23">https://medium.com/google-cloud/google-cloud-platform-gke-and-kubernetes-deploying-that-app-1c5494a7d711?source=collection_archive---------3-----------------------#2020-01-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/ec8e7569f366b016b040a45bfd6596bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*l3rn3M0pcuH5DYCRUhKisg.png"/></div></figure><div class=""/><p id="0d9d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">谷歌云平台是谷歌的荣耀云服务，是为了给AWS和Azure一个机会。谷歌的角度是让我们品尝他们内部使用的堆栈。像AWS一样，它的战略似乎是用产品和服务压倒我们，现在有100多种产品，而且还在增加。这里值得一提的包括:应用引擎(PaaS)，云功能(FaaS)，谷歌Kubernetes引擎(CaaS)，谷歌计算引擎(IaaS)等等。</p><p id="85fc" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">另一方面，Kubernetes是谷歌最好的东西之一。它代表了容器领域多年的迭代，以大规模生产实际可行的东西，并提供给大众。我认为大众喜欢它。从Docker Swarm开始，它已经成为首选的容器管理工具。这很讽刺，因为几乎每个人都用它来管理Docker容器。总之，他们比Docker更好地管理Docker容器。最重要的是，Kubernetes还支持其他容器运行时——比如<a class="ae jk" href="https://containerd.io/" rel="noopener ugc nofollow" target="_blank">容器id</a>和<a class="ae jk" href="https://coreos.com/rkt/" rel="noopener ugc nofollow" target="_blank"> Rkt </a>，所有这些都使它成为一个伟大的产品。</p><p id="6aaf" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然而，尽管Kubernetes有其辉煌的一面，但操作起来却是一种危险。设计有几个移动的部分，所有这些都给管理带来了挑战。为此，谷歌推出了谷歌Kubernetes引擎(GKE)，这基本上是他们的“容器即服务”平台。这里的逻辑很简单，为什么要购买一台虚拟机，花费数不清的时间安装和设置Kubernetes，然后需要一群工程师来管理它呢？当你可以让Google管理你的Kubernetes集群，而你只需要担心你的应用程序。听起来像一个公平的前提，因为他们是这里的专家。这有很多好处。google工程师的企业级支持，跨区域的高可用性，无需购买虚拟机并跨区域分发它们，以及cos，集成到常用的Google产品套件中，我指的是用于身份管理、存储服务等的IAM。就像我说的，公平的前提。</p><p id="1d01" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以，让我们看看它是否值得大肆宣传！</p><p id="c095" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hq">你需要以下的</strong>:</p><ol class=""><li id="0fb8" class="jm jn hp io b ip iq it iu ix jo jb jp jf jq jj jr js jt ju bi translated"><a class="ae jk" href="https://cloud.google.com" rel="noopener ugc nofollow" target="_blank">谷歌云账号</a>——顺便问一下，你已经在玩积分游戏了吗？没有吗？还没有？真的吗？哦，我知道，我知道——你不喜欢免费的东西。抱歉，我问了，我道歉！(<em class="jl">谷歌提供价值300美元的365天订阅信用…..我只是说</em></li><li id="0247" class="jm jn hp io b ip jv it jw ix jx jb jy jf jz jj jr js jt ju bi translated">我假设你已经学完了这一部分，准备开始了。如果没有，在这里检查我的安装。</li><li id="88a4" class="jm jn hp io b ip jv it jw ix jx jb jy jf jz jj jr js jt ju bi translated"><code class="du ka kb kc kd b">kubectl</code> -又来了....我做了更多的假设....不然的话...你知道该怎么做(这里安装<a class="ae jk" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank"/>)</li></ol><p id="0316" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">太好了！！让我们开始…</p><p id="ee75" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先创建一个项目</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="5023" class="km kn hp kd b fi ko kp l kq kr">gcloud projects create test-gke-application</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/d39c0d7f31c76a0309b7e6e75fdec7ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*16xRRlywwCzTMqcR"/></div></div></figure><p id="7ab5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">配置您的区域。点击<a class="ae jk" href="https://cloud.google.com/compute/docs/regions-zones/" rel="noopener ugc nofollow" target="_blank">此处</a>查看适合您的区域列表。我会选择美国中央电视台。</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="2b68" class="km kn hp kd b fi ko kp l kq kr">gcloud config set compute/zone us-central1-a</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es kx"><img src="../Images/4d780fc9707e62b69da53c2d5440c783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vW_iQOzQThEZBxX7"/></div></div></figure><p id="689c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">太好了，现在让我们把这东西兜一圈！</p><p id="d1ae" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们从建立Kubernetes集群的漫长过程开始</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="99c3" class="km kn hp kd b fi ko kp l kq kr">gcloud container clusters create gke-test-app</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/a7bf5b97a95b66dd4fee9cc26bd24a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qricRog-7oIfB-uz"/></div></div></figure><p id="4fa5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">事实上，女士们先生们，就是这样！这就是打包到一行代码中的整个过程。如果你认为这是一个骗局，检查你的门户网站。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/2a9ce96a2a14a1d93196437119fdea1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fHVoTvyN7U6LtCsc"/></div></div></figure><p id="5c99" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">印象深刻吧！</p><p id="6f75" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">旁注，如果您发现自己盯着这个错误</p><blockquote class="ky"><p id="03ef" class="kz la hp bd lb lc ld le lf lg lh jj dx translated"><em class="li">错误:(g cloud . container . clusters . create)response ERROR:code = 403，message=Kubernetes引擎API没有为此项目启用。请确保在谷歌云控制台中启用，然后重试</em></p></blockquote><p id="5967" class="pw-post-body-paragraph im in hp io b ip lj ir is it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj hb bi translated">请确保您启用了GKE服务的计费功能。转到<code class="du ka kb kc kd b">Kubernetes Engine -&gt; Clusters</code>并在您的门户网站上启用计费。如果你使用的是付费层，很可能意味着你没有付费(<strong class="io hq"> <em class="jl">尴尬停顿</em> </strong>)。</p><p id="45ee" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当然，从一端到另一端需要摇摆不定，显然这种默认部署并不是万能的。</p><p id="bba3" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">因此，有一些选项可以传递给容器<code class="du ka kb kc kd b">clusters create</code>命令。当前的默认部署配备了一个<strong class="io hq"> 3节点集群，总共3个虚拟CPU，11.25GB内存和n1个标准1实例</strong>。</p><p id="63af" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">显然，所有这些都是可以改变的。我们以后再讨论！</p><p id="319a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">您可以查看集群的3个工作虚拟机。</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="deb9" class="km kn hp kd b fi ko kp l kq kr">gcloud compute instances list</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/ec47b3910d435785f152d8cf2cc5d948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*an162nPrvkF4aeqW"/></div></div></figure><p id="d5ac" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，让我们确保<code class="du ka kb kc kd b">kubectl</code>可以顺利到达您的集群。</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="a612" class="km kn hp kd b fi ko kp l kq kr">kubectl cluster-info</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/2f95cb9d1c1c4adbbd11a53e87b39abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UlSywiW1T7KcwF_J"/></div></div></figure><p id="8f23" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">所以，现在我们尝试部署一项服务。我们将尝试从google的存储库中部署一个示例应用程序。</p><p id="114a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">好了，我们开始吧！</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="6ba2" class="km kn hp kd b fi ko kp l kq kr">kubectl create deployment hello-web --image=gcr.io/google-samples/hello-app:2.0</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/e85039a4b1c2e633f33c5292e8201618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*shyawi7Kgdd5ZO15"/></div></div></figure><p id="03c1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里显示部署现在已经开始</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lo"><img src="../Images/472ed9bb7962f5a9b72b87aae55dc388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bUDUcicounT24hY9"/></div></div></figure><p id="f95c" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们将端口8080暴露给互联网流量，当然是使用负载平衡器。</p><pre class="ke kf kg kh fd ki kd kj kk aw kl bi"><span id="4438" class="km kn hp kd b fi ko kp l kq kr">kubectl expose deployment hello-web --type=LoadBalancer --port 80 --target-port 8080</span></pre><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/fdb306ddcbfb628b9e94e4c69251cdb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SW-NYh-kgGzUfGmO"/></div></div></figure><p id="93c8" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是已经运行的服务</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/0f0b8bcbc1d25aa53c2bbdd33bee4d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KmgxfVrPd4wrpICB"/></div></div></figure><p id="f09b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就这么简单。只需几个命令，你的服务就完成了。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lp"><img src="../Images/f48819336f7409cc85d872ca34a678ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FS0xSpga6ifDf4W4"/></div></div></figure><p id="bc69" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">厉害！</p><p id="0ed0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这还不是全部。你总是可以用更多的显著特征来推进信封。例如，您现在可以为此部署设置扩展策略，并在集群中拥有5个、10个、20个甚至30个副本，设置最小和最大数量。在此基础上，您还可以将CPU利用率限制在某个百分比以下，比如80%。所有这些都在一个命令中完成！</p><p id="6587" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">简单对！就这样，您的简单应用程序已经投入生产，不费吹灰之力。</p><p id="1010" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">运行GKE就是它承诺的开箱即用的简单性。可以说，这可能是目前运行Kubernetes堆栈最简单的方法！</p></div></div>    
</body>
</html>