<html>
<head>
<title>GCP – Cloud Functions – Develop it the right way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP——云功能——以正确的方式开发它</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gcp-cloud-functions-develop-it-the-right-way-82e633b07756?source=collection_archive---------1-----------------------#2022-11-06">https://medium.com/google-cloud/gcp-cloud-functions-develop-it-the-right-way-82e633b07756?source=collection_archive---------1-----------------------#2022-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="3378" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">在云上开发功能的一般趋势是反复试验并多次部署，直到部署成功，从开发人员生产力的角度来看，这不是一个好的方法。</p></blockquote><p id="9788" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">云功能</strong>是GCP的“<strong class="il hj">功能即服务</strong>”产品，允许部署事件驱动或http功能供其他服务或用户使用。</p><p id="287c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这篇博客关注开发技术，这些技术将有助于第一次就快速部署云功能<strong class="il hj">和<strong class="il hj"/>。</strong></p><p id="59d4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">下图显示了在云功能上进行<strong class="il hj">本地开发</strong>和<strong class="il hj">测试和部署的<strong class="il hj">典型失败</strong>。</strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/e74875374f723e8fd223efe95399853e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*am6PkZUEmycsT0ZwEoo5iA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">开发方法开关</figcaption></figure><p id="3ecc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">这不是正确的开发方法，因为<strong class="il hj">云功能的部署需要时间(1-2分钟),对于每个小错误，如语法、请求解析、逻辑问题等，这会产生复合效应，开发人员会花费大量时间来首次正确部署云功能。</strong></p><blockquote class="if ig ih"><p id="4da5" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我们如何简化云功能的开发方法。</p></blockquote><p id="55f1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">进入<a class="ae ka" href="https://www.youtube.com/watch?v=qQiqo1zZJmI&amp;t=49s" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj">功能框架</strong> </a>！！</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h2 id="d55d" class="ki kj hi bd kk kl km kn ko kp kq kr ks jh kt ku kv ji kw kx ky jj kz la lb lc bi translated">介绍</h2><p id="b30f" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jh lf iw ix ji lg ja jb jj lh je jf jg hb bi translated"><strong class="il hj">功能框架</strong>帮助在本地建立云功能代码测试环境。<br/> <strong class="il hj">环境</strong>意味着建立一个快速的本地web服务器，在其上部署功能，可以通过简单的curl请求或任何本地测试程序进行测试。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h2 id="28bf" class="ki kj hi bd kk kl km kn ko kp kq kr ks jh kt ku kv ji kw kx ky jj kz la lb lc bi translated">入门(HTTP功能)</h2><blockquote class="if ig ih"><p id="c182" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">出于演示的目的，我将使用python运行时，但同样的原则也适用于其他运行时</p></blockquote><p id="5bb8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">让我们从一个简单的<strong class="il hj"> HTTP函数</strong>开始</p><p id="9f85" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">下面的函数multiply接受2个数字并返回乘法结果。</p><blockquote class="if ig ih"><p id="02f7" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这是一个非常简单的演示版本，但可以正确处理响应代码和错误。</p></blockquote><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="8f42" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">但是为什么有<strong class="il hj">请求</strong>实参和<strong class="il hj"> get_json() </strong></p><p id="6a85" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">云函数期望输入对象属于<a class="ae ka" href="https://tedboy.github.io/flask/generated/generated/flask.Request.html" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj"> Flask请求对象</strong> </a>并且<strong class="il hj"> get_json </strong>是提取json数据内容的Flask请求对象函数。</p><p id="ece7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">为了测试这个函数，让我们从pypi包中安装函数框架</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="87fa" class="ki kj hi ll b fi lp lq l lr ls">pip install functions-framework</span></pre><p id="3e83" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">运行函数框架非常简单，不需要任何代码更改。</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="a0bd" class="ki kj hi ll b fi lp lq l lr ls">functions-framework --port 8080 --target multiply --signature-type http --source main.py --debug</span></pre><p id="03a1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> Port </strong>表示本地机器上web服务器监听的端口<br/> <strong class="il hj"> Target </strong>表示函数的入口点<br/> <strong class="il hj"> Signature-type </strong>可以是event，http或cloudevent <br/> <strong class="il hj"> Source </strong>表示包含函数入口点的代码文件。</p><p id="1bd4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">上面的输出如下所示</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lt"><img src="../Images/8b25a32b0b3810d98a37066e7e3180b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezYGU6Ksib8rX1ksoAY1Yw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">函数框架命令的输出</figcaption></figure><p id="1ed5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">使用curl或任何其他方法在本地服务器上运行测试。</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="f29f" class="ki kj hi ll b fi lp lq l lr ls">curl -X POST \<br/>-H "Content-type:application/json" \<br/>-d  '{"num_1":20, "num_2": 30}' \<br/>-w '\n' \<br/>http://localhost:8080</span></pre><p id="845b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">输出如下所示</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lu"><img src="../Images/ff8f427d87a1e228c4952fcc4be38ae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYy9cBQMlA_m3-ZVldBzCg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">简单的Curl请求来测试云函数</figcaption></figure><p id="3ab8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">瞧啊。！测试已经完成。现在，我们可以简单地部署到云功能，并且部署/调用没有任何语法或逻辑问题。</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="a8f9" class="ki kj hi ll b fi lp lq l lr ls">gcloud functions deploy multiply_function \<br/>--source cloud_functions/ \<br/>--entry-point multiply \<br/>--runtime python39 \<br/>--region us-central1 \<br/>--allow-unauthenticated \<br/>--trigger-http</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lv"><img src="../Images/8a1d0f6cb41009560df079e2cfbee176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*an6FbyyrnZ3SHtuYo9YNlA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">部署的云功能</figcaption></figure><p id="14e5" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">云功能一旦部署，就可以以类似的方式调用。</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="3f78" class="ki kj hi ll b fi lp lq l lr ls">curl -X POST \<br/>-H "Authentication: Bearer $(gcloud auth print-access-token)" \<br/>-H "Content-type:application/json" \<br/>-d  '{"num_1":20, "num_2": 30}' \<br/>-w '\n' \<br/>https://redacted.cloudfunctions.net/multiply_function</span></pre></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h2 id="5b4b" class="ki kj hi bd kk kl km kn ko kp kq kr ks jh kt ku kv ji kw kx ky jj kz la lb lc bi translated">事件驱动—云发布订阅</h2><p id="8dce" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jh lf iw ix ji lg ja jb jj lh je jf jg hb bi translated">对于云发布订阅，我们将使用一个发布订阅模拟器在本地运行发布订阅，并将消息发布到本地端点</p><p id="3b16" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">该设置的摘要如下所示</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lw"><img src="../Images/0049c7d3e8212a569a304a701a702007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slMKTD7Tv7g9JnOKRA02qw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">总流量</figcaption></figure><blockquote class="if ig ih"><p id="8ef9" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">为简单起见，上面用灰色显示的框可以组合成bash脚本的一部分</p></blockquote><p id="ef55" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">以下命令在本地端口8081上运行发布-订阅模拟器</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="fe20" class="ki kj hi ll b fi lp lq l lr ls">gcloud beta emulators pubsub start --project=&lt;redacted&gt; --host-<br/>port='localhost:8081'</span></pre><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lx"><img src="../Images/09d9eeed02ac53889a1e16cbf6e8572e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nR4BVcP9iWmD-EmZCVNmZA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">云发布-订阅模拟器输出</figcaption></figure><p id="7333" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">设置将消息重定向到模拟器所需的环境变量</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="9525" class="ki kj hi ll b fi lp lq l lr ls">export PUBSUB_EMULATOR_HOST=localhost:8081<br/>export PUBSUB_EMULATOR_PROJECT=&lt;redacted&gt;</span></pre><p id="62e2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">现在让我们设置一个<strong class="il hj"> pubsub模式、pubsub主题和订阅。</strong></p><p id="f8e0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">以下命令的参考是pubsub的REST API—<a class="ae ka" href="https://cloud.google.com/pubsub/docs/reference/rest" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/pubsub/docs/reference/rest</a>。<br/>下面的命令指向<strong class="il hj"> localhost:8081 </strong>模拟器运行的地方，而不是<strong class="il hj">pubsub.googleapis.com。</strong></p><blockquote class="if ig ih"><p id="5339" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">pubsub的客户端库也可以用来代替REST API</p></blockquote><p id="c044" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">模式的创建<br/> </strong>我们期望要发布的消息应该具有字符串类型的单个字段repo_name</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="2a2a" class="ki kj hi ll b fi lp lq l lr ls">curl -X POST \<br/>-H "Content-type: application/json" \<br/>-d @pubsub_schema.json \<br/>-w '\n' \<br/>http://<strong class="ll hj">localhost:8081</strong>/v1/projects/&lt;redacted&gt;/schemas?schemaId="test-json-schema"</span><span id="45ee" class="ki kj hi ll b fi ly lq l lr ls">@<strong class="ll hj">pubsub_schema.json</strong><br/>{<br/>"name": "projects/&lt;redacted&gt;/schemas/test-json-schema",<br/>"type": "AVRO",<br/>"definition":  "{\"type\": \"record\",\"name\": \"sample\",\"fields\": [{\"<strong class="ll hj">name</strong>\": \"<strong class="ll hj">repo_name</strong>\",\"<strong class="ll hj">type</strong>\": \"<strong class="ll hj">string</strong>\"}]}"<br/>}</span></pre><p id="ae09" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">创建Pubsub主题</strong></p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="7821" class="ki kj hi ll b fi lp lq l lr ls">curl -X PUT \<br/>-H "Content-type: application/json" \<br/>-d @pubsub_request.json \<br/>http://<strong class="ll hj">localhost:8081</strong>/v1/projects/&lt;redacted&gt;/topics/test-topic</span><span id="925f" class="ki kj hi ll b fi ly lq l lr ls"><strong class="ll hj">@pubsub_request.json<br/></strong>{<br/>"schemaSettings": {<br/>"schema": "projects/&lt;redacted&gt;/schemas/test-json-schema",<br/>"encoding": "JSON"<br/>}<br/>}</span></pre><p id="a892" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">创建发布订阅</strong></p><p id="2d5b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">订阅的推送端点被称为“http://localhost:8080”，其中云功能框架将运行web服务器，准备接受消息</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="e4b5" class="ki kj hi ll b fi lp lq l lr ls">curl -X PUT \<br/>-H "Content-type: application/json" \<br/>-d @pubsub_sub_request.json \<br/>http://<strong class="ll hj">localhost:8081</strong>/v1/projects/&lt;redacted/subscriptions/test-topic-sub<br/></span><span id="bc0e" class="ki kj hi ll b fi ly lq l lr ls"><strong class="ll hj">@pubsub_sub_request.json</strong><br/>{<br/>"topic": "projects/&lt;redacted&gt;/topics/test-topic",<br/>"pushConfig": {<br/>"pushEndpoint": "<strong class="ll hj">http://localhost:8080</strong>"<br/>}<br/>}</span></pre><p id="d549" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">让我们开始函数框架</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="a737" class="ki kj hi ll b fi lp lq l lr ls">functions-framework --port 8080 --target <strong class="ll hj">pubsub_event</strong> --signature-type event --source main.py --debug</span></pre><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="li lj l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">pubsub_event函数的定义</figcaption></figure><p id="a50f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">现在，让我们试着向模拟器发送消息。<br/>该消息要求采用base 64编码，如下所示</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="ed33" class="ki kj hi ll b fi lp lq l lr ls">base64.b64encode('<strong class="ll hj">{"repo_name":"repository-1"}</strong>'.encode("utf-8"))<br/>b'<strong class="ll hj">eyJyZXBvX25hbWUiOiJyZXBvc2l0b3J5LTEifQ==</strong>'</span><span id="0c77" class="ki kj hi ll b fi ly lq l lr ls">curl -X POST \<br/>-H "Content-type: application/json" \<br/>-d @<strong class="ll hj">pubsub_message.json</strong> \<br/>-w '\n' \<br/>http://<strong class="ll hj">localhost:8081</strong>/v1/projects/&lt;redacted&gt;/topics/test-topic:publish</span><span id="75f3" class="ki kj hi ll b fi ly lq l lr ls"><strong class="ll hj">@pubsub_message.json<br/></strong>{<br/>"messages":[<br/>{<br/>"data": "<strong class="ll hj">eyJyZXBvX25hbWUiOiJyZXBvc2l0b3J5LTEifQ==</strong>"<br/>}<br/>]<br/>}</span></pre><p id="0249" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">您将能够在服务器上看到如下输出</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lz"><img src="../Images/4cb9f7a03f053d689dbdb0f6b112cec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7swCTKghtNy0eqcLvdPduw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">从函数打印的事件数据和上下文。</figcaption></figure><p id="2b00" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">现在，您可以编写您的函数逻辑来处理消息并部署云函数post测试</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h2 id="70be" class="ki kj hi bd kk kl km kn ko kp kq kr ks jh kt ku kv ji kw kx ky jj kz la lb lc bi translated">事件驱动—第1代—云存储事件示例</h2><p id="6be0" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jh lf iw ix ji lg ja jb jj lh je jf jg hb bi translated">让我们举一个例子，设置一个在云存储事件时触发的云函数。</p><p id="36d7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">云函数第1代—事件触发器需要2个参数<br/> 1。<strong class="il hj">事件</strong> —事件数据的字典表示<br/> 2。<strong class="il hj">上下文</strong> — ( <code class="du ma mb mc ll b">google.cloud.functions.Context)</code>表示事件的元数据(event_id、event_type、timestamp和resource)</p><p id="c0f1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">事件字典将取决于注册云功能的事件类型。</p><p id="f33f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">云存储事件触发</strong> —参见<a class="ae ka" href="https://cloud.google.com/functions/docs/calling/storage" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/functions/docs/calling/storage</a><br/><strong class="il hj">云存储事件数据</strong>—<a class="ae ka" href="https://github.com/googleapis/google-cloudevents/blob/main/proto/google/events/cloud/storage/v1/data.proto" rel="noopener ugc nofollow" target="_blank">https://github . com/Google APIs/Google-cloud events/blob/main/proto/Google/events/cloud/storage/v1/data . proto</a></p><p id="f8de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">所有这些受支持的事件在github中都有它们的原型结构以供测试。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="b45f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">云存储事件的上述事件和上下文数据可以通过简单地部署具有事件和上下文打印的虚拟云功能来生成。</p><p id="cef8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">一旦事件数据准备就绪，就可以通过提供curl请求或通过程序以同样的方式使用云函数框架</p><pre class="jl jm jn jo fd lk ll lm ln aw lo bi"><span id="fe68" class="ki kj hi ll b fi lp lq l lr ls">curl -X POST \<br/>-H "Authentication: Bearer $(gcloud auth print-access-token)" \<br/>-H "Content-type:application/json" \<br/>-d  @request.json \<br/>-w '\n' \<br/>https://redacted.cloudfunctions.net/storage_event</span></pre></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="31d2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">希望这些内容对你有帮助。<br/>如有任何疑问，请通过我的链接句柄与我联系—<a class="ae ka" href="https://www.linkedin.com/in/murli-krishnan-a1319842/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/murli-krishnan-a1319842/</a></p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h2 id="a339" class="ki kj hi bd kk kl km kn ko kp kq kr ks jh kt ku kv ji kw kx ky jj kz la lb lc bi translated">参考</h2><p id="29e6" class="pw-post-body-paragraph ii ij hi il b im ld io ip iq le is it jh lf iw ix ji lg ja jb jj lh je jf jg hb bi translated">功能框架—<a class="ae ka" href="https://cloud.google.com/functions/docs/functions-framework" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/functions/docs/functions-framework</a><br/>功能框架Python—<a class="ae ka" href="https://github.com/GoogleCloudPlatform/functions-framework-python" rel="noopener ugc nofollow" target="_blank">https://github . com/Google cloud platform/Functions-Framework—Python</a><br/>功能框架契约—<a class="ae ka" href="https://github.com/GoogleCloudPlatform/functions-framework" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/functions-framework</a></p></div></div>    
</body>
</html>