<html>
<head>
<title>How to test Google Cloud services locally in Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Docker本地测试Google云服务</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/how-to-test-google-cloud-services-locally-in-docker-d74196147841?source=collection_archive---------0-----------------------#2017-03-20">https://medium.com/google-cloud/how-to-test-google-cloud-services-locally-in-docker-d74196147841?source=collection_archive---------0-----------------------#2017-03-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“gcloud”命令行工具令人惊叹，它超级简单，工作起来没有任何问题，您可以使用它进行身份验证，它会打开一个浏览器窗口，然后设置正确的值，这比您必须在bash配置中手动设置的access和secret令牌要容易得多。</p><p id="d3f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而随之而来的问题是，如何在本地运行的docker容器中获得授权。</p><p id="ac35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尤其是现在“gcloud auth login”说:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="238f" class="jm jn hi ji b fi jo jp l jq jr">WARNING: `gcloud auth login` no longer writes application default credentials.</span></pre><h1 id="5bb6" class="js jn hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">解决办法</h1><p id="a67e" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们需要运行这个命令，将认证信息写到一个文件中</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e446" class="jm jn hi ji b fi jo jp l jq jr">$ gcloud auth application-default login</span></pre><p id="23cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这会将它保存到以下文件中:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8487" class="jm jn hi ji b fi jo jp l jq jr">Credentials saved to file: [/Users/kevinsimper/.config/gcloud/application_default_credentials.json]</span></pre><p id="5a61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您需要将docker-compose.yml文件更改为:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="5697" class="jm jn hi ji b fi jo jp l jq jr">volumes:<br/>  - ~/.config/:/root/.config</span></pre><p id="07e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将使<code class="du ku kv kw ji b">google-cloud</code>包寻找正确的认证位置。</p><p id="7176" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">成功，可以使用docker内部的gcloud组件。</p></div></div>    
</body>
</html>