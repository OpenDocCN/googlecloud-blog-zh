<html>
<head>
<title>Deconstructing Chatbots: Understanding Entities in Dialogflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解构聊天机器人:理解对话流中的实体</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/deconstructing-chatbots-understanding-entities-in-dialogflow-a5d3d4c0fe8d?source=collection_archive---------0-----------------------#2019-05-14">https://medium.com/google-cloud/deconstructing-chatbots-understanding-entities-in-dialogflow-a5d3d4c0fe8d?source=collection_archive---------0-----------------------#2019-05-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/78f3f99e64deaa321884e1da7197b527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ScD72WY6wOs2tpyOxK8bKw.png"/></div></div></figure><div class=""/><h1 id="7f0e" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="115a" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><a class="ae km" href="https://dialogflow.com/docs/entities" rel="noopener ugc nofollow" target="_blank">实体</a>是Dialogflow的机制，用于从自然语言输入中识别和提取有用的数据。</p><p id="6999" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">虽然意图允许代理理解特定用户输入背后的动机，但实体用于挑选用户提到的特定信息——从街道地址到产品名称或带有单位的数量。您想从用户请求中获得的任何重要数据都会有相应的实体。</p><p id="c9b7" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">有三种类型的实体:</p><h1 id="a4e4" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">系统实体</h1><p id="759c" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">Dialogflow配备了众多的<a class="ae km" href="https://dialogflow.com/docs/entities/system-entities" rel="noopener ugc nofollow" target="_blank">系统实体</a>，允许代理提取关于广泛概念的信息，而无需任何额外的配置。例如，系统实体可用于从自然语言输入中提取日期、时间和位置。</p><h1 id="537b" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">开发商实体</h1><p id="ece3" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如果您需要提取Dialogflow系统实体之外的概念信息，您可以定义自己的<a class="ae km" href="https://dialogflow.com/docs/entities/developer-entities" rel="noopener ugc nofollow" target="_blank">开发者实体类型</a>。例如，一个品牌可能会创建一个实体类型来识别其唯一的产品名称集。</p><h1 id="3fc0" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">会话实体</h1><p id="82cf" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">还可以定义仅适用于特定对话的实体类型。例如，您可以创建一个实体类型来表示特定用户在预订时可用的时间敏感选项。这些被称为<a class="ae km" href="https://dialogflow.com/docs/entities/session-entities" rel="noopener ugc nofollow" target="_blank">会话实体类型</a>。</p><h1 id="9f48" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">你会学到什么</h1><ul class=""><li id="a4ab" class="ks kt ht jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">如何在Dialogflow中创建和使用系统实体</li><li id="7eb6" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">如何在Dialogflow中创建和使用开发人员实体</li><li id="3ad4" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">如何测试代理</li></ul><h1 id="2111" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><p id="ca53" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">对话流的基本概念和结构。关于介绍基本对话设计的Dialogflow教程视频，请查看<a class="ae km" href="https://www.youtube.com/watch?v=O00K10xP5MU&amp;list=PLIivdWyY5sqK5SM34zbkitWLOV-b3V40B&amp;index=1" rel="noopener ugc nofollow" target="_blank">解构聊天机器人系列</a>。</p><p id="9023" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated">我们将使用在本文中构建的同一个约会调度聊天机器人，并在此基础上理解实体。</p><h1 id="1f8f" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">如何在Dialogflow中启用和使用系统实体</h1><ul class=""><li id="c85b" class="ks kt ht jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">导航至<a class="ae km" href="https://console.dialogflow.com/api-client/" rel="noopener ugc nofollow" target="_blank">对话流程控制台</a>。</li><li id="798b" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">选择我们在前面的codelab中创建的AppointmentScheduler代理。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es lg"><img src="../Images/fcaf918ea9b0c095a34a44418dcb1f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/0*Zuq_QWHFmTUP9uR3"/></div></figure><ul class=""><li id="3dfa" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">点击“意图”</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es lo"><img src="../Images/944b2d3ee3609f5864089862a9469e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/0*JzDAoskcgcT1VawS"/></div></figure><ul class=""><li id="2281" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">点击“预约”打开意向设置</li><li id="d996" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">您会注意到，在当前的意图设置中，有类似“为明天下午4点设置一个约会”的训练短语，其中<strong class="jq hu">日期</strong>和<strong class="jq hu">时间</strong>被自动提取为系统实体日期和时间。随意添加更多的训练短语，看看Dialogflow是如何自动提取系统实体的。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lp"><img src="../Images/6657f9bebe147435d3607047d238043c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*b5NscKylNEy4jyvj"/></div></div></figure><ul class=""><li id="23fe" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">如您所见，系统实体允许代理提取关于广泛概念的信息，而无需任何额外的配置。地址、电子邮件、货币、电话号码等数据是系统实体的一些常见示例。点击了解更多<a class="ae km" href="https://dialogflow.com/docs/reference/system-entities" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><h1 id="379a" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">如何在Dialoglfow中启用和使用开发人员实体</h1><h1 id="dc4e" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">创建开发人员实体</h1><ul class=""><li id="efd3" class="ks kt ht jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">到目前为止，我们一直以一种通用的方式处理我们的预约调度程序。假设我们的调度程序是为一个州的机动车管理局(DMV)服务的。</li><li id="178b" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">驾照和注册是DMV提供的两个主要服务，所以让我们创建这些实体。</li><li id="cf53" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">点击实体</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es lq"><img src="../Images/9cb747ad590f6a41c65f4c31f26968f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/0*6Bqkck2Z1I-0W1bb"/></div></figure><ul class=""><li id="2d74" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">点击“创建实体”按钮</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lr"><img src="../Images/30a01e766399a431981e841b3e0e5fed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LcGCOi9F8YFXRFy6"/></div></div></figure><ul class=""><li id="a8bb" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">添加实体名称“AppointmentType ”,添加“车辆登记”和“驾驶执照”作为两个具有几个同义词的实体条目，点击<strong class="jq hu">保存</strong>。输入示例见截图。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ls"><img src="../Images/75636f2179d053f969faa278b86ec1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TVzpu5qOFS0_FQsg"/></div></div></figure><ul class=""><li id="ea8a" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">您可以添加更多包含更多服务的行作为实体类型。</li><li id="6b86" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">您可以勾选<strong class="jq hu">“允许自动扩展</strong>”框来自动添加更多实体。开发者实体的自动扩展允许代理识别实体中没有明确列出的值。如果用户的请求包含实体中未列出的项目，自动扩展会将未定义的项目识别为实体中的参数。代理看到用户的请求与提供的示例相似，因此它可以导出请求中的项目。</li><li id="0556" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">[供您参考]批量上传或下载实体:</li><li id="8189" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">点击“创建实体”按钮附近的三个点。</li><li id="394e" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">您将看到“上传实体”按钮</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lt"><img src="../Images/6fc231805e88197f5d2834d0ee0f7e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dYmI7fwCNl7Dbn1P"/></div></div></figure><ul class=""><li id="1546" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">然后就可以上传CSV或者JSON格式的文件了。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lu"><img src="../Images/f03fdf371363ebe3ef9cbccd4c7f1039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BeIZgGujKh6kefDg"/></div></div></figure><ul class=""><li id="4cf5" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">应该通过说“点击保存”来结束</li></ul><h1 id="bb3c" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">编辑意图以适应新创建的开发人员实体</h1><ul class=""><li id="64e1" class="ks kt ht jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">单击左侧窗格中的“Intent”</li><li id="c268" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">将培训短语添加到“预约”意图中。</li><li id="d1c2" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">“明天下午3点预约领驾照”。您将看到Drivers license被标识为我们在上一节中设置的开发人员实体“AppointmentType”。系统实体时间和日期也会被自动识别。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es lv"><img src="../Images/9cfa3c265084fb88cce121b0bac768c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/0*qdiQHeV0Vo4O5YPu"/></div></figure><ul class=""><li id="a87d" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">再加几个类似这样的训练短语。</li><li id="b33e" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">周一的许可证更新预约</li><li id="5c50" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">在周一下午2点预约领证</li><li id="0096" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">周一的车辆登记预约</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/ed274da0169741eb1610e31a7614b98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t_WPRyhdJ6bm_6p4"/></div></div></figure><ul class=""><li id="fc6e" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">还记得第一个Codelab的槽填充吗？在此回顾槽填充<a class="ae km" href="https://dialogflow.com/docs/concepts/slot-filling" rel="noopener ugc nofollow" target="_blank">。简而言之，要预约一个准确的约会，我们需要全部三条信息:约会类型、日期和时间。如果用户只提供了一个或两个片段，那么Dialogflow将在对响应进行操作之前询问剩余的信息。</a></li><li id="9f20" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">我们需要使“约会类型”像时间和日期一样成为必填字段。为此，请单击AppointmentType旁边的复选框。</li></ul><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/6af7a77a00a15a6764cff824260a0c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H2Okkiw_KwPS3iM9"/></div></div></figure><ul class=""><li id="a121" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">然后添加一个提示，如果用户没有提供预约类型，将使用这个提示。示例提示:“您希望获得什么服务？车管所提供驾照和车辆登记服务。”</li><li id="49b9" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">完成后，<strong class="jq hu">保存</strong>所做的修改。</li></ul><h1 id="f17a" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">测试你的聊天机器人！</h1><p id="b5a1" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们来测试我们的聊天机器人，你可以在模拟器中测试它，或者使用我们在以前的代码实验室中学到的web或google home集成。</p><p id="85d3" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hu">测试用例1: </strong>在这种情况下，用户仅要求设置约会，而没有这三条信息。因此，Dialogflow的时间段填充使用我们在意向的“动作和参数”部分设置的时间段填充提示来询问日期、时间和约会类型。</p><ul class=""><li id="8f2b" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">用户:“设置约会”</li><li id="9871" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人回应:“什么日期？”</li><li id="3d2a" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">用户:“5月23日”</li><li id="a393" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人回应:“你想什么时候进来？”</li><li id="5fb6" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">用户:“上午10点”</li><li id="3eac" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人回应:“你希望得到什么服务？车管所提供驾照和车辆登记服务。”</li><li id="07d1" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">用户:“许可证”</li><li id="c66b" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人:“您已经为2019年5月23日10:00:00的车辆登记预约做好了准备。到时候见！”</li></ul><p id="6511" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hu">测试用例2: </strong>在这种情况下，用户要求用部分信息来设置约会。因此，Dialogflow的时间段填充使用我们在意向的“动作和参数”部分设置的时间段填充提示来询问日期、时间和约会类型。</p><ul class=""><li id="8aa3" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">用户:“需要预约明天下午4点”</li><li id="772c" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人回应:“你希望得到什么服务？车管所提供驾照和车辆登记服务。”</li><li id="1b4d" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">用户:“许可证”</li><li id="2bb6" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人:“你已经为2019年4月24日16:00:00的驾照预约做好了准备。到时候见！”</li></ul><p id="80e5" class="pw-post-body-paragraph jo jp ht jq b jr kn jt ju jv ko jx jy jz kp kb kc kd kq kf kg kh kr kj kk kl hb bi translated"><strong class="jq hu">测试用例3: </strong>在这种情况下，用户一次性提供所有信息。Dialogflow处理信息并提供带有预约确认的响应。</p><ul class=""><li id="fbf9" class="ks kt ht jq b jr kn jv ko jz ll kd lm kh ln kl kx ky kz la bi translated">用户:“明天下午2点预约车辆登记”</li><li id="2db0" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">聊天机器人回应:“您已经为2019年4月24日14:00:00的车辆登记预约做好了准备。到时候见！”</li></ul><h1 id="8924" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">恭喜你！</h1><p id="f607" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">你创建了一个带有自定义实体的聊天机器人。</p><h1 id="680b" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">后续步骤</h1><ul class=""><li id="62a8" class="ks kt ht jq b jr js jv jw jz ku kd kv kh kw kl kx ky kz la bi translated">点击查看Dialogflow网站<a class="ae km" href="https://cloud.google.com/dialogflow-enterprise/" rel="noopener ugc nofollow" target="_blank">获取文档、API和更多内容。</a></li><li id="5030" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">关注<a class="ae km" href="https://www.youtube.com/watch?v=O00K10xP5MU&amp;list=PLIivdWyY5sqK5SM34zbkitWLOV-b3V40B&amp;index=1" rel="noopener ugc nofollow" target="_blank">解构聊天机器人</a>视频系列，订阅谷歌云平台youtube频道</li><li id="ad01" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">想要更多的故事？查看我的<a class="ae km" rel="noopener" href="/@pvergadia/">媒体</a>，<a class="ae km" href="https://twitter.com/pvergadia" rel="noopener ugc nofollow" target="_blank">在twitter上关注我</a>。</li><li id="aea7" class="ks kt ht jq b jr lb jv lc jz ld kd le kh lf kl kx ky kz la bi translated">试试<a class="ae km" href="https://dialogflow.com/" rel="noopener ugc nofollow" target="_blank"> Dialogflow </a>，是<strong class="jq hu">免费</strong>打造一个bot！看看这个。</li></ul></div></div>    
</body>
</html>