<html>
<head>
<title>Install-free .NET w/ Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">免费安装。使用谷歌云的网络</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/install-free-net-w-google-cloud-74aacba8bcd0?source=collection_archive---------3-----------------------#2019-02-20">https://medium.com/google-cloud/install-free-net-w-google-cloud-74aacba8bcd0?source=collection_archive---------3-----------------------#2019-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c480" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">爱上容器</strong></p><p id="e237" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有些语言，你可以开始写代码，构建|运行代码，然后你马上就可以开始比赛了，比如Golang，Python，JavaScript。</p><p id="aa83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一些语言，你需要花很多时间记住所有需要的基础设施，然后才能开始构建|运行代码，例如Java和. NET。</p><p id="2b6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想用Google API客户端库来帮助一个被一些C#代码难住的开发者。我不愿意尝试重新提出这个问题，因为获得. NET运行时的感觉(比实际情况更糟)。</p><p id="84e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">拯救集装箱:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="232f" class="jm jn hi ji b fi jo jp l jq jr">docker run \<br/>--rm \<br/>--interactive \<br/>--tty \<br/>--volume=$PWD/dotnet:/dotnet \<br/>--volume=$PWD/images:/images \<br/>--volume=$PWD/secret:/secret \<br/>--workdir=/dotnet \<br/>microsoft/dotnet:2.2-sdk \<br/>dotnet watch run</span></pre><p id="934f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个超级有用！我能够非常快速地重建一个. NET项目(我认为可能有一种更简单的方法来完成这个项目)，然后敲入<code class="du js jt ju ji b">Program.cs</code>并开始运行。</p><h2 id="d324" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">设置</h2><p id="0a4e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">让我们可爱一点，用F#写“你好弗雷迪”(。NET==。网)。创建一个名为<code class="du js jt ju ji b">fsharp</code>的目录，并在其中创建<code class="du js jt ju ji b">Program.fs</code>:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7153" class="jm jn hi ji b fi jo jp l jq jr">open System</span><span id="ade3" class="jm jn hi ji b fi kt jp l jq jr">[&lt;EntryPoint&gt;]<br/>let main argv =<br/>    printfn "Hello Freddie!"<br/>    0 // return an integer exit code</span></pre><p id="8c11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在同一个目录中，创建一个名为<code class="du js jt ju ji b">fsharp.fsproj</code>的解决方案:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="938f" class="jm jn hi ji b fi jo jp l jq jr">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;</span><span id="320b" class="jm jn hi ji b fi kt jp l jq jr">&lt;PropertyGroup&gt;<br/>    &lt;OutputType&gt;Exe&lt;/OutputType&gt;<br/>    &lt;TargetFramework&gt;netcoreapp2.2&lt;/TargetFramework&gt;<br/>  &lt;/PropertyGroup&gt;</span><span id="14ab" class="jm jn hi ji b fi kt jp l jq jr">&lt;ItemGroup&gt;<br/>    &lt;Compile Include="Program.fs" /&gt;<br/>  &lt;/ItemGroup&gt;</span><span id="f4e9" class="jm jn hi ji b fi kt jp l jq jr">&lt;/Project&gt;</span></pre><blockquote class="ku kv kw"><p id="b7e8" class="if ig kx ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>太聪明了…对于F#你将需要<code class="du js jt ju ji b">&lt;ItemGroup&gt;</code>和<code class="du js jt ju ji b">&lt;Compile Include...&gt;</code>的值。这些对于C#来说都不是必须的。</p></blockquote><h2 id="c3f5" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">观察-运行它</h2><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="4eeb" class="jm jn hi ji b fi jo jp l jq jr">docker run \<br/>--rm --interactive \<br/>--tty \<br/>--volume=<strong class="ji hj">$PWD/fsharp</strong>:/dotnet \<br/>--workdir=/dotnet \<br/>microsoft/dotnet:2.2-sdk \<br/>dotnet watch run</span><span id="fa2d" class="jm jn hi ji b fi kt jp l jq jr">watch : Polling file watcher is enabled<br/>watch : Started<br/><strong class="ji hj">Hello Freddie!</strong><br/>watch : Exited<br/>watch : Waiting for a file to change before restarting dotnet...</span></pre><p id="e415" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du js jt ju ji b">watch</code>允许您更改<code class="du js jt ju ji b">Program.cs</code>，保存它，并动态地重新构建和运行项目。不错！</p><h2 id="79e1" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">退后一步</h2><p id="579b" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我随后意识到<code class="du js jt ju ji b">dotnet</code>图像也将为我们创建项目结构。对于我们的根目录:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0fc8" class="jm jn hi ji b fi jo jp l jq jr">docker run \<br/>--rm \<br/>--interactive \<br/>--tty \<br/>--volume=<strong class="ji hj">$PWD</strong>:/dotnet \<br/>--workdir=/dotnet \<br/>microsoft/dotnet:2.2-sdk \<br/>dotnet new console -lang <strong class="ji hj">F#</strong> -o fsharp</span></pre><p id="9592" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f9dc" class="jm jn hi ji b fi jo jp l jq jr">docker run \<br/>--rm \<br/>--interactive \<br/>--tty \<br/>--volume=<strong class="ji hj">$PWD</strong>:/dotnet \<br/>--workdir=/dotnet \<br/>microsoft/dotnet:2.2-sdk \<br/>dotnet new console -lang <strong class="ji hj">C#</strong> -o csharp</span></pre><h2 id="7237" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">Google API客户端库</h2><p id="215e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">要编写利用Google API客户端库(和任何其他Nuget包)的代码，我们需要将相关的包添加到我们的项目中。<code class="du js jt ju ji b">dotnet</code>图像也支持这一点:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="3dfc" class="jm jn hi ji b fi jo jp l jq jr">... dotnet add package Google.Apis.Auth --version 1.38.0<br/>... dotnet add package Google.Apis.Drive.v3 --version 1.38.0.1491</span></pre><blockquote class="ku kv kw"><p id="60a2" class="if ig kx ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>为了简洁，我省略了这些命令的<code class="du js jt ju ji b">docker run ...</code>前导。您只需要确保指定了正确的卷映射；对于您希望添加库的项目。</p></blockquote><p id="179c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者，您可以手动引用项目文件中的库。例如，要将Google的Auth API添加到F#项目中:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2fb1" class="jm jn hi ji b fi jo jp l jq jr">&lt;Project Sdk="Microsoft.NET.Sdk"&gt;</span><span id="803c" class="jm jn hi ji b fi kt jp l jq jr">&lt;PropertyGroup&gt;<br/>    &lt;OutputType&gt;Exe&lt;/OutputType&gt;<br/>    &lt;TargetFramework&gt;netcoreapp2.2&lt;/TargetFramework&gt;<br/>  &lt;/PropertyGroup&gt;</span><span id="8338" class="jm jn hi ji b fi kt jp l jq jr">&lt;ItemGroup&gt;<br/>    &lt;Compile Include="Program.fs" /&gt;<br/>  &lt;/ItemGroup&gt;</span><span id="2a22" class="jm jn hi ji b fi kt jp l jq jr"><strong class="ji hj">&lt;ItemGroup&gt;<br/>    &lt;PackageReference Include="Google.Apis.Auth" Version="1.38.0" /&gt;<br/>&lt;/ItemGroup&gt;</strong></span><span id="cd5e" class="jm jn hi ji b fi kt jp l jq jr">&lt;/Project&gt;</span></pre><p id="899e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你看了我以前的帖子"<a class="ae lb" rel="noopener" href="/@DazWilkin/getting-started-w-net-on-gcp-b56c4e00fa69">入门。NET上的GCP库</a>，您会记得我们可以在Nuget repo中搜索所有这些库，包括<code class="du js jt ju ji b"><a class="ae lb" href="https://www.nuget.org/packages/Google.Apis.Auth/" rel="noopener ugc nofollow" target="_blank">Google.Apis.Auth</a></code>:</p><figure class="jd je jf jg fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/141243943c153929ec0a7f653128ce7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bFh3Llm8_qNP7mjWcJPlSA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">Nuget:谷歌。Apis . Auth</figcaption></figure><p id="8fe1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图像支持<code class="du js jt ju ji b">restore</code>、<code class="du js jt ju ji b">build</code>、<code class="du js jt ju ji b">run</code>和我在上面一直使用的<code class="du js jt ju ji b">watch run</code>命令。</p><h2 id="5bc9" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">OAuth</h2><p id="416e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">一个小小的，默默无闻的(！？)所记录的技巧是，默认的OAuth流启动浏览器，以便捕获认证码。跑步的时候。净在一个容器中，这种流动可能会中断。</p><p id="c130" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个流程是提示用户访问一个URL，将代码复制并粘贴回代码中。这是可行的，我推荐这种方法。</p><p id="cf85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">常见的流程是:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2b88" class="jm jn hi ji b fi jo jp l jq jr">credential = await GoogleWebAuthorizationBroker.AuthorizeAsync(<br/>    GoogleClientSecrets.Load(stream).Secrets,<br/>    Scopes,<br/>    "user",<br/>    CancellationToken.None,<br/>    new FileDataStore("DriveUploader.ListMyLibrary")<br/>);</span></pre><p id="2c4d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提示用户访问URL并复制代码的流程是一个非常小的变化:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2d4b" class="jm jn hi ji b fi jo jp l jq jr">credential = await GoogleWebAuthorizationBroker.AuthorizeAsync(<br/>    GoogleClientSecrets.Load(stream).Secrets,<br/>    Scopes,<br/>    "user",<br/>    CancellationToken.None,<br/>    new FileDataStore("DriveUploader.ListMyLibrary"),<br/>    <strong class="ji hj">new PromptCodeReceiver()</strong><br/>);</span></pre><p id="edfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="b2a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你像我一样懒，并在安装的前景呻吟。NET开发代码，别担心！容器有助于软件安装，微软在这方面做得很好，提供了一个映像，节省了大量工作。</p><h2 id="f4aa" class="jm jn hi bd jv jw jx jy jz ka kb kc kd iq ke kf kg iu kh ki kj iy kk kl km kn bi translated">整理</h2><p id="0b3c" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">当你完成了。NET运行时:</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="5eaa" class="jm jn hi ji b fi jo jp l jq jr">docker image rm microsoft/dotnet:<strong class="ji hj">2.2-sdk</strong></span></pre><blockquote class="ku kv kw"><p id="64e6" class="if ig kx ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><strong class="ih hj"> NB </strong>标签会随着SDK版本变化。</p></blockquote></div></div>    
</body>
</html>