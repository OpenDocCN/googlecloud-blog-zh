<html>
<head>
<title>Stop Toxic Messages in Real Time with an AI-Powered Moderation Bot for Discord</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用人工智能的调节机器人实时阻止有害信息</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/stop-toxic-messages-in-real-time-with-an-ai-powered-moderation-bot-for-discord-ea5c17d669c0?source=collection_archive---------0-----------------------#2020-06-30">https://medium.com/google-cloud/stop-toxic-messages-in-real-time-with-an-ai-powered-moderation-bot-for-discord-ea5c17d669c0?source=collection_archive---------0-----------------------#2020-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/69c190a6b3bd9924fcdcff919d4d4707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_3AJUX05hg3AgnnAWY-BA.png"/></div></div></figure><div class=""/><p id="e2af" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将向你展示如何使用Perspective API为Discord聊天平台构建一个人工智能主持人机器人。</p><p id="4d90" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自从五年前我开始在在线约会网站OkCupid工作以来，我就一直对适度这个话题着迷，即决定谁可以在网上发布什么。那里的审核团队负责完成<a class="ae jp" href="https://www.thecut.com/2017/02/banned-from-okcupid-sexting-moderation.html" rel="noopener ugc nofollow" target="_blank">几乎不可能完成的任务</a>，在被认为有风险的调情(通常没问题)、非法挑逗(可能没问题)和性骚扰(这会让你被封禁)之间划一条线。正如RadioLab在他们关于这个话题的<a class="ae jp" href="https://www.wnycstudios.org/podcasts/radiolab/articles/post-no-evil" rel="noopener ugc nofollow" target="_blank">精彩播客</a>中所说，“多少屁股才算太多屁股？”诸如此类的问题已经够棘手了，如果你是Twitter用户，你必须决定当总统的推文违反你的服务条款时该怎么做。</p><p id="bee2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是个脏活，但总得有人去做。或者他们有吗？人工智能可以处理适度吗？</p><p id="1a71" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">想看这个帖子的视频版？点击这里查看:</em></p><figure class="jq jr js jt fd hk"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="c6ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一些政策问题，如如何处理总统的推文或如何定义仇恨言论，没有正确的答案。但是在更多的情况下，对于更多的平台，不良内容很容易被发现。你可能无法在专业网络应用或儿童教育网站上分享任何形式的裸体、血腥或仇恨言论。此外，由于大多数应用不是像脸书或推特(我们对言论自由有强烈期望)这样的公共论坛，在过滤风险内容时过于苛刻或保守的后果会更低。对于这些应用，机器学习真的可以有所帮助。</p><p id="9dbc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将向你展示如何为聊天平台Discord构建你自己的人工智能调节机器人。如果你以前从未做过任何机器学习，也不用担心——我们将使用谷歌的一个完全免费的工具<a class="ae jp" href="https://www.perspectiveapi.com/" rel="noopener ugc nofollow" target="_blank">透视图API </a>来处理复杂的部分。</p><p id="3583" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，在我们进入技术细节之前，让我们谈谈一些高层次的节制策略。大多数公司使用三种方法中的一种:</p><ol class=""><li id="a229" class="jw jx ht is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated"><strong class="is hu">预审核</strong>是指一组人工审核人员在每一条内容发布之前对其进行审核。当<em class="jo">非常非常</em>重要的是没有“坏”内容从缝隙中溜走时，这是一个好方法。例如，苹果要求每一个提交到应用商店的应用在发布前都要经过员工的<a class="ae jp" href="https://www.cnbc.com/2019/06/21/how-apples-app-review-process-for-the-app-store-works.html" rel="noopener ugc nofollow" target="_blank">审查。</a></li><li id="506a" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn kb kc kd ke bi translated"><strong class="is hu">后审核</strong>则相反——内容被允许在被审核之前<em class="jo">发布。相反，标记帖子的工作通常被众包给用户，用户可以“标记”或“报告”他们认为违反网站服务条款的内容。你几乎在任何地方都能看到这种情况(YouTube、脸书、Instagram等等)。</em></li></ol><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kk"><img src="../Images/acb0619390661f7e8e79503aee5abd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iZKUrrdTGKQ3bfFJ.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">通过后期审核，用户可以标记不合适的内容。</figcaption></figure><p id="427b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这两种方法显然都有缺点——预审核需要一个庞大的人工审核团队，并且不适用于实时应用程序(聊天或任何类型的流)。后调节的伸缩性更好，但是会迫使你的用户使用潜在的攻击性或干扰性的媒体。这让我们想到:</p><p id="c82d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">人工智能主持人夜以继日地工作，几乎即时做出反应，因此他们可以在一个血腥视频开始后几秒钟内发现它。通常，人工智能不会取代人工审核团队，而是与人工审核团队合作，帮助自动确定需要检查的内容的优先级。</p><p id="3bd1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，事不宜迟，让我们为聊天平台Discord构建一个人工智能主持人机器人。</p><h1 id="195d" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">为不和谐建造一个人工智能驱动的调节机器人</h1><p id="a055" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated"><em class="jo">想直接跳到代码？在这里 <em class="jo">查看</em> <a class="ae jp" href="https://github.com/google/making_with_ml/tree/master/discord_moderator" rel="noopener ugc nofollow" target="_blank">。</a></em></p><p id="8160" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天我将向你展示如何为不和谐建造一个人工智能驱动的调节机器人。</p><p id="de18" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该机器人位于一个不和谐的频道中，分析所有用户的消息，看它们是否有毒、无意义、轻浮、侮辱性或垃圾邮件。当它检测到一条消息确实符合其中一个类别(即有毒)时，它会用表情符号(🧨).)对该消息做出“反应”稍后，您可以使用“！因果报应”热词。如果用户发送了太多有害信息，他们就会被踢出频道。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es ls"><img src="../Images/23be4f56c75df2bcd304113b60e76f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*koLqnOi6rH6VW3ZC.gif"/></div></figure><p id="f6b6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看如何建立它。</p><h1 id="2c19" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">设置</h1><p id="ee0c" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">首先让我们为我们的主持人机器人抓取代码。克隆“making _ with _ ml”<a class="ae jp" href="https://github.com/google/making_with_ml" rel="noopener ugc nofollow" target="_blank">Github repo</a>并导航到“discord_moderator”文件夹:</p><p id="582c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里是运行ML版主机器人所需的所有代码。在我们运行这个机器人之前，我们需要设置一些(完全免费的)服务。首先，复制文件<code class="du lt lu lv lw b">.env_template</code>，并将其命名为<code class="du lt lu lv lw b">.env</code>。</p><p id="893b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在您最喜欢文本编辑器中打开该文件:</p><p id="86f2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所见，我们需要几个不同的API和开发人员令牌来开始，一个用于透视图API，我们将使用它来分析消息，另一个用于Discord(稍后将详细介绍)。</p><p id="530e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">什么是透视API？Perspective API是由Jigsaw开发的免费工具，Jigsaw是谷歌的一个部门，用他们自己的话说，“预测和应对新出现的威胁，创造定义未来的研究和技术，以使我们的世界更加安全。”Perspective API就是一个这样的工具，它可以让(数字)世界更加安全。它将文本作为输入(“你像烟头一样臭”)，并分析它的属性，如毒性、侮辱、亵渎、身份攻击、性暴露、调情、威胁等。您可以在他们的交互式网络演示中快速体验一下:</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/ae1a2aa1f21ca07583996647db58a11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EwsHxtGtO7TK3rlS.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">你可以在perspectiveapi.com上测试透视API</figcaption></figure><p id="be7b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天,《纽约时报》使用透视来帮助自动调节他们的评论部分。</p><p id="a97c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不幸的是，在Javascript中实际使用透视图API的文档有点少，所以我将在这里补充一些细节。</p><h1 id="163f" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">有利视角</h1><p id="6729" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">首先，登录你的Google Cloud账户(免费使用<a class="ae jp" href="https://console.cloud.google.com" rel="noopener ugc nofollow" target="_blank"/>)，创建一个新项目或者选择一个现有的项目。在您的项目中，启用<a class="ae jp" href="https://console.cloud.google.com/apis/api/commentanalyzer.googleapis.com/overview" rel="noopener ugc nofollow" target="_blank">透视图注释分析器API </a>。您必须填写一份简短的调查才能获得访问权限(几个小时后您会收到一封电子邮件)。</p><p id="6948" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您需要生成一个API密钥来访问代码中的API。在Google Cloud控制台左侧菜单中，单击API &amp; Services -&gt; Credentials。在该屏幕上，单击“+创建凭证”-&gt;“API密钥”。复制API密钥。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ly"><img src="../Images/d3edf5d8dd8c7f73fc104484b40be0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a6sFk7orbwpbPTxs.png"/></div></div></figure><p id="66d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在回到您之前创建的文件——<code class="du lt lu lv lw b">.env</code>——并将密钥放入<code class="du lt lu lv lw b">PERSPECTIVE_API_KEY</code>字段:</p><h2 id="8a08" class="lz kq ht bd kr ma mb mc kv md me mf kz jb mg mh ld jf mi mj lh jj mk ml ll mm bi translated">分析邮件</h2><p id="9cd0" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">现在，您应该能够使用透视图API来分析代码中的文本。要查看示例，请查看文件<code class="du lt lu lv lw b">perspective.js</code>。在文件的顶部，您将看到API可以识别的所有可能的属性:</p><p id="c3c5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一行，您将看到我们将在bot中实际使用的属性:</p><p id="a955" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看到每个属性旁边的数字了吗？当您让Perspective API分析一条评论(“你太性感了”)时，它会为每个属性返回一个“summaryScore”:</p><p id="a429" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分数大致代表了机器学习模型对评论是否真的是调情或有毒或威胁等的信心。接下来的工作就是你，开发人员，选择一个“截止时间”来决定一个评论什么时候应该真正得到一个标签。这就是我在上面发布的<code class="du lt lu lv lw b">attributeThreshold</code>对象中所有那些数字的含义。如果summaryScore高于0.75，我只会认为一个评论是侮辱性的、有毒的或威胁性的。</p><p id="9f7b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">专业提示:在您自己的应用程序中，您会希望选择一个与您的人工审核团队(如果您有)已经在审核内容的方式一致的截止值。例如，在Tinder上，发送调情信息是完全可以的，我们可能比LinkedIn这样的网站有更高的过滤色情信息的门槛。</p><p id="dfdb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同时，看一下函数<code class="du lt lu lv lw b">analyzeText</code>，看看我们实际上是如何调用透视图API的:</p><p id="d481" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了实际连接API，我们调用<code class="du lt lu lv lw b">const analyzer = new googleapis.commentanalyzer_v1alpha1.Commentanalyzer();</code>。然后，我们在第21行打包一个请求，指定我们的语言和我们想要分析的属性，并将其发送给API。就是这样！在第30行，我们检查从透视图API返回的分数是否高于我们的阈值(0.75)。</p><p id="4770" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">恭喜你，你现在可以使用机器学习来分析文本了！现在让我们把这个有用的功能扔进一个不和谐机器人。</p><h1 id="1603" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">设置一个不和谐机器人</h1><p id="4d6b" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">如果你从未用过<a class="ae jp" href="https://discord.com/" rel="noopener ugc nofollow" target="_blank"> Discord </a>，这是一个深受游戏玩家欢迎的语音、视频和文本聊天平台。你可以使用这篇文章中的方法为其他消息平台构建一个机器人，比如<a class="ae jp" href="https://discord.com/" rel="noopener ugc nofollow" target="_blank"> Hangouts </a>或<a class="ae jp" href="https://slack.com/" rel="noopener ugc nofollow" target="_blank"> Slack </a>，但我选择了Discord，因为它有如此令人愉快的开发者体验。</p><p id="0c50" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，下载Discord(或者使用网页版)，然后<a class="ae jp" href="https://discord.com/developers" rel="noopener ugc nofollow" target="_blank">注册</a>一个Discord开发者账户。一旦你进入，点击“新应用”，并给你的新应用一个名称和描述。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ly"><img src="../Images/8fee78f1e49dc26b73ca9f296cded941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QgdrslMoqKzNzIPE.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">创建新的Discord应用程序。</figcaption></figure><p id="ff6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在左侧面板中，选择“bot”创建一个新的Bot。选择“添加机器人”给你的新机器人一个用户名，并上传一个可爱或吓人的用户图标。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mn"><img src="../Images/db2743821103d95125b4764406bd724d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XtN8UWLyKSVaO1Ik.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">给你的机器人一个用户名和一张图片。</figcaption></figure><p id="9d31" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了能够在代码中控制你的机器人，你需要一个Discord开发者令牌，你可以通过点击“复制”直接从机器人页面中获取。将该代码放到` . env '文件中:</p><p id="7879" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在你已经创建了一个不和谐的机器人，你可以立即将它添加到一个频道。在任何Discord应用程序中(我使用的是桌面应用程序)，登录并创建一个新服务器:</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mo"><img src="../Images/391f14f0eab210d926d3e66c4ba44cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KYaDJsJVeI2WNZB8.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">下载Discord应用程序后，只需点击加号按钮即可创建一个新服务器。</figcaption></figure><p id="84fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们把你的机器人添加到服务器。回到Discord <a class="ae jp" href="https://discord.com/developers" rel="noopener ugc nofollow" target="_blank">开发者门户</a>，在您的应用程序中，点击左侧面板上的OAuth</p><p id="8981" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Discord有一个非常好的处理bot权限的系统。在“范围”下，勾选“机器人”旁边的框这将在下面打开一个“机器人权限”部分。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/47bc79c6818df4ec9a06bacef6174989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iFM7gx_aMnG_noyy.png"/></div></div><figcaption class="kl km et er es kn ko bd b be z dx translated">检查你的机器人需要的权限(我们的是上面的3个)。</figcaption></figure><p id="e089" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">勾选“发送消息”、“添加反应”(用表情符号对消息做出反应)和“踢会员”(禁止不良会员进入频道)。</p><p id="c42d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你向上滚动，就在BOT权限面板上方，你应该看到一个url，比如:<code class="du lt lu lv lw b">https://discord.com/api/oauth2/authorize?client_id=YOUR_CLIENT_ID&amp;permissions=2114&amp;scope=bot</code>。将该url粘贴到您的浏览器中。如果一切设置正确，您应该能够将您的机器人添加到您的服务器。这就对了。你没有写一行代码就创建了你的第一个不和谐机器人。但是现在，它什么也做不了。你需要给它一个大脑。</p><h1 id="8366" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">建立一个不和谐的调解人</h1><p id="9757" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">在这个项目中，我们的机器人大脑生活在文件<code class="du lt lu lv lw b">discord.js.</code>中</p><p id="bb68" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在文件的顶部，我们导入我前面提到的透视图文件:</p><p id="b851" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du lt lu lv lw b">const perspective = require('./perspective.js');</code></p><p id="e03a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后我们建立了一个表情地图，它告诉机器人在检测到各种属性时如何做出反应:</p><p id="d499" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以随意把它们改成你喜欢的任何东西。</p><p id="2aef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们希望我们的机器人做的是分析通道中的每一条消息。我们通过创建一个新的Discord客户端并传递我们的开发人员令牌(这是文件中的最后一行)来实现这一点:</p><p id="77f1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了监听消息，我们编写了一个监听客户端<code class="du lt lu lv lw b">message</code>事件的函数:</p><p id="5ce2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里发生了很多事。</p><ul class=""><li id="266f" class="jw jx ht is b it iu ix iy jb jy jf jz jj ka jn mq kc kd ke bi translated">在第4行，我们确保我们正在分析的消息只来自其他用户(不是机器人)</li><li id="8a87" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn mq kc kd ke bi translated">在8上，我们分配一些内存来跟踪我们的用户。这样我们就能记住我们给了他们多少表情符号，他们说了多少次有毒的话。</li><li id="f981" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn mq kc kd ke bi translated">在第14页，我们调用了<code class="du lt lu lv lw b">evaluateMessage</code>函数，它使用透视API来分析用户的消息。该函数(您可以在文件中进一步研究)将文本传递给Perspective API，如果找到属性，则用表情符号反应进行响应，并统计用户说了一些有毒的话的次数。如果它大于我们的<code class="du lt lu lv lw b">.env</code>文件中设置的值<code class="du lt lu lv lw b">KICK_THRESHOLD</code>，该函数返回True(即，我们应该将用户从频道中踢出)。</li><li id="7201" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn mq kc kd ke bi translated">在第19行，我们使用函数<code class="du lt lu lv lw b">kickBaddie</code>将用户踢出频道。</li><li id="2ff6" class="jw jx ht is b it kf ix kg jb kh jf ki jj kj jn mq kc kd ke bi translated">最后，在第27行，我们注意"！因果报应”热词。如果用户输入这个热词，我们将发送一条消息，汇总该频道用户的统计数据。</li></ul><p id="a3c4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要真正详细了解这里发生了什么，您必须查看文件中的函数<code class="du lt lu lv lw b">evaluateMessage</code>和<code class="du lt lu lv lw b">kickBaddie</code>。我在队列中添加了许多文档。但简而言之，这就是全部。</p><p id="5170" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是你要做的——你有你自己的人工智能控制的不和谐调节机器人。你怎么想呢?</p></div><div class="ab cl mr ms gp mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hb hc hd he hf"><p id="648f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">原载于2020年6月30日</em><a class="ae jp" href="https://daleonai.com/build-your-own-ai-moderator-bot-for-discord-with-the-perspective-api" rel="noopener ugc nofollow" target="_blank"><em class="jo">【https://daleonai.com】</em></a><em class="jo">。</em></p></div></div>    
</body>
</html>