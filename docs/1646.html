<html>
<head>
<title>Developing and Deploying Serverless Containers with Cloud Code and Google Cloud Run</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用云代码和Google Cloud Run开发和部署无服务器容器</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/developing-and-deploying-containers-with-cloud-code-on-google-cloud-run-4d8dfd88af48?source=collection_archive---------0-----------------------#2020-11-04">https://medium.com/google-cloud/developing-and-deploying-containers-with-cloud-code-on-google-cloud-run-4d8dfd88af48?source=collection_archive---------0-----------------------#2020-11-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b763" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用云代码在云上编写、调试和部署无服务器容器</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/83877be4427654db0bcf674c6e72ea7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KigLshx-N_oRTpgFrtNx9g.png"/></div></div></figure><p id="f6d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">云代码是一个工具，可以帮助你编写、调试和部署你的应用到谷歌云服务。对ide的扩展，如Visual Studio代码、云外壳编辑器和JetBrains IDEs家族。它为Google Kubernetes引擎和Cloud Run提供开发工具。</p><p id="e145" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您不熟悉CLI或使用web控制台，它可以为您节省大量时间，因为它可以更容易地将许多工具部署和集成到您的IDE中。</p><p id="6aa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将逐步展示使用该工具的日常工作流程，从运行本地模拟器到部署您的容器。</p><h2 id="5572" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">安装</h2><p id="2100" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">你可以从你的IDE扩展管理器或者源代码<a class="ae kp" href="https://github.com/GoogleCloudPlatform/cloud-code-vscode" rel="noopener ugc nofollow" target="_blank">安装云代码</a>。在本教程中的例子和图像将与<a class="ae kp" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/6ed65cc90eb39bbf11ffdf088a0266f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GkCz3HnOoeFKPsq6b51jQ.png"/></div></div></figure><p id="6dad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用Google提供的示例代码来部署一个用Go on Cloud Run编写的Hello World。您可以从扩展欢迎页面或他们的<a class="ae kp" href="https://github.com/GoogleCloudPlatform/cloud-code-samples/tree/master/golang/go-cloud-run-hello-world" rel="noopener ugc nofollow" target="_blank">存储库</a>中获得示例。</p><p id="c48e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们在讨论代码云，我就不深入讨论GCP基础设施的细节了。但请记住，你需要一个谷歌云和云运行(run.googleapis.com)启用项目。</p><h2 id="6860" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">初始设置</h2><p id="4361" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">安装云代码后，您将在左侧栏看到四个图标，分别代表Kubernetes Explore、Cloud Run、Cloud APIs和Secret Manager。您可以隐藏不使用的文件。要开始，请访问云运行图标。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/216bdb097bcf9b0575b68c2b0e61570e.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*-J5HBCJvvJPkI-YwnpRxeQ.png"/></div></figure><p id="260f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您还没有在Cloud SDK上验证您的Google帐户，它会要求您登录。点击邮件，它会在你的浏览器上打开一个标签，并按照那里的指示进行操作。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/a82aadef7838d8a341186a239db34249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*DbhnIsYNAMn7QWX6QrGuKw.png"/></div></figure><h2 id="47e9" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">云运行模拟器</h2><p id="f190" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">按<code class="du kt ku kv kw b">cmd + shift + P</code>搜索“云运行”，有以下选项:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/015d0b6fcdac7f839ed18b511220053d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVRYH6V_iUV5PRdneAOAJA.png"/></div></div></figure><p id="e0aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模拟器选项允许您在部署应用程序之前对其进行本地测试。在VSCode上打开示例项目或您自己的项目，并尝试使用<code class="du kt ku kv kw b">Run on Cloud Run Emulator</code>选项。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/8b770b22ae9a5db5b4a4b1e17e7a5924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yw75iHX6W7_6NeQQ5STuqQ.png"/></div></div></figure><p id="fd84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击run，Minikube将运行您的容器并在您的机器上打开一个端口。Visual Studio代码在<code class="du kt ku kv kw b">.vscode/</code>目录中创建一个<code class="du kt ku kv kw b">launch.json</code>文件，带有容器设置，相当于云运行设置。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/bf99db071f88864eb20147ce8964a9cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TVDU7lP41w9ycduHTtK1WQ.png"/></div></div></figure><p id="14c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你可以在浏览器上访问<code class="du kt ku kv kw b">http://locahost:8080</code>并看到你的容器正在运行。</p><p id="f2bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了调试您的应用程序，在您的代码上放置一些断点并运行<code class="du kt ku kv kw b">Debug on Cloud Run Emulator</code>。</p><h2 id="d290" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">部署</h2><p id="fa3c" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">要部署您的应用程序，运行<code class="du kt ku kv kw b">Deploy to Cloud Run</code>选项，它将打开容器设置，这与web控制台非常相似。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es la"><img src="../Images/706671f33088b947433807173c654f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X12x77U-ZyeqQL3gZCDSuQ.png"/></div></div></figure><p id="6cf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进行必要的更改并点击deploy，您将在顶部看到一条消息，其中包含应用程序的链接:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lb"><img src="../Images/d63643f217fdff33fc413c3c55570943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QAgJWDMeVxmPnjCJCHt_jQ.png"/></div></div></figure><p id="f397" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的浏览器中输入链接，您应该会看到您的应用程序启动并运行:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/8ab7b0e57fea9bd85f11b9e4098fb4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-DAjQinfQ4tPW8WzCE9J-Q.png"/></div></div></figure><p id="ed9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，您就有了从IDE部署到Google Cloud的无服务器容器。如果您检查IDE上的“云运行”选项卡，您将看到您的应用程序状态和一些相关信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/ef23a04b44b90b1582621b06a5e24b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*HqS4zNfUuSkwHcHUVZuKcQ.png"/></div></figure><p id="f6a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是使用云代码的日常工作流程的样子！</p></div></div>    
</body>
</html>