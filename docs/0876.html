<html>
<head>
<title>Google Cloud Production Guideline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌云生产指南</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/production-guideline-9d5d10c8f1e?source=collection_archive---------0-----------------------#2019-01-12">https://medium.com/google-cloud/production-guideline-9d5d10c8f1e?source=collection_archive---------0-----------------------#2019-01-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c396" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的几年里，我发现自己给许多使用谷歌云的公司提供了一些建议，告诉他们在进入生产阶段时需要考虑的基本问题。基于生产就绪的良好实践和通常被破坏的步骤，我整理了一个在生产之前要完成的行动列表。尽管这个列表特别提到了Google Cloud，但是它在Google Cloud之外仍然是有用和适用的。</p><h2 id="a25f" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">设计和开发</h2><ul class=""><li id="d2fe" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">拥有可重现的构建，您的构建不应该需要访问外部服务，也不应该受到外部系统中断的影响。</li><li id="611b" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">在设计时为您的服务定义和设置SLO。</li><li id="3ce0" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录您所依赖的外部服务的可用性预期。</li><li id="c326" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">通过不依赖单一全局资源来避免单点故障。当资源不可用时，复制资源或具有适当的后备(例如，硬编码值)。</li></ul><h2 id="6357" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">结构管理</h2><ul class=""><li id="8e42" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">静态、小型和非机密配置可以是命令行标志。对于其他所有事情，使用配置交付服务。</li><li id="9455" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">在配置系统不可用的情况下，动态配置应该有一个合理的后备。</li><li id="15a8" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">开发环境配置不应该从生产配置继承。这可能导致从开发访问生产服务，并可能导致隐私问题和数据泄漏。</li><li id="5e5f" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录可以动态配置的内容，并解释在配置交付系统不可用时的回退行为。</li></ul><h2 id="452b" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">发布管理</h2><ul class=""><li id="5728" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">记录关于您的发布过程的所有细节。记录发布如何影响SLO(例如，由于缓存未命中导致的临时更高延迟)。</li><li id="b91e" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录你的金丝雀释放过程。</li><li id="6ac3" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">有一个金丝雀分析计划和设置机制，以自动恢复金丝雀，如果可能的话。</li><li id="8545" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">确保回滚可以使用与推出相同的过程。</li></ul><h2 id="c6b7" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">可观察性</h2><ul class=""><li id="5402" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">确保从二进制文件中收集并导出SLO所需的指标集合。</li><li id="70a5" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">确保客户端和服务器端的可观测性数据是可以区分的。这对于调试生产中的问题非常重要。</li><li id="d0d3" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">调整警报以减少工作量，例如删除由常规事件触发的警报。</li><li id="697d" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">如果您使用Stackdriver，请在仪表板中包含GCP平台指标。为您的GCP依赖项设置警报。</li><li id="ca4d" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">总是传播传入的跟踪上下文。请参见gRPC的<code class="du ko kp kq kr b">grpc-trace-bin</code>元数据关键字，HTTP请求的<code class="du ko kp kq kr b">X-Cloud-Trace-Context</code>报头。即使您没有参与跟踪，这也将允许GCP调试生产问题。</li><li id="b97f" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">启用Stackdriver Profiler以优化CPU使用。</li></ul><h2 id="8c4d" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">安全和保护</h2><ul class=""><li id="dcca" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">确保所有外部请求都已加密。</li><li id="7d1f" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">确保您的生产项目具有正确的IAM配置。</li><li id="a64e" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">使用项目来完全隔离资源。</li><li id="ab86" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">使用项目中的网络来隔离虚拟机实例组。</li><li id="a3f1" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">使用云VPN安全地连接远程网络。</li><li id="a6ec" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录和监控用户数据访问。确保记录和审核所有用户数据访问。</li><li id="2f11" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">确保调试端点受到ACL的限制。</li><li id="51b6" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">净化用户输入。对用户输入有负载大小限制。</li><li id="4e22" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">确保您的服务可以有选择地阻止每个用户的传入流量。这允许在不影响其他用户的情况下阻止滥用情况。</li><li id="5bf3" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">避免触发大量内部扇出的外部端点。</li></ul><h2 id="cc5f" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">容量规划</h2><ul class=""><li id="de83" class="jy jz hi ih b ii ka im kb iq kc iu kd iy ke jc kf kg kh ki bi translated">记录您的服务如何扩展。示例:用户数量、传入负载的大小、传入消息的数量。</li><li id="17ed" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录服务的资源需求。示例:专用虚拟机实例的数量、扳手实例的数量、GPU或TPU等专用硬件。</li><li id="910a" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录资源限制:资源类型、区域等。</li><li id="48c1" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">记录配额限制以创建新资源。例如，如果您通过API创建新的实例，请记录GCE API的速率限制。</li><li id="3a97" class="jy jz hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">在可能的情况下，考虑对性能回归进行负载测试。</li></ul></div></div>    
</body>
</html>