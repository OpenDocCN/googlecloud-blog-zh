<html>
<head>
<title>How to quickly experiment with Dataflow (Apache Beam Python)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速试验数据流(Apache Beam Python)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/quickly-experiment-with-dataflow-3d5a0da8d8e9?source=collection_archive---------1-----------------------#2016-11-01">https://medium.com/google-cloud/quickly-experiment-with-dataflow-3d5a0da8d8e9?source=collection_archive---------1-----------------------#2016-11-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="392d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的一个同事向我展示了这个技巧，让我快速试验<a class="ae jd" href="https://cloud.google.com/dataflow/" rel="noopener ugc nofollow" target="_blank">云数据流</a> /Apache Beam，它已经为我节省了几个小时。[数据流是谷歌的自动缩放，无服务器处理批处理和流数据的方式。它运行<a class="ae jd" href="https://beam.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇光束</a>管道。如果你没有用过，你应该尝试一下。]</p><p id="83e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了尝试一些Python数据流代码，我会这样做:我会创建一个管道，从一个CSV文件中读取一些数据，用我正在尝试的代码转换它，将结果写出到一个文本文件中，然后查看它。非常非常慢的过程。</p><p id="3713" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个很酷的新方法利用了Python <a class="ae jd" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop" rel="noopener ugc nofollow" target="_blank"> REPL </a>(命令行解释器)以及Python列表可以作为数据流来源的事实。</p><p id="7163" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如有必要，在您的机器上安装Apache Beam包:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="113d" class="jn jo hi jj b fi jp jq l jr js">$pip install 'apache-beam[gcp]'</span></pre><p id="f73d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在命令行上启动Python解释器:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="baad" class="jn jo hi jj b fi jp jq l jr js">$ python</span></pre><p id="994f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入Apache Beam包:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="94dd" class="jn jo hi jj b fi jp jq l jr js">&gt;&gt;&gt; import apache_beam as beam</span></pre><p id="ce8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，你可以开始了。您可以创建一个示例列表，并将其传递给转换:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="d373" class="jn jo hi jj b fi jp jq l jr js">&gt;&gt;&gt; [3, 8, 12] | beam.Map(lambda x : 3*x)</span><span id="158e" class="jn jo hi jj b fi jt jq l jr js">[9, 24, 36]</span></pre><p id="a173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多酷啊。没有管道，没有输入/输出文件。只是一个简单的列表，通过管道连接到您想要尝试的转换代码。</p><p id="ffd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个在键-值对(在Python数据流中表示为2元组)上进行尝试的例子:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="078f" class="jn jo hi jj b fi jp jq l jr js">&gt;&gt;&gt; [(‘Jan’,3), (‘Jan’,8), (‘Feb’,12)] | beam.GroupByKey()</span><span id="bca4" class="jn jo hi jj b fi jt jq l jr js">[(‘Jan’, [3, 8]), (‘Feb’, [12])]</span></pre><p id="29f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以继续追加变换:</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="3f98" class="jn jo hi jj b fi jp jq l jr js">&gt;&gt;&gt; [(‘Jan’,3), (‘Jan’,8), (‘Feb’,12)] | beam.GroupByKey() | beam.Map(lambda (mon,days) : (mon,len(days)))</span><span id="6bb3" class="jn jo hi jj b fi jt jq l jr js">[(‘Jan’, 2), (‘Feb’, 1)]</span></pre><p id="c8f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这个技巧能为你节省和我一样多的时间。</p><p id="f9be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码快乐！</p></div></div>    
</body>
</html>