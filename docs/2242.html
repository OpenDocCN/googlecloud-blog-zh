<html>
<head>
<title>Securely Authenticate the GKE/Anthos cluster with Okta</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Okta安全认证GKE/安托斯集群</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/securely-authenticate-the-gke-anthos-cluster-with-okta-f475153fddf9?source=collection_archive---------0-----------------------#2022-06-30">https://medium.com/google-cloud/securely-authenticate-the-gke-anthos-cluster-with-okta-f475153fddf9?source=collection_archive---------0-----------------------#2022-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8fd23fa0e16533c9e537a0a81ea611ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rRLb8tBw3WMZNwTQBO94eQ.png"/></div></div></figure><h2 id="10c6" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">Okta是什么？</h2><p id="8fbc" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">Okta是一个安全的解决方案，为应用程序增加了认证和授权。它将保护我们的应用程序，而没有任何安全风险和部署开销。</p><h2 id="2149" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">目标</h2><p id="7f3a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">用Okta保护Anthos集群，这样未经验证的用户就不能访问您的集群。</p><p id="b17b" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">首先，在AWS上部署Anthos集群，对于通过Okta的认证和授权，请遵循以下步骤。</p><h1 id="7810" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">为SSM创造角色和政策</h1><p id="8d54" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">SSM是一个会话管理器，帮助管理或登录一个交互式点击浏览器的EC2实例。创建密钥并使用密钥登录不是最佳做法，这就是为什么使用SSM，下面是SSM所需的权限。</p><ol class=""><li id="a412" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated">导航到AWS控制台。</li><li id="2ed5" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">创建具有下列权限的策略。</li></ol><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="539c" class="iq ir hi ly b fi mc md l me mf">{<br/>    "Version": "2012-10-17",<br/>    "Statement": [<br/>        {<br/>            "Effect": "Allow",<br/>            "Action": [<br/>                "ssmmessages:CreateDataChannel",<br/>                "ssmmessages:OpenControlChannel",<br/>                "ssmmessages:CreateControlChannel",<br/>                "ssmmessages:OpenDataChannel",<br/>                "ssm:UpdateInstanceInformation",<br/>                "ssm:StartSession",<br/>                "ssm:TerminateSession",<br/>                "ssm:ResumeSession",<br/>                "ssm:DescribeSessions",<br/>                "ssm:GetConnectionStatus"<br/>            ],<br/>            "Resource": "*",<br/>            "Condition": {<br/>                "StringEquals": {<br/>                    "aws:RequestedRegion": [<br/>                        "us-east-1",<br/>                        "us-east-2"<br/>                    ],<br/>                    "aws:PrincipalAccount": "xxxxx"<br/>                }<br/>            }<br/>        }<br/>    ]<br/>}</span></pre><p id="8e98" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">3.创建一个角色，并将上面创建的策略添加到其中。</p><h1 id="0fb1" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">正在创建EC2实例</h1><p id="1f62" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">作为最佳实践，要通过Okta访问AWS Anthos集群，我们需要创建一个EC2实例，下面是创建实例的步骤</p><ol class=""><li id="4915" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated">导航到AWS控制台。</li><li id="2ac6" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在创建Anthos集群的公共子网所在的同一个VPC中创建一个Amazon Linux EC2实例。</li><li id="26c9" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">附加上面为SSM访问权限创建的角色。</li><li id="e5e1" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">使用您的本地IP为端口<code class="du mg mh mi ly b">[PORT]</code>(使用大于1024的<code class="du mg mh mi ly b">[PORT]</code>)创建入站规则，以便通过Okta对集群进行身份验证。</li><li id="bed7" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在实例内部安装gcloud和kubectl。</li></ol><h1 id="024d" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">创建重定向URL</h1><h2 id="6e7d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">谷歌云重定向URL</h2><p id="277d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">Cloud SDK安装在每个开发人员的本地机器上，包括<code class="du mg mh mi ly b">gcloud</code> CLI。用于重定向URL的端口号应大于1024:</p><p id="12a9" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">http://instance_publicIP:[PORT]/authorization-code/callback</code></p><p id="4b32" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">用大于1024的端口号替换<strong class="jq hj"> <em class="mj">【端口】</em> </strong>。</p><p id="a5bd" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">当您配置Google provider时，将<code class="du mg mh mi ly b"><a class="ae mk" href="http://instance_publicIP:[PORT]/authorization-code/callback/" rel="noopener ugc nofollow" target="_blank">http://instance_publicIP:[PORT]/authorization-code/callback</a></code>指定为您的重定向URL之一。</p><h2 id="ba88" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">云控制台重定向URL</h2><p id="bae7" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">云控制台的重定向URL是:</p><p id="49b3" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">https://console.cloud.google.com/kubernetes/oidc</code></p><p id="4e9e" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">当您配置OIDC提供商时，请将<code class="du mg mh mi ly b">https://console.cloud.google.com/kubernetes/oidc</code>指定为您的重定向URL之一。</p><h1 id="3d3e" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">创建Okta应用程序</h1><p id="ae4a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated"><em class="mj">使用商务邮箱id</em><a class="ae mk" href="https://www.okta.com/free-trial/" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"><em class="mj">【https://www.okta.com/free-trial/】</em></strong></a><strong class="jq hj"><em class="mj"/></strong><em class="mj">在</em> <strong class="jq hj"> <em class="mj"> Okta </em> </strong> <em class="mj">上创建账户，并以管理员用户身份登录</em></p><ol class=""><li id="3c8d" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated">在管理控制台中，进入<strong class="jq hj">应用程序、</strong>，然后<strong class="jq hj"> </strong>选择<strong class="jq hj">应用程序</strong>。</li><li id="14ad" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">创建应用集成</strong>。</li><li id="b745" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">要创建OIDC应用集成，选择<strong class="jq hj">OIDC-OpenID连接</strong>和<strong class="jq hj">网络应用</strong>，然后点击下一步。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/79e9a126b95e635cce2f8655f8da4892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhN4KhTjefgkG2TWRLRZvA.png"/></div></div></figure><h2 id="8814" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">配置初始设置</h2><p id="2e50" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">在<strong class="jq hj">通用设置</strong>中:</p><ol class=""><li id="4ff4" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated"><strong class="jq hj">应用程序名称:</strong>指定应用程序的名称。</li><li id="4477" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">应用程序徽标:</strong>这是一个可选字段，您可以在其中为您的应用程序添加徽标。</li><li id="3b72" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在<strong class="jq hj">中配置OpenID连接</strong>:</li><li id="434b" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">登录重定向URIs </strong>:添加您的两个重定向URL，回想一下您在上面创建了一个用于<code class="du mg mh mi ly b">gcloud</code> CLI的重定向URL和一个用于云控制台的重定向URL。<br/><strong class="jq hj">登录重定向URIs </strong>是Okta为用户的登录请求发送认证响应和ID令牌的地方。</li><li id="77dd" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">注销重定向URIs </strong>(可选):在您的应用程序联系Okta关闭用户会话后，Okta会将用户重定向到这些URIs之一。</li><li id="ce4d" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">保存</strong>。这将创建集成，并打开设置页面来配置附加选项。</li><li id="55ca" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">保存客户端ID，客户端密码会给你，以后会用到。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/a1267ac9c5d8088b7421c3d7a2854317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVRedcTOAJc8vCnoyFj8Pw.png"/></div></div></figure><h2 id="9cbb" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">启用刷新令牌</h2><ol class=""><li id="d755" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">应用程序、</strong>和<strong class="jq hj">T53】，然后选择<strong class="jq hj">应用程序</strong>。</strong></li><li id="c0db" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您在上面创建的OpenID Connect客户端应用程序。</li><li id="c3d1" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">导航到<strong class="jq hj">通用</strong>选项卡，点击<strong class="jq hj">通用设置</strong>部分的<strong class="jq hj">编辑</strong>。</li><li id="2513" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">定位到授权类型。</li><li id="4dbb" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择<strong class="jq hj">刷新令牌</strong>。</li><li id="b289" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">保存</strong>。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/c4171f54453ef6273b792cc6be2050d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_EyL6H4xmwc-FR_F_25-A.png"/></div></div></figure><h2 id="3ea4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">添加组声明</h2><ol class=""><li id="2528" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">应用程序、</strong>和<strong class="jq hj">T69】，然后选择<strong class="jq hj">应用程序</strong>。</strong></li><li id="e30a" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您在上面创建的OpenID Connect客户端应用程序。</li><li id="7c8b" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">导航到选项卡上的<strong class="jq hj">符号，并点击<strong class="jq hj"> OpenID连接ID令牌</strong>部分中的<strong class="jq hj">编辑</strong>。</strong></li><li id="42c2" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在<strong class="jq hj">组索赔类型</strong>部分，选择<strong class="jq hj">过滤器</strong>。</li><li id="c7d4" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在<strong class="jq hj"> Group claims filter </strong>部分，保留默认名称<code class="du mg mh mi ly b">groups</code>(如果该框为空，则添加它)，选择<strong class="jq hj"> Matches regex，</strong>并输入<code class="du mg mh mi ly b">.*</code>以返回所有用户组。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/e4064badbe8145f4322282d614b379f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Edsgnu0BQJGZe_vV4nxRA.png"/></div></div></figure><h1 id="0247" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">添加人员</h1><h2 id="f56b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">启动向导</h2><ol class=""><li id="2692" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">目录，</strong>然后选择<strong class="jq hj">人员</strong>。</li><li id="e942" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">添加人员</strong>。</li><li id="a26b" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">输入名字、姓氏和用户名作为电子邮件。</li><li id="31d1" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">保存</strong>或<strong class="jq hj">保存并添加另一个</strong>。</li></ol><h1 id="e48a" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">创建Okta集团</h1><h2 id="9a2d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">启动向导</h2><ol class=""><li id="bb3b" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">目录，</strong>然后选择<strong class="jq hj">组</strong>。</li><li id="bb86" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">添加群组</strong>。</li><li id="d1e3" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在<strong class="jq hj">名称</strong>字段中输入该组的名称。</li><li id="cbc7" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">描述</strong>。这是一个可选字段，我们可以在其中输入组的描述。</li><li id="5dfc" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">保存</strong>。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/8d34c3c60017bd3c1bd80af109ac10a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gJX9oSiTJHkuMOgu7N5cw.png"/></div></div></figure><h2 id="dba3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将用户添加到组</h2><ol class=""><li id="0955" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">目录，</strong>然后选择<strong class="jq hj">组</strong>。</li><li id="2fad" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您在上面创建的组。</li><li id="8aee" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">分配人员</strong>。</li><li id="0450" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在<strong class="jq hj">搜索</strong>字段中，输入该人的姓名。</li><li id="b38e" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<code class="du mg mh mi ly b">+</code>将该人分配到该组。</li><li id="4bd6" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">保存</strong>。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/2b34d85467facd1b1cb95e62c8273811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9wwrZcF93uMc1FLSp7lUXg.png"/></div></div></figure><h2 id="09a0" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将应用程序添加到组</h2><ol class=""><li id="dcf4" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">目录，</strong>然后选择<strong class="jq hj">组</strong></li><li id="fcf6" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您在上面创建的组。</li><li id="466e" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">应用、</strong>和<strong class="jq hj">和</strong>，然后选择<strong class="jq hj">分配应用</strong>。</li><li id="505f" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">请在<strong class="jq hj">搜索</strong>字段中输入我们之前创建的应用程序的名称。</li><li id="3674" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">分配</strong>将应用分配到组中。</li><li id="e3b8" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">完成。</strong></li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/023b520c26dc95efe2f4cf768f893729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4H2H-lZlae4bnYelUjlqjw.png"/></div></div></figure><h1 id="3b04" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">配置授权服务器</h1><h2 id="b021" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">添加组范围</h2><ol class=""><li id="3de6" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">安全、</strong>，然后选择<strong class="jq hj"> API。</strong></li><li id="e402" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您想要配置的授权服务器。示例:默认</li><li id="632a" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">导航至<strong class="jq hj">范围</strong>选项卡。</li><li id="c855" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">添加范围</strong>。</li><li id="af96" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">输入名称作为<strong class="jq hj">组</strong>。</li><li id="e517" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">输入显示短语作为<strong class="jq hj">组</strong>。</li><li id="742a" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">可选。在描述字段中输入范围的描述。</li><li id="4aef" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择<strong class="jq hj">包含在公共元数据中</strong>。</li><li id="30b0" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">创建</strong>。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/4c287ce93ce1646add200ea0758a836d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iuj_Wot2YICGqMUdNGCGcg.png"/></div></div></figure><h2 id="161a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">添加组索赔</h2><ol class=""><li id="f9fa" class="lf lg hi jq b jr js jv jw jb mn jf mo jj mp ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">安全、</strong>，然后选择<strong class="jq hj"> API。</strong></li><li id="56e9" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择您想要配置的授权服务器。示例:默认</li><li id="2f37" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">导航至<strong class="jq hj">索赔</strong>选项卡。</li><li id="f0e8" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">添加索赔</strong>。</li><li id="d0aa" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">输入名称作为<strong class="jq hj">组</strong>。</li><li id="2575" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">配置声明设置:</li><li id="a627" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">包含在令牌类型</strong>中:选择<strong class="jq hj"> ID令牌</strong>为<strong class="jq hj">总</strong>。</li><li id="ffcf" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">值类型</strong>:选择<strong class="jq hj">组</strong>。</li><li id="cdb4" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated"><strong class="jq hj">过滤器</strong>:选择<strong class="jq hj">匹配正则表达式</strong>，输入<code class="du mg mh mi ly b">.*</code>。</li><li id="602b" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">选择<strong class="jq hj">任何范围</strong>为<strong class="jq hj">包含在</strong>字段中。</li><li id="dc48" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj">创建</strong>。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/43fc780bf1d865d4879300d4b0e465fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ge0j4YzqChIvhWueSTLVMw.png"/></div></div></figure><p id="eb94" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">从EC2实例</strong>连接到Anthos集群</p><p id="a6b0" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">gcloud container hub memberships get-credentials cluster_name</code></p><p id="b399" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">编辑配置文件</strong></p><p id="2836" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">kubectl --kubeconfig=KUBECONFIG_PATH edit ClientConfigs default -n kube-public</code></p><p id="865a" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">将<strong class="jq hj"><em class="mj">KUBECONFIG _ PATH</em></strong>替换为集群的kube config文件的路径，例如<code class="du mg mh mi ly b">$HOME/.kube/config</code></p><p id="323c" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">文本编辑器加载集群的ClientConfig资源。如下所示，在文件中添加零件。不要修改任何已经写入的默认数据。</p><h1 id="ae78" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">配置您的集群</h1><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="e9d2" class="iq ir hi ly b fi mc md l me mf">spec:<br/>  authentication:<br/>    - aws:<br/>        region: XXXX<br/>      name: oidc<br/>      oidc:<br/>        clientID: CLIENT_ID<br/>        clientSecret: CLIENT_SECRET<br/>        cloudConsoleRedirectURI: XXXX<br/>        groupsClaim: groups<br/>        issuerURI: ISSUER_URI<br/>        kubectlRedirectURI: http://instance_publicIP:[PORT]/<!-- -->authorization-code/<!-- -->callback<br/>        scopes: offline_access,email,profile,groups<br/>        userClaim: email</span></pre><p id="9b7f" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">带有<code class="du mg mh mi ly b">anthos-auth</code>组件的<code class="du mg mh mi ly b">gcloud</code>工具的更新版本</p><p id="f6f1" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$ gcloud components update</code></p><p id="f076" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$ gcloud components install anthos-auth</code></p><p id="3488" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">使用gcloud anthos创建配置</p><p id="fd49" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$ gcloud anthos create-login-config --kubeconfig $HOME/.kube/config</code></p><p id="3301" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在<strong class="jq hj"> Linux </strong>和<strong class="jq hj"> macOS </strong>上，默认情况下，该文件位于<code class="du mg mh mi ly b">~/.kube/config</code></p><p id="e7f2" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">这个命令生成一个包含配置信息的文件(kubectl-anthos-config.yaml)。</p><p id="f71f" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">将配置文件复制到一个位置</strong></p><p id="98e4" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$ cp kubectl-anthos-config.yaml $HOME/.config/google/anthos/kubectl-anthos-config.yaml</code></p><h2 id="cec5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">登录配置默认目录</h2><p id="9ff4" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">每个操作系统存储配置文件的默认位置如下:</p><p id="5697" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj"> Linux </strong></p><p id="3680" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$HOME/.config/google/anthos/kubectl-anthos-config.yaml</code>，其中<code class="du mg mh mi ly b">$HOME</code>是用户的主目录。</p><p id="adb1" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj"> macOS </strong></p><p id="a6d2" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">$HOME/Library/Preferences/google/anthos/kubectl-anthos-config.yaml</code>，其中<code class="du mg mh mi ly b">$HOME</code>是用户的主目录。</p><p id="22d7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><strong class="jq hj">窗户</strong></p><p id="04d6" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><code class="du mg mh mi ly b">%APPDATA%/google/anthos/kubectl-anthos-config.yaml</code>，其中<code class="du mg mh mi ly b">%APPDATA%</code>是用户的应用数据目录。</p><h1 id="cef0" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">为您的用户集群创建RBAC策略</h1><p id="e2c5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">定义一个<code class="du mg mh mi ly b"><strong class="jq hj">Role</strong></code>。将下面的YAML复制到名为<code class="du mg mh mi ly b"><strong class="jq hj">role.yaml</strong></code>的文件中</p><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="8b17" class="iq ir hi ly b fi mc md l me mf">apiVersion: rbac.authorization.k8s.io/v1<br/>kind: Role<br/>metadata:<br/>  namespace: role-test<br/>  name: pod-reader<br/>rules:<br/>- apiGroups: [""]<br/>  resources: ["pods", "services", "secrets", "nodes"]<br/>  verbs: ["get", "watch", "list"]</span></pre><p id="cfe9" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">定义一个<code class="du mg mh mi ly b"><strong class="jq hj">RoleBinding</strong></code>。将下面的YAML复制到一个名为<code class="du mg mh mi ly b"><strong class="jq hj">role-binding.yaml</strong></code>的文件中</p><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="67a7" class="iq ir hi ly b fi mc md l me mf">apiVersion: rbac.authorization.k8s.io/v1<br/>kind: RoleBinding<br/>metadata:<br/>  name: read-pods<br/>  namespace: role-test<br/>subjects:<br/>- kind: Group<br/>  name: XXXX    # "name" is case sensitive, name of the group which is created in okta console<br/>  apiGroup: rbac.authorization.k8s.io<br/>roleRef:<br/>  kind: Role <br/>  name: pod-reader <br/>  apiGroup: rbac.authorization.k8s.io</span></pre><p id="96eb" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">使用<code class="du mg mh mi ly b">kubectl</code>将<code class="du mg mh mi ly b"><strong class="jq hj">role.yaml</strong></code>和<code class="du mg mh mi ly b"><strong class="jq hj">role-binding.yaml</strong></code>应用到您的集群</p><h1 id="6098" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">鉴定</h1><p id="b297" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">使用<code class="du mg mh mi ly b">gcloud Anthos auth login</code>通过您的登录配置验证您的集群。</p><h2 id="77f0" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">默认</h2><p id="0015" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated"><code class="du mg mh mi ly b">$ gcloud anthos auth login --cluster CLUSTER_NAME</code></p><p id="47ec" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">用完全限定的集群名替换<strong class="jq hj"> <em class="mj">集群名</em> </strong>。比如<code class="du mg mh mi ly b">projects/my-gcp-project/locations/global/awsClusters/cluster_name</code>。</p><h2 id="b7b5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">可选参数</h2><p id="b722" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated"><code class="du mg mh mi ly b">gcloud Anthos auth login</code>支持以下可选参数:</p><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="cbb6" class="iq ir hi ly b fi mc md l me mf">gcloud anthos auth login --cluster CLUSTER_NAME \<br/>--user USERNAME --login-config ANTHOS_CONFIG_YAML \<br/>--login-config-cert LOGIN_CONFIG_CERT_PEM \<br/>--kubeconfig=KUBECONFIG --dry-run</span></pre><p id="e511" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">该命令将重定向到Okta登录页面，对用户进行身份验证，一旦身份验证成功，该特定用户将能够访问服务。因此，用户将有权通过Okta访问Anthos集群。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/b14e47106f1c745edb968eb0cacdbe43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OxL3QNMLTxLpjNJ8CAb4mw.png"/></div></div></figure><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/2195fc5d2e17ca572d52bd96a6753850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNdj6_3G73tV4BPI35npTg.png"/></div></div></figure><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/232587dfcdd0e5d779dba7b75ebb6285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8_fkY7_nLYKe_Eb2wL1Yw.png"/></div></div></figure><h1 id="b707" class="ko ir hi bd is kp kq kr iw ks kt ku ja kv kw kx je ky kz la ji lb lc ld jm le bi translated">登录配置示例</h1><pre class="lt lu lv lw fd lx ly lz ma aw mb bi"><span id="ee93" class="iq ir hi ly b fi mc md l me mf">apiVersion: authentication.gke.io/v2alpha1<br/>kind: ClientConfig<br/>metadata:<br/>  creationTimestamp: null<br/>spec:<br/>  authentication:<br/>  - aws:<br/>      region: XXXX<br/>    name: oidc<br/>    oidc:<br/>      clientID: XXXX<br/>      clientSecret: XXXX<br/>      cloudConsoleRedirectURI: XXXX<br/>      groupsClaim: groups<br/>      issuerURI: XXXX<br/>      kubectlRedirectURI: http://instance_publicIP:[PORT]/<!-- -->authorization-code/<!-- -->callback<br/>      scopes: offline_access,email,profile,groups<br/>      userClaim: email<br/>  certificateAuthorityData: XXXX<br/>  internalServer: ""<br/>  name: projects/XXXX/locations/XXXX/awsClusters/XXXX<br/>  server: https://gke-p5jkh55ausbq-cp-6047815259562bb2.elb.us-east-1.amazonaws.com<br/>status: {}</span></pre><h2 id="4145" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">通过OKTA在特定应用程序级别将IP列入白名单，以限制对Anthos集群的访问</strong></h2><p id="24d7" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">仅供参考:Okta的管理员用户将成功通过身份验证，即使他的IP地址没有被列入白名单。</p><ol class=""><li id="d4a7" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">安全，</strong>然后选择<strong class="jq hj">网络。</strong></li><li id="c9a3" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">点击<strong class="jq hj"> LegacyIpZone </strong>编辑按钮。</li><li id="af86" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">在网关IP中添加允许列表IP。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/654eac0d916e19728c6ad4724c47ea8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lb5XpdP9t4Exkzfbx9n-kg.png"/></div></div></figure><ol class=""><li id="8158" class="lf lg hi jq b jr kj jv kk jb lh jf li jj lj ki lk ll lm ln bi translated">在管理控制台中，转到<strong class="jq hj">安全、</strong>，然后选择<strong class="jq hj">验证策略。</strong></li><li id="34b7" class="lf lg hi jq b jr lo jv lp jb lq jf lr jj ls ki lk ll lm ln bi translated">仅供参考:在继续下一步之前，请确保应用程序已附加到默认策略。</li></ol><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/150cc311a6f8840522319a654c6ab0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aU7HHvNtjk85lUPfuhxBFw.png"/></div></div></figure><p id="a274" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">3.单击默认策略。</p><p id="84f0" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">4.点击添加规则。</p><p id="c1ac" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">5.输入您的规则名称。</p><p id="d7f3" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">6.在以下任一区域中选择<strong class="jq hj">:</strong>，在网关IPs中选择<strong class="jq hj">区域</strong>。</p><p id="86b8" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">7.在<strong class="jq hj">访问</strong>和<strong class="jq hj">保存</strong>中选择<strong class="jq hj">认证成功后允许</strong>单选按钮</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/7a62bb2dde24b638ea84ee7a0e43f784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zfKFhKeVfwraDgZTNQL-rA.png"/></div></div></figure><p id="b412" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">8.或者，我们可以拒绝IP并在相同的默认策略中创建一个规则。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/e424f622995ac9470a620189cbecd68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7y78ltbnDL-b_JnYAltOQ.png"/></div></div></figure><p id="d746" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">如果IP是okta用户的白名单，那么它将显示下面的成功响应</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/7d639e22a5d911203727fc802e27f12a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G909gEwpMgDe11Hrii_q2w.png"/></div></div></figure><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/ce2727839306d86062142c48772c3ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFQEHL2ZEk5ABN8xh2LRsA.png"/></div></div></figure><p id="80e4" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">如果IP不在okta用户的白名单中，那么它将显示下面的不成功响应</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/f13ff15cef210c96b93701a013b0fbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WsAAostFnPgrBEn-L62Lyw.png"/></div></div></figure><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/243296afb5502ba25072c80209c5fcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HU5xRyqGBq1fImQE-hRhtA.png"/></div></div></figure><h2 id="511b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">感谢您的阅读:)</h2><p id="e830" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">有问题吗？如果你有任何问题，我很乐意在评论中阅读。</p><p id="4940" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在LinkedIn 上关注我。</p><h2 id="1ce2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">快乐学习！！</h2></div></div>    
</body>
</html>