<html>
<head>
<title>GAPI — The Google APIs Client Library for Browser JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">APIs浏览器JavaScript的Google APIs客户端库</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/gapi-the-google-apis-client-library-for-browser-javascript-5896b12dbbd5?source=collection_archive---------0-----------------------#2019-09-03">https://medium.com/google-cloud/gapi-the-google-apis-client-library-for-browser-javascript-5896b12dbbd5?source=collection_archive---------0-----------------------#2019-09-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/400bc81ffb9a309285566f6b9ffe6199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5Bpkzljno7xzynnklCXXg.png"/></div></div></figure><p id="3624" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用API最简单的方法之一就是根本不使用服务器。有些应用程序非常适合客户端代码。<code class="du jp jq jr js b">GAPI</code>库提供了一种简单、灵活的方式从浏览器调用Google APIs。</p><p id="e513" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博文中，你将了解一些关于<code class="du jp jq jr js b">GAPI</code>库的知识，如何入门，以及如何使用JavaScript <code class="du jp jq jr js b">Promises</code>和Google OAuth等特性。</p><h1 id="cea2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是<code class="du jp jq jr js b">GAPI?</code></h1><p id="f9f7" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">Google提供了一组客户端库，用于调用各种语言的Google APIs，如Python、Java和Node。</p><p id="9ab4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> GAPI </strong>是谷歌浏览器端 JavaScript的客户端库。它用于Google登录、Google Drive和数千个内部和外部网页，以便轻松连接Google APIs。</p><p id="5138" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该客户端库于2012年在谷歌I/O上首次推出，旨在提供简单的谷歌身份和API访问，现已用于数千个域，目前每天处理<em class="jo">数十亿</em>次谷歌API查询。</p><h2 id="3253" class="kw ju hi bd jv kx ky kz jz la lb lc kd jb ld le kh jf lf lg kl jj lh li kp lj bi translated">GAPI入门</h2><p id="b1dc" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">GAPI的美妙之处在于，你不需要下载任何库来使用API客户端。在一个HTML文件中，<em class="jo">只需</em>包含这个<code class="du jp jq jr js b">script</code>标签:</p><pre class="lk ll lm ln fd lo js lp lq aw lr bi"><span id="e478" class="kw ju hi js b fi ls lt l lu lv">&lt;script src="<a class="ae lw" href="https://apis.google.com/js/api.js" rel="noopener ugc nofollow" target="_blank">https://apis.google.com/js/api.js</a>"&gt;&lt;/script&gt;</span></pre><blockquote class="lx ly lz"><p id="b673" class="iq ir jo is b it iu iv iw ix iy iz ja ma jc jd je mb jg jh ji mc jk jl jm jn hb bi translated">在这个URL上，你会得到一个缩小版的GAPI(通过<a class="ae lw" href="https://github.com/google/closure-compiler" rel="noopener ugc nofollow" target="_blank">闭包编译器</a>缩小)。</p></blockquote><p id="c5c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完整的<code class="du jp jq jr js b">index.html</code>可能是这样的:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="3575" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用<code class="du jp jq jr js b">python -m SimpleHTTPServer</code>在本地提供这个HTML文件。</p><p id="f8d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…或者使用节点:<code class="du jp jq jr js b">npm install http-server -g &amp;&amp; http-server -p 8000</code>。</p><p id="7688" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们打开<code class="du jp jq jr js b">localhost:8000</code>，我们将会看到一个空白页面，它静默地加载API客户端，没有javascript错误:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/7bf34d07ad921490273569ad9906f433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8BYV5uK1tLJQ5gM62GaQw.png"/></div></div></figure><p id="c9bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经建立了我们的“你好，世界”网页！现在让我们使用这个<code class="du jp jq jr js b">gapi</code>客户端。</p><h1 id="fa1c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">提出你的第一个GAPI请求</h1><p id="982e" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">要在GAPI发出请求，让我们创建一个JS文件。</p><p id="df00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的<code class="du jp jq jr js b">HTML</code>中，在<code class="du jp jq jr js b">body</code>中添加这一行:</p><pre class="lk ll lm ln fd lo js lp lq aw lr bi"><span id="b2d4" class="kw ju hi js b fi ls lt l lu lv">&lt;script src="script.js"&gt;&lt;/script&gt;</span></pre><p id="e82d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后用以下内容创建一个新文件<code class="du jp jq jr js b">script.js</code>:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="cded" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这段代码中，我们:</p><ol class=""><li id="25c9" class="mg mh hi is b it iu ix iy jb mi jf mj jj mk jn ml mm mn mo bi translated">加载<code class="du jp jq jr js b">gapi</code>客户端</li><li id="1b3d" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">用我们的Google API Discovery文档初始化客户端</li><li id="ca50" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">提出API请求</li><li id="a750" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">处理API响应结果</li></ol><p id="82ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们本质上是在寻找所有与<code class="du jp jq jr js b">Android</code>相关的Google APIs。我们的网页会有这样的回应:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/e87452dabc781f9d1d52ee55250e5260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hAie2zTEjcNUhfnfkskwg.png"/></div></div><figcaption class="mv mw et er es mx my bd b be z dx translated">有4个与Android相关的可发现API。</figcaption></figure><h1 id="0e7f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">OAuth</h1><p id="6da5" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">对于许多API，在发出请求之前，您需要通过Google API进行适当的认证。例如，使用Google Sheets API发出API请求。如果不进行身份验证，您将在API响应中看到以下错误:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="mv mw et er es mx my bd b be z dx translated">发出未经验证的请求时，您将看到的错误代码。</figcaption></figure><p id="c9ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">连接到用户数据的Google APIs使用<em class="jo"> OAuth 2 </em>进行认证。</p><h2 id="ae12" class="kw ju hi bd jv kx ky kz jz la lb lc kd jb ld le kh jf lf lg kl jj lh li kp lj bi translated">谷歌文档API + GAPI</h2><p id="1ac1" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">让我们通过使用<strong class="is hj"> Google Docs API </strong>进入更高级的内容。Google Docs API允许您以编程方式读写文档。我认为对于GAPI来说，这是一个很好的API，可以快速构建文档支持的应用程序。</p><p id="9f10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它是免费使用的，默认情况下，每个用户每分钟可以进行300次读取和60次写入查询。</p><p id="1436" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看看如何启用API:</p><ul class=""><li id="cfdf" class="mg mh hi is b it iu ix iy jb mi jf mj jj mk jn mz mm mn mo bi translated">前往<a class="ae lw" href="https://console.cloud.google.com/apis/api/docs.googleapis.com" rel="noopener ugc nofollow" target="_blank">https://console . cloud . Google . com/APIs/API/docs . Google APIs . com</a></li><li id="0d1e" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn mz mm mn mo bi translated">启用API</li></ul><h2 id="3b5f" class="kw ju hi bd jv kx ky kz jz la lb lc kd jb ld le kh jf lf lg kl jj lh li kp lj bi translated">GAPI电码</h2><p id="6e1f" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">在您的<code class="du jp jq jr js b">index.html</code>文件中，复制以下脚本:</p><figure class="lk ll lm ln fd ij"><div class="bz dy l di"><div class="md me l"/></div></figure><h2 id="52d9" class="kw ju hi bd jv kx ky kz jz la lb lc kd jb ld le kh jf lf lg kl jj lh li kp lj bi translated">启用Google Docs API</h2><p id="f383" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">然后，通过点击Google Cloud控制台页面上的两个蓝色按钮，为您的API客户端创建一个<code class="du jp jq jr js b">Client ID</code>和<code class="du jp jq jr js b">API Key</code>:</p><p id="375f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lw" href="https://developers.google.com/docs/api/quickstart/js#step_1_turn_on_the" rel="noopener ugc nofollow" target="_blank">打开谷歌文档API </a></p><h2 id="69b8" class="kw ju hi bd jv kx ky kz jz la lb lc kd jb ld le kh jf lf lg kl jj lh li kp lj bi translated">创建凭据</h2><p id="33b4" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">对于这个应用程序，我们将为Google Docs API创建一个<strong class="is hj"> API键</strong>，并为OAuth标识创建一个<strong class="is hj"> OAuth客户端ID </strong>。</p><p id="aba6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用这两个值，并将它们粘贴到我们的应用程序中:</p><pre class="lk ll lm ln fd lo js lp lq aw lr bi"><span id="24ae" class="kw ju hi js b fi ls lt l lu lv">var CLIENT_ID = '&lt;YOUR_CLIENT_ID&gt;';<br/>var API_KEY = '&lt;YOUR_API_KEY&gt;';</span></pre><p id="83ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，去<a class="ae lw" href="https://console.cloud.google.com/apis/credentials" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/apis/credentials</a>和<strong class="is hj">创建凭证</strong>:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div class="er es na"><img src="../Images/592f097868f468127d5914491e3d15ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*brtcVAMFJKgESFIIZJW-Lw.png"/></div></figure><ol class=""><li id="85bc" class="mg mh hi is b it iu ix iy jb mi jf mj jj mk jn ml mm mn mo bi translated">首先，<strong class="is hj">创建一个API键</strong>。不要选择<em class="jo">限制键</em>选项(尽管在生产中你会想这么做。</li><li id="fd82" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">其次，创建一个<strong class="is hj"> OAuth客户端ID </strong>。我们想要一个<strong class="is hj">网络应用</strong>。<strong class="is hj"> </strong>在<strong class="is hj">授权JavaScript起源</strong>下，输入<code class="du jp jq jr js b"><a class="ae lw" href="http://localhost" rel="noopener ugc nofollow" target="_blank">http://localhost</a></code>。同样，这是增加API请求安全性的一种方式。复制<code class="du jp jq jr js b">client ID</code>，忽略<code class="du jp jq jr js b">client secret</code>。</li></ol><p id="f6e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">粘贴后，再次尝试加载网页并按下<code class="du jp jq jr js b">Authorize</code>按钮。您应该通过Google OAuth提示符看到一个对Google Docs API的请求！</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/c0535e9dc669b0f9e6b96d1eb2a42737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQP6c3pfCHUa_wlHJly4ng.png"/></div></div></figure><p id="258e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">缺德！我们成功地用GAPI客户端调用了Google API！</p></div><div class="ab cl nc nd gp ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="hb hc hd he hf"><p id="3a4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">非常感谢你的阅读！如果您有兴趣了解G Suite的更多高级示例，请单击此处:</p><div class="nj nk ez fb nl nm"><a href="https://github.com/gsuitedevs/browser-samples" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hj fi z dy nr ea eb ns ed ef hh bi translated">gsuitedevs/browser-示例</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">G套件API文档的浏览器示例。克隆此存储库。按照API文件夹中的自述文件说明运行…</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">github.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa io nm"/></div></div></a></div><p id="d867" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您有兴趣阅读<code class="du jp jq jr js b">gapi</code>的文档，请点击此处:</p><div class="nj nk ez fb nl nm"><a href="https://github.com/google/google-api-javascript-client/" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hj fi z dy nr ea eb ns ed ef hh bi translated">Google/Google-API-JavaScript-客户端</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">用于浏览器JavaScript的Google APIs客户端库。-Google/Google-API-JavaScript-客户端</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">github.com</p></div></div><div class="nv l"><div class="ob l nx ny nz nv oa io nm"/></div></div></a></div></div></div>    
</body>
</html>