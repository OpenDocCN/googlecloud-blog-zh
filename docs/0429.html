<html>
<head>
<title>Google Cloud Storage : What bucket class for the best performance?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google云存储:最佳性能的桶类是什么？</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/google-cloud-storage-what-bucket-class-for-the-best-performance-5c847ac8f9f2?source=collection_archive---------0-----------------------#2017-11-09">https://medium.com/google-cloud/google-cloud-storage-what-bucket-class-for-the-best-performance-5c847ac8f9f2?source=collection_archive---------0-----------------------#2017-11-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/d9dc4b6b7d36750855f51f34b01f8003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8gFMHNLtQJj-DnrepTSjw.jpeg"/></div></div></figure><div class=""/><p id="4d25" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">关于Google云存储，我们最常见的一个性能问题是“为了获得最佳性能，我应该使用什么类型的存储桶？”</p><p id="eda5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了帮助理解这一点，让我们来描述这些桶，并运行一些测试来找出最佳情况。</p><h1 id="1b04" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">实用术语中的GCS桶</h1><p id="fb95" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">GCS要求您创建“存储桶”来放置您的资产，其中第一个问题是您想要什么类型的服务存储桶:</p><p id="eb5c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">区域、多区域、近线或冷藏。</p><figure class="ks kt ku kv fd hk er es paragraph-image"><div class="er es kr"><img src="../Images/5582ee988153722755e284f2341d0d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*b9o06-m2fazPKSXyxrHwZQ.png"/></div></figure><p id="d5df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Nearline和Coldline不是为高性能系统设计的，所以我们现在忽略它们，看看区域和多区域存储桶的性能。</p><p id="db19" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们澄清一些术语:</p><ul class=""><li id="6366" class="kw kx ht is b it iu ix iy jb ky jf kz jj la jn lb lc ld le bi translated"><strong class="is hu">区域</strong>与GCS数据中心的位置相关。</li><li id="e1ef" class="kw kx ht is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated">一个<strong class="is hu">多区域</strong>与一组<strong class="is hu">区域</strong>相关(这是一个层次问题)</li></ul><h1 id="5945" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">地区的</h1><p id="4a63" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">有一个常见的场景，您希望让某个客户端或本地系统将数据上传到云环境来完成计算工作，然后将信息返回给客户端。或者，用sysadmin术语来说:“<em class="lk">您希望您的虚拟机靠近您的数据源以最大化吞吐量</em>”</p><p id="acc2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正是因为这个原因，区域GCS存储桶保证该存储桶中的所有数据都位于指定的区域。</p><p id="f7e5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，公平地说，您无法细粒度地控制您的数据在区域中的哪个子区域；随着时间的推移，它可以迁移和移动。因此，写入延迟被复制到2个位置，其中每个位置都有不同的元数据列表，为了容错，会对其进行复制。这可能导致在写入时对所有其他元数据位置进行远程往返同步写入(由于强烈的写后读一致性)。</p><p id="e08b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这意味着区域存储桶非常适合数据处理，因为它们的物理距离相当近，并且写一致性的开销很低。</p><h1 id="266e" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">多区域</h1><p id="e21e" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated"><em class="lk">另一方面，</em>多区域存储保证了地理位置不同(相距100英里)的两个副本，这可以获得更好的远程延迟和可用性。</p><p id="5e58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更重要的是，multiregional大量利用边缘缓存和cdn向最终用户提供内容。</p><p id="0b87" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有这些冗余和缓存意味着多区域带来了同步和确保不同地理区域之间一致性的开销。因此，它更适合一次写入多次读取的情况。这意味着在全球范围内频繁访问(例如“热门”对象)，如网站内容、流媒体视频、游戏或移动应用程序。</p><h1 id="74c2" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">性能特征</h1><p id="09e3" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">为了提供真实的数字，我们设置了一个测试:将一个2MB的文件上传到一组区域和多区域存储桶，然后从us-west1中的一个虚拟机获取该资产(禁用缓存)。</p><figure class="ks kt ku kv fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ll"><img src="../Images/7e3f92f1f12f82c164f9861c7cf300de.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*OMEHn_lGtNBOupLh7wpsvg.png"/></div></div></figure><p id="b781" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该数据似乎表明多区域存储桶在跨洋读取方面表现明显更好，但是细节要比这稍微微妙一些。</p><p id="822f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回头看看日志，多区域存储桶在这些场景中表现更好的原因是，数据被复制到(多区域的)区域，这为我们的获取客户端提供了更好的访问点(和更低的延迟)。(为了证实这一点，我直接在us-west1和europe-west1之间运行了相同的精确测试，得到了大约175ms。)</p><h1 id="d97c" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">一场精彩的表演</h1><p id="cc98" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">这些测试向我们展示的是，桶<em class="lk">本身</em>的分类没有具体的性能差异。相反，性能是由客户端和云存储空间之间的物理距离的延迟决定的。</p><p id="9b5b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们在这里得到一个方便的小规则:</p><ul class=""><li id="875c" class="kw kx ht is b it iu ix iy jb ky jf kz jj la jn lb lc ld le bi translated"><strong class="is hu">如果缓存在</strong>上，并且你的访问量足够高，可以利用缓存，那么这两个产品之间没有太大的区别(我可以从测试中看到)。这展示了谷歌令人敬畏的CDN环境的威力。</li><li id="a049" class="kw kx ht is b it lf ix lg jb lh jf li jj lj jn lb lc ld le bi translated"><strong class="is hu">如果缓存关闭</strong>，或者访问量低到无法利用缓存，那么性能开销直接由物理因素决定。您应该尝试让资产尽可能靠近客户端，同时还要考虑成本以及数据需求所需的冗余和一致性类型。</li></ul></div></div>    
</body>
</html>