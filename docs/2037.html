<html>
<head>
<title>Hot Reload Node Cloud Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">热重装节点云功能</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/hot-reload-node-cloud-functions-64ffdb095a00?source=collection_archive---------0-----------------------#2021-12-20">https://medium.com/google-cloud/hot-reload-node-cloud-functions-64ffdb095a00?source=collection_archive---------0-----------------------#2021-12-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0d5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Google Cloud Function Framework for Node允许您在您的计算机上本地开发无服务器功能<strong class="ih hj">，方法是以与Google Cloud Functions上运行的<em class="jd">相同的方式</em>旋转web服务器。正如您可能知道的，本地开发大大提高了开发速度，而不是必须等待1-2分钟来部署您的功能。</strong></p><p id="0d54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">然而，</em>一个常见的开发者问题是，一旦你的函数在函数框架中运行，任何对你的源代码<strong class="ih hj">的<strong class="ih hj">更新</strong>都不会在运行的HTTP服务器中得到反映</strong>。</p><p id="5489" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博文中，我将简要介绍如何<strong class="ih hj">将</strong> <strong class="ih hj">热重装</strong>添加到<strong class="ih hj">节点云函数开发者工作流</strong>中。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/876ebe9d7b371775830d916c98c58822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x4thqCGI_Rk1BIogMZ-wAA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">这是一张我在南卡罗来纳州纳塔莱斯港喝拿铁热负荷休息的照片。我从来没有在编码的时候对另一杯拿铁说“不”。</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="998a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Node Functions框架是一个轻量级的库，它包装了流行而熟悉的TJ Holowaychuk的<em class="jd"> Express.js </em>框架。该框架允许您编写一个简单的服务器，在收到HTTP请求时调用您的函数:</p><blockquote class="kb kc kd"><p id="0731" class="if ig jd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated"><a class="ae kh" href="https://github.com/GoogleCloudPlatform/functions-framework-nodejs/" rel="noopener ugc nofollow" target="_blank">https://github . com/Google cloud platform/functions-framework-nodejs/</a></p></blockquote><h2 id="d911" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">运行简单的云函数</h2><p id="0364" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">在<code class="du li lj lk ll b">index.js</code>有一个简单的函数:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="2ac4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个最小的<code class="du li lj lk ll b">package.json</code>:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="1a9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要测试此功能:</p><ul class=""><li id="9e07" class="lo lp hi ih b ii ij im in iq lq iu lr iy ls jc lt lu lv lw bi translated">运行<code class="du li lj lk ll b">npm i</code>来安装函数框架</li><li id="6ddc" class="lo lp hi ih b ii lx im ly iq lz iu ma iy mb jc lt lu lv lw bi translated">运行<code class="du li lj lk ll b">npm start</code>启动功能框架</li></ul><p id="5f14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您可以转到<code class="du li lj lk ll b"><a class="ae kh" href="http://localhost:8080/" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/</a></code>并看到该函数被调用，其响应为:<code class="du li lj lk ll b">Hot-reload me?</code>。</p><p id="fd4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，如果您将<code class="du li lj lk ll b">'Hot-reload me?'</code>更改为<code class="du li lj lk ll b">'Why isn't it working???¿?'</code>并刷新页面，您仍然会看到旧的响应。:(</p><p id="f246" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个结果是因为节点程序只在启动框架(用<code class="du li lj lk ll b">npm start</code>)和启动web服务器时加载一次函数。</p><p id="669b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何解决这个问题？</p><h2 id="4e24" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated">介绍国家预防机制观察</h2><p id="f69a" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">理想情况下，无论何时<em class="jd"> </em>我们的源代码发生变化，我们都希望<em class="jd">自动</em>重启函数框架。</p><p id="fc14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了实现这一点，我们可以添加方便的<code class="du li lj lk ll b">npm-watch</code>包:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="62a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，我们就可以在<code class="du li lj lk ll b">*.js</code>文件发生任何变化时，运行<code class="du li lj lk ll b">npm run watch</code>来重新运行<code class="du li lj lk ll b">start</code>命令:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/24ac5badf67de49af5ef77f1a2d722c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrbIfxnYuKvBiwu7QZ8L2Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">通过nodemon重新加载函数</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="2dcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p><p id="9efe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这个，一定要鼓掌👏，或者写一篇✏️的评论，可能会出现在以后的帖子里！).我不再写那么多博客了，但是让我知道它们是否令人愉快，我可能会改变这一点:)</p><blockquote class="kb kc kd"><p id="033a" class="if ig jd ih b ii ij ik il im in io ip ke ir is it kf iv iw ix kg iz ja jb jc hb bi translated">感谢Preston Holmes对GitHub问题的关注和开源社区的热烈讨论:<a class="ae kh" href="https://github.com/GoogleCloudPlatform/functions-framework-nodejs/issues/24" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Google cloud platform/functions-framework-nodejs/issues/24</a></p></blockquote></div></div>    
</body>
</html>