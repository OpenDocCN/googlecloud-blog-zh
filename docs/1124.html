<html>
<head>
<title>How to deploy Cassandra and connect on Google Cloud Platform with a few clicks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Google云平台上部署Cassandra并通过几下点击进行连接</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/how-to-deploy-cassandra-and-connect-on-google-cloud-platform-with-a-few-clicks-11ee3d7001d1?source=collection_archive---------0-----------------------#2019-08-23">https://medium.com/google-cloud/how-to-deploy-cassandra-and-connect-on-google-cloud-platform-with-a-few-clicks-11ee3d7001d1?source=collection_archive---------0-----------------------#2019-08-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fa39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的一年里，我花了很多时间在谷歌云平台(GCP)上使用Cloud Bigtable。)最近，我想更好地了解市场上类似的大数据产品，特别是HBase和Cassandra。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/97640a9a41a555888c1f43582b56c524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-Rg_xU7Pf0B9J2DwRNfOQ.png"/></div></div></figure><p id="3bf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我以前从来没有设置过像Cassandra这样的东西，被我看过的所有教程视频吓倒了，但事实证明，使用GCP的点击部署是一个非常容易管理的任务。</p><h1 id="ac39" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">部署</h1><p id="84d1" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在启用了计费的GCP项目上，你可以导航到<a class="ae ks" href="https://console.cloud.google.com/marketplace" rel="noopener ugc nofollow" target="_blank">云市场</a>并搜索“Cassandra”</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/7e6d3a9aebea671c7e93ed1c5ce6f320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_5XS5AtaZa2g76gHFr3Lg.png"/></div></div></figure><p id="2fac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出现了几个选项，但我选择了运行在谷歌计算引擎上的<a class="ae ks" href="https://console.cloud.google.com/marketplace/details/click-to-deploy-images/cassandra?filter=solution-type:vm&amp;q=cassandra&amp;id=25ca0967-cd8e-419e-b554-fe32e87f04be" rel="noopener ugc nofollow" target="_blank"> Cassandra(谷歌点击部署)</a>版本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/44cb0306b4a0a3276f8d0af14de6bba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3yQqznjm00BAH1rfq3r9w.png"/></div></div></figure><p id="3b54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击“在计算引擎上启动”,您将看到一个部署配置表单。如果您更熟悉Cassandra，您可以保留所有默认设置或修改它们。我唯一改变的是启用Stackdriver日志记录和监控，以防我在调试时需要它们。一旦您对配置满意，提交表单来部署您的Cassandra集群！</p><h1 id="d90d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">连接</h1><p id="369f" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">几分钟后，您的群集将部署完毕，您可以连接了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/1114e57f2bc2af9ac67569ee05aa8a4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQQZOvi_BMGf9Ah675Iy0w.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">成功部署Cassandra集群</figcaption></figure><p id="3fe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击右侧窗格中的SSH按钮，打开一个将连接到您的集群的shell。在shell中，您可以通过键入<code class="du ky kz la lb b">cqlsh</code>来访问Cassandra命令行客户端。您可以创建一个键空间、表，添加一些数据，并通过shell对其进行查询。我关注了这个<a class="ae ks" href="https://vocon-it.com/2016/12/08/cassandra-hello-world-example/#Step_5_CreateKeyspace" rel="noopener ugc nofollow" target="_blank"> Hello World </a>，发现它非常有用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/81b63c2acf2fa602356c02ae46157051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XrH1DUppVAJh8EWDy42UQ.png"/></div></div></figure><p id="27e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还想用一个<a class="ae ks" href="https://cassandra.apache.org/doc/latest/getting_started/drivers.html" rel="noopener ugc nofollow" target="_blank">客户端驱动程序</a>连接到我的Cassandra集群，看看如何在实际应用程序中使用它。您需要创建一个新的防火墙规则，允许TCP通过端口9042访问，这样客户端就可以与集群对话。您可以使用以下gcloud命令:</p><pre class="je jf jg jh fd ld lb le lf aw lg bi"><span id="49e2" class="lh jq hi lb b fi li lj l lk ll">gcloud compute firewall-rules create cassandra-client --allow tcp:9042</span></pre><p id="1e85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者在GCP控制台的<a class="ae ks" href="https://console.cloud.google.com/networking/networks/list" rel="noopener ugc nofollow" target="_blank"> VPC网络</a>下创建防火墙。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/d4a666abc8411471403831da741e2c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX7E0hLi3iK0gUcti6OISw.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">VPC网络下的防火墙规则列表</figcaption></figure><p id="b333" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加一个针对网络中所有实例的防火墙规则，过滤0.0.0.0/0作为IP地址范围，并允许TCP:9042。<em class="lm">如果您将此用于生产目的，您应该指定一个</em> <a class="ae ks" href="https://cloud.google.com/vpc/docs/firewalls" rel="noopener ugc nofollow" target="_blank"> <em class="lm">更可控的防火墙规则</em> </a> <em class="lm">。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/36e5f1b048db2ef68da6e249f0e6a92b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cXnL06Dbyvufe_wQeu1bVQ.png"/></div></div></figure><p id="a20b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在您的防火墙已经设置好了，您可以连接您选择的<a class="ae ks" href="https://cassandra.apache.org/doc/latest/getting_started/drivers.html" rel="noopener ugc nofollow" target="_blank">客户端</a>。我决定使用<a class="ae ks" href="https://github.com/datastax/java-driver" rel="noopener ugc nofollow" target="_blank"> Datastax Java驱动程序</a>，并执行一个快速查询来查看我的连接是否成功。我使用第一个虚拟机的外部IP(可以在<a class="ae ks" href="https://console.cloud.google.com/compute/instances" rel="noopener ugc nofollow" target="_blank">虚拟机实例</a>中的计算引擎下找到)和区域(没有字母后缀的区域)作为本地数据中心的名称。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/7e6c989d9e7893000c2ac45f586c620e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6Gh79eM5X4FSeMOmksOHw.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated"><a class="ae ks" href="https://github.com/datastax/java-driver/blob/4.x/examples/src/main/java/com/datastax/oss/driver/examples/basic/ReadCassandraVersion.java" rel="noopener ugc nofollow" target="_blank">阅读卡珊德拉版本</a></figcaption></figure><p id="a607" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我很高兴看到我的查询成功了！</p><p id="1197" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关更多信息，请查阅<a class="ae ks" href="https://cassandra.apache.org/doc/latest/getting_started/index.html" rel="noopener ugc nofollow" target="_blank"> Apache文档</a>或<a class="ae ks" href="https://docs.datastax.com/en/archived/cassandra/3.0/" rel="noopener ugc nofollow" target="_blank"> Datastax文档</a>。</p><p id="2954" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lm">感谢</em> <a class="ae ks" rel="noopener" href="/@bexie"> <em class="lm">丹尼尔·伯格奎斯特</em></a><em class="lm">(</em><a class="ae ks" href="https://twitter.com/bexie" rel="noopener ugc nofollow" target="_blank"><em class="lm">@贝谢</em></a><em class="lm">)</em><a class="ae ks" rel="noopener" href="/@kristeno"><em class="lm">克里斯汀·奥利里</em> </a> <em class="lm">，以及</em> <a class="ae ks" rel="noopener" href="/@hostirosti"> <em class="lm">罗伯特·库比斯</em></a><em class="lm">(</em><a class="ae ks" href="https://twitter.com/hostirosti" rel="noopener ugc nofollow" target="_blank"><em class="lm">@ hostirosti</em></a></p></div></div>    
</body>
</html>