<html>
<head>
<title>Data Validation Made Easy Using — Data Validation Tool (DVT)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据验证变得简单易用—数据验证工具(DVT)</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/data-validation-made-easy-using-data-validation-tool-dvt-bbf33a9b75c3?source=collection_archive---------4-----------------------#2022-12-16">https://medium.com/google-cloud/data-validation-made-easy-using-data-validation-tool-dvt-bbf33a9b75c3?source=collection_archive---------4-----------------------#2022-12-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="df93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将数据从一个源移动到另一个源可能非常耗时，此外，开发人员将花费时间编写协调工具来验证数据传输，这使得数据迁移过程更加耗时且容易出错。去年，Google Cloud <a class="ae jd" href="https://cloud.google.com/blog/products/databases/automate-data-validation-with-dvt" rel="noopener ugc nofollow" target="_blank">发布了</a> DVT作为开源Python CLI工具，它可以跨多个数据库自动执行验证检查。</p><p id="0840" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">本博客的目标</strong>是在不到10分钟的时间内设置DVT并让您运行第一个数据验证任务。对于这个博客，我们将比较Postgres和BQ系统的数据，但DVT支持多个数据库，你可以在这里看到完整的支持列表<a class="ae jd" href="https://github.com/GoogleCloudPlatform/professional-services-data-validator" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="519b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤DVT的安装</p><p id="80aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">先决条件-在您的系统上运行python3.7+和gcc。</p><p id="11f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您不满足先决条件，那么请按照这里的详细说明<a class="ae jd" href="https://github.com/GoogleCloudPlatform/professional-services-data-validator/blob/develop/docs/installation.md" rel="noopener ugc nofollow" target="_blank">安装这些。</a></p><p id="6591" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">前面的步骤都完成了，现在让我们进入下一步</p><pre class="je jf jg jh fd ji jj jk bn jl jm bi"><span id="4e5f" class="jn jo hi jj b be jp jq l jr js">pip install google-pso-data-validator</span></pre><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es jt"><img src="../Images/57dcd8a1d61c375543671a3e1a80f972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Q9xxRWuXfw3uYQFjLEtvw.png"/></div></div></figure><p id="6b6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2 —设置DVT连接—为了让DVT能够与您的数据库对话，我们需要传递连接详细信息，同样在您的数据库端，确保您已经将运行DVT的机器的IP列入白名单</p><p id="b6a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置BQ连接</strong></p><pre class="je jf jg jh fd ji jj jk bn jl jm bi"><span id="099f" class="jn jo hi jj b be jp jq l jr js">data-validation connections add --connection-name bq_conn \<br/>BigQuery --project-id data-poc-1234</span></pre><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kb"><img src="../Images/4e7cefb0819da37bef0d0a3e4485d9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oop72bdQQ53y10Dk4Svp_g.png"/></div></div></figure><p id="4805" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[请注意:我在托管BQ数据集的同一个项目中的GCE上运行DVT</p><p id="62a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">设置Postgres连接</strong></p><pre class="je jf jg jh fd ji jj jk bn jl jm bi"><span id="52cf" class="jn jo hi jj b be jp jq l jr js">data-validation connections add -c postgres_conn Postgres \<br/>--host "XX.X.XXX.X" \<br/>--port 5432 \<br/>--user XXX \<br/>--password XXXX \<br/>--database testdb</span></pre><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kc"><img src="../Images/434163865eea69643c6e58af7d34e5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CiU08NHTaOwvwbQlr2kxww.png"/></div></div></figure><p id="e29d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本页<a class="ae jd" href="https://github.com/GoogleCloudPlatform/professional-services-data-validator/blob/develop/docs/connections.md" rel="noopener ugc nofollow" target="_blank">这里</a>有更多关于连接其他数据库的细节。</p><p id="f2c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第3步——所有设置我们已经准备好跨BQ和Postgres系统比较表，请注意DVT支持多种比较方式——行、列，还允许传递源和目标比较的自定义查询，这超出了本博客的范围。这里，我们将在我在Postgres和BQ上设置的表之间运行一个模式验证任务</p><pre class="je jf jg jh fd ji jj jk bn jl jm bi"><span id="f72b" class="jn jo hi jj b be jp jq l jr js">data-validation validate schema -sc postgres_conn -tc bq_conn -tbls testdb.src_table=sl-test-project-363109.postgres.rep_table</span></pre><p id="dd33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的命令中，我们传递了在步骤2中创建的连接，并尝试将Postgres 'src_table '中的源表与BQ 'rep_table '中的下游复制表进行比较。</p><figure class="je jf jg jh fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kd"><img src="../Images/3d8e8b6730b29b5948b7519a2e9da517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzkLSiWNTG7bUzbF83UF2A.png"/></div></div></figure><p id="ee5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DVT的标准输出打印在终端上，但也可以直接输出到BQ，您可以在那里转储您的结果。从屏幕截图中可以看到，DVT已经在不同数据库的两个表之间进行了比较，并在屏幕上输出了汇总报告</p><p id="5b12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">在结论</strong>中，我们已经安装了DVT，并从命令行运行了我们的第一个数据验证作业。</p></div></div>    
</body>
</html>