<html>
<head>
<title>Getting Started w/ Java on GCP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GCP上开始使用Java</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/getting-started-w-java-on-gcp-9c068638140f?source=collection_archive---------0-----------------------#2017-09-21">https://medium.com/google-cloud/getting-started-w-java-on-gcp-9c068638140f?source=collection_archive---------0-----------------------#2017-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="34b5" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">“缺失教程”系列</h2></div><p id="e130" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">写一篇简短的</em> <a class="ae ju" rel="noopener" href="/@DazWilkin/starting-w-google-cloud-platform-apis-41221830ba76"> <em class="jt">系列</em> </a> <em class="jt">【入门】帖子对于像我这样的人来说，他们可能想要针对谷歌服务编写代码，选择了一种语言，但在一两周没有编写代码之后，我被“我到底该如何入门”所困扰</em></p><h2 id="a412" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">设置</h2><p id="4037" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">我运行的是(Linux)，Java (openjdk-8-jdk)，Apache Maven (3.5.0)。</p><p id="e7df" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将使用Maven，因为它是我最熟悉的Java构建工具。Google提供了与Maven和Gradle的工具集成，例如App Engine。当然，您也可以手动管理软件包。</p><p id="38c1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们设置我们的环境:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="edcb" class="jv jw hi la b fi le lf l lg lh">PROJECT_ID=[[YOUR-PROJECT-ID]]<br/>LANG=java</span><span id="d1bf" class="jv jw hi la b fi li lf l lg lh">mkdir -p ${HOME}/${PROJECT_ID}/${LANG}<br/>cd ${HOME}/${PROJECT_ID}/${LANG}</span></pre><h2 id="ba54" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">谷歌Java库</h2><p id="a9e1" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">在基础文章“<a class="ae ju" rel="noopener" href="/@DazWilkin/starting-w-google-cloud-platform-apis-41221830ba76">开始使用Google云平台API</a>”中，我总结了Google提供的两个库:</p><p id="6c7f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="jt"> API客户端库</em> </strong></p><p id="6404" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">API客户端库被分解成一个核心包(google-api-client)和特定于服务的包。在这篇文章中，我们将使用谷歌云存储(GCS ),因此我们也需要引用GCS JSON API包(google-api-services-storage)。</p><p id="474c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谷歌</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c0e7" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://developers.google.com/api-client-library/java/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/api-client-library/java/</a><br/><a class="ae ju" href="https://developers.google.com/api-client-library/java/apis/" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/api-client-library/java/apis/</a></span></pre><p id="cae7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">专家</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="72f2" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://mvnrepository.com/artifact/com.google.api-client/google-api-client" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/com.google.api-client/google-api-client</a><br/><a class="ae ju" href="https://mvnrepository.com/artifact/com.google.apis/google-api-services-storage" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/com.google.apis/google-api-services-storage</a></span></pre><p id="ca04" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当前库是1.22.0，mvnrepository为pom.xml文件生成XML:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="a238" class="jv jw hi la b fi le lf l lg lh">&lt;dependency&gt;<br/>  &lt;groupId&gt;com.google.api-client&lt;/groupId&gt;<br/>  &lt;artifactId&gt;google-api-client&lt;/artifactId&gt;<br/>  &lt;version&gt;1.22.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span><span id="ad21" class="jv jw hi la b fi li lf l lg lh">&lt;dependency&gt;<br/>  &lt;groupId&gt;com.google.apis&lt;/groupId&gt;<br/>  &lt;artifactId&gt;google-api-services-storage&lt;/artifactId&gt;<br/>  &lt;version&gt;v1-rev111-1.18.0-rc&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="ff7f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">开源代码库</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c6ce" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://github.com/google/google-api-java-client" rel="noopener ugc nofollow" target="_blank">https://github.com/google/google-api-java-client</a></span></pre><p id="ec21" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="jt">云客户端库</em> </strong></p><p id="1ed4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> NB </strong>云客户端库的发布周期滞后于底层服务。服务可能是正式版，但云客户端库*可能是Alpha版。</p><p id="279e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谷歌</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d9c5" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://cloud.google.com/apis/docs/cloud-client-libraries" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/apis/docs/cloud-client-libraries</a></span></pre><p id="79ef" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">专家</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6574" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://mvnrepository.com/artifact/com.google.cloud/google-cloud-core" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/com.google.cloud/google-cloud-core</a><br/></span></pre><p id="3a6f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当前的核心库是1.6.0，Google云存储库也是1.6.0:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="66dc" class="jv jw hi la b fi le lf l lg lh">&lt;dependency&gt;<br/>    &lt;groupId&gt;com.google.cloud&lt;/groupId&gt;<br/>    &lt;artifactId&gt;google-cloud-core&lt;/artifactId&gt;<br/>    &lt;version&gt;1.6.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span><span id="b6ec" class="jv jw hi la b fi li lf l lg lh">&lt;dependency&gt;<br/>    &lt;groupId&gt;com.google.cloud&lt;/groupId&gt;<br/>    &lt;artifactId&gt;google-cloud-storage&lt;/artifactId&gt;<br/>    &lt;version&gt;1.6.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="dede" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">开源代码库</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1168" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://googlecloudplatform.github.io/google-cloud-java/0.24.0/index.html" rel="noopener ugc nofollow" target="_blank">https://googlecloudplatform.github.io/google-cloud-java/0.24.0/index.html</a><br/><a class="ae ju" href="https://github.com/GoogleCloudPlatform/google-cloud-java" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/google-cloud-java</a></span></pre><p id="6911" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">API文档:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="59fd" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/index.html" rel="noopener ugc nofollow" target="_blank">https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/index.html</a></span></pre><p id="40c8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧，让我们写一些代码。</p><h2 id="022e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">谷歌云存储</h2><p id="abf8" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">在这个例子中，我们将使用<a class="ae ju" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank">谷歌云存储</a>。</p><p id="03f7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以通过<strong class="iz hj"> API </strong>客户端库使用谷歌的任何服务，因为<a class="ae ju" href="https://developers.google.com/api-client-library/java/apis/" rel="noopener ugc nofollow" target="_blank">所有这些</a>客户端库都支持它们。</p><p id="7cb0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谷歌的许多服务都得到云客户端库的支持，尽管它们的发布节奏与底层服务不同。你可以在这里看到列表<a class="ae ju" href="https://github.com/GoogleCloudPlatform/google-cloud-java" rel="noopener ugc nofollow" target="_blank"/>以及库是Alpha、Beta还是GA。</p><p id="13ca" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择一个您不介意在GCS bucket上复制多次的任意(小)文件，并:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="4167" class="jv jw hi la b fi le lf l lg lh">BUCKET=$(whoami)-$(date +%y%m%d%H%M)<br/>FILE=[[/Path/To/Your/File]]</span><span id="c203" class="jv jw hi la b fi li lf l lg lh">gsutil mb -p ${PROJECT_ID} gs://${BUCKET}<br/>Creating gs://${BUCKET}/...</span><span id="2700" class="jv jw hi la b fi li lf l lg lh">for i in $(seq -f "%02g" 1 10)<br/>do<br/>  gsutil cp $FILE gs://${BUCKET}/${i}<br/>done</span><span id="800b" class="jv jw hi la b fi li lf l lg lh">gsutil ls gs://${BUCKET}<br/>gs://${BUCKET}/01<br/>gs://${BUCKET}/02<br/>gs://${BUCKET}/03<br/>gs://${BUCKET}/04<br/>gs://${BUCKET}/05<br/>gs://${BUCKET}/06<br/>gs://${BUCKET}/07<br/>gs://${BUCKET}/08<br/>gs://${BUCKET}/09<br/>gs://${BUCKET}/10</span></pre><h2 id="e043" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">应用程序默认凭据(ADC)</h2><p id="17b0" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">使用Google APIs时，ADCs是一种获取身份验证凭证的简单方法，还有一个好处是代码可以从本地工作站移植到应用引擎和计算引擎。如果可以，请始终使用ADC。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b093" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://developers.google.com/identity/protocols/application-default-credentials" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/identity/protocols/application-default-credentials</a><a class="ae ju" href="https://developers.google.com/identity/protocols/application-default-credentials#callingjava" rel="noopener ugc nofollow" target="_blank"><br/>https://developers.google.com/identity/protocols/application-default-credentials#callingjava</a></span></pre><p id="829b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与Google的其他Java资产一样，ADC可以从mvnrepository获得:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="33cb" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://mvnrepository.com/artifact/com.google.apis/google-api-services-oauth2" rel="noopener ugc nofollow" target="_blank">https://mvnrepository.com/artifact/com.google.apis/google-api-services-oauth2</a></span></pre><p id="ab95" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您需要在Maven pom.xml中引用ADC作为依赖项:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="93d6" class="jv jw hi la b fi le lf l lg lh">&lt;dependency&gt;<br/>  &lt;groupId&gt;com.google.apis&lt;/groupId&gt;<br/>  &lt;artifactId&gt;google-api-services-oauth2&lt;/artifactId&gt;<br/>  &lt;version&gt;v2-rev129-1.22.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><h2 id="0fe8" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">解决方案1:使用API客户端库</h2><p id="8342" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">事实上，习惯上，我手动为Java项目创建目录，但是我使用Maven在Googled上搜索了正确的方法:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1182" class="jv jw hi la b fi le lf l lg lh">mvn archetype:generate \<br/>--batch-mode \<br/>--define archetypeGroupId=org.apache.maven.archetypes \<br/>--define groupId=com.google.dazwilkin \<br/>--define artifactId=api</span></pre><p id="7683" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将生成一个名为“api”的目录，其中包含一个默认的pom.xml和一个包含模板Java文件的“src”目录树。</p><p id="31a2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用您喜欢的编辑器(或IDE)，打开pom.xml:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1029" class="jv jw hi la b fi le lf l lg lh">&lt;project ...&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;com.google.dazwilkin&lt;/groupId&gt;<br/>  &lt;artifactId&gt;api&lt;/artifactId&gt;<br/>  &lt;packaging&gt;jar&lt;/packaging&gt;<br/>  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/>  &lt;name&gt;api&lt;/name&gt;<br/>  &lt;url&gt;<a class="ae ju" href="http://maven.apache.org" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org</a>&lt;/url&gt;<br/>  &lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;junit&lt;/groupId&gt;<br/>      &lt;artifactId&gt;junit&lt;/artifactId&gt;<br/>      &lt;version&gt;3.8.1&lt;/version&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;<br/>  &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="abcb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加API客户端库依赖项和依赖项，以便可以使用应用程序默认凭据。保存文件。结果应该类似于:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e9b3" class="jv jw hi la b fi le lf l lg lh">&lt;project&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;com.google.dazwilkin&lt;/groupId&gt;<br/>  &lt;artifactId&gt;api&lt;/artifactId&gt;<br/>  &lt;packaging&gt;jar&lt;/packaging&gt;<br/>  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/>  &lt;name&gt;api&lt;/name&gt;<br/>  &lt;url&gt;<a class="ae ju" href="http://maven.apache.org" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org</a>&lt;/url&gt;<br/>  &lt;dependencies&gt;</span><span id="ffce" class="jv jw hi la b fi li lf l lg lh">    &lt;dependency&gt;<br/>      &lt;groupId&gt;junit&lt;/groupId&gt;<br/>      &lt;artifactId&gt;junit&lt;/artifactId&gt;<br/>      &lt;version&gt;3.8.1&lt;/version&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;</span><span id="00b4" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- Google API Client Library --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.api-client&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-api-client&lt;/artifactId&gt;<br/>      &lt;version&gt;1.22.0&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="911c" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- API Client Library: Storage --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.apis&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-api-services-storage&lt;/artifactId&gt;<br/>      &lt;version&gt;v1-rev111-1.18.0-rc&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="564d" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- Application Default Credentials --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.apis&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-api-services-oauth2&lt;/artifactId&gt;<br/>      &lt;version&gt;v2-rev129-1.22.0&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="b877" class="jv jw hi la b fi li lf l lg lh">  &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="2e09" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后打开生成的App.java:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="387c" class="jv jw hi la b fi le lf l lg lh">package com.google.dazwilkin;</span><span id="3eb4" class="jv jw hi la b fi li lf l lg lh">public class App <br/>{<br/>    public static void main( String[] args )<br/>    {<br/>        System.out.println( "Hello World!" );<br/>    }<br/>}</span></pre><p id="e6fe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">可选</em>:我建议把App.java改名为CloudStorage.java，把class App也改名为CloudStorage。</p><p id="1047" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们一点一点来。</p><p id="baa3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将从应用程序默认凭证Java <a class="ae ju" href="https://developers.google.com/identity/protocols/application-default-credentials#callingjava" rel="noopener ugc nofollow" target="_blank">示例</a>中复制一些样板代码，虽然Google没有明确记录这一点，但您可以看到实例化存储服务的一致示例:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ce9b" class="jv jw hi la b fi le lf l lg lh">private static HttpTransport httpTransport;</span><span id="12c7" class="jv jw hi la b fi li lf l lg lh">private static final JsonFactory JSON_FACTORY = JacksonFactory.getDefaultInstance();</span><span id="b18e" class="jv jw hi la b fi li lf l lg lh">httpTransport = GoogleNetHttpTransport.newTrustedTransport();</span><span id="c835" class="jv jw hi la b fi li lf l lg lh">GoogleCredential credential = GoogleCredential.getApplicationDefault();</span><span id="f093" class="jv jw hi la b fi li lf l lg lh">Storage storage = new Storage.Builder(<br/>    httpTransport,<br/>    JSON_FACTORY,<br/>    credential<br/>).setApplicationName(<br/>    APPLICATION_NAME<br/>).build();</span></pre><p id="1d4a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好消息是，这个样板文件适用于所有Google的服务，所以您将看到并可以将这个模式用于任何其他服务。</p><p id="3ee5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">API客户端库采用一致的模式来引用服务资源，并根据这些资源进行方法调用:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6e64" class="jv jw hi la b fi le lf l lg lh">service.resources().verb().execute()</span></pre><p id="2604" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您将在下面的代码中看到我们使用了两次这种模式:一次是获取项目的bucket，另一次是获取bucket的对象:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ad2e" class="jv jw hi la b fi le lf l lg lh">storage.buckets().list().execute()<br/>storage.objects().list().execute()</span></pre><p id="1f70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与本系列中的其他示例一样，虽然可以通过查看API文档来理解API，但我发现最简单的方法是用API Explorer复制我的意图，然后对其进行编码。</p><p id="c513" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，例如，要枚举项目中的存储桶，可以查看API Explorer条目，并看到<strong class="iz hj"> storage.buckets.list </strong>“检索给定项目的存储桶列表”</p><figure class="kv kw kx ky fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/f2b911b0245f981f9248df89f67b7f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pjzgpQGfnCtx8IEm33h4w.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">云存储JSON API v1</figcaption></figure><p id="ad63" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，使用storage.buckets.list创建一个调用，按预期返回项目的存储桶。注意:虽然我没有在此屏幕截图中显示铲斗的详细信息，但200表示通话成功:</p><figure class="kv kw kx ky fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lv"><img src="../Images/fbb819e4102316878cb7145c132669f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eq35axmTPCYNWtHiqK9y6A.png"/></div></div></figure><p id="0f70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着您对API客户端库的熟悉，您会发现针对不同的服务清除代码变得更加容易。因为，虽然它不一定是惯用的，但它是一致的。学习如何为一个服务编码，你将能够为任何一个服务编码。</p><p id="972a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，实际上，继续快速浏览一下Java文档:</p><figure class="kv kw kx ky fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lw"><img src="../Images/9472146f79d9a6448ef3556ec7e330f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucaJ2GT4qakS57QzzOuHRw.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated"><a class="ae ju" href="https://developers.google.com/resources/api-libraries/documentation/storage/v1/java/latest/" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/resources/API-libraries/documentation/storage/v1/Java/latest/</a></figcaption></figure><p id="9d31" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">获得以下代码相对简单:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="78aa" class="jv jw hi la b fi le lf l lg lh">Storage.Buckets.List bucketsList = storage.buckets().list(PROJECT_ID);<br/>Buckets buckets;<br/>do {<br/>    buckets = bucketsList.execute();<br/>    List&lt;Bucket&gt; items = buckets.getItems();<br/>    if (items != null) {<br/>        for (Bucket bucket: items) {<br/>            System.out.println(bucket.getName());    <br/>        }<br/>    }<br/>    bucketsList.setPageToken(buckets.getNextPageToken());<br/>} while (buckets.getNextPageToken()!=null);</span></pre><p id="8b54" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这段代码最复杂的部分是分页；-)出于性能原因，并且因为枚举可能很大，API实现的最佳实践是在页面中提供桶列表。要枚举整个列表，需要检索每一页，获取下一页的令牌，并将其传递回API，然后重新执行API调用。</p><p id="1df8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以放心地看到，枚举bucket中对象的代码在结构上与bucket枚举代码非常相似:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="949b" class="jv jw hi la b fi le lf l lg lh">Storage.Objects.List objectsList = storage.objects().list(BUCKET_NAME);<br/>Objects objects;<br/>do {<br/>    objects = objectsList.execute();<br/>    List&lt;StorageObject&gt; items = objects.getItems();<br/>    if (items != null) {<br/>        for (StorageObject object : items) {<br/>            System.out.println(object.getName());<br/>        }<br/>    }<br/>    objectsList.setPageToken(objects.getNextPageToken());<br/>} while (objects.getNextPageToken()!=null);</span></pre><p id="16ec" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样，复杂性主要在于重复执行API调用的循环，直到不再有要检索的对象页面。返回到API Explorer，此方法实现storage.objects.list，它“检索匹配标准的对象列表”:</p><figure class="kv kw kx ky fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/3440228e80e09749824cac0b86fc6541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30fW6u9W-J9i9iGqBUI8Lg.png"/></div></div></figure><p id="368f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将这些放在一起，并添加您将需要的许多导入语句:</p><p id="63ed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">pom.xml:</p><figure class="kv kw kx ky fd lk"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="54b6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">CloudStorage.java:</p><figure class="kv kw kx ky fd lk"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="afb8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可能有更好的方法来构建和运行解决方案，但我的方法是:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ae2d" class="jv jw hi la b fi le lf l lg lh">mvn clean install --quiet</span><span id="8e95" class="jv jw hi la b fi li lf l lg lh">-------------------------------------------------------<br/> T E S T S<br/>-------------------------------------------------------<br/>Running com.google.dazwilkin.CloudStorageTest<br/>Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.028 sec</span><span id="59ef" class="jv jw hi la b fi li lf l lg lh">Results :</span><span id="6cdb" class="jv jw hi la b fi li lf l lg lh">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span></pre><p id="0d66" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="a738" class="jv jw hi la b fi le lf l lg lh">mvn exec:java \<br/>-define exec.mainClass="com.google.dazwilkin.CloudStorage" \<br/>--quiet</span><span id="dfdc" class="jv jw hi la b fi li lf l lg lh">[[BUCKET]]<br/>01<br/>02<br/>03<br/>04<br/>05<br/>06<br/>07<br/>08<br/>09<br/>10</span></pre><h2 id="556c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">解决方案2:使用云客户端库</h2><p id="4b86" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">与解决方案1一样，让我们使用Maven为我们生成项目结构:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9282" class="jv jw hi la b fi le lf l lg lh">mvn archetype:generate \<br/>--batch-mode \<br/>--define archetypeGroupId=org.apache.maven.archetypes \<br/>--define groupId=com.google.dazwilkin \<br/>--define artifactId=cld</span></pre><p id="4b29" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">打开pom.xml:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="8690" class="jv jw hi la b fi le lf l lg lh">&lt;project&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;com.google.dazwilkin&lt;/groupId&gt;<br/>  &lt;artifactId&gt;cld&lt;/artifactId&gt;<br/>  &lt;packaging&gt;jar&lt;/packaging&gt;<br/>  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/>  &lt;name&gt;cld&lt;/name&gt;<br/>  &lt;url&gt;<a class="ae ju" href="http://maven.apache.org" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org</a>&lt;/url&gt;<br/>  &lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;junit&lt;/groupId&gt;<br/>      &lt;artifactId&gt;junit&lt;/artifactId&gt;<br/>      &lt;version&gt;3.8.1&lt;/version&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;<br/>  &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="beec" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一次，我们将为核心和云存储添加云客户端库包，以及应用程序默认凭据包。您的pom.xml应该如下所示:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="328e" class="jv jw hi la b fi le lf l lg lh">&lt;project&gt;<br/>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>  &lt;groupId&gt;com.google.dazwilkin&lt;/groupId&gt;<br/>  &lt;artifactId&gt;cld&lt;/artifactId&gt;<br/>  &lt;packaging&gt;jar&lt;/packaging&gt;<br/>  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;<br/>  &lt;name&gt;cld&lt;/name&gt;<br/>  &lt;url&gt;<a class="ae ju" href="http://maven.apache.org" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org</a>&lt;/url&gt;<br/>  &lt;dependencies&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;junit&lt;/groupId&gt;<br/>      &lt;artifactId&gt;junit&lt;/artifactId&gt;<br/>      &lt;version&gt;3.8.1&lt;/version&gt;<br/>      &lt;scope&gt;test&lt;/scope&gt;<br/>    &lt;/dependency&gt;</span><span id="acfb" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- Google Cloud Core --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.cloud&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-cloud-core&lt;/artifactId&gt;<br/>      &lt;version&gt;1.6.0&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="6c8c" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- Google Cloud Storage --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.cloud&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-cloud-storage&lt;/artifactId&gt;<br/>      &lt;version&gt;1.6.0&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="f3d3" class="jv jw hi la b fi li lf l lg lh">    &lt;!-- Application Default Credentials --&gt;<br/>    &lt;dependency&gt;<br/>      &lt;groupId&gt;com.google.apis&lt;/groupId&gt;<br/>      &lt;artifactId&gt;google-api-services-oauth2&lt;/artifactId&gt;<br/>      &lt;version&gt;v2-rev129-1.22.0&lt;/version&gt;<br/>    &lt;/dependency&gt;</span><span id="0519" class="jv jw hi la b fi li lf l lg lh">  &lt;/dependencies&gt;<br/>&lt;/project&gt;</span></pre><p id="66d0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后打开生成的App.java:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="df71" class="jv jw hi la b fi le lf l lg lh">package com.google.dazwilkin;</span><span id="ea2e" class="jv jw hi la b fi li lf l lg lh">public class App <br/>{<br/>    public static void main( String[] args )<br/>    {<br/>        System.out.println( "Hello World!" );<br/>    }<br/>}</span></pre><p id="3b70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">可选</em>:我建议把App.java改名为CloudStorage.java，把class App也改名为CloudStorage。</p><p id="9cea" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">好吧…让欢乐开始吧。</p><p id="7026" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">碰巧Google Cloud文档现在通常使用云客户端库示例(而不是早期的API客户端库),因此有几个示例可以帮助我们开始使用云存储:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="16d1" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://github.com/GoogleCloudPlatform/google-cloud-java/tree/master/google-cloud-storage" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/google-cloud-java/tree/master/google-cloud-storage</a></span><span id="ffd4" class="jv jw hi la b fi li lf l lg lh"><a class="ae ju" href="https://cloud.google.com/storage/docs/reference/libraries#client-libraries-usage-java" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/storage/docs/reference/libraries#client-libraries-usage-java</a><br/></span></pre><p id="7741" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，老实说，作为一个Java业余爱好者，拥有这些轻量级的示例和API文档对我来说远远不够。因此，我发现这比API客户端库解决方案更难(有了它，其他语言的一致性和使用Google API Explorer的能力是非常有帮助的)。</p><p id="836c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是API文档:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1cde" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/index.html" rel="noopener ugc nofollow" target="_blank">https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/index.html</a><br/><a class="ae ju" href="https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/com/google/cloud/storage/package-summary.html" rel="noopener ugc nofollow" target="_blank">https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/com/google/cloud/storage/package-summary.html</a></span></pre><p id="60c9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于缺少示例，我从这些API文档中不清楚如何实例化服务，如何使用Bucket|BucketInfo和Blob|BlobInfo，这些支持什么方法等等。:-(其他人是怎么做到的？</p><p id="384e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以…抄袭…</p><p id="99fa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">GitHub文档很好地解释了授权流程:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9145" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://github.com/GoogleCloudPlatform/google-cloud-java#authentication" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/google-cloud-java#authentication</a></span></pre><p id="7b85" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我发现，当使用ADC并在本地(GCP以外)或计算引擎实例上运行时，以下代码就足够了:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="bc6e" class="jv jw hi la b fi le lf l lg lh">Storage storage = StorageOptions.getDefaultInstance().getService();</span></pre><p id="aa11" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">GitHub文档提供了一个枚举项目存储桶以及每个存储桶中的对象的示例:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d2e2" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://github.com/GoogleCloudPlatform/google-cloud-java/tree/master/google-cloud-storage#listing-buckets-and-contents-of-buckets" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/google-cloud-java/tree/master/google-cloud-storage#listing-buckets-and-contents-of-buckets</a></span></pre><p id="aba4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我稍微调整了一下，以反映解决方案#1中的代码，它枚举所有的桶，然后枚举特定桶中的对象:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="d13b" class="jv jw hi la b fi le lf l lg lh">for (Bucket bucket : storage.list().iterateAll()) {<br/>    System.out.println(bucket.getName());<br/>}</span><span id="cf27" class="jv jw hi la b fi li lf l lg lh">Bucket bucket = storage.get(BUCKET_NAME);<br/>for (Blob blob : bucket.list().iterateAll()) {<br/>        System.out.println(blob.getName());<br/>}</span></pre><p id="ac3b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">老实说，我发现将iterateAll应用于list方法的例子只是在我现在编写这个示例时:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="dc32" class="jv jw hi la b fi le lf l lg lh"><a class="ae ju" href="https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/com/google/cloud/storage/Storage.html#list-java.lang.String-com.google.cloud.storage.Storage.BlobListOption...-" rel="noopener ugc nofollow" target="_blank">https://googlecloudplatform.github.io/google-cloud-java/0.24.0/apidocs/com/google/cloud/storage/Storage.html#list-java.lang.String-com.google.cloud.storage.Storage.BlobListOption...-</a></span></pre><p id="cdbf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我用的是:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="dee9" class="jv jw hi la b fi le lf l lg lh">for (Bucket bucket : storage.list().iterateAll()) {<br/>    System.out.println(bucket.getName());<br/>}</span></pre><p id="bda3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，对于特定存储桶(存储桶名称)中的对象:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="4d8f" class="jv jw hi la b fi le lf l lg lh">Bucket bucket = storage.get(BUCKET_NAME);<br/>for (Blob blob : bucket.list().iterateAll()) {<br/>        System.out.println(blob.getName());<br/>}</span></pre><p id="ebdc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将这些与pom.xml和您需要的导入放在一起:</p><figure class="kv kw kx ky fd lk"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="2817" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并且:</p><figure class="kv kw kx ky fd lk"><div class="bz dy l di"><div class="lx ly l"/></div></figure><p id="dacf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">和以前一样:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2028" class="jv jw hi la b fi le lf l lg lh">mvn clean install --quiet</span><span id="882b" class="jv jw hi la b fi li lf l lg lh">-------------------------------------------------------<br/> T E S T S<br/>-------------------------------------------------------<br/>Running com.google.dazwilkin.CloudStorageTest<br/>Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec</span><span id="9c1d" class="jv jw hi la b fi li lf l lg lh">Results :</span><span id="fbe7" class="jv jw hi la b fi li lf l lg lh">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</span></pre><p id="4ebd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ca7e" class="jv jw hi la b fi le lf l lg lh">mvn exec:java \<br/>--define exec.mainClass="com.google.dazwilkin.CloudStorage" \<br/>--quiet</span><span id="8d70" class="jv jw hi la b fi li lf l lg lh">dazwilkin-1708301815<br/>01<br/>02<br/>03<br/>04<br/>05<br/>06<br/>07<br/>08<br/>09<br/>10</span></pre><h2 id="c82f" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">整理</h2><p id="c59b" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">完成后，您可以删除存储桶(及其对象)。在执行此删除操作时，要非常小心地指定正确的存储桶。它删除所有对象，然后删除存储桶:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7c30" class="jv jw hi la b fi le lf l lg lh">gsutil rm -r gs://${BUCKET}</span></pre><h2 id="6676" class="jv jw hi bd jx jy jz ka kb kc kd ke kf jg kg kh ki jk kj kk kl jo km kn ko kp bi translated">结论</h2><p id="c9ae" class="pw-post-body-paragraph ix iy hi iz b ja kq ij jc jd kr im jf jg ks ji jj jk kt jm jn jo ku jq jr js hb bi translated">Java的API客户端库非常简单。一旦你熟悉了针对一个服务的编码，你就熟悉了如何针对谷歌服务的编码。使用API Explorer内省服务及其方法，然后测试API的能力，使得API Explorer在使用API客户端库进行开发时非常有用。</p><p id="d4e7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于Java的云客户端库，我感觉和我开始写这篇文章时一样不熟悉:-(cloud.google.com上提供的每个服务的示例和GitHub示例都很好，但是还不够。我希望这只是对我的一个挑战，但我担心其他开发人员也可能会在构建这些库时遇到困难。</p></div></div>    
</body>
</html>