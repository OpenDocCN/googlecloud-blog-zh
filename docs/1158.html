<html>
<head>
<title>How to run serverless batch jobs on Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Google Cloud上运行无服务器批处理作业</h1>
<blockquote>原文：<a href="https://medium.com/google-cloud/how-to-run-serverless-batch-jobs-on-google-cloud-ca45a4e33cb1?source=collection_archive---------1-----------------------#2019-09-30">https://medium.com/google-cloud/how-to-run-serverless-batch-jobs-on-google-cloud-ca45a4e33cb1?source=collection_archive---------1-----------------------#2019-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="05e6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">对于耗时超过几分钟的功能，使用人工智能平台</h2></div><p id="c807" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">云函数、云运行、AppEngine等。对于长时间运行的功能来说并不是一个好的选择，也就是说，任何运行时间超过几分钟的功能(服务本身限制在10到15分钟，但是包括错误和重试，所以您的目标应该是最多2到3分钟)。如果你想运行一个比这个时间更长的函数，你有什么选择？</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/fd9516f75ab0ea37987b5abddffcdba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ek5RG39Ky3XVKE3RaFoPVA.png"/></div></div></figure><p id="6d9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您想以无服务器方式运行长时间运行的批处理作业，该怎么办？</p><p id="9daa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">把你的代码放在Docker容器中。使用人工智能平台运行它。使用云调度程序对其进行调度。</p><h2 id="904d" class="kf kg hi bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz bi translated">人工智能平台培训中的定制容器</h2><p id="9ecb" class="pw-post-body-paragraph ix iy hi iz b ja la ij jc jd lb im jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">你可以使用AI平台训练<a class="ae lf" href="https://cloud.google.com/ml-engine/docs/custom-containers-training" rel="noopener ugc nofollow" target="_blank">运行任何任意Docker容器</a>——不一定是机器学习的工作。要在GPU上执行任意容器，您只需:</p><pre class="ju jv jw jx fd lg lh li lj aw lk bi"><span id="6bbd" class="kf kg hi lh b fi ll lm l ln lo">gcloud ai-platform jobs submit training gpu_function \<br/>  --scale-tier BASIC_GPU \<br/>  --region $REGION \<br/>  --master-image-uri gcr.io/$PROJECT_ID/some-image-name</span></pre><p id="b689" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这只是一个REST API，所以您可以从许多编程语言中的各种客户端库调用它。对容器没有任何要求——只是它需要有一个入口点，并且在容器注册表中发布。可以使用定制的机器类型——详见<a class="ae lf" href="https://cloud.google.com/ml-engine/docs/custom-containers-training" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h2 id="33e1" class="kf kg hi bd kh ki kj kk kl km kn ko kp jg kq kr ks jk kt ku kv jo kw kx ky kz bi translated">并发自动缩放？</h2><p id="c087" class="pw-post-body-paragraph ix iy hi iz b ja la ij jc jd lb im jf jg lc ji jj jk ld jm jn jo le jq jr js hb bi translated">能够在特定于作业的集群上启动自定义容器满足了许多无服务器功能的用例。但不是全部。具体来说，无服务器功能的另一个用例是并发自动扩展—我们希望能够接收多个请求，并将它们路由到同一台机器，一旦该机器开始不堪重负，我们希望添加更多的机器。如果您需要并行自动缩放，并且您的任务持续时间超过2-3分钟，那么AI平台培训解决方案将不起作用。在这种情况下，您将需要Kubernetes，并且它不会是无服务器的。</p></div></div>    
</body>
</html>